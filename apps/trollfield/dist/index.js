(function(){const c=document.createElement("link").relList;if(c&&c.supports&&c.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))s(d);new MutationObserver(d=>{for(const m of d)if(m.type==="childList")for(const _ of m.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&s(_)}).observe(document,{childList:!0,subtree:!0});function f(d){const m={};return d.integrity&&(m.integrity=d.integrity),d.referrerpolicy&&(m.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?m.credentials="include":d.crossorigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function s(d){if(d.ep)return;d.ep=!0;const m=f(d);fetch(d.href,m)}})();function tp(o,c){const f=Object.create(null),s=o.split(",");for(let d=0;d<s.length;d++)f[s[d]]=!0;return c?d=>!!f[d.toLowerCase()]:d=>!!f[d]}const In={},Gs=[],ar=()=>{},By=()=>!1,Uy=/^on[^a-z]/,lu=o=>Uy.test(o),np=o=>o.startsWith("onUpdate:"),ai=Object.assign,ip=(o,c)=>{const f=o.indexOf(c);f>-1&&o.splice(f,1)},zy=Object.prototype.hasOwnProperty,_n=(o,c)=>zy.call(o,c),tn=Array.isArray,Vs=o=>cu(o)==="[object Map]",Z0=o=>cu(o)==="[object Set]",hn=o=>typeof o=="function",ni=o=>typeof o=="string",rp=o=>typeof o=="symbol",On=o=>o!==null&&typeof o=="object",J0=o=>On(o)&&hn(o.then)&&hn(o.catch),$0=Object.prototype.toString,cu=o=>$0.call(o),Gy=o=>cu(o).slice(8,-1),Q0=o=>cu(o)==="[object Object]",op=o=>ni(o)&&o!=="NaN"&&o[0]!=="-"&&""+parseInt(o,10)===o,$c=tp(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),uu=o=>{const c=Object.create(null);return f=>c[f]||(c[f]=o(f))},Vy=/-(\w)/g,_r=uu(o=>o.replace(Vy,(c,f)=>f?f.toUpperCase():"")),Wy=/\B([A-Z])/g,Js=uu(o=>o.replace(Wy,"-$1").toLowerCase()),hu=uu(o=>o.charAt(0).toUpperCase()+o.slice(1)),Sd=uu(o=>o?`on${hu(o)}`:""),il=(o,c)=>!Object.is(o,c),Ad=(o,c)=>{for(let f=0;f<o.length;f++)o[f](c)},nu=(o,c,f)=>{Object.defineProperty(o,c,{configurable:!0,enumerable:!1,value:f})},jy=o=>{const c=parseFloat(o);return isNaN(c)?o:c};let n0;const Fd=()=>n0||(n0=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function sp(o){if(tn(o)){const c={};for(let f=0;f<o.length;f++){const s=o[f],d=ni(s)?Ky(s):sp(s);if(d)for(const m in d)c[m]=d[m]}return c}else{if(ni(o))return o;if(On(o))return o}}const Xy=/;(?![^(]*\))/g,qy=/:([^]+)/,Yy=/\/\*[^]*?\*\//g;function Ky(o){const c={};return o.replace(Yy,"").split(Xy).forEach(f=>{if(f){const s=f.split(qy);s.length>1&&(c[s[0].trim()]=s[1].trim())}}),c}function mo(o){let c="";if(ni(o))c=o;else if(tn(o))for(let f=0;f<o.length;f++){const s=mo(o[f]);s&&(c+=s+" ")}else if(On(o))for(const f in o)o[f]&&(c+=f+" ");return c.trim()}const Zy="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Jy=tp(Zy);function e1(o){return!!o||o===""}const t1=o=>ni(o)?o:o==null?"":tn(o)||On(o)&&(o.toString===$0||!hn(o.toString))?JSON.stringify(o,n1,2):String(o),n1=(o,c)=>c&&c.__v_isRef?n1(o,c.value):Vs(c)?{[`Map(${c.size})`]:[...c.entries()].reduce((f,[s,d])=>(f[`${s} =>`]=d,f),{})}:Z0(c)?{[`Set(${c.size})`]:[...c.values()]}:On(c)&&!tn(c)&&!Q0(c)?String(c):c;let Fi;class i1{constructor(c=!1){this.detached=c,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Fi,!c&&Fi&&(this.index=(Fi.scopes||(Fi.scopes=[])).push(this)-1)}get active(){return this._active}run(c){if(this._active){const f=Fi;try{return Fi=this,c()}finally{Fi=f}}}on(){Fi=this}off(){Fi=this.parent}stop(c){if(this._active){let f,s;for(f=0,s=this.effects.length;f<s;f++)this.effects[f].stop();for(f=0,s=this.cleanups.length;f<s;f++)this.cleanups[f]();if(this.scopes)for(f=0,s=this.scopes.length;f<s;f++)this.scopes[f].stop(!0);if(!this.detached&&this.parent&&!c){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0,this._active=!1}}}function r1(o){return new i1(o)}function $y(o,c=Fi){c&&c.active&&c.effects.push(o)}function o1(){return Fi}function Qy(o){Fi&&Fi.cleanups.push(o)}const ap=o=>{const c=new Set(o);return c.w=0,c.n=0,c},s1=o=>(o.w&fo)>0,a1=o=>(o.n&fo)>0,ex=({deps:o})=>{if(o.length)for(let c=0;c<o.length;c++)o[c].w|=fo},tx=o=>{const{deps:c}=o;if(c.length){let f=0;for(let s=0;s<c.length;s++){const d=c[s];s1(d)&&!a1(d)?d.delete(o):c[f++]=d,d.w&=~fo,d.n&=~fo}c.length=f}},iu=new WeakMap;let Ka=0,fo=1;const Hd=30;let rr;const qo=Symbol(""),Bd=Symbol("");class lp{constructor(c,f=null,s){this.fn=c,this.scheduler=f,this.active=!0,this.deps=[],this.parent=void 0,$y(this,s)}run(){if(!this.active)return this.fn();let c=rr,f=uo;for(;c;){if(c===this)return;c=c.parent}try{return this.parent=rr,rr=this,uo=!0,fo=1<<++Ka,Ka<=Hd?ex(this):i0(this),this.fn()}finally{Ka<=Hd&&tx(this),fo=1<<--Ka,rr=this.parent,uo=f,this.parent=void 0,this.deferStop&&this.stop()}}stop(){rr===this?this.deferStop=!0:this.active&&(i0(this),this.onStop&&this.onStop(),this.active=!1)}}function i0(o){const{deps:c}=o;if(c.length){for(let f=0;f<c.length;f++)c[f].delete(o);c.length=0}}let uo=!0;const l1=[];function $s(){l1.push(uo),uo=!1}function Qs(){const o=l1.pop();uo=o===void 0?!0:o}function Ri(o,c,f){if(uo&&rr){let s=iu.get(o);s||iu.set(o,s=new Map);let d=s.get(f);d||s.set(f,d=ap()),c1(d)}}function c1(o,c){let f=!1;Ka<=Hd?a1(o)||(o.n|=fo,f=!s1(o)):f=!o.has(rr),f&&(o.add(rr),rr.deps.push(o))}function Hr(o,c,f,s,d,m){const _=iu.get(o);if(!_)return;let y=[];if(c==="clear")y=[..._.values()];else if(f==="length"&&tn(o)){const x=Number(s);_.forEach((R,C)=>{(C==="length"||C>=x)&&y.push(R)})}else switch(f!==void 0&&y.push(_.get(f)),c){case"add":tn(o)?op(f)&&y.push(_.get("length")):(y.push(_.get(qo)),Vs(o)&&y.push(_.get(Bd)));break;case"delete":tn(o)||(y.push(_.get(qo)),Vs(o)&&y.push(_.get(Bd)));break;case"set":Vs(o)&&y.push(_.get(qo));break}if(y.length===1)y[0]&&Ud(y[0]);else{const x=[];for(const R of y)R&&x.push(...R);Ud(ap(x))}}function Ud(o,c){const f=tn(o)?o:[...o];for(const s of f)s.computed&&r0(s);for(const s of f)s.computed||r0(s)}function r0(o,c){(o!==rr||o.allowRecurse)&&(o.scheduler?o.scheduler():o.run())}function nx(o,c){var f;return(f=iu.get(o))==null?void 0:f.get(c)}const ix=tp("__proto__,__v_isRef,__isVue"),u1=new Set(Object.getOwnPropertyNames(Symbol).filter(o=>o!=="arguments"&&o!=="caller").map(o=>Symbol[o]).filter(rp)),rx=cp(),ox=cp(!1,!0),sx=cp(!0),o0=ax();function ax(){const o={};return["includes","indexOf","lastIndexOf"].forEach(c=>{o[c]=function(...f){const s=En(this);for(let m=0,_=this.length;m<_;m++)Ri(s,"get",m+"");const d=s[c](...f);return d===-1||d===!1?s[c](...f.map(En)):d}}),["push","pop","shift","unshift","splice"].forEach(c=>{o[c]=function(...f){$s();const s=En(this)[c].apply(this,f);return Qs(),s}}),o}function lx(o){const c=En(this);return Ri(c,"has",o),c.hasOwnProperty(o)}function cp(o=!1,c=!1){return function(s,d,m){if(d==="__v_isReactive")return!o;if(d==="__v_isReadonly")return o;if(d==="__v_isShallow")return c;if(d==="__v_raw"&&m===(o?c?Mx:m1:c?f1:p1).get(s))return s;const _=tn(s);if(!o){if(_&&_n(o0,d))return Reflect.get(o0,d,m);if(d==="hasOwnProperty")return lx}const y=Reflect.get(s,d,m);return(rp(d)?u1.has(d):ix(d))||(o||Ri(s,"get",d),c)?y:Xn(y)?_&&op(d)?y:y.value:On(y)?o?v1(y):hl(y):y}}const cx=h1(),ux=h1(!0);function h1(o=!1){return function(f,s,d,m){let _=f[s];if(Xs(_)&&Xn(_)&&!Xn(d))return!1;if(!o&&(!ru(d)&&!Xs(d)&&(_=En(_),d=En(d)),!tn(f)&&Xn(_)&&!Xn(d)))return _.value=d,!0;const y=tn(f)&&op(s)?Number(s)<f.length:_n(f,s),x=Reflect.set(f,s,d,m);return f===En(m)&&(y?il(d,_)&&Hr(f,"set",s,d):Hr(f,"add",s,d)),x}}function hx(o,c){const f=_n(o,c);o[c];const s=Reflect.deleteProperty(o,c);return s&&f&&Hr(o,"delete",c,void 0),s}function dx(o,c){const f=Reflect.has(o,c);return(!rp(c)||!u1.has(c))&&Ri(o,"has",c),f}function px(o){return Ri(o,"iterate",tn(o)?"length":qo),Reflect.ownKeys(o)}const d1={get:rx,set:cx,deleteProperty:hx,has:dx,ownKeys:px},fx={get:sx,set(o,c){return!0},deleteProperty(o,c){return!0}},mx=ai({},d1,{get:ox,set:ux}),up=o=>o,du=o=>Reflect.getPrototypeOf(o);function jc(o,c,f=!1,s=!1){o=o.__v_raw;const d=En(o),m=En(c);f||(c!==m&&Ri(d,"get",c),Ri(d,"get",m));const{has:_}=du(d),y=s?up:f?pp:rl;if(_.call(d,c))return y(o.get(c));if(_.call(d,m))return y(o.get(m));o!==d&&o.get(c)}function Xc(o,c=!1){const f=this.__v_raw,s=En(f),d=En(o);return c||(o!==d&&Ri(s,"has",o),Ri(s,"has",d)),o===d?f.has(o):f.has(o)||f.has(d)}function qc(o,c=!1){return o=o.__v_raw,!c&&Ri(En(o),"iterate",qo),Reflect.get(o,"size",o)}function s0(o){o=En(o);const c=En(this);return du(c).has.call(c,o)||(c.add(o),Hr(c,"add",o,o)),this}function a0(o,c){c=En(c);const f=En(this),{has:s,get:d}=du(f);let m=s.call(f,o);m||(o=En(o),m=s.call(f,o));const _=d.call(f,o);return f.set(o,c),m?il(c,_)&&Hr(f,"set",o,c):Hr(f,"add",o,c),this}function l0(o){const c=En(this),{has:f,get:s}=du(c);let d=f.call(c,o);d||(o=En(o),d=f.call(c,o)),s&&s.call(c,o);const m=c.delete(o);return d&&Hr(c,"delete",o,void 0),m}function c0(){const o=En(this),c=o.size!==0,f=o.clear();return c&&Hr(o,"clear",void 0,void 0),f}function Yc(o,c){return function(s,d){const m=this,_=m.__v_raw,y=En(_),x=c?up:o?pp:rl;return!o&&Ri(y,"iterate",qo),_.forEach((R,C)=>s.call(d,x(R),x(C),m))}}function Kc(o,c,f){return function(...s){const d=this.__v_raw,m=En(d),_=Vs(m),y=o==="entries"||o===Symbol.iterator&&_,x=o==="keys"&&_,R=d[o](...s),C=f?up:c?pp:rl;return!c&&Ri(m,"iterate",x?Bd:qo),{next(){const{value:L,done:N}=R.next();return N?{value:L,done:N}:{value:y?[C(L[0]),C(L[1])]:C(L),done:N}},[Symbol.iterator](){return this}}}}function oo(o){return function(...c){return o==="delete"?!1:this}}function gx(){const o={get(m){return jc(this,m)},get size(){return qc(this)},has:Xc,add:s0,set:a0,delete:l0,clear:c0,forEach:Yc(!1,!1)},c={get(m){return jc(this,m,!1,!0)},get size(){return qc(this)},has:Xc,add:s0,set:a0,delete:l0,clear:c0,forEach:Yc(!1,!0)},f={get(m){return jc(this,m,!0)},get size(){return qc(this,!0)},has(m){return Xc.call(this,m,!0)},add:oo("add"),set:oo("set"),delete:oo("delete"),clear:oo("clear"),forEach:Yc(!0,!1)},s={get(m){return jc(this,m,!0,!0)},get size(){return qc(this,!0)},has(m){return Xc.call(this,m,!0)},add:oo("add"),set:oo("set"),delete:oo("delete"),clear:oo("clear"),forEach:Yc(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(m=>{o[m]=Kc(m,!1,!1),f[m]=Kc(m,!0,!1),c[m]=Kc(m,!1,!0),s[m]=Kc(m,!0,!0)}),[o,f,c,s]}const[vx,yx,xx,_x]=gx();function hp(o,c){const f=c?o?_x:xx:o?yx:vx;return(s,d,m)=>d==="__v_isReactive"?!o:d==="__v_isReadonly"?o:d==="__v_raw"?s:Reflect.get(_n(f,d)&&d in s?f:s,d,m)}const bx={get:hp(!1,!1)},Ex={get:hp(!1,!0)},wx={get:hp(!0,!1)},p1=new WeakMap,f1=new WeakMap,m1=new WeakMap,Mx=new WeakMap;function Tx(o){switch(o){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Sx(o){return o.__v_skip||!Object.isExtensible(o)?0:Tx(Gy(o))}function hl(o){return Xs(o)?o:dp(o,!1,d1,bx,p1)}function g1(o){return dp(o,!1,mx,Ex,f1)}function v1(o){return dp(o,!0,fx,wx,m1)}function dp(o,c,f,s,d){if(!On(o)||o.__v_raw&&!(c&&o.__v_isReactive))return o;const m=d.get(o);if(m)return m;const _=Sx(o);if(_===0)return o;const y=new Proxy(o,_===2?s:f);return d.set(o,y),y}function ho(o){return Xs(o)?ho(o.__v_raw):!!(o&&o.__v_isReactive)}function Xs(o){return!!(o&&o.__v_isReadonly)}function ru(o){return!!(o&&o.__v_isShallow)}function y1(o){return ho(o)||Xs(o)}function En(o){const c=o&&o.__v_raw;return c?En(c):o}function pu(o){return nu(o,"__v_skip",!0),o}const rl=o=>On(o)?hl(o):o,pp=o=>On(o)?v1(o):o;function x1(o){uo&&rr&&(o=En(o),c1(o.dep||(o.dep=ap())))}function _1(o,c){o=En(o);const f=o.dep;f&&Ud(f)}function Xn(o){return!!(o&&o.__v_isRef===!0)}function fp(o){return b1(o,!1)}function Ax(o){return b1(o,!0)}function b1(o,c){return Xn(o)?o:new Rx(o,c)}class Rx{constructor(c,f){this.__v_isShallow=f,this.dep=void 0,this.__v_isRef=!0,this._rawValue=f?c:En(c),this._value=f?c:rl(c)}get value(){return x1(this),this._value}set value(c){const f=this.__v_isShallow||ru(c)||Xs(c);c=f?c:En(c),il(c,this._rawValue)&&(this._rawValue=c,this._value=f?c:rl(c),_1(this))}}function Ws(o){return Xn(o)?o.value:o}const Cx={get:(o,c,f)=>Ws(Reflect.get(o,c,f)),set:(o,c,f,s)=>{const d=o[c];return Xn(d)&&!Xn(f)?(d.value=f,!0):Reflect.set(o,c,f,s)}};function E1(o){return ho(o)?o:new Proxy(o,Cx)}function Lx(o){const c=tn(o)?new Array(o.length):{};for(const f in o)c[f]=Dx(o,f);return c}class Px{constructor(c,f,s){this._object=c,this._key=f,this._defaultValue=s,this.__v_isRef=!0}get value(){const c=this._object[this._key];return c===void 0?this._defaultValue:c}set value(c){this._object[this._key]=c}get dep(){return nx(En(this._object),this._key)}}function Dx(o,c,f){const s=o[c];return Xn(s)?s:new Px(o,c,f)}class Nx{constructor(c,f,s,d){this._setter=f,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this._dirty=!0,this.effect=new lp(c,()=>{this._dirty||(this._dirty=!0,_1(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!d,this.__v_isReadonly=s}get value(){const c=En(this);return x1(c),(c._dirty||!c._cacheable)&&(c._dirty=!1,c._value=c.effect.run()),c._value}set value(c){this._setter(c)}}function Ix(o,c,f=!1){let s,d;const m=hn(o);return m?(s=o,d=ar):(s=o.get,d=o.set),new Nx(s,d,m||!d,f)}function po(o,c,f,s){let d;try{d=s?o(...s):o()}catch(m){fu(m,c,f)}return d}function lr(o,c,f,s){if(hn(o)){const m=po(o,c,f,s);return m&&J0(m)&&m.catch(_=>{fu(_,c,f)}),m}const d=[];for(let m=0;m<o.length;m++)d.push(lr(o[m],c,f,s));return d}function fu(o,c,f,s=!0){const d=c?c.vnode:null;if(c){let m=c.parent;const _=c.proxy,y=f;for(;m;){const R=m.ec;if(R){for(let C=0;C<R.length;C++)if(R[C](o,_,y)===!1)return}m=m.parent}const x=c.appContext.config.errorHandler;if(x){po(x,null,10,[o,_,y]);return}}Ox(o,f,d,s)}function Ox(o,c,f,s=!0){console.error(o)}let ol=!1,zd=!1;const gi=[];let vr=0;const js=[];let Fr=null,jo=0;const w1=Promise.resolve();let mp=null;function gp(o){const c=mp||w1;return o?c.then(this?o.bind(this):o):c}function kx(o){let c=vr+1,f=gi.length;for(;c<f;){const s=c+f>>>1;sl(gi[s])<o?c=s+1:f=s}return c}function vp(o){(!gi.length||!gi.includes(o,ol&&o.allowRecurse?vr+1:vr))&&(o.id==null?gi.push(o):gi.splice(kx(o.id),0,o),M1())}function M1(){!ol&&!zd&&(zd=!0,mp=w1.then(S1))}function Fx(o){const c=gi.indexOf(o);c>vr&&gi.splice(c,1)}function Hx(o){tn(o)?js.push(...o):(!Fr||!Fr.includes(o,o.allowRecurse?jo+1:jo))&&js.push(o),M1()}function u0(o,c=ol?vr+1:0){for(;c<gi.length;c++){const f=gi[c];f&&f.pre&&(gi.splice(c,1),c--,f())}}function T1(o){if(js.length){const c=[...new Set(js)];if(js.length=0,Fr){Fr.push(...c);return}for(Fr=c,Fr.sort((f,s)=>sl(f)-sl(s)),jo=0;jo<Fr.length;jo++)Fr[jo]();Fr=null,jo=0}}const sl=o=>o.id==null?1/0:o.id,Bx=(o,c)=>{const f=sl(o)-sl(c);if(f===0){if(o.pre&&!c.pre)return-1;if(c.pre&&!o.pre)return 1}return f};function S1(o){zd=!1,ol=!0,gi.sort(Bx);const c=ar;try{for(vr=0;vr<gi.length;vr++){const f=gi[vr];f&&f.active!==!1&&po(f,null,14)}}finally{vr=0,gi.length=0,T1(),ol=!1,mp=null,(gi.length||js.length)&&S1()}}function Ux(o,c,...f){if(o.isUnmounted)return;const s=o.vnode.props||In;let d=f;const m=c.startsWith("update:"),_=m&&c.slice(7);if(_&&_ in s){const C=`${_==="modelValue"?"model":_}Modifiers`,{number:L,trim:N}=s[C]||In;N&&(d=f.map(B=>ni(B)?B.trim():B)),L&&(d=f.map(jy))}let y,x=s[y=Sd(c)]||s[y=Sd(_r(c))];!x&&m&&(x=s[y=Sd(Js(c))]),x&&lr(x,o,6,d);const R=s[y+"Once"];if(R){if(!o.emitted)o.emitted={};else if(o.emitted[y])return;o.emitted[y]=!0,lr(R,o,6,d)}}function A1(o,c,f=!1){const s=c.emitsCache,d=s.get(o);if(d!==void 0)return d;const m=o.emits;let _={},y=!1;if(!hn(o)){const x=R=>{const C=A1(R,c,!0);C&&(y=!0,ai(_,C))};!f&&c.mixins.length&&c.mixins.forEach(x),o.extends&&x(o.extends),o.mixins&&o.mixins.forEach(x)}return!m&&!y?(On(o)&&s.set(o,null),null):(tn(m)?m.forEach(x=>_[x]=null):ai(_,m),On(o)&&s.set(o,_),_)}function mu(o,c){return!o||!lu(c)?!1:(c=c.slice(2).replace(/Once$/,""),_n(o,c[0].toLowerCase()+c.slice(1))||_n(o,Js(c))||_n(o,c))}let Gi=null,R1=null;function ou(o){const c=Gi;return Gi=o,R1=o&&o.type.__scopeId||null,c}function yr(o,c=Gi,f){if(!c||o._n)return o;const s=(...d)=>{s._d&&b0(-1);const m=ou(c);let _;try{_=o(...d)}finally{ou(m),s._d&&b0(1)}return _};return s._n=!0,s._c=!0,s._d=!0,s}function Rd(o){const{type:c,vnode:f,proxy:s,withProxy:d,props:m,propsOptions:[_],slots:y,attrs:x,emit:R,render:C,renderCache:L,data:N,setupState:B,ctx:q,inheritAttrs:$}=o;let he,ce;const Ee=ou(o);try{if(f.shapeFlag&4){const Ae=d||s;he=gr(C.call(Ae,Ae,L,m,B,N,q)),ce=x}else{const Ae=c;he=gr(Ae.length>1?Ae(m,{attrs:x,slots:y,emit:R}):Ae(m,null)),ce=c.props?x:zx(x)}}catch(Ae){Qa.length=0,fu(Ae,o,1),he=bn(Ko)}let Ye=he;if(ce&&$!==!1){const Ae=Object.keys(ce),{shapeFlag:ee}=Ye;Ae.length&&ee&7&&(_&&Ae.some(np)&&(ce=Gx(ce,_)),Ye=qs(Ye,ce))}return f.dirs&&(Ye=qs(Ye),Ye.dirs=Ye.dirs?Ye.dirs.concat(f.dirs):f.dirs),f.transition&&(Ye.transition=f.transition),he=Ye,ou(Ee),he}const zx=o=>{let c;for(const f in o)(f==="class"||f==="style"||lu(f))&&((c||(c={}))[f]=o[f]);return c},Gx=(o,c)=>{const f={};for(const s in o)(!np(s)||!(s.slice(9)in c))&&(f[s]=o[s]);return f};function Vx(o,c,f){const{props:s,children:d,component:m}=o,{props:_,children:y,patchFlag:x}=c,R=m.emitsOptions;if(c.dirs||c.transition)return!0;if(f&&x>=0){if(x&1024)return!0;if(x&16)return s?h0(s,_,R):!!_;if(x&8){const C=c.dynamicProps;for(let L=0;L<C.length;L++){const N=C[L];if(_[N]!==s[N]&&!mu(R,N))return!0}}}else return(d||y)&&(!y||!y.$stable)?!0:s===_?!1:s?_?h0(s,_,R):!0:!!_;return!1}function h0(o,c,f){const s=Object.keys(c);if(s.length!==Object.keys(o).length)return!0;for(let d=0;d<s.length;d++){const m=s[d];if(c[m]!==o[m]&&!mu(f,m))return!0}return!1}function Wx({vnode:o,parent:c},f){for(;c&&c.subTree===o;)(o=c.vnode).el=f,c=c.parent}const jx=o=>o.__isSuspense;function Xx(o,c){c&&c.pendingBranch?tn(o)?c.effects.push(...o):c.effects.push(o):Hx(o)}const Zc={};function Ja(o,c,f){return C1(o,c,f)}function C1(o,c,{immediate:f,deep:s,flush:d,onTrack:m,onTrigger:_}=In){var y;const x=o1()===((y=si)==null?void 0:y.scope)?si:null;let R,C=!1,L=!1;if(Xn(o)?(R=()=>o.value,C=ru(o)):ho(o)?(R=()=>o,s=!0):tn(o)?(L=!0,C=o.some(Ae=>ho(Ae)||ru(Ae)),R=()=>o.map(Ae=>{if(Xn(Ae))return Ae.value;if(ho(Ae))return zs(Ae);if(hn(Ae))return po(Ae,x,2)})):hn(o)?c?R=()=>po(o,x,2):R=()=>{if(!(x&&x.isUnmounted))return N&&N(),lr(o,x,3,[B])}:R=ar,c&&s){const Ae=R;R=()=>zs(Ae())}let N,B=Ae=>{N=Ee.onStop=()=>{po(Ae,x,4)}},q;if(cl)if(B=ar,c?f&&lr(c,x,3,[R(),L?[]:void 0,B]):R(),d==="sync"){const Ae=z_();q=Ae.__watcherHandles||(Ae.__watcherHandles=[])}else return ar;let $=L?new Array(o.length).fill(Zc):Zc;const he=()=>{if(!!Ee.active)if(c){const Ae=Ee.run();(s||C||(L?Ae.some((ee,de)=>il(ee,$[de])):il(Ae,$)))&&(N&&N(),lr(c,x,3,[Ae,$===Zc?void 0:L&&$[0]===Zc?[]:$,B]),$=Ae)}else Ee.run()};he.allowRecurse=!!c;let ce;d==="sync"?ce=he:d==="post"?ce=()=>Si(he,x&&x.suspense):(he.pre=!0,x&&(he.id=x.uid),ce=()=>vp(he));const Ee=new lp(R,ce);c?f?he():$=Ee.run():d==="post"?Si(Ee.run.bind(Ee),x&&x.suspense):Ee.run();const Ye=()=>{Ee.stop(),x&&x.scope&&ip(x.scope.effects,Ee)};return q&&q.push(Ye),Ye}function qx(o,c,f){const s=this.proxy,d=ni(o)?o.includes(".")?L1(s,o):()=>s[o]:o.bind(s,s);let m;hn(c)?m=c:(m=c.handler,f=c);const _=si;Ys(this);const y=C1(d,m.bind(s),f);return _?Ys(_):Yo(),y}function L1(o,c){const f=c.split(".");return()=>{let s=o;for(let d=0;d<f.length&&s;d++)s=s[f[d]];return s}}function zs(o,c){if(!On(o)||o.__v_skip||(c=c||new Set,c.has(o)))return o;if(c.add(o),Xn(o))zs(o.value,c);else if(tn(o))for(let f=0;f<o.length;f++)zs(o[f],c);else if(Z0(o)||Vs(o))o.forEach(f=>{zs(f,c)});else if(Q0(o))for(const f in o)zs(o[f],c);return o}function Vo(o,c,f,s){const d=o.dirs,m=c&&c.dirs;for(let _=0;_<d.length;_++){const y=d[_];m&&(y.oldValue=m[_].value);let x=y.dir[s];x&&($s(),lr(x,f,8,[o.el,y,o,c]),Qs())}}function P1(o,c){return hn(o)?(()=>ai({name:o.name},c,{setup:o}))():o}const Qc=o=>!!o.type.__asyncLoader,D1=o=>o.type.__isKeepAlive;function Yx(o,c){N1(o,"a",c)}function Kx(o,c){N1(o,"da",c)}function N1(o,c,f=si){const s=o.__wdc||(o.__wdc=()=>{let d=f;for(;d;){if(d.isDeactivated)return;d=d.parent}return o()});if(gu(c,s,f),f){let d=f.parent;for(;d&&d.parent;)D1(d.parent.vnode)&&Zx(s,c,f,d),d=d.parent}}function Zx(o,c,f,s){const d=gu(c,o,s,!0);I1(()=>{ip(s[c],d)},f)}function gu(o,c,f=si,s=!1){if(f){const d=f[o]||(f[o]=[]),m=c.__weh||(c.__weh=(..._)=>{if(f.isUnmounted)return;$s(),Ys(f);const y=lr(c,f,o,_);return Yo(),Qs(),y});return s?d.unshift(m):d.push(m),m}}const Br=o=>(c,f=si)=>(!cl||o==="sp")&&gu(o,(...s)=>c(...s),f),Jx=Br("bm"),$x=Br("m"),Qx=Br("bu"),e_=Br("u"),t_=Br("bum"),I1=Br("um"),n_=Br("sp"),i_=Br("rtg"),r_=Br("rtc");function o_(o,c=si){gu("ec",o,c)}const O1="components";function Un(o,c){return a_(O1,o,!0,c)||o}const s_=Symbol.for("v-ndc");function a_(o,c,f=!0,s=!1){const d=Gi||si;if(d){const m=d.type;if(o===O1){const y=H_(m,!1);if(y&&(y===c||y===_r(c)||y===hu(_r(c))))return m}const _=d0(d[o]||m[o],c)||d0(d.appContext[o],c);return!_&&s?m:_}}function d0(o,c){return o&&(o[c]||o[_r(c)]||o[hu(_r(c))])}function Gd(o,c,f,s){let d;const m=f&&f[s];if(tn(o)||ni(o)){d=new Array(o.length);for(let _=0,y=o.length;_<y;_++)d[_]=c(o[_],_,void 0,m&&m[_])}else if(typeof o=="number"){d=new Array(o);for(let _=0;_<o;_++)d[_]=c(_+1,_,void 0,m&&m[_])}else if(On(o))if(o[Symbol.iterator])d=Array.from(o,(_,y)=>c(_,y,void 0,m&&m[y]));else{const _=Object.keys(o);d=new Array(_.length);for(let y=0,x=_.length;y<x;y++){const R=_[y];d[y]=c(o[R],R,y,m&&m[y])}}else d=[];return f&&(f[s]=d),d}const Vd=o=>o?X1(o)?Ep(o)||o.proxy:Vd(o.parent):null,$a=ai(Object.create(null),{$:o=>o,$el:o=>o.vnode.el,$data:o=>o.data,$props:o=>o.props,$attrs:o=>o.attrs,$slots:o=>o.slots,$refs:o=>o.refs,$parent:o=>Vd(o.parent),$root:o=>Vd(o.root),$emit:o=>o.emit,$options:o=>yp(o),$forceUpdate:o=>o.f||(o.f=()=>vp(o.update)),$nextTick:o=>o.n||(o.n=gp.bind(o.proxy)),$watch:o=>qx.bind(o)}),Cd=(o,c)=>o!==In&&!o.__isScriptSetup&&_n(o,c),l_={get({_:o},c){const{ctx:f,setupState:s,data:d,props:m,accessCache:_,type:y,appContext:x}=o;let R;if(c[0]!=="$"){const B=_[c];if(B!==void 0)switch(B){case 1:return s[c];case 2:return d[c];case 4:return f[c];case 3:return m[c]}else{if(Cd(s,c))return _[c]=1,s[c];if(d!==In&&_n(d,c))return _[c]=2,d[c];if((R=o.propsOptions[0])&&_n(R,c))return _[c]=3,m[c];if(f!==In&&_n(f,c))return _[c]=4,f[c];Wd&&(_[c]=0)}}const C=$a[c];let L,N;if(C)return c==="$attrs"&&Ri(o,"get",c),C(o);if((L=y.__cssModules)&&(L=L[c]))return L;if(f!==In&&_n(f,c))return _[c]=4,f[c];if(N=x.config.globalProperties,_n(N,c))return N[c]},set({_:o},c,f){const{data:s,setupState:d,ctx:m}=o;return Cd(d,c)?(d[c]=f,!0):s!==In&&_n(s,c)?(s[c]=f,!0):_n(o.props,c)||c[0]==="$"&&c.slice(1)in o?!1:(m[c]=f,!0)},has({_:{data:o,setupState:c,accessCache:f,ctx:s,appContext:d,propsOptions:m}},_){let y;return!!f[_]||o!==In&&_n(o,_)||Cd(c,_)||(y=m[0])&&_n(y,_)||_n(s,_)||_n($a,_)||_n(d.config.globalProperties,_)},defineProperty(o,c,f){return f.get!=null?o._.accessCache[c]=0:_n(f,"value")&&this.set(o,c,f.value,null),Reflect.defineProperty(o,c,f)}};function p0(o){return tn(o)?o.reduce((c,f)=>(c[f]=null,c),{}):o}let Wd=!0;function c_(o){const c=yp(o),f=o.proxy,s=o.ctx;Wd=!1,c.beforeCreate&&f0(c.beforeCreate,o,"bc");const{data:d,computed:m,methods:_,watch:y,provide:x,inject:R,created:C,beforeMount:L,mounted:N,beforeUpdate:B,updated:q,activated:$,deactivated:he,beforeDestroy:ce,beforeUnmount:Ee,destroyed:Ye,unmounted:Ae,render:ee,renderTracked:de,renderTriggered:De,errorCaptured:Se,serverPrefetch:ve,expose:Ge,inheritAttrs:Xt,components:xt,directives:At,filters:M}=c;if(R&&u_(R,s,null),_)for(const A in _){const T=_[A];hn(T)&&(s[A]=T.bind(f))}if(d){const A=d.call(f,f);On(A)&&(o.data=hl(A))}if(Wd=!0,m)for(const A in m){const T=m[A],F=hn(T)?T.bind(f,f):hn(T.get)?T.get.bind(f,f):ar,z=!hn(T)&&hn(T.set)?T.set.bind(f):ar,j=zi({get:F,set:z});Object.defineProperty(s,A,{enumerable:!0,configurable:!0,get:()=>j.value,set:se=>j.value=se})}if(y)for(const A in y)k1(y[A],s,f,A);if(x){const A=hn(x)?x.call(f):x;Reflect.ownKeys(A).forEach(T=>{eu(T,A[T])})}C&&f0(C,o,"c");function O(A,T){tn(T)?T.forEach(F=>A(F.bind(f))):T&&A(T.bind(f))}if(O(Jx,L),O($x,N),O(Qx,B),O(e_,q),O(Yx,$),O(Kx,he),O(o_,Se),O(r_,de),O(i_,De),O(t_,Ee),O(I1,Ae),O(n_,ve),tn(Ge))if(Ge.length){const A=o.exposed||(o.exposed={});Ge.forEach(T=>{Object.defineProperty(A,T,{get:()=>f[T],set:F=>f[T]=F})})}else o.exposed||(o.exposed={});ee&&o.render===ar&&(o.render=ee),Xt!=null&&(o.inheritAttrs=Xt),xt&&(o.components=xt),At&&(o.directives=At)}function u_(o,c,f=ar){tn(o)&&(o=jd(o));for(const s in o){const d=o[s];let m;On(d)?"default"in d?m=xr(d.from||s,d.default,!0):m=xr(d.from||s):m=xr(d),Xn(m)?Object.defineProperty(c,s,{enumerable:!0,configurable:!0,get:()=>m.value,set:_=>m.value=_}):c[s]=m}}function f0(o,c,f){lr(tn(o)?o.map(s=>s.bind(c.proxy)):o.bind(c.proxy),c,f)}function k1(o,c,f,s){const d=s.includes(".")?L1(f,s):()=>f[s];if(ni(o)){const m=c[o];hn(m)&&Ja(d,m)}else if(hn(o))Ja(d,o.bind(f));else if(On(o))if(tn(o))o.forEach(m=>k1(m,c,f,s));else{const m=hn(o.handler)?o.handler.bind(f):c[o.handler];hn(m)&&Ja(d,m,o)}}function yp(o){const c=o.type,{mixins:f,extends:s}=c,{mixins:d,optionsCache:m,config:{optionMergeStrategies:_}}=o.appContext,y=m.get(c);let x;return y?x=y:!d.length&&!f&&!s?x=c:(x={},d.length&&d.forEach(R=>su(x,R,_,!0)),su(x,c,_)),On(c)&&m.set(c,x),x}function su(o,c,f,s=!1){const{mixins:d,extends:m}=c;m&&su(o,m,f,!0),d&&d.forEach(_=>su(o,_,f,!0));for(const _ in c)if(!(s&&_==="expose")){const y=h_[_]||f&&f[_];o[_]=y?y(o[_],c[_]):c[_]}return o}const h_={data:m0,props:g0,emits:g0,methods:Za,computed:Za,beforeCreate:Ei,created:Ei,beforeMount:Ei,mounted:Ei,beforeUpdate:Ei,updated:Ei,beforeDestroy:Ei,beforeUnmount:Ei,destroyed:Ei,unmounted:Ei,activated:Ei,deactivated:Ei,errorCaptured:Ei,serverPrefetch:Ei,components:Za,directives:Za,watch:p_,provide:m0,inject:d_};function m0(o,c){return c?o?function(){return ai(hn(o)?o.call(this,this):o,hn(c)?c.call(this,this):c)}:c:o}function d_(o,c){return Za(jd(o),jd(c))}function jd(o){if(tn(o)){const c={};for(let f=0;f<o.length;f++)c[o[f]]=o[f];return c}return o}function Ei(o,c){return o?[...new Set([].concat(o,c))]:c}function Za(o,c){return o?ai(Object.create(null),o,c):c}function g0(o,c){return o?tn(o)&&tn(c)?[...new Set([...o,...c])]:ai(Object.create(null),p0(o),p0(c!=null?c:{})):c}function p_(o,c){if(!o)return c;if(!c)return o;const f=ai(Object.create(null),o);for(const s in c)f[s]=Ei(o[s],c[s]);return f}function F1(){return{app:null,config:{isNativeTag:By,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let f_=0;function m_(o,c){return function(s,d=null){hn(s)||(s=ai({},s)),d!=null&&!On(d)&&(d=null);const m=F1(),_=new Set;let y=!1;const x=m.app={_uid:f_++,_component:s,_props:d,_container:null,_context:m,_instance:null,version:G_,get config(){return m.config},set config(R){},use(R,...C){return _.has(R)||(R&&hn(R.install)?(_.add(R),R.install(x,...C)):hn(R)&&(_.add(R),R(x,...C))),x},mixin(R){return m.mixins.includes(R)||m.mixins.push(R),x},component(R,C){return C?(m.components[R]=C,x):m.components[R]},directive(R,C){return C?(m.directives[R]=C,x):m.directives[R]},mount(R,C,L){if(!y){const N=bn(s,d);return N.appContext=m,C&&c?c(N,R):o(N,R,L),y=!0,x._container=R,R.__vue_app__=x,Ep(N.component)||N.component.proxy}},unmount(){y&&(o(null,x._container),delete x._container.__vue_app__)},provide(R,C){return m.provides[R]=C,x},runWithContext(R){al=x;try{return R()}finally{al=null}}};return x}}let al=null;function eu(o,c){if(si){let f=si.provides;const s=si.parent&&si.parent.provides;s===f&&(f=si.provides=Object.create(s)),f[o]=c}}function xr(o,c,f=!1){const s=si||Gi;if(s||al){const d=s?s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides:al._context.provides;if(d&&o in d)return d[o];if(arguments.length>1)return f&&hn(c)?c.call(s&&s.proxy):c}}function g_(){return!!(si||Gi||al)}function v_(o,c,f,s=!1){const d={},m={};nu(m,yu,1),o.propsDefaults=Object.create(null),H1(o,c,d,m);for(const _ in o.propsOptions[0])_ in d||(d[_]=void 0);f?o.props=s?d:g1(d):o.type.props?o.props=d:o.props=m,o.attrs=m}function y_(o,c,f,s){const{props:d,attrs:m,vnode:{patchFlag:_}}=o,y=En(d),[x]=o.propsOptions;let R=!1;if((s||_>0)&&!(_&16)){if(_&8){const C=o.vnode.dynamicProps;for(let L=0;L<C.length;L++){let N=C[L];if(mu(o.emitsOptions,N))continue;const B=c[N];if(x)if(_n(m,N))B!==m[N]&&(m[N]=B,R=!0);else{const q=_r(N);d[q]=Xd(x,y,q,B,o,!1)}else B!==m[N]&&(m[N]=B,R=!0)}}}else{H1(o,c,d,m)&&(R=!0);let C;for(const L in y)(!c||!_n(c,L)&&((C=Js(L))===L||!_n(c,C)))&&(x?f&&(f[L]!==void 0||f[C]!==void 0)&&(d[L]=Xd(x,y,L,void 0,o,!0)):delete d[L]);if(m!==y)for(const L in m)(!c||!_n(c,L)&&!0)&&(delete m[L],R=!0)}R&&Hr(o,"set","$attrs")}function H1(o,c,f,s){const[d,m]=o.propsOptions;let _=!1,y;if(c)for(let x in c){if($c(x))continue;const R=c[x];let C;d&&_n(d,C=_r(x))?!m||!m.includes(C)?f[C]=R:(y||(y={}))[C]=R:mu(o.emitsOptions,x)||(!(x in s)||R!==s[x])&&(s[x]=R,_=!0)}if(m){const x=En(f),R=y||In;for(let C=0;C<m.length;C++){const L=m[C];f[L]=Xd(d,x,L,R[L],o,!_n(R,L))}}return _}function Xd(o,c,f,s,d,m){const _=o[f];if(_!=null){const y=_n(_,"default");if(y&&s===void 0){const x=_.default;if(_.type!==Function&&!_.skipFactory&&hn(x)){const{propsDefaults:R}=d;f in R?s=R[f]:(Ys(d),s=R[f]=x.call(null,c),Yo())}else s=x}_[0]&&(m&&!y?s=!1:_[1]&&(s===""||s===Js(f))&&(s=!0))}return s}function B1(o,c,f=!1){const s=c.propsCache,d=s.get(o);if(d)return d;const m=o.props,_={},y=[];let x=!1;if(!hn(o)){const C=L=>{x=!0;const[N,B]=B1(L,c,!0);ai(_,N),B&&y.push(...B)};!f&&c.mixins.length&&c.mixins.forEach(C),o.extends&&C(o.extends),o.mixins&&o.mixins.forEach(C)}if(!m&&!x)return On(o)&&s.set(o,Gs),Gs;if(tn(m))for(let C=0;C<m.length;C++){const L=_r(m[C]);v0(L)&&(_[L]=In)}else if(m)for(const C in m){const L=_r(C);if(v0(L)){const N=m[C],B=_[L]=tn(N)||hn(N)?{type:N}:ai({},N);if(B){const q=_0(Boolean,B.type),$=_0(String,B.type);B[0]=q>-1,B[1]=$<0||q<$,(q>-1||_n(B,"default"))&&y.push(L)}}}const R=[_,y];return On(o)&&s.set(o,R),R}function v0(o){return o[0]!=="$"}function y0(o){const c=o&&o.toString().match(/^\s*(function|class) (\w+)/);return c?c[2]:o===null?"null":""}function x0(o,c){return y0(o)===y0(c)}function _0(o,c){return tn(c)?c.findIndex(f=>x0(f,o)):hn(c)&&x0(c,o)?0:-1}const U1=o=>o[0]==="_"||o==="$stable",xp=o=>tn(o)?o.map(gr):[gr(o)],x_=(o,c,f)=>{if(c._n)return c;const s=yr((...d)=>xp(c(...d)),f);return s._c=!1,s},z1=(o,c,f)=>{const s=o._ctx;for(const d in o){if(U1(d))continue;const m=o[d];if(hn(m))c[d]=x_(d,m,s);else if(m!=null){const _=xp(m);c[d]=()=>_}}},G1=(o,c)=>{const f=xp(c);o.slots.default=()=>f},__=(o,c)=>{if(o.vnode.shapeFlag&32){const f=c._;f?(o.slots=En(c),nu(c,"_",f)):z1(c,o.slots={})}else o.slots={},c&&G1(o,c);nu(o.slots,yu,1)},b_=(o,c,f)=>{const{vnode:s,slots:d}=o;let m=!0,_=In;if(s.shapeFlag&32){const y=c._;y?f&&y===1?m=!1:(ai(d,c),!f&&y===1&&delete d._):(m=!c.$stable,z1(c,d)),_=c}else c&&(G1(o,c),_={default:1});if(m)for(const y in d)!U1(y)&&!(y in _)&&delete d[y]};function qd(o,c,f,s,d=!1){if(tn(o)){o.forEach((N,B)=>qd(N,c&&(tn(c)?c[B]:c),f,s,d));return}if(Qc(s)&&!d)return;const m=s.shapeFlag&4?Ep(s.component)||s.component.proxy:s.el,_=d?null:m,{i:y,r:x}=o,R=c&&c.r,C=y.refs===In?y.refs={}:y.refs,L=y.setupState;if(R!=null&&R!==x&&(ni(R)?(C[R]=null,_n(L,R)&&(L[R]=null)):Xn(R)&&(R.value=null)),hn(x))po(x,y,12,[_,C]);else{const N=ni(x),B=Xn(x);if(N||B){const q=()=>{if(o.f){const $=N?_n(L,x)?L[x]:C[x]:x.value;d?tn($)&&ip($,m):tn($)?$.includes(m)||$.push(m):N?(C[x]=[m],_n(L,x)&&(L[x]=C[x])):(x.value=[m],o.k&&(C[o.k]=x.value))}else N?(C[x]=_,_n(L,x)&&(L[x]=_)):B&&(x.value=_,o.k&&(C[o.k]=_))};_?(q.id=-1,Si(q,f)):q()}}}const Si=Xx;function E_(o){return w_(o)}function w_(o,c){const f=Fd();f.__VUE__=!0;const{insert:s,remove:d,patchProp:m,createElement:_,createText:y,createComment:x,setText:R,setElementText:C,parentNode:L,nextSibling:N,setScopeId:B=ar,insertStaticContent:q}=o,$=(X,J,pe,Ce=null,Ne=null,Be=null,it=!1,tt=null,mt=!!J.dynamicChildren)=>{if(X===J)return;X&&!qa(X,J)&&(Ce=Re(X),se(X,Ne,Be,!0),X=null),J.patchFlag===-2&&(mt=!1,J.dynamicChildren=null);const{type:Ie,ref:Nt,shapeFlag:Tt}=J;switch(Ie){case vu:he(X,J,pe,Ce);break;case Ko:ce(X,J,pe,Ce);break;case Ld:X==null&&Ee(J,pe,Ce,it);break;case Ai:xt(X,J,pe,Ce,Ne,Be,it,tt,mt);break;default:Tt&1?ee(X,J,pe,Ce,Ne,Be,it,tt,mt):Tt&6?At(X,J,pe,Ce,Ne,Be,it,tt,mt):(Tt&64||Tt&128)&&Ie.process(X,J,pe,Ce,Ne,Be,it,tt,mt,et)}Nt!=null&&Ne&&qd(Nt,X&&X.ref,Be,J||X,!J)},he=(X,J,pe,Ce)=>{if(X==null)s(J.el=y(J.children),pe,Ce);else{const Ne=J.el=X.el;J.children!==X.children&&R(Ne,J.children)}},ce=(X,J,pe,Ce)=>{X==null?s(J.el=x(J.children||""),pe,Ce):J.el=X.el},Ee=(X,J,pe,Ce)=>{[X.el,X.anchor]=q(X.children,J,pe,Ce,X.el,X.anchor)},Ye=({el:X,anchor:J},pe,Ce)=>{let Ne;for(;X&&X!==J;)Ne=N(X),s(X,pe,Ce),X=Ne;s(J,pe,Ce)},Ae=({el:X,anchor:J})=>{let pe;for(;X&&X!==J;)pe=N(X),d(X),X=pe;d(J)},ee=(X,J,pe,Ce,Ne,Be,it,tt,mt)=>{it=it||J.type==="svg",X==null?de(J,pe,Ce,Ne,Be,it,tt,mt):ve(X,J,Ne,Be,it,tt,mt)},de=(X,J,pe,Ce,Ne,Be,it,tt)=>{let mt,Ie;const{type:Nt,props:Tt,shapeFlag:It,transition:zt,dirs:$t}=X;if(mt=X.el=_(X.type,Be,Tt&&Tt.is,Tt),It&8?C(mt,X.children):It&16&&Se(X.children,mt,null,Ce,Ne,Be&&Nt!=="foreignObject",it,tt),$t&&Vo(X,null,Ce,"created"),De(mt,X,X.scopeId,it,Ce),Tt){for(const wn in Tt)wn!=="value"&&!$c(wn)&&m(mt,wn,null,Tt[wn],Be,X.children,Ce,Ne,Fe);"value"in Tt&&m(mt,"value",null,Tt.value),(Ie=Tt.onVnodeBeforeMount)&&mr(Ie,Ce,X)}$t&&Vo(X,null,Ce,"beforeMount");const fn=(!Ne||Ne&&!Ne.pendingBranch)&&zt&&!zt.persisted;fn&&zt.beforeEnter(mt),s(mt,J,pe),((Ie=Tt&&Tt.onVnodeMounted)||fn||$t)&&Si(()=>{Ie&&mr(Ie,Ce,X),fn&&zt.enter(mt),$t&&Vo(X,null,Ce,"mounted")},Ne)},De=(X,J,pe,Ce,Ne)=>{if(pe&&B(X,pe),Ce)for(let Be=0;Be<Ce.length;Be++)B(X,Ce[Be]);if(Ne){let Be=Ne.subTree;if(J===Be){const it=Ne.vnode;De(X,it,it.scopeId,it.slotScopeIds,Ne.parent)}}},Se=(X,J,pe,Ce,Ne,Be,it,tt,mt=0)=>{for(let Ie=mt;Ie<X.length;Ie++){const Nt=X[Ie]=tt?lo(X[Ie]):gr(X[Ie]);$(null,Nt,J,pe,Ce,Ne,Be,it,tt)}},ve=(X,J,pe,Ce,Ne,Be,it)=>{const tt=J.el=X.el;let{patchFlag:mt,dynamicChildren:Ie,dirs:Nt}=J;mt|=X.patchFlag&16;const Tt=X.props||In,It=J.props||In;let zt;pe&&Wo(pe,!1),(zt=It.onVnodeBeforeUpdate)&&mr(zt,pe,J,X),Nt&&Vo(J,X,pe,"beforeUpdate"),pe&&Wo(pe,!0);const $t=Ne&&J.type!=="foreignObject";if(Ie?Ge(X.dynamicChildren,Ie,tt,pe,Ce,$t,Be):it||T(X,J,tt,null,pe,Ce,$t,Be,!1),mt>0){if(mt&16)Xt(tt,J,Tt,It,pe,Ce,Ne);else if(mt&2&&Tt.class!==It.class&&m(tt,"class",null,It.class,Ne),mt&4&&m(tt,"style",Tt.style,It.style,Ne),mt&8){const fn=J.dynamicProps;for(let wn=0;wn<fn.length;wn++){const Mt=fn[wn],li=Tt[Mt],Y=It[Mt];(Y!==li||Mt==="value")&&m(tt,Mt,li,Y,Ne,X.children,pe,Ce,Fe)}}mt&1&&X.children!==J.children&&C(tt,J.children)}else!it&&Ie==null&&Xt(tt,J,Tt,It,pe,Ce,Ne);((zt=It.onVnodeUpdated)||Nt)&&Si(()=>{zt&&mr(zt,pe,J,X),Nt&&Vo(J,X,pe,"updated")},Ce)},Ge=(X,J,pe,Ce,Ne,Be,it)=>{for(let tt=0;tt<J.length;tt++){const mt=X[tt],Ie=J[tt],Nt=mt.el&&(mt.type===Ai||!qa(mt,Ie)||mt.shapeFlag&70)?L(mt.el):pe;$(mt,Ie,Nt,null,Ce,Ne,Be,it,!0)}},Xt=(X,J,pe,Ce,Ne,Be,it)=>{if(pe!==Ce){if(pe!==In)for(const tt in pe)!$c(tt)&&!(tt in Ce)&&m(X,tt,pe[tt],null,it,J.children,Ne,Be,Fe);for(const tt in Ce){if($c(tt))continue;const mt=Ce[tt],Ie=pe[tt];mt!==Ie&&tt!=="value"&&m(X,tt,Ie,mt,it,J.children,Ne,Be,Fe)}"value"in Ce&&m(X,"value",pe.value,Ce.value)}},xt=(X,J,pe,Ce,Ne,Be,it,tt,mt)=>{const Ie=J.el=X?X.el:y(""),Nt=J.anchor=X?X.anchor:y("");let{patchFlag:Tt,dynamicChildren:It,slotScopeIds:zt}=J;zt&&(tt=tt?tt.concat(zt):zt),X==null?(s(Ie,pe,Ce),s(Nt,pe,Ce),Se(J.children,pe,Nt,Ne,Be,it,tt,mt)):Tt>0&&Tt&64&&It&&X.dynamicChildren?(Ge(X.dynamicChildren,It,pe,Ne,Be,it,tt),(J.key!=null||Ne&&J===Ne.subTree)&&V1(X,J,!0)):T(X,J,pe,Nt,Ne,Be,it,tt,mt)},At=(X,J,pe,Ce,Ne,Be,it,tt,mt)=>{J.slotScopeIds=tt,X==null?J.shapeFlag&512?Ne.ctx.activate(J,pe,Ce,it,mt):M(J,pe,Ce,Ne,Be,it,mt):I(X,J,mt)},M=(X,J,pe,Ce,Ne,Be,it)=>{const tt=X.component=N_(X,Ce,Ne);if(D1(X)&&(tt.ctx.renderer=et),I_(tt),tt.asyncDep){if(Ne&&Ne.registerDep(tt,O),!X.el){const mt=tt.subTree=bn(Ko);ce(null,mt,J,pe)}return}O(tt,X,J,pe,Ne,Be,it)},I=(X,J,pe)=>{const Ce=J.component=X.component;if(Vx(X,J,pe))if(Ce.asyncDep&&!Ce.asyncResolved){A(Ce,J,pe);return}else Ce.next=J,Fx(Ce.update),Ce.update();else J.el=X.el,Ce.vnode=J},O=(X,J,pe,Ce,Ne,Be,it)=>{const tt=()=>{if(X.isMounted){let{next:Nt,bu:Tt,u:It,parent:zt,vnode:$t}=X,fn=Nt,wn;Wo(X,!1),Nt?(Nt.el=$t.el,A(X,Nt,it)):Nt=$t,Tt&&Ad(Tt),(wn=Nt.props&&Nt.props.onVnodeBeforeUpdate)&&mr(wn,zt,Nt,$t),Wo(X,!0);const Mt=Rd(X),li=X.subTree;X.subTree=Mt,$(li,Mt,L(li.el),Re(li),X,Ne,Be),Nt.el=Mt.el,fn===null&&Wx(X,Mt.el),It&&Si(It,Ne),(wn=Nt.props&&Nt.props.onVnodeUpdated)&&Si(()=>mr(wn,zt,Nt,$t),Ne)}else{let Nt;const{el:Tt,props:It}=J,{bm:zt,m:$t,parent:fn}=X,wn=Qc(J);if(Wo(X,!1),zt&&Ad(zt),!wn&&(Nt=It&&It.onVnodeBeforeMount)&&mr(Nt,fn,J),Wo(X,!0),Tt&&rn){const Mt=()=>{X.subTree=Rd(X),rn(Tt,X.subTree,X,Ne,null)};wn?J.type.__asyncLoader().then(()=>!X.isUnmounted&&Mt()):Mt()}else{const Mt=X.subTree=Rd(X);$(null,Mt,pe,Ce,X,Ne,Be),J.el=Mt.el}if($t&&Si($t,Ne),!wn&&(Nt=It&&It.onVnodeMounted)){const Mt=J;Si(()=>mr(Nt,fn,Mt),Ne)}(J.shapeFlag&256||fn&&Qc(fn.vnode)&&fn.vnode.shapeFlag&256)&&X.a&&Si(X.a,Ne),X.isMounted=!0,J=pe=Ce=null}},mt=X.effect=new lp(tt,()=>vp(Ie),X.scope),Ie=X.update=()=>mt.run();Ie.id=X.uid,Wo(X,!0),Ie()},A=(X,J,pe)=>{J.component=X;const Ce=X.vnode.props;X.vnode=J,X.next=null,y_(X,J.props,Ce,pe),b_(X,J.children,pe),$s(),u0(),Qs()},T=(X,J,pe,Ce,Ne,Be,it,tt,mt=!1)=>{const Ie=X&&X.children,Nt=X?X.shapeFlag:0,Tt=J.children,{patchFlag:It,shapeFlag:zt}=J;if(It>0){if(It&128){z(Ie,Tt,pe,Ce,Ne,Be,it,tt,mt);return}else if(It&256){F(Ie,Tt,pe,Ce,Ne,Be,it,tt,mt);return}}zt&8?(Nt&16&&Fe(Ie,Ne,Be),Tt!==Ie&&C(pe,Tt)):Nt&16?zt&16?z(Ie,Tt,pe,Ce,Ne,Be,it,tt,mt):Fe(Ie,Ne,Be,!0):(Nt&8&&C(pe,""),zt&16&&Se(Tt,pe,Ce,Ne,Be,it,tt,mt))},F=(X,J,pe,Ce,Ne,Be,it,tt,mt)=>{X=X||Gs,J=J||Gs;const Ie=X.length,Nt=J.length,Tt=Math.min(Ie,Nt);let It;for(It=0;It<Tt;It++){const zt=J[It]=mt?lo(J[It]):gr(J[It]);$(X[It],zt,pe,null,Ne,Be,it,tt,mt)}Ie>Nt?Fe(X,Ne,Be,!0,!1,Tt):Se(J,pe,Ce,Ne,Be,it,tt,mt,Tt)},z=(X,J,pe,Ce,Ne,Be,it,tt,mt)=>{let Ie=0;const Nt=J.length;let Tt=X.length-1,It=Nt-1;for(;Ie<=Tt&&Ie<=It;){const zt=X[Ie],$t=J[Ie]=mt?lo(J[Ie]):gr(J[Ie]);if(qa(zt,$t))$(zt,$t,pe,null,Ne,Be,it,tt,mt);else break;Ie++}for(;Ie<=Tt&&Ie<=It;){const zt=X[Tt],$t=J[It]=mt?lo(J[It]):gr(J[It]);if(qa(zt,$t))$(zt,$t,pe,null,Ne,Be,it,tt,mt);else break;Tt--,It--}if(Ie>Tt){if(Ie<=It){const zt=It+1,$t=zt<Nt?J[zt].el:Ce;for(;Ie<=It;)$(null,J[Ie]=mt?lo(J[Ie]):gr(J[Ie]),pe,$t,Ne,Be,it,tt,mt),Ie++}}else if(Ie>It)for(;Ie<=Tt;)se(X[Ie],Ne,Be,!0),Ie++;else{const zt=Ie,$t=Ie,fn=new Map;for(Ie=$t;Ie<=It;Ie++){const fe=J[Ie]=mt?lo(J[Ie]):gr(J[Ie]);fe.key!=null&&fn.set(fe.key,Ie)}let wn,Mt=0;const li=It-$t+1;let Y=!1,ne=0;const ue=new Array(li);for(Ie=0;Ie<li;Ie++)ue[Ie]=0;for(Ie=zt;Ie<=Tt;Ie++){const fe=X[Ie];if(Mt>=li){se(fe,Ne,Be,!0);continue}let ke;if(fe.key!=null)ke=fn.get(fe.key);else for(wn=$t;wn<=It;wn++)if(ue[wn-$t]===0&&qa(fe,J[wn])){ke=wn;break}ke===void 0?se(fe,Ne,Be,!0):(ue[ke-$t]=Ie+1,ke>=ne?ne=ke:Y=!0,$(fe,J[ke],pe,null,Ne,Be,it,tt,mt),Mt++)}const ye=Y?M_(ue):Gs;for(wn=ye.length-1,Ie=li-1;Ie>=0;Ie--){const fe=$t+Ie,ke=J[fe],Oe=fe+1<Nt?J[fe+1].el:Ce;ue[Ie]===0?$(null,ke,pe,Oe,Ne,Be,it,tt,mt):Y&&(wn<0||Ie!==ye[wn]?j(ke,pe,Oe,2):wn--)}}},j=(X,J,pe,Ce,Ne=null)=>{const{el:Be,type:it,transition:tt,children:mt,shapeFlag:Ie}=X;if(Ie&6){j(X.component.subTree,J,pe,Ce);return}if(Ie&128){X.suspense.move(J,pe,Ce);return}if(Ie&64){it.move(X,J,pe,et);return}if(it===Ai){s(Be,J,pe);for(let Tt=0;Tt<mt.length;Tt++)j(mt[Tt],J,pe,Ce);s(X.anchor,J,pe);return}if(it===Ld){Ye(X,J,pe);return}if(Ce!==2&&Ie&1&&tt)if(Ce===0)tt.beforeEnter(Be),s(Be,J,pe),Si(()=>tt.enter(Be),Ne);else{const{leave:Tt,delayLeave:It,afterLeave:zt}=tt,$t=()=>s(Be,J,pe),fn=()=>{Tt(Be,()=>{$t(),zt&&zt()})};It?It(Be,$t,fn):fn()}else s(Be,J,pe)},se=(X,J,pe,Ce=!1,Ne=!1)=>{const{type:Be,props:it,ref:tt,children:mt,dynamicChildren:Ie,shapeFlag:Nt,patchFlag:Tt,dirs:It}=X;if(tt!=null&&qd(tt,null,pe,X,!0),Nt&256){J.ctx.deactivate(X);return}const zt=Nt&1&&It,$t=!Qc(X);let fn;if($t&&(fn=it&&it.onVnodeBeforeUnmount)&&mr(fn,J,X),Nt&6)wt(X.component,pe,Ce);else{if(Nt&128){X.suspense.unmount(pe,Ce);return}zt&&Vo(X,null,J,"beforeUnmount"),Nt&64?X.type.remove(X,J,pe,Ne,et,Ce):Ie&&(Be!==Ai||Tt>0&&Tt&64)?Fe(Ie,J,pe,!1,!0):(Be===Ai&&Tt&384||!Ne&&Nt&16)&&Fe(mt,J,pe),Ce&&Te(X)}($t&&(fn=it&&it.onVnodeUnmounted)||zt)&&Si(()=>{fn&&mr(fn,J,X),zt&&Vo(X,null,J,"unmounted")},pe)},Te=X=>{const{type:J,el:pe,anchor:Ce,transition:Ne}=X;if(J===Ai){ae(pe,Ce);return}if(J===Ld){Ae(X);return}const Be=()=>{d(pe),Ne&&!Ne.persisted&&Ne.afterLeave&&Ne.afterLeave()};if(X.shapeFlag&1&&Ne&&!Ne.persisted){const{leave:it,delayLeave:tt}=Ne,mt=()=>it(pe,Be);tt?tt(X.el,Be,mt):mt()}else Be()},ae=(X,J)=>{let pe;for(;X!==J;)pe=N(X),d(X),X=pe;d(J)},wt=(X,J,pe)=>{const{bum:Ce,scope:Ne,update:Be,subTree:it,um:tt}=X;Ce&&Ad(Ce),Ne.stop(),Be&&(Be.active=!1,se(it,X,J,pe)),tt&&Si(tt,J),Si(()=>{X.isUnmounted=!0},J),J&&J.pendingBranch&&!J.isUnmounted&&X.asyncDep&&!X.asyncResolved&&X.suspenseId===J.pendingId&&(J.deps--,J.deps===0&&J.resolve())},Fe=(X,J,pe,Ce=!1,Ne=!1,Be=0)=>{for(let it=Be;it<X.length;it++)se(X[it],J,pe,Ce,Ne)},Re=X=>X.shapeFlag&6?Re(X.component.subTree):X.shapeFlag&128?X.suspense.next():N(X.anchor||X.el),ut=(X,J,pe)=>{X==null?J._vnode&&se(J._vnode,null,null,!0):$(J._vnode||null,X,J,null,null,null,pe),u0(),T1(),J._vnode=X},et={p:$,um:se,m:j,r:Te,mt:M,mc:Se,pc:T,pbc:Ge,n:Re,o};let _t,rn;return c&&([_t,rn]=c(et)),{render:ut,hydrate:_t,createApp:m_(ut,_t)}}function Wo({effect:o,update:c},f){o.allowRecurse=c.allowRecurse=f}function V1(o,c,f=!1){const s=o.children,d=c.children;if(tn(s)&&tn(d))for(let m=0;m<s.length;m++){const _=s[m];let y=d[m];y.shapeFlag&1&&!y.dynamicChildren&&((y.patchFlag<=0||y.patchFlag===32)&&(y=d[m]=lo(d[m]),y.el=_.el),f||V1(_,y)),y.type===vu&&(y.el=_.el)}}function M_(o){const c=o.slice(),f=[0];let s,d,m,_,y;const x=o.length;for(s=0;s<x;s++){const R=o[s];if(R!==0){if(d=f[f.length-1],o[d]<R){c[s]=d,f.push(s);continue}for(m=0,_=f.length-1;m<_;)y=m+_>>1,o[f[y]]<R?m=y+1:_=y;R<o[f[m]]&&(m>0&&(c[s]=f[m-1]),f[m]=s)}}for(m=f.length,_=f[m-1];m-- >0;)f[m]=_,_=c[_];return f}const T_=o=>o.__isTeleport,Ai=Symbol.for("v-fgt"),vu=Symbol.for("v-txt"),Ko=Symbol.for("v-cmt"),Ld=Symbol.for("v-stc"),Qa=[];let sr=null;function un(o=!1){Qa.push(sr=o?null:[])}function S_(){Qa.pop(),sr=Qa[Qa.length-1]||null}let ll=1;function b0(o){ll+=o}function W1(o){return o.dynamicChildren=ll>0?sr||Gs:null,S_(),ll>0&&sr&&sr.push(o),o}function Rn(o,c,f,s,d,m){return W1(Zt(o,c,f,s,d,m,!0))}function or(o,c,f,s,d){return W1(bn(o,c,f,s,d,!0))}function Yd(o){return o?o.__v_isVNode===!0:!1}function qa(o,c){return o.type===c.type&&o.key===c.key}const yu="__vInternal",j1=({key:o})=>o!=null?o:null,tu=({ref:o,ref_key:c,ref_for:f})=>(typeof o=="number"&&(o=""+o),o!=null?ni(o)||Xn(o)||hn(o)?{i:Gi,r:o,k:c,f:!!f}:o:null);function Zt(o,c=null,f=null,s=0,d=null,m=o===Ai?0:1,_=!1,y=!1){const x={__v_isVNode:!0,__v_skip:!0,type:o,props:c,key:c&&j1(c),ref:c&&tu(c),scopeId:R1,slotScopeIds:null,children:f,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:m,patchFlag:s,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:Gi};return y?(_p(x,f),m&128&&o.normalize(x)):f&&(x.shapeFlag|=ni(f)?8:16),ll>0&&!_&&sr&&(x.patchFlag>0||m&6)&&x.patchFlag!==32&&sr.push(x),x}const bn=A_;function A_(o,c=null,f=null,s=0,d=null,m=!1){if((!o||o===s_)&&(o=Ko),Yd(o)){const y=qs(o,c,!0);return f&&_p(y,f),ll>0&&!m&&sr&&(y.shapeFlag&6?sr[sr.indexOf(o)]=y:sr.push(y)),y.patchFlag|=-2,y}if(B_(o)&&(o=o.__vccOpts),c){c=R_(c);let{class:y,style:x}=c;y&&!ni(y)&&(c.class=mo(y)),On(x)&&(y1(x)&&!tn(x)&&(x=ai({},x)),c.style=sp(x))}const _=ni(o)?1:jx(o)?128:T_(o)?64:On(o)?4:hn(o)?2:0;return Zt(o,c,f,s,d,_,m,!0)}function R_(o){return o?y1(o)||yu in o?ai({},o):o:null}function qs(o,c,f=!1){const{props:s,ref:d,patchFlag:m,children:_}=o,y=c?L_(s||{},c):s;return{__v_isVNode:!0,__v_skip:!0,type:o.type,props:y,key:y&&j1(y),ref:c&&c.ref?f&&d?tn(d)?d.concat(tu(c)):[d,tu(c)]:tu(c):d,scopeId:o.scopeId,slotScopeIds:o.slotScopeIds,children:_,target:o.target,targetAnchor:o.targetAnchor,staticCount:o.staticCount,shapeFlag:o.shapeFlag,patchFlag:c&&o.type!==Ai?m===-1?16:m|16:m,dynamicProps:o.dynamicProps,dynamicChildren:o.dynamicChildren,appContext:o.appContext,dirs:o.dirs,transition:o.transition,component:o.component,suspense:o.suspense,ssContent:o.ssContent&&qs(o.ssContent),ssFallback:o.ssFallback&&qs(o.ssFallback),el:o.el,anchor:o.anchor,ctx:o.ctx,ce:o.ce}}function C_(o=" ",c=0){return bn(vu,null,o,c)}function xu(o="",c=!1){return c?(un(),or(Ko,null,o)):bn(Ko,null,o)}function gr(o){return o==null||typeof o=="boolean"?bn(Ko):tn(o)?bn(Ai,null,o.slice()):typeof o=="object"?lo(o):bn(vu,null,String(o))}function lo(o){return o.el===null&&o.patchFlag!==-1||o.memo?o:qs(o)}function _p(o,c){let f=0;const{shapeFlag:s}=o;if(c==null)c=null;else if(tn(c))f=16;else if(typeof c=="object")if(s&65){const d=c.default;d&&(d._c&&(d._d=!1),_p(o,d()),d._c&&(d._d=!0));return}else{f=32;const d=c._;!d&&!(yu in c)?c._ctx=Gi:d===3&&Gi&&(Gi.slots._===1?c._=1:(c._=2,o.patchFlag|=1024))}else hn(c)?(c={default:c,_ctx:Gi},f=32):(c=String(c),s&64?(f=16,c=[C_(c)]):f=8);o.children=c,o.shapeFlag|=f}function L_(...o){const c={};for(let f=0;f<o.length;f++){const s=o[f];for(const d in s)if(d==="class")c.class!==s.class&&(c.class=mo([c.class,s.class]));else if(d==="style")c.style=sp([c.style,s.style]);else if(lu(d)){const m=c[d],_=s[d];_&&m!==_&&!(tn(m)&&m.includes(_))&&(c[d]=m?[].concat(m,_):_)}else d!==""&&(c[d]=s[d])}return c}function mr(o,c,f,s=null){lr(o,c,7,[f,s])}const P_=F1();let D_=0;function N_(o,c,f){const s=o.type,d=(c?c.appContext:o.appContext)||P_,m={uid:D_++,vnode:o,type:s,parent:c,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,scope:new i1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:c?c.provides:Object.create(d.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:B1(s,d),emitsOptions:A1(s,d),emit:null,emitted:null,propsDefaults:In,inheritAttrs:s.inheritAttrs,ctx:In,data:In,props:In,attrs:In,slots:In,refs:In,setupState:In,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:f,suspenseId:f?f.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return m.ctx={_:m},m.root=c?c.root:m,m.emit=Ux.bind(null,m),o.ce&&o.ce(m),m}let si=null,bp,Hs,E0="__VUE_INSTANCE_SETTERS__";(Hs=Fd()[E0])||(Hs=Fd()[E0]=[]),Hs.push(o=>si=o),bp=o=>{Hs.length>1?Hs.forEach(c=>c(o)):Hs[0](o)};const Ys=o=>{bp(o),o.scope.on()},Yo=()=>{si&&si.scope.off(),bp(null)};function X1(o){return o.vnode.shapeFlag&4}let cl=!1;function I_(o,c=!1){cl=c;const{props:f,children:s}=o.vnode,d=X1(o);v_(o,f,d,c),__(o,s);const m=d?O_(o,c):void 0;return cl=!1,m}function O_(o,c){const f=o.type;o.accessCache=Object.create(null),o.proxy=pu(new Proxy(o.ctx,l_));const{setup:s}=f;if(s){const d=o.setupContext=s.length>1?F_(o):null;Ys(o),$s();const m=po(s,o,0,[o.props,d]);if(Qs(),Yo(),J0(m)){if(m.then(Yo,Yo),c)return m.then(_=>{w0(o,_,c)}).catch(_=>{fu(_,o,0)});o.asyncDep=m}else w0(o,m,c)}else q1(o,c)}function w0(o,c,f){hn(c)?o.type.__ssrInlineRender?o.ssrRender=c:o.render=c:On(c)&&(o.setupState=E1(c)),q1(o,f)}let M0;function q1(o,c,f){const s=o.type;if(!o.render){if(!c&&M0&&!s.render){const d=s.template||yp(o).template;if(d){const{isCustomElement:m,compilerOptions:_}=o.appContext.config,{delimiters:y,compilerOptions:x}=s,R=ai(ai({isCustomElement:m,delimiters:y},_),x);s.render=M0(d,R)}}o.render=s.render||ar}Ys(o),$s(),c_(o),Qs(),Yo()}function k_(o){return o.attrsProxy||(o.attrsProxy=new Proxy(o.attrs,{get(c,f){return Ri(o,"get","$attrs"),c[f]}}))}function F_(o){const c=f=>{o.exposed=f||{}};return{get attrs(){return k_(o)},slots:o.slots,emit:o.emit,expose:c}}function Ep(o){if(o.exposed)return o.exposeProxy||(o.exposeProxy=new Proxy(E1(pu(o.exposed)),{get(c,f){if(f in c)return c[f];if(f in $a)return $a[f](o)},has(c,f){return f in c||f in $a}}))}function H_(o,c=!0){return hn(o)?o.displayName||o.name:o.name||c&&o.__name}function B_(o){return hn(o)&&"__vccOpts"in o}const zi=(o,c)=>Ix(o,c,cl);function Y1(o,c,f){const s=arguments.length;return s===2?On(c)&&!tn(c)?Yd(c)?bn(o,null,[c]):bn(o,c):bn(o,null,c):(s>3?f=Array.prototype.slice.call(arguments,2):s===3&&Yd(f)&&(f=[f]),bn(o,c,f))}const U_=Symbol.for("v-scx"),z_=()=>xr(U_),G_="3.3.4",V_="http://www.w3.org/2000/svg",Xo=typeof document<"u"?document:null,T0=Xo&&Xo.createElement("template"),W_={insert:(o,c,f)=>{c.insertBefore(o,f||null)},remove:o=>{const c=o.parentNode;c&&c.removeChild(o)},createElement:(o,c,f,s)=>{const d=c?Xo.createElementNS(V_,o):Xo.createElement(o,f?{is:f}:void 0);return o==="select"&&s&&s.multiple!=null&&d.setAttribute("multiple",s.multiple),d},createText:o=>Xo.createTextNode(o),createComment:o=>Xo.createComment(o),setText:(o,c)=>{o.nodeValue=c},setElementText:(o,c)=>{o.textContent=c},parentNode:o=>o.parentNode,nextSibling:o=>o.nextSibling,querySelector:o=>Xo.querySelector(o),setScopeId(o,c){o.setAttribute(c,"")},insertStaticContent(o,c,f,s,d,m){const _=f?f.previousSibling:c.lastChild;if(d&&(d===m||d.nextSibling))for(;c.insertBefore(d.cloneNode(!0),f),!(d===m||!(d=d.nextSibling)););else{T0.innerHTML=s?`<svg>${o}</svg>`:o;const y=T0.content;if(s){const x=y.firstChild;for(;x.firstChild;)y.appendChild(x.firstChild);y.removeChild(x)}c.insertBefore(y,f)}return[_?_.nextSibling:c.firstChild,f?f.previousSibling:c.lastChild]}};function j_(o,c,f){const s=o._vtc;s&&(c=(c?[c,...s]:[...s]).join(" ")),c==null?o.removeAttribute("class"):f?o.setAttribute("class",c):o.className=c}function X_(o,c,f){const s=o.style,d=ni(f);if(f&&!d){if(c&&!ni(c))for(const m in c)f[m]==null&&Kd(s,m,"");for(const m in f)Kd(s,m,f[m])}else{const m=s.display;d?c!==f&&(s.cssText=f):c&&o.removeAttribute("style"),"_vod"in o&&(s.display=m)}}const S0=/\s*!important$/;function Kd(o,c,f){if(tn(f))f.forEach(s=>Kd(o,c,s));else if(f==null&&(f=""),c.startsWith("--"))o.setProperty(c,f);else{const s=q_(o,c);S0.test(f)?o.setProperty(Js(s),f.replace(S0,""),"important"):o[s]=f}}const A0=["Webkit","Moz","ms"],Pd={};function q_(o,c){const f=Pd[c];if(f)return f;let s=_r(c);if(s!=="filter"&&s in o)return Pd[c]=s;s=hu(s);for(let d=0;d<A0.length;d++){const m=A0[d]+s;if(m in o)return Pd[c]=m}return c}const R0="http://www.w3.org/1999/xlink";function Y_(o,c,f,s,d){if(s&&c.startsWith("xlink:"))f==null?o.removeAttributeNS(R0,c.slice(6,c.length)):o.setAttributeNS(R0,c,f);else{const m=Jy(c);f==null||m&&!e1(f)?o.removeAttribute(c):o.setAttribute(c,m?"":f)}}function K_(o,c,f,s,d,m,_){if(c==="innerHTML"||c==="textContent"){s&&_(s,d,m),o[c]=f==null?"":f;return}const y=o.tagName;if(c==="value"&&y!=="PROGRESS"&&!y.includes("-")){o._value=f;const R=y==="OPTION"?o.getAttribute("value"):o.value,C=f==null?"":f;R!==C&&(o.value=C),f==null&&o.removeAttribute(c);return}let x=!1;if(f===""||f==null){const R=typeof o[c];R==="boolean"?f=e1(f):f==null&&R==="string"?(f="",x=!0):R==="number"&&(f=0,x=!0)}try{o[c]=f}catch{}x&&o.removeAttribute(c)}function Z_(o,c,f,s){o.addEventListener(c,f,s)}function J_(o,c,f,s){o.removeEventListener(c,f,s)}function $_(o,c,f,s,d=null){const m=o._vei||(o._vei={}),_=m[c];if(s&&_)_.value=s;else{const[y,x]=Q_(c);if(s){const R=m[c]=nb(s,d);Z_(o,y,R,x)}else _&&(J_(o,y,_,x),m[c]=void 0)}}const C0=/(?:Once|Passive|Capture)$/;function Q_(o){let c;if(C0.test(o)){c={};let s;for(;s=o.match(C0);)o=o.slice(0,o.length-s[0].length),c[s[0].toLowerCase()]=!0}return[o[2]===":"?o.slice(3):Js(o.slice(2)),c]}let Dd=0;const eb=Promise.resolve(),tb=()=>Dd||(eb.then(()=>Dd=0),Dd=Date.now());function nb(o,c){const f=s=>{if(!s._vts)s._vts=Date.now();else if(s._vts<=f.attached)return;lr(ib(s,f.value),c,5,[s])};return f.value=o,f.attached=tb(),f}function ib(o,c){if(tn(c)){const f=o.stopImmediatePropagation;return o.stopImmediatePropagation=()=>{f.call(o),o._stopped=!0},c.map(s=>d=>!d._stopped&&s&&s(d))}else return c}const L0=/^on[a-z]/,rb=(o,c,f,s,d=!1,m,_,y,x)=>{c==="class"?j_(o,s,d):c==="style"?X_(o,f,s):lu(c)?np(c)||$_(o,c,f,s,_):(c[0]==="."?(c=c.slice(1),!0):c[0]==="^"?(c=c.slice(1),!1):ob(o,c,s,d))?K_(o,c,s,m,_,y,x):(c==="true-value"?o._trueValue=s:c==="false-value"&&(o._falseValue=s),Y_(o,c,s,d))};function ob(o,c,f,s){return s?!!(c==="innerHTML"||c==="textContent"||c in o&&L0.test(c)&&hn(f)):c==="spellcheck"||c==="draggable"||c==="translate"||c==="form"||c==="list"&&o.tagName==="INPUT"||c==="type"&&o.tagName==="TEXTAREA"||L0.test(c)&&ni(f)?!1:c in o}const sb=ai({patchProp:rb},W_);let P0;function ab(){return P0||(P0=E_(sb))}const lb=(...o)=>{const c=ab().createApp(...o),{mount:f}=c;return c.mount=s=>{const d=cb(s);if(!d)return;const m=c._component;!hn(m)&&!m.render&&!m.template&&(m.template=d.innerHTML),d.innerHTML="";const _=f(d,!1,d instanceof SVGElement);return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),_},c};function cb(o){return ni(o)?document.querySelector(o):o}var ub=!1;/*!
 * pinia v2.1.6
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let K1;const _u=o=>K1=o,Z1=Symbol();function Zd(o){return o&&typeof o=="object"&&Object.prototype.toString.call(o)==="[object Object]"&&typeof o.toJSON!="function"}var el;(function(o){o.direct="direct",o.patchObject="patch object",o.patchFunction="patch function"})(el||(el={}));function hb(){const o=r1(!0),c=o.run(()=>fp({}));let f=[],s=[];const d=pu({install(m){_u(d),d._a=m,m.provide(Z1,d),m.config.globalProperties.$pinia=d,s.forEach(_=>f.push(_)),s=[]},use(m){return!this._a&&!ub?s.push(m):f.push(m),this},_p:f,_a:null,_e:o,_s:new Map,state:c});return d}const J1=()=>{};function D0(o,c,f,s=J1){o.push(c);const d=()=>{const m=o.indexOf(c);m>-1&&(o.splice(m,1),s())};return!f&&o1()&&Qy(d),d}function Bs(o,...c){o.slice().forEach(f=>{f(...c)})}const db=o=>o();function Jd(o,c){o instanceof Map&&c instanceof Map&&c.forEach((f,s)=>o.set(s,f)),o instanceof Set&&c instanceof Set&&c.forEach(o.add,o);for(const f in c){if(!c.hasOwnProperty(f))continue;const s=c[f],d=o[f];Zd(d)&&Zd(s)&&o.hasOwnProperty(f)&&!Xn(s)&&!ho(s)?o[f]=Jd(d,s):o[f]=s}return o}const pb=Symbol();function fb(o){return!Zd(o)||!o.hasOwnProperty(pb)}const{assign:ao}=Object;function mb(o){return!!(Xn(o)&&o.effect)}function gb(o,c,f,s){const{state:d,actions:m,getters:_}=c,y=f.state.value[o];let x;function R(){y||(f.state.value[o]=d?d():{});const C=Lx(f.state.value[o]);return ao(C,m,Object.keys(_||{}).reduce((L,N)=>(L[N]=pu(zi(()=>{_u(f);const B=f._s.get(o);return _[N].call(B,B)})),L),{}))}return x=$1(o,R,c,f,s,!0),x}function $1(o,c,f={},s,d,m){let _;const y=ao({actions:{}},f),x={deep:!0};let R,C,L=[],N=[],B;const q=s.state.value[o];!m&&!q&&(s.state.value[o]={}),fp({});let $;function he(Se){let ve;R=C=!1,typeof Se=="function"?(Se(s.state.value[o]),ve={type:el.patchFunction,storeId:o,events:B}):(Jd(s.state.value[o],Se),ve={type:el.patchObject,payload:Se,storeId:o,events:B});const Ge=$=Symbol();gp().then(()=>{$===Ge&&(R=!0)}),C=!0,Bs(L,ve,s.state.value[o])}const ce=m?function(){const{state:ve}=f,Ge=ve?ve():{};this.$patch(Xt=>{ao(Xt,Ge)})}:J1;function Ee(){_.stop(),L=[],N=[],s._s.delete(o)}function Ye(Se,ve){return function(){_u(s);const Ge=Array.from(arguments),Xt=[],xt=[];function At(O){Xt.push(O)}function M(O){xt.push(O)}Bs(N,{args:Ge,name:Se,store:ee,after:At,onError:M});let I;try{I=ve.apply(this&&this.$id===o?this:ee,Ge)}catch(O){throw Bs(xt,O),O}return I instanceof Promise?I.then(O=>(Bs(Xt,O),O)).catch(O=>(Bs(xt,O),Promise.reject(O))):(Bs(Xt,I),I)}}const Ae={_p:s,$id:o,$onAction:D0.bind(null,N),$patch:he,$reset:ce,$subscribe(Se,ve={}){const Ge=D0(L,Se,ve.detached,()=>Xt()),Xt=_.run(()=>Ja(()=>s.state.value[o],xt=>{(ve.flush==="sync"?C:R)&&Se({storeId:o,type:el.direct,events:B},xt)},ao({},x,ve)));return Ge},$dispose:Ee},ee=hl(Ae);s._s.set(o,ee);const de=s._a&&s._a.runWithContext||db,De=s._e.run(()=>(_=r1(),de(()=>_.run(c))));for(const Se in De){const ve=De[Se];if(Xn(ve)&&!mb(ve)||ho(ve))m||(q&&fb(ve)&&(Xn(ve)?ve.value=q[Se]:Jd(ve,q[Se])),s.state.value[o][Se]=ve);else if(typeof ve=="function"){const Ge=Ye(Se,ve);De[Se]=Ge,y.actions[Se]=ve}}return ao(ee,De),ao(En(ee),De),Object.defineProperty(ee,"$state",{get:()=>s.state.value[o],set:Se=>{he(ve=>{ao(ve,Se)})}}),s._p.forEach(Se=>{ao(ee,_.run(()=>Se({store:ee,app:s._a,pinia:s,options:y})))}),q&&m&&f.hydrate&&f.hydrate(ee.$state,q),R=!0,C=!0,ee}function vb(o,c,f){let s,d;const m=typeof c=="function";typeof o=="string"?(s=o,d=m?f:c):(d=o,s=o.id);function _(y,x){const R=g_();return y=y||(R?xr(Z1,null):null),y&&_u(y),y=K1,y._s.has(s)||(m?$1(s,c,d,y):gb(s,d,y)),y._s.get(s)}return _.$id=s,_}const Ci=(o,c)=>{const f=o.__vccOpts||o;for(const[s,d]of c)f[s]=d;return f},yb={name:"Loader"},xb={class:"lds-spinner"},_b=Zt("div",null,null,-1),bb=Zt("div",null,null,-1),Eb=Zt("div",null,null,-1),wb=Zt("div",null,[Zt("span",{class:"a11y-hidden"},"Loading")],-1),Mb=Zt("div",null,null,-1),Tb=Zt("div",null,null,-1),Sb=Zt("div",null,null,-1),Ab=Zt("div",null,null,-1),Rb=Zt("div",null,null,-1),Cb=Zt("div",null,null,-1),Lb=Zt("div",null,null,-1),Pb=Zt("div",null,null,-1),Db=[_b,bb,Eb,wb,Mb,Tb,Sb,Ab,Rb,Cb,Lb,Pb];function Nb(o,c,f,s,d,m){return un(),Rn("div",xb,Db)}const Q1=Ci(yb,[["render",Nb]]);var Zo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ib(o){var c=o.default;if(typeof c=="function"){var f=function(){return c.apply(this,arguments)};f.prototype=c.prototype}else f={};return Object.defineProperty(f,"__esModule",{value:!0}),Object.keys(o).forEach(function(s){var d=Object.getOwnPropertyDescriptor(o,s);Object.defineProperty(f,s,d.get?d:{enumerable:!0,get:function(){return o[s]}})}),f}var ev={exports:{}};(function(o){(function(c,f,s){function d(x){var R=this,C=y();R.next=function(){var L=2091639*R.s0+R.c*23283064365386963e-26;return R.s0=R.s1,R.s1=R.s2,R.s2=L-(R.c=L|0)},R.c=1,R.s0=C(" "),R.s1=C(" "),R.s2=C(" "),R.s0-=C(x),R.s0<0&&(R.s0+=1),R.s1-=C(x),R.s1<0&&(R.s1+=1),R.s2-=C(x),R.s2<0&&(R.s2+=1),C=null}function m(x,R){return R.c=x.c,R.s0=x.s0,R.s1=x.s1,R.s2=x.s2,R}function _(x,R){var C=new d(x),L=R&&R.state,N=C.next;return N.int32=function(){return C.next()*4294967296|0},N.double=function(){return N()+(N()*2097152|0)*11102230246251565e-32},N.quick=N,L&&(typeof L=="object"&&m(L,C),N.state=function(){return m(C,{})}),N}function y(){var x=4022871197,R=function(C){C=String(C);for(var L=0;L<C.length;L++){x+=C.charCodeAt(L);var N=.02519603282416938*x;x=N>>>0,N-=x,N*=x,x=N>>>0,N-=x,x+=N*4294967296}return(x>>>0)*23283064365386963e-26};return R}f&&f.exports?f.exports=_:s&&s.amd?s(function(){return _}):this.alea=_})(Zo,o,!1)})(ev);var tv={exports:{}};(function(o){(function(c,f,s){function d(y){var x=this,R="";x.x=0,x.y=0,x.z=0,x.w=0,x.next=function(){var L=x.x^x.x<<11;return x.x=x.y,x.y=x.z,x.z=x.w,x.w^=x.w>>>19^L^L>>>8},y===(y|0)?x.x=y:R+=y;for(var C=0;C<R.length+64;C++)x.x^=R.charCodeAt(C)|0,x.next()}function m(y,x){return x.x=y.x,x.y=y.y,x.z=y.z,x.w=y.w,x}function _(y,x){var R=new d(y),C=x&&x.state,L=function(){return(R.next()>>>0)/4294967296};return L.double=function(){do var N=R.next()>>>11,B=(R.next()>>>0)/4294967296,q=(N+B)/(1<<21);while(q===0);return q},L.int32=R.next,L.quick=L,C&&(typeof C=="object"&&m(C,R),L.state=function(){return m(R,{})}),L}f&&f.exports?f.exports=_:s&&s.amd?s(function(){return _}):this.xor128=_})(Zo,o,!1)})(tv);var nv={exports:{}};(function(o){(function(c,f,s){function d(y){var x=this,R="";x.next=function(){var L=x.x^x.x>>>2;return x.x=x.y,x.y=x.z,x.z=x.w,x.w=x.v,(x.d=x.d+362437|0)+(x.v=x.v^x.v<<4^(L^L<<1))|0},x.x=0,x.y=0,x.z=0,x.w=0,x.v=0,y===(y|0)?x.x=y:R+=y;for(var C=0;C<R.length+64;C++)x.x^=R.charCodeAt(C)|0,C==R.length&&(x.d=x.x<<10^x.x>>>4),x.next()}function m(y,x){return x.x=y.x,x.y=y.y,x.z=y.z,x.w=y.w,x.v=y.v,x.d=y.d,x}function _(y,x){var R=new d(y),C=x&&x.state,L=function(){return(R.next()>>>0)/4294967296};return L.double=function(){do var N=R.next()>>>11,B=(R.next()>>>0)/4294967296,q=(N+B)/(1<<21);while(q===0);return q},L.int32=R.next,L.quick=L,C&&(typeof C=="object"&&m(C,R),L.state=function(){return m(R,{})}),L}f&&f.exports?f.exports=_:s&&s.amd?s(function(){return _}):this.xorwow=_})(Zo,o,!1)})(nv);var iv={exports:{}};(function(o){(function(c,f,s){function d(y){var x=this;x.next=function(){var C=x.x,L=x.i,N,B;return N=C[L],N^=N>>>7,B=N^N<<24,N=C[L+1&7],B^=N^N>>>10,N=C[L+3&7],B^=N^N>>>3,N=C[L+4&7],B^=N^N<<7,N=C[L+7&7],N=N^N<<13,B^=N^N<<9,C[L]=B,x.i=L+1&7,B};function R(C,L){var N,B=[];if(L===(L|0))B[0]=L;else for(L=""+L,N=0;N<L.length;++N)B[N&7]=B[N&7]<<15^L.charCodeAt(N)+B[N+1&7]<<13;for(;B.length<8;)B.push(0);for(N=0;N<8&&B[N]===0;++N);for(N==8?B[7]=-1:B[N],C.x=B,C.i=0,N=256;N>0;--N)C.next()}R(x,y)}function m(y,x){return x.x=y.x.slice(),x.i=y.i,x}function _(y,x){y==null&&(y=+new Date);var R=new d(y),C=x&&x.state,L=function(){return(R.next()>>>0)/4294967296};return L.double=function(){do var N=R.next()>>>11,B=(R.next()>>>0)/4294967296,q=(N+B)/(1<<21);while(q===0);return q},L.int32=R.next,L.quick=L,C&&(C.x&&m(C,R),L.state=function(){return m(R,{})}),L}f&&f.exports?f.exports=_:s&&s.amd?s(function(){return _}):this.xorshift7=_})(Zo,o,!1)})(iv);var rv={exports:{}};(function(o){(function(c,f,s){function d(y){var x=this;x.next=function(){var C=x.w,L=x.X,N=x.i,B,q;return x.w=C=C+1640531527|0,q=L[N+34&127],B=L[N=N+1&127],q^=q<<13,B^=B<<17,q^=q>>>15,B^=B>>>12,q=L[N]=q^B,x.i=N,q+(C^C>>>16)|0};function R(C,L){var N,B,q,$,he,ce=[],Ee=128;for(L===(L|0)?(B=L,L=null):(L=L+"\0",B=0,Ee=Math.max(Ee,L.length)),q=0,$=-32;$<Ee;++$)L&&(B^=L.charCodeAt(($+32)%L.length)),$===0&&(he=B),B^=B<<10,B^=B>>>15,B^=B<<4,B^=B>>>13,$>=0&&(he=he+1640531527|0,N=ce[$&127]^=B+he,q=N==0?q+1:0);for(q>=128&&(ce[(L&&L.length||0)&127]=-1),q=127,$=4*128;$>0;--$)B=ce[q+34&127],N=ce[q=q+1&127],B^=B<<13,N^=N<<17,B^=B>>>15,N^=N>>>12,ce[q]=B^N;C.w=he,C.X=ce,C.i=q}R(x,y)}function m(y,x){return x.i=y.i,x.w=y.w,x.X=y.X.slice(),x}function _(y,x){y==null&&(y=+new Date);var R=new d(y),C=x&&x.state,L=function(){return(R.next()>>>0)/4294967296};return L.double=function(){do var N=R.next()>>>11,B=(R.next()>>>0)/4294967296,q=(N+B)/(1<<21);while(q===0);return q},L.int32=R.next,L.quick=L,C&&(C.X&&m(C,R),L.state=function(){return m(R,{})}),L}f&&f.exports?f.exports=_:s&&s.amd?s(function(){return _}):this.xor4096=_})(Zo,o,!1)})(rv);var ov={exports:{}};(function(o){(function(c,f,s){function d(y){var x=this,R="";x.next=function(){var L=x.b,N=x.c,B=x.d,q=x.a;return L=L<<25^L>>>7^N,N=N-B|0,B=B<<24^B>>>8^q,q=q-L|0,x.b=L=L<<20^L>>>12^N,x.c=N=N-B|0,x.d=B<<16^N>>>16^q,x.a=q-L|0},x.a=0,x.b=0,x.c=-1640531527,x.d=1367130551,y===Math.floor(y)?(x.a=y/4294967296|0,x.b=y|0):R+=y;for(var C=0;C<R.length+20;C++)x.b^=R.charCodeAt(C)|0,x.next()}function m(y,x){return x.a=y.a,x.b=y.b,x.c=y.c,x.d=y.d,x}function _(y,x){var R=new d(y),C=x&&x.state,L=function(){return(R.next()>>>0)/4294967296};return L.double=function(){do var N=R.next()>>>11,B=(R.next()>>>0)/4294967296,q=(N+B)/(1<<21);while(q===0);return q},L.int32=R.next,L.quick=L,C&&(typeof C=="object"&&m(C,R),L.state=function(){return m(R,{})}),L}f&&f.exports?f.exports=_:s&&s.amd?s(function(){return _}):this.tychei=_})(Zo,o,!1)})(ov);var sv={exports:{}};const Ob={},kb=Object.freeze(Object.defineProperty({__proto__:null,default:Ob},Symbol.toStringTag,{value:"Module"})),Fb=Ib(kb);(function(o){(function(c,f,s){var d=256,m=6,_=52,y="random",x=s.pow(d,m),R=s.pow(2,_),C=R*2,L=d-1,N;function B(Ae,ee,de){var De=[];ee=ee==!0?{entropy:!0}:ee||{};var Se=ce(he(ee.entropy?[Ae,Ye(f)]:Ae==null?Ee():Ae,3),De),ve=new q(De),Ge=function(){for(var Xt=ve.g(m),xt=x,At=0;Xt<R;)Xt=(Xt+At)*d,xt*=d,At=ve.g(1);for(;Xt>=C;)Xt/=2,xt/=2,At>>>=1;return(Xt+At)/xt};return Ge.int32=function(){return ve.g(4)|0},Ge.quick=function(){return ve.g(4)/4294967296},Ge.double=Ge,ce(Ye(ve.S),f),(ee.pass||de||function(Xt,xt,At,M){return M&&(M.S&&$(M,ve),Xt.state=function(){return $(ve,{})}),At?(s[y]=Xt,xt):Xt})(Ge,Se,"global"in ee?ee.global:this==s,ee.state)}function q(Ae){var ee,de=Ae.length,De=this,Se=0,ve=De.i=De.j=0,Ge=De.S=[];for(de||(Ae=[de++]);Se<d;)Ge[Se]=Se++;for(Se=0;Se<d;Se++)Ge[Se]=Ge[ve=L&ve+Ae[Se%de]+(ee=Ge[Se])],Ge[ve]=ee;(De.g=function(Xt){for(var xt,At=0,M=De.i,I=De.j,O=De.S;Xt--;)xt=O[M=L&M+1],At=At*d+O[L&(O[M]=O[I=L&I+xt])+(O[I]=xt)];return De.i=M,De.j=I,At})(d)}function $(Ae,ee){return ee.i=Ae.i,ee.j=Ae.j,ee.S=Ae.S.slice(),ee}function he(Ae,ee){var de=[],De=typeof Ae,Se;if(ee&&De=="object")for(Se in Ae)try{de.push(he(Ae[Se],ee-1))}catch{}return de.length?de:De=="string"?Ae:Ae+"\0"}function ce(Ae,ee){for(var de=Ae+"",De,Se=0;Se<de.length;)ee[L&Se]=L&(De^=ee[L&Se]*19)+de.charCodeAt(Se++);return Ye(ee)}function Ee(){try{var Ae;return N&&(Ae=N.randomBytes)?Ae=Ae(d):(Ae=new Uint8Array(d),(c.crypto||c.msCrypto).getRandomValues(Ae)),Ye(Ae)}catch{var ee=c.navigator,de=ee&&ee.plugins;return[+new Date,c,de,c.screen,Ye(f)]}}function Ye(Ae){return String.fromCharCode.apply(0,Ae)}if(ce(s.random(),f),o.exports){o.exports=B;try{N=Fb}catch{}}else s["seed"+y]=B})(typeof self<"u"?self:Zo,[],Math)})(sv);var Hb=ev.exports,Bb=tv.exports,Ub=nv.exports,zb=iv.exports,Gb=rv.exports,Vb=ov.exports,Jo=sv.exports;Jo.alea=Hb;Jo.xor128=Bb;Jo.xorwow=Ub;Jo.xorshift7=zb;Jo.xor4096=Gb;Jo.tychei=Vb;var Wb=Jo;const{alea:jb}=Wb,Xb=o=>o*o*o*(o*(o*6-15)+10),Nd=(o,c,f)=>o+(c-o)*Xb(f),qb=(o,c)=>o[0]*c[0]+o[1]*c[1];class Yb{constructor(c,f,s=Math.floor(Math.random()*4294967296)){this.random=jb(s.toString()),this.vectors=this._createVectorField(c,f)}_dotProdGrid(c,f,s,d){const m=this.vectors[d][s],_=[c-s,f-d];return qb(m,_)}_createRandomVector(){const c=this.random()*Math.PI*2;return[Math.cos(c),Math.sin(c)]}_createVectorField(c,f){return Array(f+1).fill([]).map(()=>Array(c+1).fill(0).map(()=>this._createRandomVector()))}perlin(c,f){const[s,d]=[Math.floor(c),Math.floor(f)],[m,_]=[s+1,d+1],y=[this._dotProdGrid(c,f,s,d),this._dotProdGrid(c,f,m,d),this._dotProdGrid(c,f,s,_),this._dotProdGrid(c,f,m,_)];return Nd(Nd(y[0],y[1],c-s),Nd(y[2],y[3],c-s),f-d)}}const av=[[-.7207726424842171,14.026011008285593],[1.1126140076335815,11.651417697596393],[1.8933574234672257,15.497854749410564],[4.883194137582727,15.251123270010218],[-1.6117004208986856,10.395188859171263],[6.177984802760356,17.95732302859585],[-2.651124595282667,16.322473796646698],[5.21071061428027,12.269054699790601],[2.444299490016263,8.96318151451812],[5.036570344476825,20.731700983096893],[-4.094938367125177,18.95218895084838],[-2.60396371383991,7.564038287851979],[6.194194418119995,9.434842356372236],[8.494613492498573,16.051219276466433],[6.9095679367240095,6.521383805288977],[1.0512651883203006,6.306217940379682],[1.9971383795363593,18.49605913089583],[6.990366435457474,23.008251187873583],[-2.8725723571191253,21.691864358188077],[3.577107821022963,23.352763581096745],[1.1247888217958284,21.6247208946941],[4.481815877800962,4.75899340007367],[-4.187376825822792,11.933334189469178],[8.19373926809643,11.950401203792474],[3.05581535367072,2.119576323296993],[-3.3059870801509703,24.660391211335828],[8.6653781045894,20.519408905150158],[10.592455642929288,18.19576079200683],[-5.80489530930755,23.000434084704665],[13.134217051772175,16.60219593906953],[9.132100954796698,8.827631370180164],[11.164640754340667,11.533574670289802],[4.91218100451502,-.23709645211445363],[13.820308672953459,12.929077413408166],[3.36036752811264,-2.804561142125987],[16.11822351412735,16.911558885497527],[11.775707227913507,7.409412109015825],[9.564260403228452,24.549377348404327],[4.810172014404678,-5.430978274176329],[15.335201090132017,10.339656442539393],[-8.60923717866486,24.06611071472412],[.42348348882084963,-2.192423788460001],[-6.930123682768279,10.71787556050819],[-7.094937559682972,18.949987893682007],[7.814694267388184,-.9956587493883475],[-5.598897544234703,7.738312071183948],[-1.0961849993818795,4.211353340617222],[7.7535020243077994,-4.85062626650879],[12.543148430914613,24.194094195823034],[13.287999883376372,19.598251819840762],[8.775833600398876,4.172543139643842],[10.771640847112643,-.4892331135286483],[10.63422282413206,-4.0131015364500655],[11.152722901572297,-6.967954776408785],[15.523707308810309,21.59865485619609],[-11.544736928698534,24.684852355113954],[-8.092763207987595,13.483426018264815],[14.072341259792609,5.479263896153711],[18.479155110086772,21.083554580589315],[-12.948314311991952,22.033443195986067],[-11.075734368565598,13.164234766567695],[-10.75053875489167,19.991438641482674],[1.8512245117187334,-5.925578796162185],[8.376552672342896,-8.105003085998323],[-9.331198394864217,16.215875155560134],[3.8907908440640995,-8.28662850899558],[13.214239888985581,1.2525217258909116],[13.617869532098098,-4.325915094409886],[16.592403865377975,7.615791324382123],[-9.781340838762763,9.784837121127055],[16.43216099198078,3.6269003164060933],[19.151124522271637,24.007329043349394],[-13.181344315031454,15.301150009001077],[-15.416753901028036,23.738378970518184],[-12.8851676227988,10.771338759952464],[14.672265733249056,-1.3693403294925979],[-15.629261144930517,20.68714305153211],[-18.182364709061346,22.5758830098846],[.9281345461814148,-8.780032319259796],[-15.500066428281652,9.300861205861814],[-17.682700027346215,18.500047087431902],[17.58102602511707,-2.103583861607081],[-1.2354272341591077,-10.858252813492737],[-1.0828978186860532,-6.550819669922085],[-1.631260755326558,-.006554146614181633],[19.107973271514695,16.663775939751865],[17.931792715899157,11.84222488656983],[-20.67785969325086,18.670395482604945],[-3.841070110270717,3.0007312988466133],[-9.863578745315223,6.785964511841037],[-3.9665290690607335,-5.723371295784688],[-17.675192393719158,11.366975199444845],[-12.853423153168947,6.539326281175409],[-6.832788755943316,3.2234857491612274],[21.275279520041593,14.58946072139755],[7.981449670057145,-11.078871546032298],[4.556954050038765,-11.21173134188977],[22.116661379671825,23.553907443289283],[11.475123173374186,-9.950580811422583],[-15.695550684523116,13.664456289453156],[-18.328571900774186,8.30108283438149],[18.951823768592384,1.9986191698721214],[-15.00300404697764,4.446648097370577],[-20.621022629137887,24.323151606537103],[19.567625220912944,7.23100841731798],[20.770665305932795,10.872275188103067],[-4.202060505024566,-10.412061110080204],[-18.61383048361553,15.648206265540232],[-4.611555936560727,-.3498333809300114],[23.628322334565716,12.728496048703185],[7.089880302922161,-13.943326828208402],[-7.576144091126274,.10975020647244449],[4.434955834932509,-15.340243457528105],[21.960244217375404,5.4212088876001125],[-21.283420488553123,14.279524708151015],[14.037143937221671,-7.792645802856548],[23.569361953871372,20.929091060812148],[-13.74294908170627,18.35437070941753],[17.531488465219105,-5.103174838750366],[24.48527262349704,3.8012608797063727],[22.742809904758964,8.611601465222904],[-23.29032235715487,22.953904016797203],[-7.173450726581134,-10.825389249986102],[1.4286568979602765,41.21999117647679],[32.82677308526462,8.14858290026775],[49.10993742480764,25.824832904998292],[.8991852666087361,38.248850332243194],[17.185055953524614,22.119269545888713],[15.19742940060218,27.120477687576194],[27.166709824402368,11.975333871138586],[10.548753418945275,26.497823975996365],[45.50602675971476,23.563027496384237],[1.9746435862130238,35.448245147145876],[23.493304663550482,11.154036755980265],[1.0062829699319316,32.60883011639821],[28.040173602975248,7.0037101337251695],[.4143296292320311,45.24797099404356],[4.21942311147696,31.5725946105122],[37.95413114176188,12.439335774307715],[7.121122840659738,28.592625942160428],[40.89351787080449,11.839331060052704],[3.160795232640335,28.76558427669618],[25.48065636364034,8.906719862404724],[42.00100124477654,16.743080721211786],[48.46493512281253,41.640169950238615],[45.5314852319357,19.901229669174246],[14.238140465850837,24.277984989315794],[18.073973612562956,18.78532877288672],[14.001652761040246,21.28732058730184],[46.04656505383195,16.94577830312618],[35.71983844430752,7.3547486428146955],[20.935321951625024,9.586642598312661],[31.01071661276084,5.760709601979669],[15.306898913992207,15.80291111120073],[5.3570807218381145,26.16607377848799],[38.5389582793732,6.328803539244664],[46.16794481502467,13.948234816607116],[39.26856083763546,9.3175232481141],[11.078159612910143,20.614128331823206],[23.216591651927168,6.938469120965712],[15.879182395376427,11.892558550281537],[49.1184153790938,13.405350436134006],[18.244811380648216,8.259558250028006],[49.001954125609366,16.430341173673245],[39.19304942358222,3.400977592391368],[47.19963474435405,11.099210614755474],[35.31138063466284,4.382685013324181],[20.389721216498877,5.934076995697135],[13.168184079761497,18.40542364998303],[37.54411429061378,.894782682321039],[29.807087565615323,3.0127508837912695],[18.28861749491513,3.792730888420923],[49.9592710631856,22.94757164283948],[40.97536268134073,.9878138078093301],[9.478766495532144,23.69512385223625],[12.86402262024899,14.061545149242283],[11.020595181343054,11.694738169894629],[44.28083015998867,10.405971984637613],[15.657059276409479,5.2331826726245545],[4.633305599397822,23.25469101901843],[33.445809013866416,2.0332930648236593],[13.739095764346517,7.540002120781512],[41.458110553747744,7.020576622714949],[8.21590829271431,12.759506434238604],[2.442198334457662,25.456524155318974],[21.753067034658326,3.261758118746406],[49.51783028717048,19.980227705701214],[44.31748358708691,6.1128399559371625],[25.47455271535703,4.963219304857698],[10.457382102759766,17.120296169347913],[.3443918500106582,23.311947751034864],[47.57268694121007,8.122495637062622],[.30986144915055247,27.83168034043898],[7.323580259831975,21.60821889765672],[5.0188039343082185,19.687800690779564],[17.86598856511309,.8226492754522758],[12.817415922805619,4.265491800324163],[7.527389993654994,17.76461460039256],[9.514912598082992,9.099951096073857],[5.485345474057386,14.002095140677069],[20.885660861433262,.3898934752349619],[2.154467755223595,20.579752625127465],[6.611798988064756,8.343689654952504],[27.03311420712615,1.8703534895398786],[23.871742638826614,.6785379255876686],[9.028479429066227,6.139649967458667],[10.754277403410207,2.087543350569906],[49.208761171847755,5.607886102394589],[43.75372011905979,2.119507206337036],[46.44945146845799,4.002220863632211],[3.6411292986537824,11.635902693224882],[12.95014042594881,.043482298094298155],[48.28739725472809,1.6311545873058795],[7.097174476198292,3.843988585845985],[1.2840010083841258,9.780115468565086],[3.1439626251099755,15.87770873485231],[.2267391394562952,18.281087276723756],[4.362800260907164,6.358241412050264],[.8159012768356784,6.816860055792786],[5.092427858675777,1.6121751976945258],[.6434734964317567,12.710938647542653],[2.1922209653256717,.8448421697564678],[1.3104447462519646,3.7123272524510824]],Kb=50,Zb=50,lv=(o,c)=>o.tags.includes(c),cv=o=>o._embedded["wp:featuredmedia"]&&o._embedded["wp:featuredmedia"].length>=1,uv=o=>o._embedded["wp:featuredmedia"][0].media_details.sizes.full.source_url,N0=o=>{const c=o.id;let f="";return window.wpData.youtube_urls[c]&&(f=window.wpData.youtube_urls[c]),f},hv=(o,c)=>o.tags.includes(c),Jb=o=>{let c="";return o.meta.video_link&&(c=o.meta.video_link),c};window.points=av;const $b=()=>{for(var o="0123456789ABCDEF",c="#",f=0;f<6;f++)c+=o[Math.floor(Math.random()*16)];return c},Qb=(o,c)=>{const f=new Yb(2938,345,1984);return o.map((s,d)=>{let m=c+d;return s.position=av[m],s}).map((s,d)=>{let m=f.perlin(Math.abs(s.position[0]),Math.abs(s.position[1]));return s.height=.7,m&&(s.height=Math.abs(m)*4+.85),s}).map(s=>(s.rot=Math.ceil((Math.random()*2-1)*35),s)).map(s=>(s.position[0]=s.position[0]-Kb/2,s.position[1]=s.position[1]-Zb/2,s)).filter(s=>!isNaN(s.position[0])&&!isNaN(s.position[1]))},ea=vb("posts",{state:()=>({posts:[],tags:[],currentFilter:null,page:{isFinal:!1,current:null}}),getters:{allPosts(o){return o.posts},getPostBySlug(o){return c=>o.posts.find(f=>f.slug===c)},getPostsByCurrentFilter(o){return o.currentFilter==null?o.posts:o.posts.filter(c=>c.tags.includes(o.currentFilter))},allTags(o){return o.tags},pageState(o){return o.page}},actions:{addPosts(o){let c=Qb(o,this.posts.length),f=this.posts.concat(c);this.posts=f},addTags(o){let c=this.tags.concat(o);this.tags=c},selectFilter(o){this.currentFilter=o},setPageFinalFlag(o){this.page.isFinal=o},setPageCurrent(o){this.page.current=o}}}),eE={name:"a-post",props:["post"],data(){return{videoWidth:null,videoHeight:null}},mounted(){this.isVideo&&window.setTimeout(()=>{let o=document.querySelector(`#${this.post.slug}`),c=o.videoHeight/o.videoWidth;this.videoWidth=2.2,this.videoHeight=this.videoWidth*c},100)},computed:{textAttr(){return`side: double; wrapCount: 13; baseline: bottom; color: ${$b()}`},isYouTube(){const o=parseInt(window.wpData.youtube_tag_id,10);return lv(this.post,o)},hasImage(){return cv(this.post)},imgUrl(){return uv(this.post)},width(){return this.post._embedded["wp:featuredmedia"][0].media_details.sizes.full.width},height(){return this.post._embedded["wp:featuredmedia"][0].media_details.sizes.full.height},isVideo(){const o=parseInt(window.wpData.video_tag_id,10);return hv(this.post,o)},posX(){return this.post.position[0]},posZ(){return this.post.position[1]}}};function tE(o,c,f,s,d,m){const _=Un("a-image"),y=Un("a-video"),x=Un("a-entity"),R=Un("a-text");return un(),or(x,{"post-url":f.post.slug,"cursor-listener":"",position:`${m.posX} ${f.post.height} ${m.posZ}`,rotation:`0 ${f.post.rot} 0`},{default:yr(()=>[m.isYouTube?(un(),or(_,{key:0,"post-url":f.post.slug,src:`#${f.post.slug}`,width:"2.2",height:"1.5"},null,8,["post-url","src"])):m.isVideo?(un(),or(y,{key:1,"post-url":f.post.slug,src:`#${f.post.slug}`,width:d.videoWidth,height:d.videoHeight,autoplay:"",loop:"true"},null,8,["post-url","src","width","height"])):m.hasImage?(un(),or(_,{key:2,"post-url":f.post.slug,src:`#${f.post.slug}`,width:"1.5",height:`${m.height/m.width*1.5}`},null,8,["post-url","src","height"])):(un(),or(R,{key:3,value:f.post.title.rendered,text:m.textAttr,position:"-0.65 0 0.1"},{default:yr(()=>[bn(x,{"post-url":f.post.slug,position:"2.1 0.5 0",geometry:"primitive: plane; width: 4.3; height: 2.5;",material:"visible: false"},null,8,["post-url"])]),_:1},8,["value","text"]))]),_:1},8,["post-url","position","rotation"])}const nE=Ci(eE,[["render",tE]]),iE={name:"AAsset",props:["post"],setup(){return{store:ea()}},computed:{isYouTube(){const o=parseInt(window.wpData.youtube_tag_id,10);return lv(this.post,o)},youTubeThumbnail(){return console.log(N0(this.post),this.post.title.rendered),N0(this.post)},hasImage(){return cv(this.post)},imgUrl(){return uv(this.post)},isVideo(){const o=parseInt(window.wpData.video_tag_id,10);return hv(this.post,o)},videoUrl(){return Jb(this.post)}}},rE=["id","src"],oE=["id","src"],sE=["id","src"];function aE(o,c,f,s,d,m){return un(),Rn("template",null,[m.isYouTube?(un(),Rn("img",{key:0,id:f.post.slug,src:m.youTubeThumbnail,crossorigin:"anonymous"},null,8,rE)):m.isVideo?(un(),Rn("video",{key:1,id:f.post.slug,src:m.videoUrl,"webkit-playsinline":"",playsinline:"",crossorigin:"anonymous"},null,8,oE)):m.hasImage?(un(),Rn("img",{key:2,id:f.post.slug,src:f.post._embedded["wp:featuredmedia"][0].media_details.sizes.full.source_url,crossorigin:"anonymous"},null,8,sE)):xu("",!0)])}const lE=Ci(iE,[["render",aE]]),cE={name:"MagicWindowButton",data(){return{isMagicWindow:!1}},methods:{toggleMagicWindow(){this.isMagicWindow=!this.isMagicWindow,this.$emit("magicWindowChanged",this.isMagicWindow)}}},uE=Zt("span",{class:"a11y-hidden"},"Toggle mobile window tracking",-1),hE=Zt("svg",{fill:"black",viewBox:"0 0 512 512"},[Zt("path",{d:"M464 6.1c9.5-8.5 24-8.1 33 .9l8 8c9 9 9.4 23.5 .9 33l-85.8 95.9c-2.6 2.9-4.1 6.7-4.1 10.7V176c0 8.8-7.2 16-16 16H384.2c-4.6 0-8.9 1.9-11.9 5.3L100.7 500.9C94.3 508 85.3 512 75.8 512c-8.8 0-17.3-3.5-23.5-9.8L9.7 459.7C3.5 453.4 0 445 0 436.2c0-9.5 4-18.5 11.1-24.8l111.6-99.8c3.4-3 5.3-7.4 5.3-11.9V272c0-8.8 7.2-16 16-16h34.6c3.9 0 7.7-1.5 10.7-4.1L464 6.1zM432 288c3.6 0 6.7 2.4 7.7 5.8l14.8 51.7 51.7 14.8c3.4 1 5.8 4.1 5.8 7.7s-2.4 6.7-5.8 7.7l-51.7 14.8-14.8 51.7c-1 3.4-4.1 5.8-7.7 5.8s-6.7-2.4-7.7-5.8l-14.8-51.7-51.7-14.8c-3.4-1-5.8-4.1-5.8-7.7s2.4-6.7 5.8-7.7l51.7-14.8 14.8-51.7c1-3.4 4.1-5.8 7.7-5.8zM87.7 69.8l14.8 51.7 51.7 14.8c3.4 1 5.8 4.1 5.8 7.7s-2.4 6.7-5.8 7.7l-51.7 14.8L87.7 218.2c-1 3.4-4.1 5.8-7.7 5.8s-6.7-2.4-7.7-5.8L57.5 166.5 5.8 151.7c-3.4-1-5.8-4.1-5.8-7.7s2.4-6.7 5.8-7.7l51.7-14.8L72.3 69.8c1-3.4 4.1-5.8 7.7-5.8s6.7 2.4 7.7 5.8zM208 0c3.7 0 6.9 2.5 7.8 6.1l6.8 27.3 27.3 6.8c3.6 .9 6.1 4.1 6.1 7.8s-2.5 6.9-6.1 7.8l-27.3 6.8-6.8 27.3c-.9 3.6-4.1 6.1-7.8 6.1s-6.9-2.5-7.8-6.1l-6.8-27.3-27.3-6.8c-3.6-.9-6.1-4.1-6.1-7.8s2.5-6.9 6.1-7.8l27.3-6.8 6.8-27.3c.9-3.6 4.1-6.1 7.8-6.1z"})],-1),dE=[uE,hE];function pE(o,c,f,s,d,m){return un(),Rn("button",{class:mo(["magic-window ui-button",{"is-active":d.isMagicWindow}]),onClick:c[0]||(c[0]=(..._)=>m.toggleMagicWindow&&m.toggleMagicWindow(..._))},dE,2)}const fE=Ci(cE,[["render",pE]]),mE={name:"DaytimeButton",data(){return{isDay:!0}},methods:{toggleDaytime(){this.isDay=!this.isDay,this.$emit("daytimeChanged",this.isDay)}}},gE=Zt("span",{class:"a11y-hidden"},"Toggle daytime lighting",-1),vE={key:0,viewBox:"0 -17 512 512"},yE=Zt("path",{d:"M375.7 19.7c-1.5-8-6.9-14.7-14.4-17.8s-16.1-2.2-22.8 2.4L256 61.1 173.5 4.2c-6.7-4.6-15.3-5.5-22.8-2.4s-12.9 9.8-14.4 17.8l-18.1 98.5L19.7 136.3c-8 1.5-14.7 6.9-17.8 14.4s-2.2 16.1 2.4 22.8L61.1 256 4.2 338.5c-4.6 6.7-5.5 15.3-2.4 22.8s9.8 13 17.8 14.4l98.5 18.1 18.1 98.5c1.5 8 6.9 14.7 14.4 17.8s16.1 2.2 22.8-2.4L256 450.9l82.5 56.9c6.7 4.6 15.3 5.5 22.8 2.4s12.9-9.8 14.4-17.8l18.1-98.5 98.5-18.1c8-1.5 14.7-6.9 17.8-14.4s2.2-16.1-2.4-22.8L450.9 256l56.9-82.5c4.6-6.7 5.5-15.3 2.4-22.8s-9.8-12.9-17.8-14.4l-98.5-18.1L375.7 19.7zM269.6 110l65.6-45.2 14.4 78.3c1.8 9.8 9.5 17.5 19.3 19.3l78.3 14.4L402 242.4c-5.7 8.2-5.7 19 0 27.2l45.2 65.6-78.3 14.4c-9.8 1.8-17.5 9.5-19.3 19.3l-14.4 78.3L269.6 402c-8.2-5.7-19-5.7-27.2 0l-65.6 45.2-14.4-78.3c-1.8-9.8-9.5-17.5-19.3-19.3L64.8 335.2 110 269.6c5.7-8.2 5.7-19 0-27.2L64.8 176.8l78.3-14.4c9.8-1.8 17.5-9.5 19.3-19.3l14.4-78.3L242.4 110c8.2 5.7 19 5.7 27.2 0zM256 368a112 112 0 1 0 0-224 112 112 0 1 0 0 224zM192 256a64 64 0 1 1 128 0 64 64 0 1 1 -128 0z"},null,-1),xE=[yE],_E={key:1,viewBox:"3 25 384 512"},bE=Zt("path",{d:"M144.7 98.7c-21 34.1-33.1 74.3-33.1 117.3c0 98 62.8 181.4 150.4 211.7c-12.4 2.8-25.3 4.3-38.6 4.3C126.6 432 48 353.3 48 256c0-68.9 39.4-128.4 96.8-157.3zm62.1-66C91.1 41.2 0 137.9 0 256C0 379.7 100 480 223.5 480c47.8 0 92-15 128.4-40.6c1.9-1.3 3.7-2.7 5.5-4c4.8-3.6 9.4-7.4 13.9-11.4c2.7-2.4 5.3-4.8 7.9-7.3c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-3.7 .6-7.4 1.2-11.1 1.6c-5 .5-10.1 .9-15.3 1c-1.2 0-2.5 0-3.7 0c-.1 0-.2 0-.3 0c-96.8-.2-175.2-78.9-175.2-176c0-54.8 24.9-103.7 64.1-136c1-.9 2.1-1.7 3.2-2.6c4-3.2 8.2-6.2 12.5-9c3.1-2 6.3-4 9.6-5.8c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-3.6-.3-7.1-.5-10.7-.6c-2.7-.1-5.5-.1-8.2-.1c-3.3 0-6.5 .1-9.8 .2c-2.3 .1-4.6 .2-6.9 .4z"},null,-1),EE=[bE];function wE(o,c,f,s,d,m){return un(),Rn("button",{class:"daytime-button ui-button",onClick:c[0]||(c[0]=(..._)=>m.toggleDaytime&&m.toggleDaytime(..._))},[gE,d.isDay?(un(),Rn("svg",vE,xE)):(un(),Rn("svg",_E,EE))])}const ME=Ci(mE,[["render",wE]]),TE={name:"RagnarokButton",data(){return{isRagnarok:!1}},methods:{toggleR(){this.isRagnarok=!this.isRagnarok,this.$emit("rChanged",this.isRagnarok)}}},SE=Zt("span",{class:"a11y-hidden"},"Toggle Ragnarok",-1),AE=Zt("svg",{viewBox:"0 0 640 512"},[Zt("path",{d:"M320 96C178.6 96 64 210.6 64 352v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V352C0 175.3 143.3 32 320 32s320 143.3 320 320v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V352C576 210.6 461.4 96 320 96zm0 192c-35.3 0-64 28.7-64 64v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V352c0-70.7 57.3-128 128-128s128 57.3 128 128v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V352c0-35.3-28.7-64-64-64zM160 352v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V352c0-123.7 100.3-224 224-224s224 100.3 224 224v96c0 17.7-14.3 32-32 32s-32-14.3-32-32V352c0-88.4-71.6-160-160-160s-160 71.6-160 160z"})],-1),RE=[SE,AE];function CE(o,c,f,s,d,m){return un(),Rn("button",{class:mo(["ragnarok-button ui-button",{"is-active":d.isRagnarok}]),onClick:c[0]||(c[0]=(..._)=>m.toggleR&&m.toggleR(..._))},RE,2)}const LE=Ci(TE,[["render",CE]]),PE={name:"AboutButton",data(){return{isOpen:!1}},methods:{url(){window.vueRouter.push(`/page/${window.wpData.about_page_id}`)}},watch:{$route(o,c){o.path!=`/page/${window.wpData.about_page_id}`&&(this.isOpen=!1),o.path==`/page/${window.wpData.about_page_id}`&&(this.isOpen=!0)}}},DE=Zt("span",{class:"a11y-hidden"},"Open about page",-1),NE=Zt("svg",{viewBox:"0 0 512 512"},[Zt("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM169.8 165.3c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1c0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6c-13.3 0-24-10.7-24-24V250.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1c0-8.4-6.8-15.1-15.1-15.1H222.6c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})],-1),IE=[DE,NE];function OE(o,c,f,s,d,m){return un(),Rn("button",{class:mo(["about-button ui-button",{"is-active":d.isOpen}]),onClick:c[0]||(c[0]=(..._)=>m.url&&m.url(..._))},IE,2)}const kE=Ci(PE,[["render",OE]]),FE={name:"TheField",components:{APost:nE,AAsset:lE,MagicWindowButton:fE,DaytimeButton:ME,RagnarokButton:LE,AboutButton:kE},created(){},data(){return{isMagicWindow:!1,isDay:!0,isRagnarok:!1,isPointOn:!0}},setup(){return{store:ea()}},methods:{toggleMW(o){this.isMagicWindow=o},toggleDT(o){this.isDay=o},toggleR(o){this.isRagnarok=o}},computed:{isFinal(){return this.store.pageState.isFinal},magicWindow(){return`magicWindowTrackingEnabled: ${this.isMagicWindow}`},environment(){let o,c,f;return this.isRagnarok?(o="#a51d2d",c="#c01c28",f=.9):this.isDay?(o="#091f3a",c="#1b75e4",f=.4,this.isPointOn=!0):(o="#192636",c="#01080e",f=.9,this.isPointOn=!1),`preset: checkerboard; active: true; seed: 8; skyType: gradient; skyColor:  ${o}; horizonColor: ${c}; fog: ${f}; lightPosition: [object Object]; ground: noise; groundYScale: 1.18; groundTexture: squares; groundColor: #252525; groundColor2: #111111; dressing: trees; dressingAmount: 20; dressingColor: #888b1d; dressingScale: 1; dressingVariance: [object Object]; gridColor: #c5a543; grid: 1x1; gridColor: #ffffff`}}},HE={key:1},BE={class:"ui ui-bottom"},UE={class:"ui ui-top"};function zE(o,c,f,s,d,m){const _=Un("AAsset"),y=Un("a-assets"),x=Un("a-entity"),R=Un("a-light"),C=Un("APost"),L=Un("a-scene"),N=Un("MagicWindowButton"),B=Un("DaytimeButton"),q=Un("RagnarokButton"),$=Un("AboutButton");return un(),Rn(Ai,null,[m.isFinal?(un(),or(L,{key:0,"vr-mode-ui":"enabled: true","post-processing":"effect: bloom","bloom-params":"strength: 0.1; radius: 3, threshold: 2","loading-screen":"dotsColor: black; backgroundColor: white"},{default:yr(()=>[bn(y,null,{default:yr(()=>[(un(!0),Rn(Ai,null,Gd(s.store.allPosts,(he,ce)=>(un(),or(_,{key:he.id,post:he},null,8,["post"]))),128))]),_:1}),bn(x,{environment:m.environment},null,8,["environment"]),bn(x,{id:"rig","movement-controls":"controls: keyboard, nipple","nipple-controls":"moveJoystickPosition: false",position:"0 0 0"},{default:yr(()=>[bn(x,{camera:"",id:"camera","look-controls":m.magicWindow,position:"0 1.6 0"},{default:yr(()=>[bn(x,{cursor:"rayOrigin:mouse",position:"0 0 -1",material:"color: black; shader: flat"})]),_:1},8,["look-controls"])]),_:1}),bn(R,{type:"ambient",color:"#ccc",visible:"false"}),bn(R,{color:"#ddf",distance:"100",visible:d.isPointOn,intensity:"0.4",type:"point"},null,8,["visible"]),bn(R,{color:"#ddf",position:"3 10 -10",distance:"50",visible:"false",intensity:"0.4",type:"point"}),bn(x,{position:"0 0 0",id:"all-posts"},{default:yr(()=>[(un(!0),Rn(Ai,null,Gd(s.store.getPostsByCurrentFilter,(he,ce)=>(un(),or(C,{key:he.id,post:he},null,8,["post"]))),128))]),_:1})]),_:1})):(un(),Rn("div",HE," Loading ")),Zt("div",BE,[bn(N,{onMagicWindowChanged:m.toggleMW},null,8,["onMagicWindowChanged"]),d.isRagnarok?xu("",!0):(un(),or(B,{key:0,onDaytimeChanged:m.toggleDT},null,8,["onDaytimeChanged"])),bn(q,{onRChanged:m.toggleR},null,8,["onRChanged"])]),Zt("div",UE,[bn($)])],64)}const GE=Ci(FE,[["render",zE]]),VE={name:"TrollfieldApp",components:{TheField:GE,LoadSpinner:Q1},setup(){return{store:ea()}},data(){return{isLoading:!1}},async created(){this.isLoading=!0,this.store.setPageCurrent(1),this.fetchData(1),this.fetchTags()},methods:{fetchData(o){fetch(`${window.wpData.rest_url}/wp/v2/posts?per_page=30&page=${o}&_embed=true`).then(c=>(parseInt(c.headers.get("x-wp-totalpages"),10)>o&&(this.fetchData(o+1),this.store.setPageCurrent(o+1)),c.json())).then(c=>{this.store.pageState.current==o&&(this.isLoading=!1,this.store.setPageFinalFlag(!0)),this.store.addPosts(c)}).catch(c=>{console.log("Error here?",c)})},fetchTags(){fetch(`${window.wpData.rest_url}/trolllike-theme/v1/tags`).then(o=>o.json()).then(o=>{let c=o,f=[],s=[];c.forEach(d=>{s.includes(d.term_id)||(f.push(d),s.push(d.term_id))}),this.store.addTags(Array.from(f))}).catch(o=>{console.log("Error",o)})}},computed:{}},WE={key:0,style:{"text-align":"center"}},jE={key:1};function XE(o,c,f,s,d,m){const _=Un("LoadSpinner"),y=Un("TheField"),x=Un("router-view");return d.isLoading?(un(),Rn("div",WE,[bn(_)])):(un(),Rn("div",jE,[bn(y),bn(x)]))}const qE=Ci(VE,[["render",XE]]);/*!
  * vue-router v4.2.4
  * (c) 2023 Eduardo San Martin Morote
  * @license MIT
  */const Us=typeof window<"u";function YE(o){return o.__esModule||o[Symbol.toStringTag]==="Module"}const An=Object.assign;function Id(o,c){const f={};for(const s in c){const d=c[s];f[s]=cr(d)?d.map(o):o(d)}return f}const tl=()=>{},cr=Array.isArray,KE=/\/$/,ZE=o=>o.replace(KE,"");function Od(o,c,f="/"){let s,d={},m="",_="";const y=c.indexOf("#");let x=c.indexOf("?");return y<x&&y>=0&&(x=-1),x>-1&&(s=c.slice(0,x),m=c.slice(x+1,y>-1?y:c.length),d=o(m)),y>-1&&(s=s||c.slice(0,y),_=c.slice(y,c.length)),s=ew(s!=null?s:c,f),{fullPath:s+(m&&"?")+m+_,path:s,query:d,hash:_}}function JE(o,c){const f=c.query?o(c.query):"";return c.path+(f&&"?")+f+(c.hash||"")}function I0(o,c){return!c||!o.toLowerCase().startsWith(c.toLowerCase())?o:o.slice(c.length)||"/"}function $E(o,c,f){const s=c.matched.length-1,d=f.matched.length-1;return s>-1&&s===d&&Ks(c.matched[s],f.matched[d])&&dv(c.params,f.params)&&o(c.query)===o(f.query)&&c.hash===f.hash}function Ks(o,c){return(o.aliasOf||o)===(c.aliasOf||c)}function dv(o,c){if(Object.keys(o).length!==Object.keys(c).length)return!1;for(const f in o)if(!QE(o[f],c[f]))return!1;return!0}function QE(o,c){return cr(o)?O0(o,c):cr(c)?O0(c,o):o===c}function O0(o,c){return cr(c)?o.length===c.length&&o.every((f,s)=>f===c[s]):o.length===1&&o[0]===c}function ew(o,c){if(o.startsWith("/"))return o;if(!o)return c;const f=c.split("/"),s=o.split("/"),d=s[s.length-1];(d===".."||d===".")&&s.push("");let m=f.length-1,_,y;for(_=0;_<s.length;_++)if(y=s[_],y!==".")if(y==="..")m>1&&m--;else break;return f.slice(0,m).join("/")+"/"+s.slice(_-(_===s.length?1:0)).join("/")}var ul;(function(o){o.pop="pop",o.push="push"})(ul||(ul={}));var nl;(function(o){o.back="back",o.forward="forward",o.unknown=""})(nl||(nl={}));function tw(o){if(!o)if(Us){const c=document.querySelector("base");o=c&&c.getAttribute("href")||"/",o=o.replace(/^\w+:\/\/[^\/]+/,"")}else o="/";return o[0]!=="/"&&o[0]!=="#"&&(o="/"+o),ZE(o)}const nw=/^[^#]+#/;function iw(o,c){return o.replace(nw,"#")+c}function rw(o,c){const f=document.documentElement.getBoundingClientRect(),s=o.getBoundingClientRect();return{behavior:c.behavior,left:s.left-f.left-(c.left||0),top:s.top-f.top-(c.top||0)}}const bu=()=>({left:window.pageXOffset,top:window.pageYOffset});function ow(o){let c;if("el"in o){const f=o.el,s=typeof f=="string"&&f.startsWith("#"),d=typeof f=="string"?s?document.getElementById(f.slice(1)):document.querySelector(f):f;if(!d)return;c=rw(d,o)}else c=o;"scrollBehavior"in document.documentElement.style?window.scrollTo(c):window.scrollTo(c.left!=null?c.left:window.pageXOffset,c.top!=null?c.top:window.pageYOffset)}function k0(o,c){return(history.state?history.state.position-c:-1)+o}const $d=new Map;function sw(o,c){$d.set(o,c)}function aw(o){const c=$d.get(o);return $d.delete(o),c}let lw=()=>location.protocol+"//"+location.host;function pv(o,c){const{pathname:f,search:s,hash:d}=c,m=o.indexOf("#");if(m>-1){let y=d.includes(o.slice(m))?o.slice(m).length:1,x=d.slice(y);return x[0]!=="/"&&(x="/"+x),I0(x,"")}return I0(f,o)+s+d}function cw(o,c,f,s){let d=[],m=[],_=null;const y=({state:N})=>{const B=pv(o,location),q=f.value,$=c.value;let he=0;if(N){if(f.value=B,c.value=N,_&&_===q){_=null;return}he=$?N.position-$.position:0}else s(B);d.forEach(ce=>{ce(f.value,q,{delta:he,type:ul.pop,direction:he?he>0?nl.forward:nl.back:nl.unknown})})};function x(){_=f.value}function R(N){d.push(N);const B=()=>{const q=d.indexOf(N);q>-1&&d.splice(q,1)};return m.push(B),B}function C(){const{history:N}=window;!N.state||N.replaceState(An({},N.state,{scroll:bu()}),"")}function L(){for(const N of m)N();m=[],window.removeEventListener("popstate",y),window.removeEventListener("beforeunload",C)}return window.addEventListener("popstate",y),window.addEventListener("beforeunload",C,{passive:!0}),{pauseListeners:x,listen:R,destroy:L}}function F0(o,c,f,s=!1,d=!1){return{back:o,current:c,forward:f,replaced:s,position:window.history.length,scroll:d?bu():null}}function uw(o){const{history:c,location:f}=window,s={value:pv(o,f)},d={value:c.state};d.value||m(s.value,{back:null,current:s.value,forward:null,position:c.length-1,replaced:!0,scroll:null},!0);function m(x,R,C){const L=o.indexOf("#"),N=L>-1?(f.host&&document.querySelector("base")?o:o.slice(L))+x:lw()+o+x;try{c[C?"replaceState":"pushState"](R,"",N),d.value=R}catch(B){console.error(B),f[C?"replace":"assign"](N)}}function _(x,R){const C=An({},c.state,F0(d.value.back,x,d.value.forward,!0),R,{position:d.value.position});m(x,C,!0),s.value=x}function y(x,R){const C=An({},d.value,c.state,{forward:x,scroll:bu()});m(C.current,C,!0);const L=An({},F0(s.value,x,null),{position:C.position+1},R);m(x,L,!1),s.value=x}return{location:s,state:d,push:y,replace:_}}function hw(o){o=tw(o);const c=uw(o),f=cw(o,c.state,c.location,c.replace);function s(m,_=!0){_||f.pauseListeners(),history.go(m)}const d=An({location:"",base:o,go:s,createHref:iw.bind(null,o)},c,f);return Object.defineProperty(d,"location",{enumerable:!0,get:()=>c.location.value}),Object.defineProperty(d,"state",{enumerable:!0,get:()=>c.state.value}),d}function dw(o){return o=location.host?o||location.pathname+location.search:"",o.includes("#")||(o+="#"),hw(o)}function pw(o){return typeof o=="string"||o&&typeof o=="object"}function fv(o){return typeof o=="string"||typeof o=="symbol"}const so={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},mv=Symbol("");var H0;(function(o){o[o.aborted=4]="aborted",o[o.cancelled=8]="cancelled",o[o.duplicated=16]="duplicated"})(H0||(H0={}));function Zs(o,c){return An(new Error,{type:o,[mv]:!0},c)}function kr(o,c){return o instanceof Error&&mv in o&&(c==null||!!(o.type&c))}const B0="[^/]+?",fw={sensitive:!1,strict:!1,start:!0,end:!0},mw=/[.+*?^${}()[\]/\\]/g;function gw(o,c){const f=An({},fw,c),s=[];let d=f.start?"^":"";const m=[];for(const R of o){const C=R.length?[]:[90];f.strict&&!R.length&&(d+="/");for(let L=0;L<R.length;L++){const N=R[L];let B=40+(f.sensitive?.25:0);if(N.type===0)L||(d+="/"),d+=N.value.replace(mw,"\\$&"),B+=40;else if(N.type===1){const{value:q,repeatable:$,optional:he,regexp:ce}=N;m.push({name:q,repeatable:$,optional:he});const Ee=ce||B0;if(Ee!==B0){B+=10;try{new RegExp(`(${Ee})`)}catch(Ae){throw new Error(`Invalid custom RegExp for param "${q}" (${Ee}): `+Ae.message)}}let Ye=$?`((?:${Ee})(?:/(?:${Ee}))*)`:`(${Ee})`;L||(Ye=he&&R.length<2?`(?:/${Ye})`:"/"+Ye),he&&(Ye+="?"),d+=Ye,B+=20,he&&(B+=-8),$&&(B+=-20),Ee===".*"&&(B+=-50)}C.push(B)}s.push(C)}if(f.strict&&f.end){const R=s.length-1;s[R][s[R].length-1]+=.7000000000000001}f.strict||(d+="/?"),f.end?d+="$":f.strict&&(d+="(?:/|$)");const _=new RegExp(d,f.sensitive?"":"i");function y(R){const C=R.match(_),L={};if(!C)return null;for(let N=1;N<C.length;N++){const B=C[N]||"",q=m[N-1];L[q.name]=B&&q.repeatable?B.split("/"):B}return L}function x(R){let C="",L=!1;for(const N of o){(!L||!C.endsWith("/"))&&(C+="/"),L=!1;for(const B of N)if(B.type===0)C+=B.value;else if(B.type===1){const{value:q,repeatable:$,optional:he}=B,ce=q in R?R[q]:"";if(cr(ce)&&!$)throw new Error(`Provided param "${q}" is an array but it is not repeatable (* or + modifiers)`);const Ee=cr(ce)?ce.join("/"):ce;if(!Ee)if(he)N.length<2&&(C.endsWith("/")?C=C.slice(0,-1):L=!0);else throw new Error(`Missing required param "${q}"`);C+=Ee}}return C||"/"}return{re:_,score:s,keys:m,parse:y,stringify:x}}function vw(o,c){let f=0;for(;f<o.length&&f<c.length;){const s=c[f]-o[f];if(s)return s;f++}return o.length<c.length?o.length===1&&o[0]===40+40?-1:1:o.length>c.length?c.length===1&&c[0]===40+40?1:-1:0}function yw(o,c){let f=0;const s=o.score,d=c.score;for(;f<s.length&&f<d.length;){const m=vw(s[f],d[f]);if(m)return m;f++}if(Math.abs(d.length-s.length)===1){if(U0(s))return 1;if(U0(d))return-1}return d.length-s.length}function U0(o){const c=o[o.length-1];return o.length>0&&c[c.length-1]<0}const xw={type:0,value:""},_w=/[a-zA-Z0-9_]/;function bw(o){if(!o)return[[]];if(o==="/")return[[xw]];if(!o.startsWith("/"))throw new Error(`Invalid path "${o}"`);function c(B){throw new Error(`ERR (${f})/"${R}": ${B}`)}let f=0,s=f;const d=[];let m;function _(){m&&d.push(m),m=[]}let y=0,x,R="",C="";function L(){!R||(f===0?m.push({type:0,value:R}):f===1||f===2||f===3?(m.length>1&&(x==="*"||x==="+")&&c(`A repeatable param (${R}) must be alone in its segment. eg: '/:ids+.`),m.push({type:1,value:R,regexp:C,repeatable:x==="*"||x==="+",optional:x==="*"||x==="?"})):c("Invalid state to consume buffer"),R="")}function N(){R+=x}for(;y<o.length;){if(x=o[y++],x==="\\"&&f!==2){s=f,f=4;continue}switch(f){case 0:x==="/"?(R&&L(),_()):x===":"?(L(),f=1):N();break;case 4:N(),f=s;break;case 1:x==="("?f=2:_w.test(x)?N():(L(),f=0,x!=="*"&&x!=="?"&&x!=="+"&&y--);break;case 2:x===")"?C[C.length-1]=="\\"?C=C.slice(0,-1)+x:f=3:C+=x;break;case 3:L(),f=0,x!=="*"&&x!=="?"&&x!=="+"&&y--,C="";break;default:c("Unknown state");break}}return f===2&&c(`Unfinished custom RegExp for param "${R}"`),L(),_(),d}function Ew(o,c,f){const s=gw(bw(o.path),f),d=An(s,{record:o,parent:c,children:[],alias:[]});return c&&!d.record.aliasOf==!c.record.aliasOf&&c.children.push(d),d}function ww(o,c){const f=[],s=new Map;c=V0({strict:!1,end:!0,sensitive:!1},c);function d(C){return s.get(C)}function m(C,L,N){const B=!N,q=Mw(C);q.aliasOf=N&&N.record;const $=V0(c,C),he=[q];if("alias"in C){const Ye=typeof C.alias=="string"?[C.alias]:C.alias;for(const Ae of Ye)he.push(An({},q,{components:N?N.record.components:q.components,path:Ae,aliasOf:N?N.record:q}))}let ce,Ee;for(const Ye of he){const{path:Ae}=Ye;if(L&&Ae[0]!=="/"){const ee=L.record.path,de=ee[ee.length-1]==="/"?"":"/";Ye.path=L.record.path+(Ae&&de+Ae)}if(ce=Ew(Ye,L,$),N?N.alias.push(ce):(Ee=Ee||ce,Ee!==ce&&Ee.alias.push(ce),B&&C.name&&!G0(ce)&&_(C.name)),q.children){const ee=q.children;for(let de=0;de<ee.length;de++)m(ee[de],ce,N&&N.children[de])}N=N||ce,(ce.record.components&&Object.keys(ce.record.components).length||ce.record.name||ce.record.redirect)&&x(ce)}return Ee?()=>{_(Ee)}:tl}function _(C){if(fv(C)){const L=s.get(C);L&&(s.delete(C),f.splice(f.indexOf(L),1),L.children.forEach(_),L.alias.forEach(_))}else{const L=f.indexOf(C);L>-1&&(f.splice(L,1),C.record.name&&s.delete(C.record.name),C.children.forEach(_),C.alias.forEach(_))}}function y(){return f}function x(C){let L=0;for(;L<f.length&&yw(C,f[L])>=0&&(C.record.path!==f[L].record.path||!gv(C,f[L]));)L++;f.splice(L,0,C),C.record.name&&!G0(C)&&s.set(C.record.name,C)}function R(C,L){let N,B={},q,$;if("name"in C&&C.name){if(N=s.get(C.name),!N)throw Zs(1,{location:C});$=N.record.name,B=An(z0(L.params,N.keys.filter(Ee=>!Ee.optional).map(Ee=>Ee.name)),C.params&&z0(C.params,N.keys.map(Ee=>Ee.name))),q=N.stringify(B)}else if("path"in C)q=C.path,N=f.find(Ee=>Ee.re.test(q)),N&&(B=N.parse(q),$=N.record.name);else{if(N=L.name?s.get(L.name):f.find(Ee=>Ee.re.test(L.path)),!N)throw Zs(1,{location:C,currentLocation:L});$=N.record.name,B=An({},L.params,C.params),q=N.stringify(B)}const he=[];let ce=N;for(;ce;)he.unshift(ce.record),ce=ce.parent;return{name:$,path:q,params:B,matched:he,meta:Sw(he)}}return o.forEach(C=>m(C)),{addRoute:m,resolve:R,removeRoute:_,getRoutes:y,getRecordMatcher:d}}function z0(o,c){const f={};for(const s of c)s in o&&(f[s]=o[s]);return f}function Mw(o){return{path:o.path,redirect:o.redirect,name:o.name,meta:o.meta||{},aliasOf:void 0,beforeEnter:o.beforeEnter,props:Tw(o),children:o.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in o?o.components||null:o.component&&{default:o.component}}}function Tw(o){const c={},f=o.props||!1;if("component"in o)c.default=f;else for(const s in o.components)c[s]=typeof f=="object"?f[s]:f;return c}function G0(o){for(;o;){if(o.record.aliasOf)return!0;o=o.parent}return!1}function Sw(o){return o.reduce((c,f)=>An(c,f.meta),{})}function V0(o,c){const f={};for(const s in o)f[s]=s in c?c[s]:o[s];return f}function gv(o,c){return c.children.some(f=>f===o||gv(o,f))}const vv=/#/g,Aw=/&/g,Rw=/\//g,Cw=/=/g,Lw=/\?/g,yv=/\+/g,Pw=/%5B/g,Dw=/%5D/g,xv=/%5E/g,Nw=/%60/g,_v=/%7B/g,Iw=/%7C/g,bv=/%7D/g,Ow=/%20/g;function wp(o){return encodeURI(""+o).replace(Iw,"|").replace(Pw,"[").replace(Dw,"]")}function kw(o){return wp(o).replace(_v,"{").replace(bv,"}").replace(xv,"^")}function Qd(o){return wp(o).replace(yv,"%2B").replace(Ow,"+").replace(vv,"%23").replace(Aw,"%26").replace(Nw,"`").replace(_v,"{").replace(bv,"}").replace(xv,"^")}function Fw(o){return Qd(o).replace(Cw,"%3D")}function Hw(o){return wp(o).replace(vv,"%23").replace(Lw,"%3F")}function Bw(o){return o==null?"":Hw(o).replace(Rw,"%2F")}function au(o){try{return decodeURIComponent(""+o)}catch{}return""+o}function Uw(o){const c={};if(o===""||o==="?")return c;const s=(o[0]==="?"?o.slice(1):o).split("&");for(let d=0;d<s.length;++d){const m=s[d].replace(yv," "),_=m.indexOf("="),y=au(_<0?m:m.slice(0,_)),x=_<0?null:au(m.slice(_+1));if(y in c){let R=c[y];cr(R)||(R=c[y]=[R]),R.push(x)}else c[y]=x}return c}function W0(o){let c="";for(let f in o){const s=o[f];if(f=Fw(f),s==null){s!==void 0&&(c+=(c.length?"&":"")+f);continue}(cr(s)?s.map(m=>m&&Qd(m)):[s&&Qd(s)]).forEach(m=>{m!==void 0&&(c+=(c.length?"&":"")+f,m!=null&&(c+="="+m))})}return c}function zw(o){const c={};for(const f in o){const s=o[f];s!==void 0&&(c[f]=cr(s)?s.map(d=>d==null?null:""+d):s==null?s:""+s)}return c}const Gw=Symbol(""),j0=Symbol(""),Mp=Symbol(""),Ev=Symbol(""),ep=Symbol("");function Ya(){let o=[];function c(s){return o.push(s),()=>{const d=o.indexOf(s);d>-1&&o.splice(d,1)}}function f(){o=[]}return{add:c,list:()=>o.slice(),reset:f}}function co(o,c,f,s,d){const m=s&&(s.enterCallbacks[d]=s.enterCallbacks[d]||[]);return()=>new Promise((_,y)=>{const x=L=>{L===!1?y(Zs(4,{from:f,to:c})):L instanceof Error?y(L):pw(L)?y(Zs(2,{from:c,to:L})):(m&&s.enterCallbacks[d]===m&&typeof L=="function"&&m.push(L),_())},R=o.call(s&&s.instances[d],c,f,x);let C=Promise.resolve(R);o.length<3&&(C=C.then(x)),C.catch(L=>y(L))})}function kd(o,c,f,s){const d=[];for(const m of o)for(const _ in m.components){let y=m.components[_];if(!(c!=="beforeRouteEnter"&&!m.instances[_]))if(Vw(y)){const R=(y.__vccOpts||y)[c];R&&d.push(co(R,f,s,m,_))}else{let x=y();d.push(()=>x.then(R=>{if(!R)return Promise.reject(new Error(`Couldn't resolve component "${_}" at "${m.path}"`));const C=YE(R)?R.default:R;m.components[_]=C;const N=(C.__vccOpts||C)[c];return N&&co(N,f,s,m,_)()}))}}return d}function Vw(o){return typeof o=="object"||"displayName"in o||"props"in o||"__vccOpts"in o}function X0(o){const c=xr(Mp),f=xr(Ev),s=zi(()=>c.resolve(Ws(o.to))),d=zi(()=>{const{matched:x}=s.value,{length:R}=x,C=x[R-1],L=f.matched;if(!C||!L.length)return-1;const N=L.findIndex(Ks.bind(null,C));if(N>-1)return N;const B=q0(x[R-2]);return R>1&&q0(C)===B&&L[L.length-1].path!==B?L.findIndex(Ks.bind(null,x[R-2])):N}),m=zi(()=>d.value>-1&&qw(f.params,s.value.params)),_=zi(()=>d.value>-1&&d.value===f.matched.length-1&&dv(f.params,s.value.params));function y(x={}){return Xw(x)?c[Ws(o.replace)?"replace":"push"](Ws(o.to)).catch(tl):Promise.resolve()}return{route:s,href:zi(()=>s.value.href),isActive:m,isExactActive:_,navigate:y}}const Ww=P1({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:X0,setup(o,{slots:c}){const f=hl(X0(o)),{options:s}=xr(Mp),d=zi(()=>({[Y0(o.activeClass,s.linkActiveClass,"router-link-active")]:f.isActive,[Y0(o.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:f.isExactActive}));return()=>{const m=c.default&&c.default(f);return o.custom?m:Y1("a",{"aria-current":f.isExactActive?o.ariaCurrentValue:null,href:f.href,onClick:f.navigate,class:d.value},m)}}}),jw=Ww;function Xw(o){if(!(o.metaKey||o.altKey||o.ctrlKey||o.shiftKey)&&!o.defaultPrevented&&!(o.button!==void 0&&o.button!==0)){if(o.currentTarget&&o.currentTarget.getAttribute){const c=o.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(c))return}return o.preventDefault&&o.preventDefault(),!0}}function qw(o,c){for(const f in c){const s=c[f],d=o[f];if(typeof s=="string"){if(s!==d)return!1}else if(!cr(d)||d.length!==s.length||s.some((m,_)=>m!==d[_]))return!1}return!0}function q0(o){return o?o.aliasOf?o.aliasOf.path:o.path:""}const Y0=(o,c,f)=>o!=null?o:c!=null?c:f,Yw=P1({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(o,{attrs:c,slots:f}){const s=xr(ep),d=zi(()=>o.route||s.value),m=xr(j0,0),_=zi(()=>{let R=Ws(m);const{matched:C}=d.value;let L;for(;(L=C[R])&&!L.components;)R++;return R}),y=zi(()=>d.value.matched[_.value]);eu(j0,zi(()=>_.value+1)),eu(Gw,y),eu(ep,d);const x=fp();return Ja(()=>[x.value,y.value,o.name],([R,C,L],[N,B,q])=>{C&&(C.instances[L]=R,B&&B!==C&&R&&R===N&&(C.leaveGuards.size||(C.leaveGuards=B.leaveGuards),C.updateGuards.size||(C.updateGuards=B.updateGuards))),R&&C&&(!B||!Ks(C,B)||!N)&&(C.enterCallbacks[L]||[]).forEach($=>$(R))},{flush:"post"}),()=>{const R=d.value,C=o.name,L=y.value,N=L&&L.components[C];if(!N)return K0(f.default,{Component:N,route:R});const B=L.props[C],q=B?B===!0?R.params:typeof B=="function"?B(R):B:null,he=Y1(N,An({},q,c,{onVnodeUnmounted:ce=>{ce.component.isUnmounted&&(L.instances[C]=null)},ref:x}));return K0(f.default,{Component:he,route:R})||he}}});function K0(o,c){if(!o)return null;const f=o(c);return f.length===1?f[0]:f}const Kw=Yw;function Zw(o){const c=ww(o.routes,o),f=o.parseQuery||Uw,s=o.stringifyQuery||W0,d=o.history,m=Ya(),_=Ya(),y=Ya(),x=Ax(so);let R=so;Us&&o.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const C=Id.bind(null,Re=>""+Re),L=Id.bind(null,Bw),N=Id.bind(null,au);function B(Re,ut){let et,_t;return fv(Re)?(et=c.getRecordMatcher(Re),_t=ut):_t=Re,c.addRoute(_t,et)}function q(Re){const ut=c.getRecordMatcher(Re);ut&&c.removeRoute(ut)}function $(){return c.getRoutes().map(Re=>Re.record)}function he(Re){return!!c.getRecordMatcher(Re)}function ce(Re,ut){if(ut=An({},ut||x.value),typeof Re=="string"){const pe=Od(f,Re,ut.path),Ce=c.resolve({path:pe.path},ut),Ne=d.createHref(pe.fullPath);return An(pe,Ce,{params:N(Ce.params),hash:au(pe.hash),redirectedFrom:void 0,href:Ne})}let et;if("path"in Re)et=An({},Re,{path:Od(f,Re.path,ut.path).path});else{const pe=An({},Re.params);for(const Ce in pe)pe[Ce]==null&&delete pe[Ce];et=An({},Re,{params:L(pe)}),ut.params=L(ut.params)}const _t=c.resolve(et,ut),rn=Re.hash||"";_t.params=C(N(_t.params));const X=JE(s,An({},Re,{hash:kw(rn),path:_t.path})),J=d.createHref(X);return An({fullPath:X,hash:rn,query:s===W0?zw(Re.query):Re.query||{}},_t,{redirectedFrom:void 0,href:J})}function Ee(Re){return typeof Re=="string"?Od(f,Re,x.value.path):An({},Re)}function Ye(Re,ut){if(R!==Re)return Zs(8,{from:ut,to:Re})}function Ae(Re){return De(Re)}function ee(Re){return Ae(An(Ee(Re),{replace:!0}))}function de(Re){const ut=Re.matched[Re.matched.length-1];if(ut&&ut.redirect){const{redirect:et}=ut;let _t=typeof et=="function"?et(Re):et;return typeof _t=="string"&&(_t=_t.includes("?")||_t.includes("#")?_t=Ee(_t):{path:_t},_t.params={}),An({query:Re.query,hash:Re.hash,params:"path"in _t?{}:Re.params},_t)}}function De(Re,ut){const et=R=ce(Re),_t=x.value,rn=Re.state,X=Re.force,J=Re.replace===!0,pe=de(et);if(pe)return De(An(Ee(pe),{state:typeof pe=="object"?An({},rn,pe.state):rn,force:X,replace:J}),ut||et);const Ce=et;Ce.redirectedFrom=ut;let Ne;return!X&&$E(s,_t,et)&&(Ne=Zs(16,{to:Ce,from:_t}),j(_t,_t,!0,!1)),(Ne?Promise.resolve(Ne):Ge(Ce,_t)).catch(Be=>kr(Be)?kr(Be,2)?Be:z(Be):T(Be,Ce,_t)).then(Be=>{if(Be){if(kr(Be,2))return De(An({replace:J},Ee(Be.to),{state:typeof Be.to=="object"?An({},rn,Be.to.state):rn,force:X}),ut||Ce)}else Be=xt(Ce,_t,!0,J,rn);return Xt(Ce,_t,Be),Be})}function Se(Re,ut){const et=Ye(Re,ut);return et?Promise.reject(et):Promise.resolve()}function ve(Re){const ut=ae.values().next().value;return ut&&typeof ut.runWithContext=="function"?ut.runWithContext(Re):Re()}function Ge(Re,ut){let et;const[_t,rn,X]=Jw(Re,ut);et=kd(_t.reverse(),"beforeRouteLeave",Re,ut);for(const pe of _t)pe.leaveGuards.forEach(Ce=>{et.push(co(Ce,Re,ut))});const J=Se.bind(null,Re,ut);return et.push(J),Fe(et).then(()=>{et=[];for(const pe of m.list())et.push(co(pe,Re,ut));return et.push(J),Fe(et)}).then(()=>{et=kd(rn,"beforeRouteUpdate",Re,ut);for(const pe of rn)pe.updateGuards.forEach(Ce=>{et.push(co(Ce,Re,ut))});return et.push(J),Fe(et)}).then(()=>{et=[];for(const pe of X)if(pe.beforeEnter)if(cr(pe.beforeEnter))for(const Ce of pe.beforeEnter)et.push(co(Ce,Re,ut));else et.push(co(pe.beforeEnter,Re,ut));return et.push(J),Fe(et)}).then(()=>(Re.matched.forEach(pe=>pe.enterCallbacks={}),et=kd(X,"beforeRouteEnter",Re,ut),et.push(J),Fe(et))).then(()=>{et=[];for(const pe of _.list())et.push(co(pe,Re,ut));return et.push(J),Fe(et)}).catch(pe=>kr(pe,8)?pe:Promise.reject(pe))}function Xt(Re,ut,et){y.list().forEach(_t=>ve(()=>_t(Re,ut,et)))}function xt(Re,ut,et,_t,rn){const X=Ye(Re,ut);if(X)return X;const J=ut===so,pe=Us?history.state:{};et&&(_t||J?d.replace(Re.fullPath,An({scroll:J&&pe&&pe.scroll},rn)):d.push(Re.fullPath,rn)),x.value=Re,j(Re,ut,et,J),z()}let At;function M(){At||(At=d.listen((Re,ut,et)=>{if(!wt.listening)return;const _t=ce(Re),rn=de(_t);if(rn){De(An(rn,{replace:!0}),_t).catch(tl);return}R=_t;const X=x.value;Us&&sw(k0(X.fullPath,et.delta),bu()),Ge(_t,X).catch(J=>kr(J,12)?J:kr(J,2)?(De(J.to,_t).then(pe=>{kr(pe,20)&&!et.delta&&et.type===ul.pop&&d.go(-1,!1)}).catch(tl),Promise.reject()):(et.delta&&d.go(-et.delta,!1),T(J,_t,X))).then(J=>{J=J||xt(_t,X,!1),J&&(et.delta&&!kr(J,8)?d.go(-et.delta,!1):et.type===ul.pop&&kr(J,20)&&d.go(-1,!1)),Xt(_t,X,J)}).catch(tl)}))}let I=Ya(),O=Ya(),A;function T(Re,ut,et){z(Re);const _t=O.list();return _t.length?_t.forEach(rn=>rn(Re,ut,et)):console.error(Re),Promise.reject(Re)}function F(){return A&&x.value!==so?Promise.resolve():new Promise((Re,ut)=>{I.add([Re,ut])})}function z(Re){return A||(A=!Re,M(),I.list().forEach(([ut,et])=>Re?et(Re):ut()),I.reset()),Re}function j(Re,ut,et,_t){const{scrollBehavior:rn}=o;if(!Us||!rn)return Promise.resolve();const X=!et&&aw(k0(Re.fullPath,0))||(_t||!et)&&history.state&&history.state.scroll||null;return gp().then(()=>rn(Re,ut,X)).then(J=>J&&ow(J)).catch(J=>T(J,Re,ut))}const se=Re=>d.go(Re);let Te;const ae=new Set,wt={currentRoute:x,listening:!0,addRoute:B,removeRoute:q,hasRoute:he,getRoutes:$,resolve:ce,options:o,push:Ae,replace:ee,go:se,back:()=>se(-1),forward:()=>se(1),beforeEach:m.add,beforeResolve:_.add,afterEach:y.add,onError:O.add,isReady:F,install(Re){const ut=this;Re.component("RouterLink",jw),Re.component("RouterView",Kw),Re.config.globalProperties.$router=ut,Object.defineProperty(Re.config.globalProperties,"$route",{enumerable:!0,get:()=>Ws(x)}),Us&&!Te&&x.value===so&&(Te=!0,Ae(d.location).catch(rn=>{}));const et={};for(const rn in so)Object.defineProperty(et,rn,{get:()=>x.value[rn],enumerable:!0});Re.provide(Mp,ut),Re.provide(Ev,g1(et)),Re.provide(ep,x);const _t=Re.unmount;ae.add(Re),Re.unmount=function(){ae.delete(Re),ae.size<1&&(R=so,At&&At(),At=null,x.value=so,Te=!1,A=!1),_t()}}};function Fe(Re){return Re.reduce((ut,et)=>ut.then(()=>ve(et)),Promise.resolve())}return wt}function Jw(o,c){const f=[],s=[],d=[],m=Math.max(c.matched.length,o.matched.length);for(let _=0;_<m;_++){const y=c.matched[_];y&&(o.matched.find(R=>Ks(R,y))?s.push(y):f.push(y));const x=o.matched[_];x&&(c.matched.find(R=>Ks(R,x))||d.push(x))}return[f,s,d]}const $w={name:"FilterTag",props:["tag"],setup(){return{store:ea()}},methods:{selectFilter(){if(this.amICurrentFilter())this.store.selectFilter(null);else{let o=this.tag.term_id;this.store.selectFilter(o)}},amICurrentFilter(){return this.store.currentFilter==this.tag.term_id}}};function Qw(o,c,f,s,d,m){return un(),Rn("li",null,[Zt("button",{class:mo(["filter-tag",{"is-current":m.amICurrentFilter()}]),onClick:c[0]||(c[0]=(..._)=>m.selectFilter&&m.selectFilter(..._))},t1(f.tag.name),3)])}const e2=Ci($w,[["render",Qw]]),t2={name:"TheFilter",components:{FilterTag:e2},data(){return{isOpen:!1}},setup(){return{store:ea()}},methods:{toggleFilter(){this.isOpen=!this.isOpen}}},n2=Zt("span",{class:"a11y-hidden"},"Filter",-1),i2=Zt("svg",{class:"filter-icon",xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512"},[Zt("path",{d:"M3.9 54.9C10.5 40.9 24.5 32 40 32H472c15.5 0 29.5 8.9 36.1 22.9s4.6 30.5-5.2 42.5L320 320.9V448c0 12.1-6.8 23.2-17.7 28.6s-23.8 4.3-33.5-3l-64-48c-8.1-6-12.8-15.5-12.8-25.6V320.9L9 97.3C-.7 85.4-2.8 68.8 3.9 54.9z"})],-1),r2=[n2,i2],o2={key:0,class:"filter-inner"},s2={class:"filter-menu"};function a2(o,c,f,s,d,m){const _=Un("FilterTag");return un(),Rn("div",{class:mo(["filter",{"is-open":d.isOpen}])},[Zt("button",{type:"button",class:"filter-toggle",onClick:c[0]||(c[0]=(...y)=>m.toggleFilter&&m.toggleFilter(...y))},r2),d.isOpen?(un(),Rn("div",o2,[Zt("menu",s2,[(un(!0),Rn(Ai,null,Gd(s.store.allTags,y=>(un(),or(_,{key:y.term_id,tag:y},null,8,["tag"]))),128))])])):xu("",!0)],2)}const l2=Ci(t2,[["render",a2]]),c2={name:"TrollfieldHomeView",components:{TheFilter:l2}};function u2(o,c,f,s,d,m){const _=Un("TheFilter");return un(),Rn("div",null,[bn(_)])}const h2=Ci(c2,[["render",u2]]),d2={name:"TrollfieldSingleView",components:{},setup(){return{store:ea()}},created(){window.setTimeout(()=>{this.showPDF()},100)},computed:{item(){return this.store.getPostBySlug(this.$route.params.slug)},isExternal(){const o=parseInt(window.wpData.link_tag_id,10);return console.log(this.item.tags),this.item.tags.includes(o)},isText(){const o=parseInt(window.wpData.text_tag_id,10);return console.log(this.item.tags),this.item.tags.includes(o)}},methods:{showPDF(){let o=document.querySelector(".wp-block-file__embed");o&&o.hidden&&(o.hidden=!1)}}},p2={key:0,class:"single-view"},f2=Zt("span",{class:"a11y-hidden"},"Close",-1),m2=Zt("svg",{viewBox:"0 0 384 512"},[Zt("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})],-1),g2={key:0,class:"single-content-wrapper"},v2=["innerHTML"],y2=["href"],x2={key:1,class:"single-content-wrapper"},_2=["innerHTML"],b2=["innerHTML"],E2=["innerHTML"],w2=["innerHTML"];function M2(o,c,f,s,d,m){const _=Un("router-link");return m.item&&m.item.title?(un(),Rn("div",p2,[bn(_,{to:"/",class:"close-btn"},{default:yr(()=>[f2,m2]),_:1}),m.isExternal?(un(),Rn("div",g2,[Zt("h3",{innerHTML:m.item.title.rendered,class:"a11y-hidden"},null,8,v2),Zt("a",{href:m.item.meta.external_link,class:"external-link",target:"_blank",referrerpolicy:"no-referrer"},t1(m.item.title.rendered),9,y2)])):m.isText?(un(),Rn("div",x2,[Zt("h1",{innerHTML:m.item.title.rendered},null,8,_2),Zt("div",{innerHTML:m.item.content.rendered},null,8,b2)])):(un(),Rn(Ai,{key:2},[Zt("h3",{innerHTML:m.item.title.rendered,class:"a11y-hidden"},null,8,E2),Zt("div",{innerHTML:m.item.content.rendered,class:"single-content-wrapper"},null,8,w2)],64))])):xu("",!0)}const T2=Ci(d2,[["render",M2]]),S2={name:"TrollfieldSinglePageView",components:{LoadSpinner:Q1},data(){return{page:null,isLoading:!1}},created(){this.isLoading=!0,fetch(`${window.wpData.rest_url}/wp/v2/pages/${window.wpData.about_page_id}`).then(o=>o.json()).then(o=>{this.page=o,this.isLoading=!1}).catch(o=>{console.log("Error",o)})},computed:{}},A2={class:"single-view"},R2=Zt("span",{class:"a11y-hidden"},"Close",-1),C2=Zt("svg",{viewBox:"0 0 384 512"},[Zt("path",{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"})],-1),L2={key:0,class:"single-content-wrapper",style:{"text-align":"center"}},P2={key:1,class:"single-content-wrapper"},D2=["innerHTML"],N2=["innerHTML"];function I2(o,c,f,s,d,m){const _=Un("router-link"),y=Un("LoadSpinner");return un(),Rn("div",A2,[bn(_,{to:"/",class:"close-btn"},{default:yr(()=>[R2,C2]),_:1}),d.isLoading?(un(),Rn("div",P2,[Zt("h1",{innerHTML:d.page.title.rendered},null,8,D2),Zt("div",{innerHTML:d.page.content.rendered},null,8,N2)])):(un(),Rn("div",L2,[bn(y)]))])}const O2=Ci(S2,[["render",I2]]),k2=[{path:"/",component:h2},{path:"/page/:id",component:O2},{path:"/:slug",component:T2}],wv=Zw({history:dw(),routes:k2});window.vueRouter=wv;function Jc(o){throw new Error('Could not dynamically require "'+o+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}(function o(c,f,s){function d(y,x){if(!f[y]){if(!c[y]){var R=typeof Jc=="function"&&Jc;if(!x&&R)return R(y,!0);if(m)return m(y,!0);var C=new Error("Cannot find module '"+y+"'");throw C.code="MODULE_NOT_FOUND",C}var L=f[y]={exports:{}};c[y][0].call(L.exports,function(N){var B=c[y][1][N];return d(B||N)},L,L.exports,o,c,f,s)}return f[y].exports}for(var m=typeof Jc=="function"&&Jc,_=0;_<s.length;_++)d(s[_]);return d})({1:[function(o,c,f){o("./")},{"./":2}],2:[function(o,c,f){o("./src/controls"),o("./src/loaders"),o("./src/misc"),o("./src/pathfinding"),o("./src/primitives")},{"./src/controls":14,"./src/loaders":24,"./src/misc":29,"./src/pathfinding":32,"./src/primitives":39}],3:[function(o,c,f){c.exports=THREE.ColladaLoader=function(s){this.manager=s!==void 0?s:THREE.DefaultLoadingManager},THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(s,d,m,_){var y=this,x=y.path===void 0?THREE.LoaderUtils.extractUrlBase(s):y.path,R=new THREE.FileLoader(y.manager);R.setPath(y.path),R.load(s,function(C){d(y.parse(C,x))},m,_)},setPath:function(s){return this.path=s,this},setResourcePath:function(s){return this.resourcePath=s,this},options:{set convertUpAxis(s){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(s){return this.crossOrigin=s,this},parse:function(s,d){function m(Y,ne){for(var ue=[],ye=Y.childNodes,fe=0,ke=ye.length;fe<ke;fe++){var Oe=ye[fe];Oe.nodeName===ne&&ue.push(Oe)}return ue}function _(Y){if(Y.length===0)return[];for(var ne=Y.trim().split(/\s+/),ue=new Array(ne.length),ye=0,fe=ne.length;ye<fe;ye++)ue[ye]=ne[ye];return ue}function y(Y){if(Y.length===0)return[];for(var ne=Y.trim().split(/\s+/),ue=new Array(ne.length),ye=0,fe=ne.length;ye<fe;ye++)ue[ye]=parseFloat(ne[ye]);return ue}function x(Y){if(Y.length===0)return[];for(var ne=Y.trim().split(/\s+/),ue=new Array(ne.length),ye=0,fe=ne.length;ye<fe;ye++)ue[ye]=parseInt(ne[ye]);return ue}function R(Y){return Y.substring(1)}function C(){return"three_default_"+wn++}function L(Y){return Object.keys(Y).length===0}function N(Y,ne,ue,ye){var fe=m(Y,ne)[0];if(fe!==void 0)for(var ke=m(fe,ue),Oe=0;Oe<ke.length;Oe++)ye(ke[Oe])}function B(Y,ne){for(var ue in Y)Y[ue].build=ne(Y[ue])}function q(Y,ne){return Y.build!==void 0||(Y.build=ne(Y)),Y.build}function $(Y){var ne=[],ue=Y.channels,ye=Y.samplers,fe=Y.sources;for(var ke in ue)if(ue.hasOwnProperty(ke)){var Oe=ue[ke],Ze=ye[Oe.sampler],qe=Ze.inputs.INPUT,Ve=Ze.inputs.OUTPUT;(function(Le,rt){for(var gt=Le.keyframes,yt=Le.name,ht=[],lt=[],pt=[],Dt=[],kt=0,St=gt.length;kt<St;kt++){var an=gt[kt],Qt=an.time,Fn=an.value;it.fromArray(Fn).transpose(),it.decompose(Ce,Be,Ne),ht.push(Qt),lt.push(Ce.x,Ce.y,Ce.z),pt.push(Be.x,Be.y,Be.z,Be.w),Dt.push(Ne.x,Ne.y,Ne.z)}lt.length>0&&rt.push(new THREE.VectorKeyframeTrack(yt+".position",ht,lt)),pt.length>0&&rt.push(new THREE.QuaternionKeyframeTrack(yt+".quaternion",ht,pt)),Dt.length>0&&rt.push(new THREE.VectorKeyframeTrack(yt+".scale",ht,Dt))})(function(Le,rt,gt){var yt,ht,lt,pt,Dt,kt,St=Mt.nodes[Le.id],an=X(St.id),Qt=St.transforms[Le.sid],Fn=St.matrix.clone().transpose(),en={};switch(Qt){case"matrix":for(lt=0,pt=rt.array.length;lt<pt;lt++)if(yt=rt.array[lt],ht=lt*gt.stride,en[yt]===void 0&&(en[yt]={}),Le.arraySyntax===!0){var Dn=gt.array[ht],ci=Le.indices[0]+4*Le.indices[1];en[yt][ci]=Dn}else for(Dt=0,kt=gt.stride;Dt<kt;Dt++)en[yt][Dt]=gt.array[ht+Dt];break;case"translate":case"rotate":case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',Qt)}var ui=function(Li,Vi){var Cn=[];for(var Ur in Li)Cn.push({time:parseFloat(Ur),value:Li[Ur]});Cn.sort(function(Hi,Wi){return Hi.time-Wi.time});for(var hi=0;hi<16;hi++)(function(Hi,Wi,Eu){var $o,ji,Qo,ta=!0;for(ji=0,Qo=Hi.length;ji<Qo;ji++)($o=Hi[ji]).value[Wi]===void 0?$o.value[Wi]=null:ta=!1;if(ta===!0)for(ji=0,Qo=Hi.length;ji<Qo;ji++)($o=Hi[ji]).value[Wi]=Eu;else(function(ur,Xi){for(var es,xn,qn=0,hr=ur.length;qn<hr;qn++){var br=ur[qn];if(br.value[Xi]===null){if(es=function(wi,Yn,Bi){for(;Yn>=0;){var Nn=wi[Yn];if(Nn.value[Bi]!==null)return Nn;Yn--}return null}(ur,qn,Xi),xn=function(wi,Yn,Bi){for(;Yn<wi.length;){var Nn=wi[Yn];if(Nn.value[Bi]!==null)return Nn;Yn++}return null}(ur,qn,Xi),es===null){br.value[Xi]=xn.value[Xi];continue}if(xn===null){br.value[Xi]=es.value[Xi];continue}(function(wi,Yn,Bi,Nn){if(Bi.time-Yn.time==0)return void(wi.value[Nn]=Yn.value[Nn]);wi.value[Nn]=(wi.time-Yn.time)*(Bi.value[Nn]-Yn.value[Nn])/(Bi.time-Yn.time)+Yn.value[Nn]})(br,es,xn,Xi)}}})(Hi,Wi)})(Cn,hi,Vi.elements[hi]);return Cn}(en,Fn);return{name:an.uuid,keyframes:ui}}(Oe,fe[qe],fe[Ve]),ne)}return ne}function he(Y){return q(Mt.animations[Y],$)}function ce(Y){for(var ne=[],ue=Y.name,ye=Y.end-Y.start||-1,fe=Y.animations,ke=0,Oe=fe.length;ke<Oe;ke++)for(var Ze=he(fe[ke]),qe=0,Ve=Ze.length;qe<Ve;qe++)ne.push(Ze[qe]);return new THREE.AnimationClip(ue,ye,ne)}function Ee(Y){return q(Mt.clips[Y],ce)}function Ye(Y){var ne={id:Y.id},ue=Mt.geometries[ne.id];return Y.skin!==void 0&&(ne.skin=function(ye){function fe(Li,Vi){return Vi.weight-Li.weight}var ke,Oe,Ze,qe={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},Ve=ye.sources,Le=ye.vertexWeights,rt=Le.vcount,gt=Le.v,yt=Le.inputs.JOINT.offset,ht=Le.inputs.WEIGHT.offset,lt=ye.sources[ye.joints.inputs.JOINT],pt=ye.sources[ye.joints.inputs.INV_BIND_MATRIX],Dt=Ve[Le.inputs.WEIGHT.id].array,kt=0;for(ke=0,Ze=rt.length;ke<Ze;ke++){var St=rt[ke],an=[];for(Oe=0;Oe<St;Oe++){var Qt=gt[kt+yt],Fn=gt[kt+ht],en=Dt[Fn];an.push({index:Qt,weight:en}),kt+=2}for(an.sort(fe),Oe=0;Oe<4;Oe++){var Dn=an[Oe];Dn!==void 0?(qe.indices.array.push(Dn.index),qe.weights.array.push(Dn.weight)):(qe.indices.array.push(0),qe.weights.array.push(0))}}for(ye.bindShapeMatrix?qe.bindMatrix=new THREE.Matrix4().fromArray(ye.bindShapeMatrix).transpose():qe.bindMatrix=new THREE.Matrix4().identity(),ke=0,Ze=lt.array.length;ke<Ze;ke++){var ci=lt.array[ke],ui=new THREE.Matrix4().fromArray(pt.array,ke*pt.stride).transpose();qe.joints.push({name:ci,boneInverse:ui})}return qe}(Y.skin),ue.sources.skinIndices=ne.skin.indices,ue.sources.skinWeights=ne.skin.weights),ne}function Ae(Y){return q(Mt.controllers[Y],Ye)}function ee(Y){return Y.build!==void 0?Y.build:Y.init_from}function de(Y){var ne=Mt.images[Y];return ne!==void 0?q(ne,ee):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",Y),null)}function De(Y){for(var ne={},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1)switch(fe.nodeName){case"color":ne[fe.nodeName]=y(fe.textContent);break;case"float":ne[fe.nodeName]=parseFloat(fe.textContent);break;case"texture":ne[fe.nodeName]={id:fe.getAttribute("texture"),extra:function(ke){for(var Oe={technique:{}},Ze=0,qe=ke.childNodes.length;Ze<qe;Ze++){var Ve=ke.childNodes[Ze];if(Ve.nodeType===1)switch(Ve.nodeName){case"extra":(function(Le,rt){for(var gt=0,yt=Le.childNodes.length;gt<yt;gt++){var ht=Le.childNodes[gt];if(ht.nodeType===1)switch(ht.nodeName){case"technique":(function(lt,pt){for(var Dt=0,kt=lt.childNodes.length;Dt<kt;Dt++){var St=lt.childNodes[Dt];if(St.nodeType===1)switch(St.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":pt.technique[St.nodeName]=parseFloat(St.textContent);break;case"wrapU":case"wrapV":St.textContent.toUpperCase()==="TRUE"?pt.technique[St.nodeName]=1:St.textContent.toUpperCase()==="FALSE"?pt.technique[St.nodeName]=0:pt.technique[St.nodeName]=parseInt(St.textContent)}}})(ht,rt)}}})(Ve,Oe)}}return Oe}(fe)}}}return ne}function Se(Y){return Y}function ve(Y){function ne(gt){var yt=ye.profile.samplers[gt.id],ht=null;if(yt!==void 0?ht=de(ye.profile.surfaces[yt.source].init_from):(console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),ht=de(gt.id)),ht!==null){var lt=function(St){var an,Qt=St.slice(2+(St.lastIndexOf(".")-1>>>0));switch(Qt=Qt.toLowerCase()){case"tga":an=zt;break;default:an=It}return an}(ht);if(lt!==void 0){var pt=lt.load(ht),Dt=gt.extra;if(Dt!==void 0&&Dt.technique!==void 0&&L(Dt.technique)===!1){var kt=Dt.technique;pt.wrapS=kt.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,pt.wrapT=kt.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,pt.offset.set(kt.offsetU||0,kt.offsetV||0),pt.repeat.set(kt.repeatU||1,kt.repeatV||1)}else pt.wrapS=THREE.RepeatWrapping,pt.wrapT=THREE.RepeatWrapping;return pt}return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",ht),null}return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",gt.id),null}var ue,ye=function(gt){return q(Mt.effects[gt],Se)}(Y.url),fe=ye.profile.technique,ke=ye.profile.extra;switch(fe.type){case"phong":case"blinn":ue=new THREE.MeshPhongMaterial;break;case"lambert":ue=new THREE.MeshLambertMaterial;break;default:ue=new THREE.MeshBasicMaterial}ue.name=Y.name;var Oe=fe.parameters;for(var Ze in Oe){var qe=Oe[Ze];switch(Ze){case"diffuse":qe.color&&ue.color.fromArray(qe.color),qe.texture&&(ue.map=ne(qe.texture));break;case"specular":qe.color&&ue.specular&&ue.specular.fromArray(qe.color),qe.texture&&(ue.specularMap=ne(qe.texture));break;case"bump":qe.texture&&(ue.normalMap=ne(qe.texture));break;case"ambient":qe.texture&&(ue.lightMap=ne(qe.texture));break;case"shininess":qe.float&&ue.shininess&&(ue.shininess=qe.float);break;case"emission":qe.color&&ue.emissive&&ue.emissive.fromArray(qe.color),qe.texture&&(ue.emissiveMap=ne(qe.texture))}}var Ve=Oe.transparent,Le=Oe.transparency;if(Le===void 0&&Ve&&(Le={float:1}),Ve===void 0&&Le&&(Ve={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Ve&&Le)if(Ve.data.texture)ue.transparent=!0;else{var rt=Ve.data.color;switch(Ve.opaque){case"A_ONE":ue.opacity=rt[3]*Le.float;break;case"RGB_ZERO":ue.opacity=1-rt[0]*Le.float;break;case"A_ZERO":ue.opacity=1-rt[3]*Le.float;break;case"RGB_ONE":ue.opacity=rt[0]*Le.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Ve.opaque)}ue.opacity<1&&(ue.transparent=!0)}return ke!==void 0&&ke.technique!==void 0&&ke.technique.double_sided===1&&(ue.side=THREE.DoubleSide),ue}function Ge(Y){return q(Mt.materials[Y],ve)}function Xt(Y){var ne;switch(Y.optics.technique){case"perspective":ne=new THREE.PerspectiveCamera(Y.optics.parameters.yfov,Y.optics.parameters.aspect_ratio,Y.optics.parameters.znear,Y.optics.parameters.zfar);break;case"orthographic":var ue=Y.optics.parameters.ymag,ye=Y.optics.parameters.xmag,fe=Y.optics.parameters.aspect_ratio;ye=ye===void 0?ue*fe:ye,ue=ue===void 0?ye/fe:ue,ye*=.5,ue*=.5,ne=new THREE.OrthographicCamera(-ye,ye,ue,-ue,Y.optics.parameters.znear,Y.optics.parameters.zfar);break;default:ne=new THREE.PerspectiveCamera}return ne.name=Y.name,ne}function xt(Y){var ne=Mt.cameras[Y];return ne!==void 0?q(ne,Xt):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",Y),null)}function At(Y){var ne;switch(Y.technique){case"directional":ne=new THREE.DirectionalLight;break;case"point":ne=new THREE.PointLight;break;case"spot":ne=new THREE.SpotLight;break;case"ambient":ne=new THREE.AmbientLight}return Y.parameters.color&&ne.color.copy(Y.parameters.color),Y.parameters.distance&&(ne.distance=Y.parameters.distance),ne}function M(Y){var ne=Mt.lights[Y];return ne!==void 0?q(ne,At):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",Y),null)}function I(Y){for(var ne={array:[],stride:3},ue=0;ue<Y.childNodes.length;ue++){var ye=Y.childNodes[ue];if(ye.nodeType===1)switch(ye.nodeName){case"float_array":ne.array=y(ye.textContent);break;case"Name_array":ne.array=_(ye.textContent);break;case"technique_common":var fe=m(ye,"accessor")[0];fe!==void 0&&(ne.stride=parseInt(fe.getAttribute("stride")))}}return ne}function O(Y){for(var ne=0,ue=0,ye=Y.length;ue<ye;ue++)Y[ue].hasUV===!0&&ne++;ne>0&&ne<Y.length&&(Y.uvsNeedsFix=!0)}function A(Y){var ne={},ue=Y.sources,ye=Y.vertices,fe=Y.primitives;if(fe.length===0)return{};var ke=function(qe){for(var Ve={},Le=0;Le<qe.length;Le++){var rt=qe[Le];Ve[rt.type]===void 0&&(Ve[rt.type]=[]),Ve[rt.type].push(rt)}return Ve}(fe);for(var Oe in ke){var Ze=ke[Oe];O(Ze),ne[Oe]=function(qe,Ve,Le){for(var rt={},gt={array:[],stride:0},yt={array:[],stride:0},ht={array:[],stride:0},lt={array:[],stride:0},pt={array:[],stride:0},Dt={array:[],stride:4},kt={array:[],stride:4},St=new THREE.BufferGeometry,an=[],Qt=0,Fn=0;Fn<qe.length;Fn++){var en=qe[Fn],Dn=en.inputs,ci=0;switch(en.type){case"lines":case"linestrips":ci=2*en.count;break;case"triangles":ci=3*en.count;break;case"polylist":for(var ui=0;ui<en.count;ui++){var Li=en.vcount[ui];switch(Li){case 3:ci+=3;break;case 4:ci+=6;break;default:ci+=3*(Li-2)}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",en.type)}St.addGroup(Qt,ci,Fn),Qt+=ci,en.material&&an.push(en.material);for(var Vi in Dn){var Cn=Dn[Vi];switch(Vi){case"VERTEX":for(var Ur in Le){var hi=Le[Ur];switch(Ur){case"POSITION":var Hi=gt.array.length;if(T(en,Ve[hi],Cn.offset,gt.array),gt.stride=Ve[hi].stride,Ve.skinWeights&&Ve.skinIndices&&(T(en,Ve.skinIndices,Cn.offset,Dt.array),T(en,Ve.skinWeights,Cn.offset,kt.array)),en.hasUV===!1&&qe.uvsNeedsFix===!0)for(var ci=(gt.array.length-Hi)/gt.stride,Wi=0;Wi<ci;Wi++)ht.array.push(0,0);break;case"NORMAL":T(en,Ve[hi],Cn.offset,yt.array),yt.stride=Ve[hi].stride;break;case"COLOR":T(en,Ve[hi],Cn.offset,pt.array),pt.stride=Ve[hi].stride;break;case"TEXCOORD":T(en,Ve[hi],Cn.offset,ht.array),ht.stride=Ve[hi].stride;break;case"TEXCOORD1":T(en,Ve[hi],Cn.offset,lt.array),ht.stride=Ve[hi].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Ur)}}break;case"NORMAL":T(en,Ve[Cn.id],Cn.offset,yt.array),yt.stride=Ve[Cn.id].stride;break;case"COLOR":T(en,Ve[Cn.id],Cn.offset,pt.array),pt.stride=Ve[Cn.id].stride;break;case"TEXCOORD":T(en,Ve[Cn.id],Cn.offset,ht.array),ht.stride=Ve[Cn.id].stride;break;case"TEXCOORD1":T(en,Ve[Cn.id],Cn.offset,lt.array),lt.stride=Ve[Cn.id].stride}}}return gt.array.length>0&&St.addAttribute("position",new THREE.Float32BufferAttribute(gt.array,gt.stride)),yt.array.length>0&&St.addAttribute("normal",new THREE.Float32BufferAttribute(yt.array,yt.stride)),pt.array.length>0&&St.addAttribute("color",new THREE.Float32BufferAttribute(pt.array,pt.stride)),ht.array.length>0&&St.addAttribute("uv",new THREE.Float32BufferAttribute(ht.array,ht.stride)),lt.array.length>0&&St.addAttribute("uv2",new THREE.Float32BufferAttribute(lt.array,lt.stride)),Dt.array.length>0&&St.addAttribute("skinIndex",new THREE.Float32BufferAttribute(Dt.array,Dt.stride)),kt.array.length>0&&St.addAttribute("skinWeight",new THREE.Float32BufferAttribute(kt.array,kt.stride)),rt.data=St,rt.type=qe[0].type,rt.materialKeys=an,rt}(Ze,ue,ye)}return ne}function T(Y,ne,ue,ye){function fe(an){for(var Qt=ke[an+ue]*Ve,Fn=Qt+Ve;Qt<Fn;Qt++)ye.push(qe[Qt])}var ke=Y.p,Oe=Y.stride,Ze=Y.vcount,qe=ne.array,Ve=ne.stride;if(Y.vcount!==void 0)for(var Le=0,rt=0,gt=Ze.length;rt<gt;rt++){var yt=Ze[rt];if(yt===4){var ht=Le+1*Oe,lt=Le+2*Oe,pt=Le+3*Oe;fe(St=Le+0*Oe),fe(ht),fe(pt),fe(ht),fe(lt),fe(pt)}else if(yt===3){var ht=Le+1*Oe,lt=Le+2*Oe;fe(St=Le+0*Oe),fe(ht),fe(lt)}else if(yt>4)for(var Dt=1,kt=yt-2;Dt<=kt;Dt++){var St=Le+0*Oe,ht=Le+Oe*Dt,lt=Le+Oe*(Dt+1);fe(St),fe(ht),fe(lt)}Le+=Oe*yt}else for(var rt=0,gt=ke.length;rt<gt;rt+=Oe)fe(rt)}function F(Y){return q(Mt.geometries[Y],A)}function z(Y){return Y.build!==void 0?Y.build:Y}function j(Y){for(var ne={sid:Y.getAttribute("sid"),name:Y.getAttribute("name")||"",attachments:[],transforms:[]},ue=0;ue<Y.childNodes.length;ue++){var ye=Y.childNodes[ue];if(ye.nodeType===1)switch(ye.nodeName){case"attachment_full":ne.attachments.push(function(fe){for(var ke={joint:fe.getAttribute("joint").split("/").pop(),transforms:[],links:[]},Oe=0;Oe<fe.childNodes.length;Oe++){var Ze=fe.childNodes[Oe];if(Ze.nodeType===1)switch(Ze.nodeName){case"link":ke.links.push(j(Ze));break;case"matrix":case"translate":case"rotate":ke.transforms.push(se(Ze))}}return ke}(ye));break;case"matrix":case"translate":case"rotate":ne.transforms.push(se(ye))}}return ne}function se(Y){var ne={type:Y.nodeName},ue=y(Y.textContent);switch(ne.type){case"matrix":ne.obj=new THREE.Matrix4,ne.obj.fromArray(ue).transpose();break;case"translate":ne.obj=new THREE.Vector3,ne.obj.fromArray(ue);break;case"rotate":ne.obj=new THREE.Vector3,ne.obj.fromArray(ue),ne.angle=THREE.MathUtils.degToRad(ue[3])}return ne}function Te(Y){return Y.build!==void 0?Y.build:Y}function ae(Y){for(var ne={name:Y.getAttribute("name")||"",type:Y.getAttribute("type"),id:Y.getAttribute("id"),sid:Y.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},ue=0;ue<Y.childNodes.length;ue++){var ye=Y.childNodes[ue];if(ye.nodeType===1)switch(ye.nodeName){case"node":ne.nodes.push(ye.getAttribute("id")),ae(ye);break;case"instance_camera":ne.instanceCameras.push(R(ye.getAttribute("url")));break;case"instance_controller":ne.instanceControllers.push(wt(ye));break;case"instance_light":ne.instanceLights.push(R(ye.getAttribute("url")));break;case"instance_geometry":ne.instanceGeometries.push(wt(ye));break;case"instance_node":ne.instanceNodes.push(R(ye.getAttribute("url")));break;case"matrix":fe=y(ye.textContent),ne.matrix.multiply(it.fromArray(fe).transpose()),ne.transforms[ye.getAttribute("sid")]=ye.nodeName;break;case"translate":fe=y(ye.textContent),tt.fromArray(fe),ne.matrix.multiply(it.makeTranslation(tt.x,tt.y,tt.z)),ne.transforms[ye.getAttribute("sid")]=ye.nodeName;break;case"rotate":var fe=y(ye.textContent),ke=THREE.MathUtils.degToRad(fe[3]);ne.matrix.multiply(it.makeRotationAxis(tt.fromArray(fe),ke)),ne.transforms[ye.getAttribute("sid")]=ye.nodeName;break;case"scale":fe=y(ye.textContent),ne.matrix.scale(tt.fromArray(fe)),ne.transforms[ye.getAttribute("sid")]=ye.nodeName;break;case"extra":break;default:console.log(ye)}}return rn(ne.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",ne.id):Mt.nodes[ne.id]=ne,ne}function wt(Y){for(var ne={id:R(Y.getAttribute("url")),materials:{},skeletons:[]},ue=0;ue<Y.childNodes.length;ue++){var ye=Y.childNodes[ue];switch(ye.nodeName){case"bind_material":for(var fe=ye.getElementsByTagName("instance_material"),ke=0;ke<fe.length;ke++){var Oe=fe[ke],Ze=Oe.getAttribute("symbol"),qe=Oe.getAttribute("target");ne.materials[Ze]=R(qe)}break;case"skeleton":ne.skeletons.push(R(ye.textContent))}}return ne}function Fe(Y,ne){var ue,ye,fe=[],ke=[];for(ue=0;ue<Y.length;ue++){var Oe=Y[ue];if(rn(Oe))Re(X(Oe),ne,fe);else if(function(gt){return Mt.visualScenes[gt]!==void 0}(Oe))for(var Ze=Mt.visualScenes[Oe].children,qe=0;qe<Ze.length;qe++){var Ve=Ze[qe];Ve.type==="JOINT"&&Re(X(Ve.id),ne,fe)}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Oe)}for(ue=0;ue<ne.length;ue++)for(qe=0;qe<fe.length;qe++)if((ye=fe[qe]).bone.name===ne[ue].name){ke[ue]=ye,ye.processed=!0;break}for(ue=0;ue<fe.length;ue++)(ye=fe[ue]).processed===!1&&(ke.push(ye),ye.processed=!0);var Le=[],rt=[];for(ue=0;ue<ke.length;ue++)ye=ke[ue],Le.push(ye.bone),rt.push(ye.boneInverse);return new THREE.Skeleton(Le,rt)}function Re(Y,ne,ue){Y.traverse(function(ye){if(ye.isBone===!0){for(var fe,ke=0;ke<ne.length;ke++){var Oe=ne[ke];if(Oe.name===ye.name){fe=Oe.boneInverse;break}}fe===void 0&&(fe=new THREE.Matrix4),ue.push({bone:ye,boneInverse:fe,processed:!1})}})}function ut(Y){for(var ne=[],ue=Y.matrix,ye=Y.nodes,fe=Y.type,ke=Y.instanceCameras,Oe=Y.instanceControllers,Ze=Y.instanceLights,qe=Y.instanceGeometries,Ve=Y.instanceNodes,Le=0,rt=ye.length;Le<rt;Le++)ne.push(X(ye[Le]));for(var Le=0,rt=ke.length;Le<rt;Le++){var gt=xt(ke[Le]);gt!==null&&ne.push(gt.clone())}for(var Le=0,rt=Oe.length;Le<rt;Le++)for(var yt=Ae((St=Oe[Le]).id),ht=_t(an=F(yt.id),St.materials),lt=Fe(St.skeletons,yt.skin.joints),pt=0,Dt=ht.length;pt<Dt;pt++)(Qt=ht[pt]).isSkinnedMesh&&(Qt.bind(lt,yt.skin.bindMatrix),Qt.normalizeSkinWeights()),ne.push(Qt);for(var Le=0,rt=Ze.length;Le<rt;Le++){var kt=M(Ze[Le]);kt!==null&&ne.push(kt.clone())}for(var Le=0,rt=qe.length;Le<rt;Le++)for(var St=qe[Le],an=F(St.id),pt=0,Dt=(ht=_t(an,St.materials)).length;pt<Dt;pt++)ne.push(ht[pt]);for(var Le=0,rt=Ve.length;Le<rt;Le++)ne.push(X(Ve[Le]).clone());var Qt;if(ye.length===0&&ne.length===1)Qt=ne[0];else for(Qt=fe==="JOINT"?new THREE.Bone:new THREE.Group,Le=0;Le<ne.length;Le++)Qt.add(ne[Le]);return Qt.name===""&&(Qt.name=fe==="JOINT"?Y.sid:Y.name),Qt.matrix.copy(ue),Qt.matrix.decompose(Qt.position,Qt.quaternion,Qt.scale),Qt}function et(Y,ne){for(var ue=[],ye=0,fe=Y.length;ye<fe;ye++){var ke=ne[Y[ye]];ke===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",Y[ye]),ue.push(mt)):ue.push(Ge(ke))}return ue}function _t(Y,ne){var ue=[];for(var ye in Y){var fe=Y[ye],ke=et(fe.materialKeys,ne);ke.length===0&&(ye==="lines"||ye==="linestrips"?ke.push(new THREE.LineBasicMaterial):ke.push(new THREE.MeshPhongMaterial));var Oe=fe.data.attributes.skinIndex!==void 0;if(Oe)for(var Ze=0,qe=ke.length;Ze<qe;Ze++)ke[Ze].skinning=!0;var Ve,Le=ke.length===1?ke[0]:ke;switch(ye){case"lines":Ve=new THREE.LineSegments(fe.data,Le);break;case"linestrips":Ve=new THREE.Line(fe.data,Le);break;case"triangles":case"polylist":Ve=Oe?new THREE.SkinnedMesh(fe.data,Le):new THREE.Mesh(fe.data,Le)}ue.push(Ve)}return ue}function rn(Y){return Mt.nodes[Y]!==void 0}function X(Y){return q(Mt.nodes[Y],ut)}function J(Y){var ne=new THREE.Group;ne.name=Y.name;for(var ue=Y.children,ye=0;ye<ue.length;ye++){var fe=ue[ye];ne.add(X(fe.id))}return ne}function pe(Y){return q(Mt.visualScenes[Y],J)}var Ce=new THREE.Vector3,Ne=new THREE.Vector3,Be=new THREE.Quaternion,it=new THREE.Matrix4,tt=new THREE.Vector3,mt=new THREE.MeshBasicMaterial({color:16711935});if(s.length===0)return{scene:new THREE.Scene};var Ie=m(new DOMParser().parseFromString(s,"application/xml"),"COLLADA")[0],Nt=Ie.getAttribute("version");console.log("THREE.ColladaLoader: File version",Nt);var Tt=function(Y){return{unit:function(ne){return ne!==void 0&&ne.hasAttribute("meter")===!0?parseFloat(ne.getAttribute("meter")):1}(m(Y,"unit")[0]),upAxis:function(ne){return ne!==void 0?ne.textContent:"Y_UP"}(m(Y,"up_axis")[0])}}(m(Ie,"asset")[0]),It=new THREE.TextureLoader(this.manager);It.setPath(this.resourcePath||d).setCrossOrigin(this.crossOrigin);var zt;THREE.TGALoader&&(zt=new THREE.TGALoader(this.manager)).setPath(this.resourcePath||d);var $t=[],fn={},wn=0,Mt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};N(Ie,"library_animations","animation",function(Y){for(var ne={sources:{},samplers:{},channels:{}},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1){var ke;switch(fe.nodeName){case"source":ke=fe.getAttribute("id"),ne.sources[ke]=I(fe);break;case"sampler":ke=fe.getAttribute("id"),ne.samplers[ke]=function(Oe){for(var Ze={inputs:{}},qe=0,Ve=Oe.childNodes.length;qe<Ve;qe++){var Le=Oe.childNodes[qe];if(Le.nodeType===1)switch(Le.nodeName){case"input":var rt=R(Le.getAttribute("source")),gt=Le.getAttribute("semantic");Ze.inputs[gt]=rt}}return Ze}(fe);break;case"channel":ke=fe.getAttribute("target"),ne.channels[ke]=function(Oe){var Ze={},qe=Oe.getAttribute("target").split("/"),Ve=qe.shift(),Le=qe.shift(),rt=Le.indexOf("(")!==-1,gt=Le.indexOf(".")!==-1;if(gt)qe=Le.split("."),Le=qe.shift(),Ze.member=qe.shift();else if(rt){var yt=Le.split("(");Le=yt.shift();for(var ht=0;ht<yt.length;ht++)yt[ht]=parseInt(yt[ht].replace(/\)/,""));Ze.indices=yt}return Ze.id=Ve,Ze.sid=Le,Ze.arraySyntax=rt,Ze.memberSyntax=gt,Ze.sampler=R(Oe.getAttribute("source")),Ze}(fe);break;default:console.log(fe)}}}Mt.animations[Y.getAttribute("id")]=ne}),N(Ie,"library_animation_clips","animation_clip",function(Y){for(var ne={name:Y.getAttribute("id")||"default",start:parseFloat(Y.getAttribute("start")||0),end:parseFloat(Y.getAttribute("end")||0),animations:[]},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1)switch(fe.nodeName){case"instance_animation":ne.animations.push(R(fe.getAttribute("url")))}}Mt.clips[Y.getAttribute("id")]=ne}),N(Ie,"library_controllers","controller",function(Y){for(var ne={},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1)switch(fe.nodeName){case"skin":ne.id=R(fe.getAttribute("source")),ne.skin=function(ke){for(var Oe={sources:{}},Ze=0,qe=ke.childNodes.length;Ze<qe;Ze++){var Ve=ke.childNodes[Ze];if(Ve.nodeType===1)switch(Ve.nodeName){case"bind_shape_matrix":Oe.bindShapeMatrix=y(Ve.textContent);break;case"source":var Le=Ve.getAttribute("id");Oe.sources[Le]=I(Ve);break;case"joints":Oe.joints=function(rt){for(var gt={inputs:{}},yt=0,ht=rt.childNodes.length;yt<ht;yt++){var lt=rt.childNodes[yt];if(lt.nodeType===1)switch(lt.nodeName){case"input":var pt=lt.getAttribute("semantic"),Dt=R(lt.getAttribute("source"));gt.inputs[pt]=Dt}}return gt}(Ve);break;case"vertex_weights":Oe.vertexWeights=function(rt){for(var gt={inputs:{}},yt=0,ht=rt.childNodes.length;yt<ht;yt++){var lt=rt.childNodes[yt];if(lt.nodeType===1)switch(lt.nodeName){case"input":var pt=lt.getAttribute("semantic"),Dt=R(lt.getAttribute("source")),kt=parseInt(lt.getAttribute("offset"));gt.inputs[pt]={id:Dt,offset:kt};break;case"vcount":gt.vcount=x(lt.textContent);break;case"v":gt.v=x(lt.textContent)}}return gt}(Ve)}}return Oe}(fe);break;case"morph":ne.id=R(fe.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.")}}Mt.controllers[Y.getAttribute("id")]=ne}),N(Ie,"library_images","image",function(Y){var ne={init_from:m(Y,"init_from")[0].textContent};Mt.images[Y.getAttribute("id")]=ne}),N(Ie,"library_effects","effect",function(Y){for(var ne={},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1)switch(fe.nodeName){case"profile_COMMON":ne.profile=function(ke){for(var Oe={surfaces:{},samplers:{}},Ze=0,qe=ke.childNodes.length;Ze<qe;Ze++){var Ve=ke.childNodes[Ze];if(Ve.nodeType===1)switch(Ve.nodeName){case"newparam":(function(Le,rt){for(var gt=Le.getAttribute("sid"),yt=0,ht=Le.childNodes.length;yt<ht;yt++){var lt=Le.childNodes[yt];if(lt.nodeType===1)switch(lt.nodeName){case"surface":rt.surfaces[gt]=function(pt){for(var Dt={},kt=0,St=pt.childNodes.length;kt<St;kt++){var an=pt.childNodes[kt];if(an.nodeType===1)switch(an.nodeName){case"init_from":Dt.init_from=an.textContent}}return Dt}(lt);break;case"sampler2D":rt.samplers[gt]=function(pt){for(var Dt={},kt=0,St=pt.childNodes.length;kt<St;kt++){var an=pt.childNodes[kt];if(an.nodeType===1)switch(an.nodeName){case"source":Dt.source=an.textContent}}return Dt}(lt)}}})(Ve,Oe);break;case"technique":Oe.technique=function(Le){for(var rt={},gt=0,yt=Le.childNodes.length;gt<yt;gt++){var ht=Le.childNodes[gt];if(ht.nodeType===1)switch(ht.nodeName){case"constant":case"lambert":case"blinn":case"phong":rt.type=ht.nodeName,rt.parameters=function(lt){for(var pt={},Dt=0,kt=lt.childNodes.length;Dt<kt;Dt++){var St=lt.childNodes[Dt];if(St.nodeType===1)switch(St.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":pt[St.nodeName]=De(St);break;case"transparent":pt[St.nodeName]={opaque:St.getAttribute("opaque"),data:De(St)}}}return pt}(ht)}}return rt}(Ve);break;case"extra":Oe.extra=function(Le){for(var rt={},gt=0,yt=Le.childNodes.length;gt<yt;gt++){var ht=Le.childNodes[gt];if(ht.nodeType===1)switch(ht.nodeName){case"technique":rt.technique=function(lt){for(var pt={},Dt=0,kt=lt.childNodes.length;Dt<kt;Dt++){var St=lt.childNodes[Dt];if(St.nodeType===1)switch(St.nodeName){case"double_sided":pt[St.nodeName]=parseInt(St.textContent)}}return pt}(ht)}}return rt}(Ve)}}return Oe}(fe)}}Mt.effects[Y.getAttribute("id")]=ne}),N(Ie,"library_materials","material",function(Y){for(var ne={name:Y.getAttribute("name")},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1)switch(fe.nodeName){case"instance_effect":ne.url=R(fe.getAttribute("url"))}}Mt.materials[Y.getAttribute("id")]=ne}),N(Ie,"library_cameras","camera",function(Y){for(var ne={name:Y.getAttribute("name")},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1)switch(fe.nodeName){case"optics":ne.optics=function(ke){for(var Oe=0;Oe<ke.childNodes.length;Oe++){var Ze=ke.childNodes[Oe];switch(Ze.nodeName){case"technique_common":return function(qe){for(var Ve={},Le=0;Le<qe.childNodes.length;Le++){var rt=qe.childNodes[Le];switch(rt.nodeName){case"perspective":case"orthographic":Ve.technique=rt.nodeName,Ve.parameters=function(gt){for(var yt={},ht=0;ht<gt.childNodes.length;ht++){var lt=gt.childNodes[ht];switch(lt.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":yt[lt.nodeName]=parseFloat(lt.textContent)}}return yt}(rt)}}return Ve}(Ze)}}return{}}(fe)}}Mt.cameras[Y.getAttribute("id")]=ne}),N(Ie,"library_lights","light",function(Y){for(var ne={},ue=0,ye=Y.childNodes.length;ue<ye;ue++){var fe=Y.childNodes[ue];if(fe.nodeType===1)switch(fe.nodeName){case"technique_common":ne=function(ke){for(var Oe={},Ze=0,qe=ke.childNodes.length;Ze<qe;Ze++){var Ve=ke.childNodes[Ze];if(Ve.nodeType===1)switch(Ve.nodeName){case"directional":case"point":case"spot":case"ambient":Oe.technique=Ve.nodeName,Oe.parameters=function(Le){for(var rt={},gt=0,yt=Le.childNodes.length;gt<yt;gt++){var ht=Le.childNodes[gt];if(ht.nodeType===1)switch(ht.nodeName){case"color":var lt=y(ht.textContent);rt.color=new THREE.Color().fromArray(lt);break;case"falloff_angle":rt.falloffAngle=parseFloat(ht.textContent);break;case"quadratic_attenuation":var pt=parseFloat(ht.textContent);rt.distance=pt?Math.sqrt(1/pt):0}}return rt}(Ve)}}return Oe}(fe)}}Mt.lights[Y.getAttribute("id")]=ne}),N(Ie,"library_geometries","geometry",function(Y){var ne={name:Y.getAttribute("name"),sources:{},vertices:{},primitives:[]},ue=m(Y,"mesh")[0];if(ue!==void 0){for(var ye=0;ye<ue.childNodes.length;ye++){var fe=ue.childNodes[ye];if(fe.nodeType===1){var ke=fe.getAttribute("id");switch(fe.nodeName){case"source":ne.sources[ke]=I(fe);break;case"vertices":ne.vertices=function(Oe){for(var Ze={},qe=0;qe<Oe.childNodes.length;qe++){var Ve=Oe.childNodes[qe];Ve.nodeType===1&&(Ze[Ve.getAttribute("semantic")]=R(Ve.getAttribute("source")))}return Ze}(fe);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",fe.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":ne.primitives.push(function(Oe){for(var Ze={type:Oe.nodeName,material:Oe.getAttribute("material"),count:parseInt(Oe.getAttribute("count")),inputs:{},stride:0,hasUV:!1},qe=0,Ve=Oe.childNodes.length;qe<Ve;qe++){var Le=Oe.childNodes[qe];if(Le.nodeType===1)switch(Le.nodeName){case"input":var rt=R(Le.getAttribute("source")),gt=Le.getAttribute("semantic"),yt=parseInt(Le.getAttribute("offset")),ht=parseInt(Le.getAttribute("set")),lt=ht>0?gt+ht:gt;Ze.inputs[lt]={id:rt,offset:yt},Ze.stride=Math.max(Ze.stride,yt+1),gt==="TEXCOORD"&&(Ze.hasUV=!0);break;case"vcount":Ze.vcount=x(Le.textContent);break;case"p":Ze.p=x(Le.textContent)}}return Ze}(fe));break;default:console.log(fe)}}}Mt.geometries[Y.getAttribute("id")]=ne}}),N(Ie,"library_nodes","node",ae),N(Ie,"library_visual_scenes","visual_scene",function(Y){var ne={name:Y.getAttribute("name"),children:[]};(function(fe){for(var ke=fe.getElementsByTagName("node"),Oe=0;Oe<ke.length;Oe++){var Ze=ke[Oe];Ze.hasAttribute("id")===!1&&Ze.setAttribute("id",C())}})(Y);for(var ue=m(Y,"node"),ye=0;ye<ue.length;ye++)ne.children.push(ae(ue[ye]));Mt.visualScenes[Y.getAttribute("id")]=ne}),N(Ie,"library_kinematics_models","kinematics_model",function(Y){for(var ne={name:Y.getAttribute("name")||"",joints:{},links:[]},ue=0;ue<Y.childNodes.length;ue++){var ye=Y.childNodes[ue];if(ye.nodeType===1)switch(ye.nodeName){case"technique_common":(function(fe,ke){for(var Oe=0;Oe<fe.childNodes.length;Oe++){var Ze=fe.childNodes[Oe];if(Ze.nodeType===1)switch(Ze.nodeName){case"joint":ke.joints[Ze.getAttribute("sid")]=function(qe){for(var Ve,Le=0;Le<qe.childNodes.length;Le++){var rt=qe.childNodes[Le];if(rt.nodeType===1)switch(rt.nodeName){case"prismatic":case"revolute":Ve=function(gt,yt){for(var yt={sid:gt.getAttribute("sid"),name:gt.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:gt.nodeName,static:!1,zeroPosition:0,middlePosition:0},ht=0;ht<gt.childNodes.length;ht++){var lt=gt.childNodes[ht];if(lt.nodeType===1)switch(lt.nodeName){case"axis":var pt=y(lt.textContent);yt.axis.fromArray(pt);break;case"limits":var Dt=lt.getElementsByTagName("max")[0],kt=lt.getElementsByTagName("min")[0];yt.limits.max=parseFloat(Dt.textContent),yt.limits.min=parseFloat(kt.textContent)}}return yt.limits.min>=yt.limits.max&&(yt.static=!0),yt.middlePosition=(yt.limits.min+yt.limits.max)/2,yt}(rt)}}return Ve}(Ze);break;case"link":ke.links.push(j(Ze))}}})(ye,ne)}}Mt.kinematicsModels[Y.getAttribute("id")]=ne}),N(Ie,"library_physics_models","physics_model",function(Y){for(var ne={name:Y.getAttribute("name")||"",rigidBodies:{}},ue=0;ue<Y.childNodes.length;ue++){var ye=Y.childNodes[ue];if(ye.nodeType===1)switch(ye.nodeName){case"rigid_body":ne.rigidBodies[ye.getAttribute("name")]={},function(fe,ke){for(var Oe=0;Oe<fe.childNodes.length;Oe++){var Ze=fe.childNodes[Oe];if(Ze.nodeType===1)switch(Ze.nodeName){case"technique_common":(function(qe,Ve){for(var Le=0;Le<qe.childNodes.length;Le++){var rt=qe.childNodes[Le];if(rt.nodeType===1)switch(rt.nodeName){case"inertia":Ve.inertia=y(rt.textContent);break;case"mass":Ve.mass=y(rt.textContent)[0]}}})(Ze,ke)}}}(ye,ne.rigidBodies[ye.getAttribute("name")])}}Mt.physicsModels[Y.getAttribute("id")]=ne}),N(Ie,"scene","instance_kinematics_scene",function(Y){for(var ne={bindJointAxis:[]},ue=0;ue<Y.childNodes.length;ue++){var ye=Y.childNodes[ue];if(ye.nodeType===1)switch(ye.nodeName){case"bind_joint_axis":ne.bindJointAxis.push(function(fe){for(var ke={target:fe.getAttribute("target").split("/").pop()},Oe=0;Oe<fe.childNodes.length;Oe++){var Ze=fe.childNodes[Oe];if(Ze.nodeType===1)switch(Ze.nodeName){case"axis":var qe=Ze.getElementsByTagName("param")[0];ke.axis=qe.textContent;var Ve=ke.axis.split("inst_").pop().split("axis")[0];ke.jointIndex=Ve.substr(0,Ve.length-1)}}return ke}(ye))}}Mt.kinematicsScenes[R(Y.getAttribute("url"))]=ne}),B(Mt.animations,$),B(Mt.clips,ce),B(Mt.controllers,Ye),B(Mt.images,ee),B(Mt.effects,Se),B(Mt.materials,ve),B(Mt.cameras,Xt),B(Mt.lights,At),B(Mt.geometries,A),B(Mt.visualScenes,J),function(){var Y=Mt.clips;if(L(Y)===!0){if(L(Mt.animations)===!1){var ne=[];for(var ue in Mt.animations)for(var ye=he(ue),fe=0,ke=ye.length;fe<ke;fe++)ne.push(ye[fe]);$t.push(new THREE.AnimationClip("default",-1,ne))}}else for(var ue in Y)$t.push(Ee(ue))}(),function(){function Y(lt,pt){var Dt=pt.getAttribute("name"),kt=fe.joints[lt];Oe.traverse(function(St){St.name===Dt&&(qe[lt]={object:St,transforms:function(an){for(var Qt=[],Fn=Ie.querySelector('[id="'+an.id+'"]'),en=0;en<Fn.childNodes.length;en++){var Dn=Fn.childNodes[en];if(Dn.nodeType===1)switch(Dn.nodeName){case"matrix":var ui=y(Dn.textContent),ci=new THREE.Matrix4().fromArray(ui).transpose();Qt.push({sid:Dn.getAttribute("sid"),type:Dn.nodeName,obj:ci});break;case"translate":case"scale":var ui=y(Dn.textContent),Li=new THREE.Vector3().fromArray(ui);Qt.push({sid:Dn.getAttribute("sid"),type:Dn.nodeName,obj:Li});break;case"rotate":var ui=y(Dn.textContent),Li=new THREE.Vector3().fromArray(ui),Vi=THREE.MathUtils.degToRad(ui[3]);Qt.push({sid:Dn.getAttribute("sid"),type:Dn.nodeName,obj:Li,angle:Vi})}}return Qt}(pt),joint:kt,position:kt.zeroPosition})})}var ne=Object.keys(Mt.kinematicsModels)[0],ue=Object.keys(Mt.kinematicsScenes)[0],ye=Object.keys(Mt.visualScenes)[0];if(ne!==void 0&&ue!==void 0){for(var fe=function(lt){return q(Mt.kinematicsModels[lt],z)}(ne),ke=function(lt){return q(Mt.kinematicsScenes[lt],Te)}(ue),Oe=pe(ye),Ze=ke.bindJointAxis,qe={},Ve=0,Le=Ze.length;Ve<Le;Ve++){var rt=Ze[Ve],gt=Ie.querySelector('[sid="'+rt.target+'"]');if(gt){var yt=gt.parentElement;Y(rt.jointIndex,yt)}}var ht=new THREE.Matrix4;fn={joints:fe&&fe.joints,getJointValue:function(lt){var pt=qe[lt];if(pt)return pt.position;console.warn("THREE.ColladaLoader: Joint "+lt+" doesn't exist.")},setJointValue:function(lt,pt){var Dt=qe[lt];if(Dt){var kt=Dt.joint;if(pt>kt.limits.max||pt<kt.limits.min)console.warn("THREE.ColladaLoader: Joint "+lt+" value "+pt+" outside of limits (min: "+kt.limits.min+", max: "+kt.limits.max+").");else if(kt.static)console.warn("THREE.ColladaLoader: Joint "+lt+" is static.");else{var St=Dt.object,an=kt.axis,Qt=Dt.transforms;it.identity();for(var Fn=0;Fn<Qt.length;Fn++){var en=Qt[Fn];if(en.sid&&en.sid.indexOf(lt)!==-1)switch(kt.type){case"revolute":it.multiply(ht.makeRotationAxis(an,THREE.MathUtils.degToRad(pt)));break;case"prismatic":it.multiply(ht.makeTranslation(an.x*pt,an.y*pt,an.z*pt));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+kt.type)}else switch(en.type){case"matrix":it.multiply(en.obj);break;case"translate":it.multiply(ht.makeTranslation(en.obj.x,en.obj.y,en.obj.z));break;case"scale":it.scale(en.obj);break;case"rotate":it.multiply(ht.makeRotationAxis(en.obj,en.angle))}}St.matrix.copy(it),St.matrix.decompose(St.position,St.quaternion,St.scale),qe[lt].position=pt}}else console.log("THREE.ColladaLoader: "+lt+" does not exist.")}}}}();var li=function(Y){return pe(R(m(Y,"instance_visual_scene")[0].getAttribute("url")))}(m(Ie,"scene")[0]);return Tt.upAxis==="Z_UP"&&li.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),li.scale.multiplyScalar(Tt.unit),{animations:$t,kinematics:fn,library:Mt,scene:li}}}},{}],4:[function(o,c,f){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(m){return typeof m}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},d=typeof Symbol=="function"&&s(Symbol.iterator)==="symbol"?function(m){return m===void 0?"undefined":s(m)}:function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":m===void 0?"undefined":s(m)};c.exports=THREE.FBXLoader=function(){function m(M){this.manager=M!==void 0?M:THREE.DefaultLoadingManager}function _(M){this.textureLoader=M}function y(){}function x(){}function R(){}function C(){}function L(M,I){this.dv=new DataView(M),this.offset=0,this.littleEndian=I===void 0||I}function N(){}function B(M){var I=M.match(/FBXVersion: (\d+)/);if(I)return parseInt(I[1]);throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function q(M){return M/46186158e3}function $(M,I,O,A){var T;switch(A.mappingType){case"ByPolygonVertex":T=M;break;case"ByPolygon":T=I;break;case"ByVertice":T=O;break;case"AllSame":T=A.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+A.mappingType)}A.referenceType==="IndexToDirect"&&(T=A.indices[T]);var F=T*A.dataSize,z=F+A.dataSize;return function(j,se,Te,ae){for(var wt=Te,Fe=0;wt<ae;wt++,Fe++)j[Fe]=se[wt];return j}(Se,A.buffer,F,z)}function he(M){var I=new THREE.Matrix4;xt.set(0,0,0),At.identity();var O=ce(M.eulerOrder?M.eulerOrder:0);if(M.translation&&xt.fromArray(M.translation),M.rotationOffset&&xt.add(Xt.fromArray(M.rotationOffset)),M.rotation&&((A=M.rotation.map(THREE.MathUtils.degToRad)).push(O),At.makeRotationFromEuler(Ge.fromArray(A))),M.preRotation&&((A=M.preRotation.map(THREE.MathUtils.degToRad)).push(O),ve.makeRotationFromEuler(Ge.fromArray(A)),At.premultiply(ve)),M.postRotation){var A=M.postRotation.map(THREE.MathUtils.degToRad);A.push(O),ve.makeRotationFromEuler(Ge.fromArray(A)),ve.getInverse(ve),At.multiply(ve)}return M.scale&&I.scale(Xt.fromArray(M.scale)),I.setPosition(xt),I.multiply(At),I}function ce(M){var I=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return M===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),I[0]):I[M]}function Ee(M){return M.split(",").map(function(I){return parseFloat(I)})}function Ye(M,I,O){return I===void 0&&(I=0),O===void 0&&(O=M.byteLength),THREE.LoaderUtils.decodeText(new Uint8Array(M,I,O))}function Ae(M,I,O){return M.slice(0,I).concat(O).concat(M.slice(I))}var ee,de,De;m.prototype={constructor:m,crossOrigin:"anonymous",load:function(M,I,O,A){var T=this,F=THREE.LoaderUtils.extractUrlBase(M),z=new THREE.FileLoader(this.manager);z.setResponseType("arraybuffer"),z.load(M,function(j){try{var se=T.parse(j,F);I(se)}catch(Te){setTimeout(function(){A&&A(Te),T.manager.itemError(M)},0)}},O,A)},setCrossOrigin:function(M){return this.crossOrigin=M,this},parse:function(M,I){if(function(A){var T="Kaydara FBX Binary  \0";return A.byteLength>=T.length&&T===Ye(A,0,T.length)}(M))ee=new C().parse(M);else{var O=Ye(M);if(!function(A){function T(se){var Te=A[se-1];return A=A.slice(z+se),z++,Te}for(var F=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],z=0,j=0;j<F.length;++j)if(T(1)===F[j])return!1;return!0}(O))throw new Error("THREE.FBXLoader: Unknown format.");if(B(O)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+B(O));ee=new R().parse(O)}return new _(new THREE.TextureLoader(this.manager).setPath(I).setCrossOrigin(this.crossOrigin)).parse(ee)}},_.prototype={constructor:_,parse:function(){de=this.parseConnections();var M=this.parseImages(),I=this.parseTextures(M),O=this.parseMaterials(I),A=this.parseDeformers(),T=new y().parse(A);return this.parseScene(A,T,O),De},parseConnections:function(){var M=new Map;return"Connections"in ee&&ee.Connections.connections.forEach(function(I){var O=I[0],A=I[1],T=I[2];M.has(O)||M.set(O,{parents:[],children:[]});var F={ID:A,relationship:T};M.get(O).parents.push(F),M.has(A)||M.set(A,{parents:[],children:[]});var z={ID:O,relationship:T};M.get(A).children.push(z)}),M},parseImages:function(){var M={},I={};if("Video"in ee.Objects){var O=ee.Objects.Video;for(var A in O){var T=O[A];if(M[se=parseInt(A)]=T.RelativeFilename||T.Filename,"Content"in T){var F=T.Content instanceof ArrayBuffer&&T.Content.byteLength>0,z=typeof T.Content=="string"&&T.Content!=="";if(F||z){var j=this.parseImage(O[A]);I[T.RelativeFilename||T.Filename]=j}}}}for(var se in M){var Te=M[se];I[Te]!==void 0?M[se]=I[Te]:M[se]=M[se].split("\\").pop()}return M},parseImage:function(M){var I,O=M.Content,A=M.RelativeFilename||M.Filename,T=A.slice(A.lastIndexOf(".")+1).toLowerCase();switch(T){case"bmp":I="image/bmp";break;case"jpg":case"jpeg":I="image/jpeg";break;case"png":I="image/png";break;case"tif":I="image/tiff";break;case"tga":if(typeof THREE.TGALoader!="function")return void console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");THREE.Loader.Handlers.get(".tga")===null&&THREE.Loader.Handlers.add(/\.tga$/i,new THREE.TGALoader),I="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+T+'" is not supported.')}if(typeof O=="string")return"data:"+I+";base64,"+O;var F=new Uint8Array(O);return window.URL.createObjectURL(new Blob([F],{type:I}))},parseTextures:function(M){var I=new Map;if("Texture"in ee.Objects){var O=ee.Objects.Texture;for(var A in O){var T=this.parseTexture(O[A],M);I.set(parseInt(A),T)}}return I},parseTexture:function(M,I){var O=this.loadTexture(M,I);O.ID=M.id,O.name=M.attrName;var A=M.WrapModeU,T=M.WrapModeV,F=A!==void 0?A.value:0,z=T!==void 0?T.value:0;if(O.wrapS=F===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,O.wrapT=z===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"Scaling"in M){var j=M.Scaling.value;O.repeat.x=j[0],O.repeat.y=j[1]}return O},loadTexture:function(M,I){var O,A=this.textureLoader.path,T=de.get(M.id).children;T!==void 0&&T.length>0&&I[T[0].ID]!==void 0&&((O=I[T[0].ID]).indexOf("blob:")!==0&&O.indexOf("data:")!==0||this.textureLoader.setPath(void 0));var F,z=M.FileName.slice(-3).toLowerCase();if(z==="tga"){var j=THREE.Loader.Handlers.get(".tga");j===null?(console.warn("FBXLoader: TGALoader not found, creating empty placeholder texture for",O),F=new THREE.Texture):F=j.load(O)}else z==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating empty placeholder texture for",O),F=new THREE.Texture):F=this.textureLoader.load(O);return this.textureLoader.setPath(A),F},parseMaterials:function(M){var I=new Map;if("Material"in ee.Objects){var O=ee.Objects.Material;for(var A in O){var T=this.parseMaterial(O[A],M);T!==null&&I.set(parseInt(A),T)}}return I},parseMaterial:function(M,I){var O=M.id,A=M.attrName,T=M.ShadingModel;if((T===void 0?"undefined":d(T))==="object"&&(T=T.value),!de.has(O))return null;var F,z=this.parseParameters(M,I,O);switch(T.toLowerCase()){case"phong":F=new THREE.MeshPhongMaterial;break;case"lambert":F=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',T),F=new THREE.MeshPhongMaterial({color:3342591})}return F.setValues(z),F.name=A,F},parseParameters:function(M,I,O){var A={};M.BumpFactor&&(A.bumpScale=M.BumpFactor.value),M.Diffuse?A.color=new THREE.Color().fromArray(M.Diffuse.value):M.DiffuseColor&&M.DiffuseColor.type==="Color"&&(A.color=new THREE.Color().fromArray(M.DiffuseColor.value)),M.DisplacementFactor&&(A.displacementScale=M.DisplacementFactor.value),M.Emissive?A.emissive=new THREE.Color().fromArray(M.Emissive.value):M.EmissiveColor&&M.EmissiveColor.type==="Color"&&(A.emissive=new THREE.Color().fromArray(M.EmissiveColor.value)),M.EmissiveFactor&&(A.emissiveIntensity=parseFloat(M.EmissiveFactor.value)),M.Opacity&&(A.opacity=parseFloat(M.Opacity.value)),A.opacity<1&&(A.transparent=!0),M.ReflectionFactor&&(A.reflectivity=M.ReflectionFactor.value),M.Shininess&&(A.shininess=M.Shininess.value),M.Specular?A.specular=new THREE.Color().fromArray(M.Specular.value):M.SpecularColor&&M.SpecularColor.type==="Color"&&(A.specular=new THREE.Color().fromArray(M.SpecularColor.value));var T=this;return de.get(O).children.forEach(function(F){var z=F.relationship;switch(z){case"Bump":A.bumpMap=T.getTexture(I,F.ID);break;case"DiffuseColor":A.map=T.getTexture(I,F.ID);break;case"DisplacementColor":A.displacementMap=T.getTexture(I,F.ID);break;case"EmissiveColor":A.emissiveMap=T.getTexture(I,F.ID);break;case"NormalMap":A.normalMap=T.getTexture(I,F.ID);break;case"ReflectionColor":A.envMap=T.getTexture(I,F.ID),A.envMap.mapping=THREE.EquirectangularReflectionMapping;break;case"SpecularColor":A.specularMap=T.getTexture(I,F.ID);break;case"TransparentColor":A.alphaMap=T.getTexture(I,F.ID),A.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",z)}}),A},getTexture:function(M,I){return"LayeredTexture"in ee.Objects&&I in ee.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),I=de.get(I).children[0].ID),M.get(I)},parseDeformers:function(){var M={},I={};if("Deformer"in ee.Objects){var O=ee.Objects.Deformer;for(var A in O){var T=O[A],F=de.get(parseInt(A));if(T.attrType==="Skin"){var z=this.parseSkeleton(F,O);z.ID=A,F.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),z.geometryID=F.parents[0].ID,M[A]=z}else if(T.attrType==="BlendShape"){var j={id:A};j.rawTargets=this.parseMorphTargets(F,O),j.id=A,F.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),I[A]=j}}}return{skeletons:M,morphTargets:I}},parseSkeleton:function(M,I){var O=[];return M.children.forEach(function(A){var T=I[A.ID];if(T.attrType==="Cluster"){var F={ID:A.ID,indices:[],weights:[],transform:new THREE.Matrix4().fromArray(T.Transform.a),transformLink:new THREE.Matrix4().fromArray(T.TransformLink.a),linkMode:T.Mode};"Indexes"in T&&(F.indices=T.Indexes.a,F.weights=T.Weights.a),O.push(F)}}),{rawBones:O,bones:[]}},parseMorphTargets:function(M,I){for(var O=[],A=0;A<M.children.length;A++){if(A===8){console.warn("FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.");break}var T=M.children[A],F=I[T.ID],z={name:F.attrName,initialWeight:F.DeformPercent,id:F.id,fullWeights:F.FullWeights.a};if(F.attrType!=="BlendShapeChannel")return;de.get(parseInt(T.ID)).children.forEach(function(j){j.relationship===void 0&&(z.geoID=j.ID)}),O.push(z)}return O},parseScene:function(M,I,O){De=new THREE.Group;var A=this.parseModels(M.skeletons,I,O),T=ee.Objects.Model,F=this;A.forEach(function(j){var se=T[j.ID];F.setLookAtProperties(j,se),de.get(j.ID).parents.forEach(function(Te){var ae=A.get(Te.ID);ae!==void 0&&ae.add(j)}),j.parent===null&&De.add(j)}),this.bindSkeleton(M.skeletons,I,A),this.createAmbientLight(),this.setupMorphMaterials();var z=new x().parse();De.children.length===1&&De.children[0].isGroup&&(De.children[0].animations=z,De=De.children[0]),De.animations=z},parseModels:function(M,I,O){var A=new Map,T=ee.Objects.Model;for(var F in T){var z=parseInt(F),j=T[F],se=de.get(z),Te=this.buildSkeleton(se,M,z,j.attrName);if(!Te){switch(j.attrType){case"Camera":Te=this.createCamera(se);break;case"Light":Te=this.createLight(se);break;case"Mesh":Te=this.createMesh(se,I,O);break;case"NurbsCurve":Te=this.createCurve(se,I);break;case"LimbNode":case"Null":default:Te=new THREE.Group}Te.name=THREE.PropertyBinding.sanitizeNodeName(j.attrName),Te.ID=z}this.setModelTransforms(Te,j),A.set(z,Te)}return A},buildSkeleton:function(M,I,O,A){var T=null;return M.parents.forEach(function(F){for(var z in I){var j=I[z];j.rawBones.forEach(function(se,Te){if(se.ID===F.ID){var ae=T;(T=new THREE.Bone).matrixWorld.copy(se.transformLink),T.name=THREE.PropertyBinding.sanitizeNodeName(A),T.ID=O,j.bones[Te]=T,ae!==null&&T.add(ae)}})}}),T},createCamera:function(M){var I,O;if(M.children.forEach(function(wt){var Fe=ee.Objects.NodeAttribute[wt.ID];Fe!==void 0&&(O=Fe)}),O===void 0)I=new THREE.Object3D;else{var A=0;O.CameraProjectionType!==void 0&&O.CameraProjectionType.value===1&&(A=1);var T=1;O.NearPlane!==void 0&&(T=O.NearPlane.value/1e3);var F=1e3;O.FarPlane!==void 0&&(F=O.FarPlane.value/1e3);var z=window.innerWidth,j=window.innerHeight;O.AspectWidth!==void 0&&O.AspectHeight!==void 0&&(z=O.AspectWidth.value,j=O.AspectHeight.value);var se=z/j,Te=45;O.FieldOfView!==void 0&&(Te=O.FieldOfView.value);var ae=O.FocalLength?O.FocalLength.value:null;switch(A){case 0:I=new THREE.PerspectiveCamera(Te,se,T,F),ae!==null&&I.setFocalLength(ae);break;case 1:I=new THREE.OrthographicCamera(-z/2,z/2,j/2,-j/2,T,F);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+A+"."),I=new THREE.Object3D}}return I},createLight:function(M){var I,O;if(M.children.forEach(function(Te){var ae=ee.Objects.NodeAttribute[Te.ID];ae!==void 0&&(O=ae)}),O===void 0)I=new THREE.Object3D;else{var A;A=O.LightType===void 0?0:O.LightType.value;var T=16777215;O.Color!==void 0&&(T=new THREE.Color().fromArray(O.Color.value));var F=O.Intensity===void 0?1:O.Intensity.value/100;O.CastLightOnObject!==void 0&&O.CastLightOnObject.value===0&&(F=0);var z=0;switch(O.FarAttenuationEnd!==void 0&&(z=O.EnableFarAttenuation!==void 0&&O.EnableFarAttenuation.value===0?0:O.FarAttenuationEnd.value),A){case 0:I=new THREE.PointLight(T,F,z,1);break;case 1:I=new THREE.DirectionalLight(T,F);break;case 2:var j=Math.PI/3;O.InnerAngle!==void 0&&(j=THREE.MathUtils.degToRad(O.InnerAngle.value));var se=0;O.OuterAngle!==void 0&&(se=THREE.MathUtils.degToRad(O.OuterAngle.value),se=Math.max(se,1)),I=new THREE.SpotLight(T,F,z,j,se,1);break;default:console.warn("THREE.FBXLoader: Unknown light type "+O.LightType.value+", defaulting to a THREE.PointLight."),I=new THREE.PointLight(T,F)}O.CastShadows!==void 0&&O.CastShadows.value===1&&(I.castShadow=!0)}return I},createMesh:function(M,I,O){var A,T=null,F=null,z=[];return M.children.forEach(function(j){I.has(j.ID)&&(T=I.get(j.ID)),O.has(j.ID)&&z.push(O.get(j.ID))}),z.length>1?F=z:z.length>0?F=z[0]:(F=new THREE.MeshPhongMaterial({color:13421772}),z.push(F)),"color"in T.attributes&&z.forEach(function(j){j.vertexColors=THREE.VertexColors}),T.FBX_Deformer?(z.forEach(function(j){j.skinning=!0}),A=new THREE.SkinnedMesh(T,F)):A=new THREE.Mesh(T,F),A},createCurve:function(M,I){var O=M.children.reduce(function(T,F){return I.has(F.ID)&&(T=I.get(F.ID)),T},null),A=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(O,A)},setModelTransforms:function(M,I){var O={};"RotationOrder"in I&&(O.eulerOrder=parseInt(I.RotationOrder.value)),"Lcl_Translation"in I&&(O.translation=I.Lcl_Translation.value),"RotationOffset"in I&&(O.rotationOffset=I.RotationOffset.value),"Lcl_Rotation"in I&&(O.rotation=I.Lcl_Rotation.value),"PreRotation"in I&&(O.preRotation=I.PreRotation.value),"PostRotation"in I&&(O.postRotation=I.PostRotation.value),"Lcl_Scaling"in I&&(O.scale=I.Lcl_Scaling.value);var A=he(O);M.applyMatrix(A)},setLookAtProperties:function(M,I){"LookAtProperty"in I&&de.get(M.ID).children.forEach(function(O){if(O.relationship==="LookAtProperty"){var A=ee.Objects.Model[O.ID];if("Lcl_Translation"in A){var T=A.Lcl_Translation.value;M.target!==void 0?(M.target.position.fromArray(T),De.add(M.target)):M.lookAt(new THREE.Vector3().fromArray(T))}}})},bindSkeleton:function(M,I,O){var A=this.parsePoseNodes();for(var T in M){var F=M[T];de.get(parseInt(F.ID)).parents.forEach(function(z){if(I.has(z.ID)){var j=z.ID;de.get(j).parents.forEach(function(se){O.has(se.ID)&&O.get(se.ID).bind(new THREE.Skeleton(F.bones),A[se.ID])})}})}},parsePoseNodes:function(){var M={};if("Pose"in ee.Objects){var I=ee.Objects.Pose;for(var O in I)if(I[O].attrType==="BindPose"){var A=I[O].PoseNode;Array.isArray(A)?A.forEach(function(T){M[T.Node]=new THREE.Matrix4().fromArray(T.Matrix.a)}):M[A.Node]=new THREE.Matrix4().fromArray(A.Matrix.a)}}return M},createAmbientLight:function(){if("GlobalSettings"in ee&&"AmbientColor"in ee.GlobalSettings){var M=ee.GlobalSettings.AmbientColor.value,I=M[0],O=M[1],A=M[2];if(I!==0||O!==0||A!==0){var T=new THREE.Color(I,O,A);De.add(new THREE.AmbientLight(T,1))}}},setupMorphMaterials:function(){De.traverse(function(M){if(M.isMesh&&(M.geometry.morphAttributes.position||M.geometry.morphAttributes.normal)){var I=M.uuid,O=M.material.uuid,A=!1;De.traverse(function(T){T.isMesh&&T.material.uuid===O&&T.uuid!==I&&(A=!0)}),A===!0&&(M.material=M.material.clone()),M.material.morphTargets=!0}})}},y.prototype={constructor:y,parse:function(M){var I=new Map;if("Geometry"in ee.Objects){var O=ee.Objects.Geometry;for(var A in O){var T=de.get(parseInt(A)),F=this.parseGeometry(T,O[A],M);I.set(parseInt(A),F)}}return I},parseGeometry:function(M,I,O){switch(I.attrType){case"Mesh":return this.parseMeshGeometry(M,I,O);case"NurbsCurve":return this.parseNurbsGeometry(I)}},parseMeshGeometry:function(M,I,O){var A=O.skeletons,T=O.morphTargets,F=M.parents.map(function(wt){return ee.Objects.Model[wt.ID]});if(F.length!==0){var z=M.children.reduce(function(wt,Fe){return A[Fe.ID]!==void 0&&(wt=A[Fe.ID]),wt},null),j=M.children.reduce(function(wt,Fe){return T[Fe.ID]!==void 0&&(wt=T[Fe.ID]),wt},null),se=F[0],Te={};"RotationOrder"in se&&(Te.eulerOrder=se.RotationOrder.value),"GeometricTranslation"in se&&(Te.translation=se.GeometricTranslation.value),"GeometricRotation"in se&&(Te.rotation=se.GeometricRotation.value),"GeometricScaling"in se&&(Te.scale=se.GeometricScaling.value);var ae=he(Te);return this.genGeometry(I,z,j,ae)}},genGeometry:function(M,I,O,A){var T=new THREE.BufferGeometry;M.attrName&&(T.name=M.attrName);var F=this.parseGeoNode(M,I),z=this.genBuffers(F),j=new THREE.Float32BufferAttribute(z.vertex,3);if(A.applyToBufferAttribute(j),T.addAttribute("position",j),z.colors.length>0&&T.addAttribute("color",new THREE.Float32BufferAttribute(z.colors,3)),I&&(T.addAttribute("skinIndex",new THREE.Uint16BufferAttribute(z.weightsIndices,4)),T.addAttribute("skinWeight",new THREE.Float32BufferAttribute(z.vertexWeights,4)),T.FBX_Deformer=I),z.normal.length>0){var se=new THREE.Float32BufferAttribute(z.normal,3);new THREE.Matrix3().getNormalMatrix(A).applyToBufferAttribute(se),T.addAttribute("normal",se)}if(z.uvs.forEach(function(Re,ut){var et="uv"+(ut+1).toString();ut===0&&(et="uv"),T.addAttribute(et,new THREE.Float32BufferAttribute(z.uvs[ut],2))}),F.material&&F.material.mappingType!=="AllSame"){var Te=z.materialIndex[0],ae=0;if(z.materialIndex.forEach(function(Re,ut){Re!==Te&&(T.addGroup(ae,ut-ae,Te),Te=Re,ae=ut)}),T.groups.length>0){var wt=T.groups[T.groups.length-1],Fe=wt.start+wt.count;Fe!==z.materialIndex.length&&T.addGroup(Fe,z.materialIndex.length-Fe,Te)}T.groups.length===0&&T.addGroup(0,z.materialIndex.length,z.materialIndex[0])}return this.addMorphTargets(T,M,O,A),T},parseGeoNode:function(M,I){var O={};if(O.vertexPositions=M.Vertices!==void 0?M.Vertices.a:[],O.vertexIndices=M.PolygonVertexIndex!==void 0?M.PolygonVertexIndex.a:[],M.LayerElementColor&&(O.color=this.parseVertexColors(M.LayerElementColor[0])),M.LayerElementMaterial&&(O.material=this.parseMaterialIndices(M.LayerElementMaterial[0])),M.LayerElementNormal&&(O.normal=this.parseNormals(M.LayerElementNormal[0])),M.LayerElementUV){O.uv=[];for(var A=0;M.LayerElementUV[A];)O.uv.push(this.parseUVs(M.LayerElementUV[A])),A++}return O.weightTable={},I!==null&&(O.skeleton=I,I.rawBones.forEach(function(T,F){T.indices.forEach(function(z,j){O.weightTable[z]===void 0&&(O.weightTable[z]=[]),O.weightTable[z].push({id:F,weight:T.weights[j]})})})),O},genBuffers:function(M){var I={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},O=0,A=0,T=!1,F=[],z=[],j=[],se=[],Te=[],ae=[],wt=this;return M.vertexIndices.forEach(function(Fe,Re){var ut=!1;Fe<0&&(Fe^=-1,ut=!0);var et=[],_t=[];if(F.push(3*Fe,3*Fe+1,3*Fe+2),M.color&&(pe=$(Re,O,Fe,M.color),j.push(pe[0],pe[1],pe[2])),M.skeleton){if(M.weightTable[Fe]!==void 0&&M.weightTable[Fe].forEach(function(Ne){_t.push(Ne.weight),et.push(Ne.id)}),_t.length>4){T||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),T=!0);var rn=[0,0,0,0],X=[0,0,0,0];_t.forEach(function(Ne,Be){var it=Ne,tt=et[Be];X.forEach(function(mt,Ie,Nt){if(it>mt){Nt[Ie]=it,it=mt;var Tt=rn[Ie];rn[Ie]=tt,tt=Tt}})}),et=rn,_t=X}for(;_t.length<4;)_t.push(0),et.push(0);for(var J=0;J<4;++J)Te.push(_t[J]),ae.push(et[J])}if(M.normal){var pe=$(Re,O,Fe,M.normal);z.push(pe[0],pe[1],pe[2])}if(M.material&&M.material.mappingType!=="AllSame")var Ce=$(Re,O,Fe,M.material)[0];M.uv&&M.uv.forEach(function(Ne,Be){var it=$(Re,O,Fe,Ne);se[Be]===void 0&&(se[Be]=[]),se[Be].push(it[0]),se[Be].push(it[1])}),A++,ut&&(wt.genFace(I,M,F,Ce,z,j,se,Te,ae,A),O++,A=0,F=[],z=[],j=[],se=[],Te=[],ae=[])}),I},genFace:function(M,I,O,A,T,F,z,j,se,Te){for(var ae=2;ae<Te;ae++)M.vertex.push(I.vertexPositions[O[0]]),M.vertex.push(I.vertexPositions[O[1]]),M.vertex.push(I.vertexPositions[O[2]]),M.vertex.push(I.vertexPositions[O[3*(ae-1)]]),M.vertex.push(I.vertexPositions[O[3*(ae-1)+1]]),M.vertex.push(I.vertexPositions[O[3*(ae-1)+2]]),M.vertex.push(I.vertexPositions[O[3*ae]]),M.vertex.push(I.vertexPositions[O[3*ae+1]]),M.vertex.push(I.vertexPositions[O[3*ae+2]]),I.skeleton&&(M.vertexWeights.push(j[0]),M.vertexWeights.push(j[1]),M.vertexWeights.push(j[2]),M.vertexWeights.push(j[3]),M.vertexWeights.push(j[4*(ae-1)]),M.vertexWeights.push(j[4*(ae-1)+1]),M.vertexWeights.push(j[4*(ae-1)+2]),M.vertexWeights.push(j[4*(ae-1)+3]),M.vertexWeights.push(j[4*ae]),M.vertexWeights.push(j[4*ae+1]),M.vertexWeights.push(j[4*ae+2]),M.vertexWeights.push(j[4*ae+3]),M.weightsIndices.push(se[0]),M.weightsIndices.push(se[1]),M.weightsIndices.push(se[2]),M.weightsIndices.push(se[3]),M.weightsIndices.push(se[4*(ae-1)]),M.weightsIndices.push(se[4*(ae-1)+1]),M.weightsIndices.push(se[4*(ae-1)+2]),M.weightsIndices.push(se[4*(ae-1)+3]),M.weightsIndices.push(se[4*ae]),M.weightsIndices.push(se[4*ae+1]),M.weightsIndices.push(se[4*ae+2]),M.weightsIndices.push(se[4*ae+3])),I.color&&(M.colors.push(F[0]),M.colors.push(F[1]),M.colors.push(F[2]),M.colors.push(F[3*(ae-1)]),M.colors.push(F[3*(ae-1)+1]),M.colors.push(F[3*(ae-1)+2]),M.colors.push(F[3*ae]),M.colors.push(F[3*ae+1]),M.colors.push(F[3*ae+2])),I.material&&I.material.mappingType!=="AllSame"&&(M.materialIndex.push(A),M.materialIndex.push(A),M.materialIndex.push(A)),I.normal&&(M.normal.push(T[0]),M.normal.push(T[1]),M.normal.push(T[2]),M.normal.push(T[3*(ae-1)]),M.normal.push(T[3*(ae-1)+1]),M.normal.push(T[3*(ae-1)+2]),M.normal.push(T[3*ae]),M.normal.push(T[3*ae+1]),M.normal.push(T[3*ae+2])),I.uv&&I.uv.forEach(function(wt,Fe){M.uvs[Fe]===void 0&&(M.uvs[Fe]=[]),M.uvs[Fe].push(z[Fe][0]),M.uvs[Fe].push(z[Fe][1]),M.uvs[Fe].push(z[Fe][2*(ae-1)]),M.uvs[Fe].push(z[Fe][2*(ae-1)+1]),M.uvs[Fe].push(z[Fe][2*ae]),M.uvs[Fe].push(z[Fe][2*ae+1])})},addMorphTargets:function(M,I,O,A){if(O!==null){M.morphAttributes.position=[],M.morphAttributes.normal=[];var T=this;O.rawTargets.forEach(function(F){var z=ee.Objects.Geometry[F.geoID];z!==void 0&&T.genMorphGeometry(M,I,z,A)})}},genMorphGeometry:function(M,I,O,A){var T=new THREE.BufferGeometry;O.attrName&&(T.name=O.attrName);for(var F=I.PolygonVertexIndex!==void 0?I.PolygonVertexIndex.a:[],z=I.Vertices!==void 0?I.Vertices.a.slice():[],j=O.Vertices!==void 0?O.Vertices.a:[],se=O.Indexes!==void 0?O.Indexes.a:[],Te=0;Te<se.length;Te++){var ae=3*se[Te];z[ae]+=j[3*Te],z[ae+1]+=j[3*Te+1],z[ae+2]+=j[3*Te+2]}var wt={vertexIndices:F,vertexPositions:z},Fe=this.genBuffers(wt),Re=new THREE.Float32BufferAttribute(Fe.vertex,3);Re.name=O.attrName,A.applyToBufferAttribute(Re),M.morphAttributes.position.push(Re)},parseNormals:function(M){var I=M.MappingInformationType,O=M.ReferenceInformationType,A=M.Normals.a,T=[];return O==="IndexToDirect"&&("NormalIndex"in M?T=M.NormalIndex.a:"NormalsIndex"in M&&(T=M.NormalsIndex.a)),{dataSize:3,buffer:A,indices:T,mappingType:I,referenceType:O}},parseUVs:function(M){var I=M.MappingInformationType,O=M.ReferenceInformationType,A=M.UV.a,T=[];return O==="IndexToDirect"&&(T=M.UVIndex.a),{dataSize:2,buffer:A,indices:T,mappingType:I,referenceType:O}},parseVertexColors:function(M){var I=M.MappingInformationType,O=M.ReferenceInformationType,A=M.Colors.a,T=[];return O==="IndexToDirect"&&(T=M.ColorIndex.a),{dataSize:4,buffer:A,indices:T,mappingType:I,referenceType:O}},parseMaterialIndices:function(M){var I=M.MappingInformationType,O=M.ReferenceInformationType;if(I==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:O};for(var A=M.Materials.a,T=[],F=0;F<A.length;++F)T.push(F);return{dataSize:1,buffer:A,indices:T,mappingType:I,referenceType:O}},parseNurbsGeometry:function(M){if(THREE.NURBSCurve===void 0)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var I=parseInt(M.Order);if(isNaN(I))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",M.Order,M.id),new THREE.BufferGeometry;for(var O=I-1,A=M.KnotVector.a,T=[],F=M.Points.a,z=0,j=F.length;z<j;z+=4)T.push(new THREE.Vector4().fromArray(F,z));var se,Te;if(M.Form==="Closed")T.push(T[0]);else if(M.Form==="Periodic")for(se=O,Te=A.length-1-se,z=0;z<O;++z)T.push(T[z]);var ae=new THREE.NURBSCurve(O,A,T,se,Te).getPoints(7*T.length),wt=new Float32Array(3*ae.length);ae.forEach(function(Re,ut){Re.toArray(wt,3*ut)});var Fe=new THREE.BufferGeometry;return Fe.addAttribute("position",new THREE.BufferAttribute(wt,3)),Fe}},x.prototype={constructor:x,parse:function(){var M=[],I=this.parseClips();if(I===void 0)return M;for(var O in I){var A=I[O],T=this.addClip(A);M.push(T)}return M},parseClips:function(){if(ee.Objects.AnimationCurve!==void 0){var M=this.parseAnimationCurveNodes();this.parseAnimationCurves(M);var I=this.parseAnimationLayers(M);return this.parseAnimStacks(I)}},parseAnimationCurveNodes:function(){var M=ee.Objects.AnimationCurveNode,I=new Map;for(var O in M){var A=M[O];if(A.attrName.match(/S|R|T|DeformPercent/)!==null){var T={id:A.id,attr:A.attrName,curves:{}};I.set(T.id,T)}}return I},parseAnimationCurves:function(M){var I=ee.Objects.AnimationCurve;for(var O in I){var A={id:I[O].id,times:I[O].KeyTime.a.map(q),values:I[O].KeyValueFloat.a},T=de.get(A.id);if(T!==void 0){var F=T.parents[0].ID,z=T.parents[0].relationship;z.match(/X/)?M.get(F).curves.x=A:z.match(/Y/)?M.get(F).curves.y=A:z.match(/Z/)?M.get(F).curves.z=A:z.match(/d|DeformPercent/)&&M.has(F)&&(M.get(F).curves.morph=A)}}},parseAnimationLayers:function(M){var I=ee.Objects.AnimationLayer,O=new Map;for(var A in I){var T=[],F=de.get(parseInt(A));if(F!==void 0){var z=this;F.children.forEach(function(j,se){if(M.has(j.ID)){var Te=M.get(j.ID);if(Te.curves.x!==void 0||Te.curves.y!==void 0||Te.curves.z!==void 0){if(T[se]===void 0){de.get(j.ID).parents.forEach(function(_t){_t.relationship!==void 0&&(et=_t.ID)});var ae=ee.Objects.Model[et.toString()],wt={modelName:THREE.PropertyBinding.sanitizeNodeName(ae.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1],transform:z.getModelAnimTransform(ae)};"PreRotation"in ae&&(wt.preRotations=ae.PreRotation.value),"PostRotation"in ae&&(wt.postRotations=ae.PostRotation.value),T[se]=wt}T[se][Te.attr]=Te}else if(Te.curves.morph!==void 0){if(T[se]===void 0){var Fe;de.get(j.ID).parents.forEach(function(X){X.relationship!==void 0&&(Fe=X.ID)});var Re=de.get(Fe).parents[0].ID,ut=de.get(Re).parents[0].ID,et=de.get(ut).parents[0].ID,ae=ee.Objects.Model[et],wt={modelName:THREE.PropertyBinding.sanitizeNodeName(ae.attrName),morphName:ee.Objects.Deformer[Fe].attrName};T[se]=wt}T[se][Te.attr]=Te}}}),O.set(parseInt(A),T)}}return O},getModelAnimTransform:function(M){var I={};return"RotationOrder"in M&&(I.eulerOrder=parseInt(M.RotationOrder.value)),"Lcl_Translation"in M&&(I.translation=M.Lcl_Translation.value),"RotationOffset"in M&&(I.rotationOffset=M.RotationOffset.value),"Lcl_Rotation"in M&&(I.rotation=M.Lcl_Rotation.value),"PreRotation"in M&&(I.preRotation=M.PreRotation.value),"PostRotation"in M&&(I.postRotation=M.PostRotation.value),"Lcl_Scaling"in M&&(I.scale=M.Lcl_Scaling.value),he(I)},parseAnimStacks:function(M){var I=ee.Objects.AnimationStack,O={};for(var A in I){var T=de.get(parseInt(A)).children;T.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var F=M.get(T[0].ID);O[A]={name:I[A].attrName,layer:F}}return O},addClip:function(M){var I=[],O=this;return M.layer.forEach(function(A){I=I.concat(O.generateTracks(A))}),new THREE.AnimationClip(M.name,-1,I)},generateTracks:function(M){var I=[],O=new THREE.Vector3,A=new THREE.Quaternion,T=new THREE.Vector3;if(M.transform&&M.transform.decompose(O,A,T),O=O.toArray(),A=new THREE.Euler().setFromQuaternion(A).toArray(),T=T.toArray(),M.T!==void 0&&Object.keys(M.T.curves).length>0){var F=this.generateVectorTrack(M.modelName,M.T.curves,O,"position");F!==void 0&&I.push(F)}if(M.R!==void 0&&Object.keys(M.R.curves).length>0){var z=this.generateRotationTrack(M.modelName,M.R.curves,A,M.preRotations,M.postRotations);z!==void 0&&I.push(z)}if(M.S!==void 0&&Object.keys(M.S.curves).length>0){var j=this.generateVectorTrack(M.modelName,M.S.curves,T,"scale");j!==void 0&&I.push(j)}if(M.DeformPercent!==void 0){var se=this.generateMorphTrack(M);se!==void 0&&I.push(se)}return I},generateVectorTrack:function(M,I,O,A){var T=this.getTimesForAllAxes(I),F=this.getKeyframeTrackValues(T,I,O);return new THREE.VectorKeyframeTrack(M+"."+A,T,F)},generateRotationTrack:function(M,I,O,A,T){I.x!==void 0&&(this.interpolateRotations(I.x),I.x.values=I.x.values.map(THREE.MathUtils.degToRad)),I.y!==void 0&&(this.interpolateRotations(I.y),I.y.values=I.y.values.map(THREE.MathUtils.degToRad)),I.z!==void 0&&(this.interpolateRotations(I.z),I.z.values=I.z.values.map(THREE.MathUtils.degToRad));var F=this.getTimesForAllAxes(I),z=this.getKeyframeTrackValues(F,I,O);A!==void 0&&((A=A.map(THREE.MathUtils.degToRad)).push("ZYX"),A=new THREE.Euler().fromArray(A),A=new THREE.Quaternion().setFromEuler(A)),T!==void 0&&((T=T.map(THREE.MathUtils.degToRad)).push("ZYX"),T=new THREE.Euler().fromArray(T),T=new THREE.Quaternion().setFromEuler(T).inverse());for(var j=new THREE.Quaternion,se=new THREE.Euler,Te=[],ae=0;ae<z.length;ae+=3)se.set(z[ae],z[ae+1],z[ae+2],"ZYX"),j.setFromEuler(se),A!==void 0&&j.premultiply(A),T!==void 0&&j.multiply(T),j.toArray(Te,ae/3*4);return new THREE.QuaternionKeyframeTrack(M+".quaternion",F,Te)},generateMorphTrack:function(M){var I=M.DeformPercent.curves.morph,O=I.values.map(function(T){return T/100}),A=De.getObjectByName(M.modelName).morphTargetDictionary[M.morphName];return new THREE.NumberKeyframeTrack(M.modelName+".morphTargetInfluences["+A+"]",I.times,O)},getTimesForAllAxes:function(M){var I=[];return M.x!==void 0&&(I=I.concat(M.x.times)),M.y!==void 0&&(I=I.concat(M.y.times)),M.z!==void 0&&(I=I.concat(M.z.times)),I=I.sort(function(O,A){return O-A}).filter(function(O,A,T){return T.indexOf(O)==A})},getKeyframeTrackValues:function(M,I,O){var A=O,T=[],F=-1,z=-1,j=-1;return M.forEach(function(se){if(I.x&&(F=I.x.times.indexOf(se)),I.y&&(z=I.y.times.indexOf(se)),I.z&&(j=I.z.times.indexOf(se)),F!==-1){var Te=I.x.values[F];T.push(Te),A[0]=Te}else T.push(A[0]);if(z!==-1){var ae=I.y.values[z];T.push(ae),A[1]=ae}else T.push(A[1]);if(j!==-1){var wt=I.z.values[j];T.push(wt),A[2]=wt}else T.push(A[2])}),T},interpolateRotations:function(M){for(var I=1;I<M.values.length;I++){var O=M.values[I-1],A=M.values[I]-O,T=Math.abs(A);if(T>=180){for(var F=T/180,z=A/F,j=O+z,se=M.times[I-1],Te=(M.times[I]-se)/F,ae=se+Te,wt=[],Fe=[];ae<M.times[I];)wt.push(ae),ae+=Te,Fe.push(j),j+=z;M.times=Ae(M.times,I,wt),M.values=Ae(M.values,I,Fe)}}}},R.prototype={constructor:R,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(M){this.nodeStack.push(M),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(M,I){this.currentProp=M,this.currentPropName=I},parse:function(M){this.currentIndent=0,console.log("FBXTree: ",N),this.allNodes=new N,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var I=this,O=M.split(/[\r\n]+/);return O.forEach(function(A,T){var F=A.match(/^[\s\t]*;/),z=A.match(/^[\s\t]*$/);if(!F&&!z){var j=A.match("^\\t{"+I.currentIndent+"}(\\w+):(.*){",""),se=A.match("^\\t{"+I.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),Te=A.match("^\\t{"+(I.currentIndent-1)+"}}");j?I.parseNodeBegin(A,j):se?I.parseNodeProperty(A,se,O[++T]):Te?I.popStack():A.match(/^[^\s\t}]/)&&I.parseNodePropertyContinued(A)}}),this.allNodes},parseNodeBegin:function(M,I){var O=I[1].trim().replace(/^"/,"").replace(/"$/,""),A=I[2].split(",").map(function(j){return j.trim().replace(/^"/,"").replace(/"$/,"")}),T={name:O},F=this.parseNodeAttr(A),z=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(O,T):O in z?(O==="PoseNode"?z.PoseNode.push(T):z[O].id!==void 0&&(z[O]={},z[O][z[O].id]=z[O]),F.id!==""&&(z[O][F.id]=T)):typeof F.id=="number"?(z[O]={},z[O][F.id]=T):O!=="Properties70"&&(z[O]=O==="PoseNode"?[T]:T),typeof F.id=="number"&&(T.id=F.id),F.name!==""&&(T.attrName=F.name),F.type!==""&&(T.attrType=F.type),this.pushStack(T)},parseNodeAttr:function(M){var I=M[0];M[0]!==""&&(I=parseInt(M[0]),isNaN(I)&&(I=M[0]));var O="",A="";return M.length>1&&(O=M[1].replace(/^(\w+)::/,""),A=M[2]),{id:I,name:O,type:A}},parseNodeProperty:function(M,I,O){var A=I[1].replace(/^"/,"").replace(/"$/,"").trim(),T=I[2].replace(/^"/,"").replace(/"$/,"").trim();A==="Content"&&T===","&&(T=O.replace(/"/g,"").replace(/,$/,"").trim());var F=this.getCurrentNode();if(F.name!=="Properties70"){if(A==="C"){var z=T.split(",").slice(1),j=parseInt(z[0]),se=parseInt(z[1]),Te=T.split(",").slice(3);A="connections",function(ae,wt){for(var Fe=0,Re=ae.length,ut=wt.length;Fe<ut;Fe++,Re++)ae[Re]=wt[Fe]}(T=[j,se],Te=Te.map(function(ae){return ae.trim().replace(/^"/,"")})),F[A]===void 0&&(F[A]=[])}A==="Node"&&(F.id=T),A in F&&Array.isArray(F[A])?F[A].push(T):A!=="a"?F[A]=T:F.a=T,this.setCurrentProp(F,A),A==="a"&&T.slice(-1)!==","&&(F.a=Ee(T))}else this.parseNodeSpecialProperty(M,A,T)},parseNodePropertyContinued:function(M){var I=this.getCurrentNode();I.a+=M,M.slice(-1)!==","&&(I.a=Ee(I.a))},parseNodeSpecialProperty:function(M,I,O){var A=O.split('",').map(function(Te){return Te.trim().replace(/^\"/,"").replace(/\s/,"_")}),T=A[0],F=A[1],z=A[2],j=A[3],se=A[4];switch(F){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":se=parseFloat(se);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":se=Ee(se)}this.getPrevNode()[T]={type:F,type2:z,flag:j,value:se},this.setCurrentProp(this.getPrevNode(),T)}},C.prototype={constructor:C,parse:function(M){var I=new L(M);I.skip(23);var O=I.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+O);for(var A=new N;!this.endOfContent(I);){var T=this.parseNode(I,O);T!==null&&A.add(T.name,T)}return A},endOfContent:function(M){return M.size()%16==0?(M.getOffset()+160+16&-16)>=M.size():M.getOffset()+160+16>=M.size()},parseNode:function(M,I){var O={},A=I>=7500?M.getUint64():M.getUint32(),T=I>=7500?M.getUint64():M.getUint32(),F=(I>=7500?M.getUint64():M.getUint32(),M.getUint8()),z=M.getString(F);if(A===0)return null;for(var j=[],se=0;se<T;se++)j.push(this.parseProperty(M));var Te=j.length>0?j[0]:"",ae=j.length>1?j[1]:"",wt=j.length>2?j[2]:"";for(O.singleProperty=T===1&&M.getOffset()===A;A>M.getOffset();){var Fe=this.parseNode(M,I);Fe!==null&&this.parseSubNode(z,O,Fe)}return O.propertyList=j,typeof Te=="number"&&(O.id=Te),ae!==""&&(O.attrName=ae),wt!==""&&(O.attrType=wt),z!==""&&(O.name=z),O},parseSubNode:function(M,I,O){if(O.singleProperty===!0){var A=O.propertyList[0];Array.isArray(A)?(I[O.name]=O,O.a=A):I[O.name]=A}else if(M==="Connections"&&O.name==="C"){var T=[];O.propertyList.forEach(function(ae,wt){wt!==0&&T.push(ae)}),I.connections===void 0&&(I.connections=[]),I.connections.push(T)}else if(O.name==="Properties70")Object.keys(O).forEach(function(ae){I[ae]=O[ae]});else if(M==="Properties70"&&O.name==="P"){var F,z=O.propertyList[0],j=O.propertyList[1],se=O.propertyList[2],Te=O.propertyList[3];z.indexOf("Lcl ")===0&&(z=z.replace("Lcl ","Lcl_")),j.indexOf("Lcl ")===0&&(j=j.replace("Lcl ","Lcl_")),F=j==="Color"||j==="ColorRGB"||j==="Vector"||j==="Vector3D"||j.indexOf("Lcl_")===0?[O.propertyList[4],O.propertyList[5],O.propertyList[6]]:O.propertyList[4],I[z]={type:j,type2:se,flag:Te,value:F}}else I[O.name]===void 0?typeof O.id=="number"?(I[O.name]={},I[O.name][O.id]=O):I[O.name]=O:O.name==="PoseNode"?(Array.isArray(I[O.name])||(I[O.name]=[I[O.name]]),I[O.name].push(O)):I[O.name][O.id]===void 0&&(I[O.name][O.id]=O)},parseProperty:function(M){var I=M.getString(1);switch(I){case"C":return M.getBoolean();case"D":return M.getFloat64();case"F":return M.getFloat32();case"I":return M.getInt32();case"L":return M.getInt64();case"R":return O=M.getUint32(),M.getArrayBuffer(O);case"S":var O=M.getUint32();return M.getString(O);case"Y":return M.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var A=M.getUint32(),T=M.getUint32(),F=M.getUint32();if(T===0)switch(I){case"b":case"c":return M.getBooleanArray(A);case"d":return M.getFloat64Array(A);case"f":return M.getFloat32Array(A);case"i":return M.getInt32Array(A);case"l":return M.getInt64Array(A)}typeof Zlib>"u"&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var z=new L(new Zlib.Inflate(new Uint8Array(M.getArrayBuffer(F))).decompress().buffer);switch(I){case"b":case"c":return z.getBooleanArray(A);case"d":return z.getFloat64Array(A);case"f":return z.getFloat32Array(A);case"i":return z.getInt32Array(A);case"l":return z.getInt64Array(A)}default:throw new Error("THREE.FBXLoader: Unknown property type "+I)}}},L.prototype={constructor:L,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(M){this.offset+=M},getBoolean:function(){return(1&this.getUint8())==1},getBooleanArray:function(M){for(var I=[],O=0;O<M;O++)I.push(this.getBoolean());return I},getUint8:function(){var M=this.dv.getUint8(this.offset);return this.offset+=1,M},getInt16:function(){var M=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,M},getInt32:function(){var M=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,M},getInt32Array:function(M){for(var I=[],O=0;O<M;O++)I.push(this.getInt32());return I},getUint32:function(){var M=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,M},getInt64:function(){var M,I;return this.littleEndian?(M=this.getUint32(),I=this.getUint32()):(I=this.getUint32(),M=this.getUint32()),2147483648&I?(I=4294967295&~I,(M=4294967295&~M)===4294967295&&(I=I+1&4294967295),M=M+1&4294967295,-(4294967296*I+M)):4294967296*I+M},getInt64Array:function(M){for(var I=[],O=0;O<M;O++)I.push(this.getInt64());return I},getUint64:function(){var M,I;return this.littleEndian?(M=this.getUint32(),I=this.getUint32()):(I=this.getUint32(),M=this.getUint32()),4294967296*I+M},getFloat32:function(){var M=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,M},getFloat32Array:function(M){for(var I=[],O=0;O<M;O++)I.push(this.getFloat32());return I},getFloat64:function(){var M=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,M},getFloat64Array:function(M){for(var I=[],O=0;O<M;O++)I.push(this.getFloat64());return I},getArrayBuffer:function(M){var I=this.dv.buffer.slice(this.offset,this.offset+M);return this.offset+=M,I},getString:function(M){for(var I=[],O=0;O<M;O++)I[O]=this.getUint8();var A=I.indexOf(0);return A>=0&&(I=I.slice(0,A)),THREE.LoaderUtils.decodeText(new Uint8Array(I))}},N.prototype={constructor:N,add:function(M,I){this[M]=I}};var Se=[],ve=new THREE.Matrix4,Ge=new THREE.Euler,Xt=new THREE.Vector3,xt=new THREE.Vector3,At=new THREE.Matrix4;return m}()},{}],5:[function(o,c,f){c.exports=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16})},{}],6:[function(o,c,f){c.exports=function(s,d,m){this.type=s,this.index=d,this.pressed=m.pressed,this.value=m.value}},{}],7:[function(o,c,f){function s(m){var _=document.getElementById(m),y=_.parentNode;try{y&&y.removeChild(_)}catch{}}function d(m,_,y){return new y(function(x,R){var C=_.timeout||5e3,L="script_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),N=function($,he){var ce=document.createElement("script");return ce.type="text/javascript",ce.async=!0,ce.id=he,ce.src=$,ce}(m,L),B=setTimeout(function(){R(new Error("Script request to "+m+" timed out")),s(L)},C),q=function($){clearTimeout($)};N.addEventListener("load",function($){x({ok:!0}),q(B),s(L)}),N.addEventListener("error",function($){R(new Error("Script request to "+m+" failed "+$)),q(B),s(L)}),function($){var he=document.getElementsByTagName("script")[0];he.parentNode.insertBefore($,he)}(N)})}c.exports=function(m){return m=m||{},function(_,y){return y=y||{},d(_,y,m.Promise||Promise)}}},{}],8:[function(o,c,f){(function(s){function d(de,De){return String(de).indexOf(De)!==-1}function m(de,De,Se){q!==De&&B!==De&&N!==De||Object.keys(Se).forEach(function(ve){de[ve]=Se[ve]})}function _(de){var De="keyCode"in de?de.keyCode:"which"in de?de.which:0,Se=function(){if(ee||"keyLocation"in de){var Ge=ee?de.location:de.keyLocation;if(Ge&&De in ce[Ge])return ce[Ge][De]}return"keyIdentifier"in de&&de.keyIdentifier in he?he[de.keyIdentifier]:De in $?$[De]:null}();if(!Se)return null;var ve=function(){var Ge=Ee[Se.code];return Ge?de.shiftKey&&"shiftKey"in Ge?Ge.shiftKey:Ge.key:Se.code}();return{code:Se.code,key:ve,location:Se.location,keyCap:Se.keyCap}}var y="KeyboardEvent"in s;y||(s.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in s.KeyboardEvent||(s.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var x=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,R=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,C=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,L=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD,N=d(navigator.platform,"Win")?"win":d(navigator.platform,"Mac")?"mac":d(navigator.platform,"CrOS")?"cros":d(navigator.platform,"Linux")?"linux":d(navigator.userAgent,"iPad")||d(navigator.platform,"iPod")||d(navigator.platform,"iPhone")?"ios":"",B=d(navigator.userAgent,"Chrome/")?"chrome":d(navigator.vendor,"Apple")?"safari":d(navigator.userAgent,"MSIE")?"ie":d(navigator.userAgent,"Gecko/")?"moz":d(navigator.userAgent,"Opera/")?"opera":"",q=B+"-"+N,$={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:R},92:{code:"OSRight",location:C},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:L},97:{code:"Numpad1",keyCap:"1",location:L},98:{code:"Numpad2",keyCap:"2",location:L},99:{code:"Numpad3",keyCap:"3",location:L},100:{code:"Numpad4",keyCap:"4",location:L},101:{code:"Numpad5",keyCap:"5",location:L},102:{code:"Numpad6",keyCap:"6",location:L},103:{code:"Numpad7",keyCap:"7",location:L},104:{code:"Numpad8",keyCap:"8",location:L},105:{code:"Numpad9",keyCap:"9",location:L},106:{code:"NumpadMultiply",keyCap:"*",location:L},107:{code:"NumpadAdd",keyCap:"+",location:L},108:{code:"NumpadComma",keyCap:",",location:L},109:{code:"NumpadSubtract",keyCap:"-",location:L},110:{code:"NumpadDecimal",keyCap:".",location:L},111:{code:"NumpadDivide",keyCap:"/",location:L},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:L},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:R},161:{code:"ShiftRight",location:C},162:{code:"ControlLeft",location:R},163:{code:"ControlRight",location:C},164:{code:"AltLeft",location:R},165:{code:"AltRight",location:C},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};m($,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:L},189:{code:"NumpadSubtract",keyCap:"-",location:L}}),m($,"moz-mac",{12:{code:"NumLock",location:L},173:{code:"Minus",keyCap:"-"}}),m($,"moz-win",{173:{code:"Minus",keyCap:"-"}}),m($,"chrome-mac",{93:{code:"OSRight",location:C}}),m($,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),m($,"ios",{10:{code:"Enter",location:x}}),m($,"safari-mac",{91:{code:"OSLeft",location:R},93:{code:"OSRight",location:C},229:{code:"KeyQ",keyCap:"Q"}});var he={};N==="cros"&&(he["U+00A0"]={code:"ShiftLeft",location:R},he["U+00A1"]={code:"ShiftRight",location:C},he["U+00A2"]={code:"ControlLeft",location:R},he["U+00A3"]={code:"ControlRight",location:C},he["U+00A4"]={code:"AltLeft",location:R},he["U+00A5"]={code:"AltRight",location:C}),q==="chrome-mac"&&(he["U+0010"]={code:"ContextMenu"}),q==="safari-mac"&&(he["U+0010"]={code:"ContextMenu"}),N==="ios"&&(he["U+0010"]={code:"Function"},he["U+001C"]={code:"ArrowLeft"},he["U+001D"]={code:"ArrowRight"},he["U+001E"]={code:"ArrowUp"},he["U+001F"]={code:"ArrowDown"},he["U+0001"]={code:"Home"},he["U+0004"]={code:"End"},he["U+000B"]={code:"PageUp"},he["U+000C"]={code:"PageDown"});var ce=[];ce[R]={16:{code:"ShiftLeft",location:R},17:{code:"ControlLeft",location:R},18:{code:"AltLeft",location:R}},ce[C]={16:{code:"ShiftRight",location:C},17:{code:"ControlRight",location:C},18:{code:"AltRight",location:C}},ce[L]={13:{code:"NumpadEnter",location:L}},m(ce[L],"moz",{109:{code:"NumpadSubtract",location:L},107:{code:"NumpadAdd",location:L}}),m(ce[R],"moz-mac",{224:{code:"OSLeft",location:R}}),m(ce[C],"moz-mac",{224:{code:"OSRight",location:C}}),m(ce[C],"moz-win",{91:{code:"OSRight",location:C}}),m(ce[C],"mac",{93:{code:"OSRight",location:C}}),m(ce[L],"chrome-mac",{12:{code:"NumLock",location:L}}),m(ce[L],"safari-mac",{12:{code:"NumLock",location:L},187:{code:"NumpadAdd",location:L},189:{code:"NumpadSubtract",location:L},190:{code:"NumpadDecimal",location:L},191:{code:"NumpadDivide",location:L}});var Ee={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};m(Ee,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var Ye={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},Ae=function(de,De){var Se={};return Object.keys(de).forEach(function(ve){var Ge=de[ve];De in Ge&&(Se[Ge[De]]=Ge)}),Se}($,"code");try{var ee=y&&"location"in new KeyboardEvent("")}catch{}"KeyboardEvent"in s&&"defineProperty"in Object&&function(){function de(Se,ve,Ge){ve in Se||Object.defineProperty(Se,ve,Ge)}if(de(KeyboardEvent.prototype,"code",{get:function(){var Se=_(this);return Se?Se.code:""}}),"key"in KeyboardEvent.prototype){var De=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var Se=De.get.call(this);return Ye.hasOwnProperty(Se)?Ye[Se]:Se}})}de(KeyboardEvent.prototype,"key",{get:function(){var Se=_(this);return Se&&"key"in Se?Se.key:"Unidentified"}}),de(KeyboardEvent.prototype,"location",{get:function(){var Se=_(this);return Se&&"location"in Se?Se.location:x}}),de(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in s.KeyboardEvent||(s.KeyboardEvent.queryKeyCap=function(de,De){if(de=String(de),!Ae.hasOwnProperty(de))return"Undefined";if(De&&String(De).toLowerCase()!=="en-us")throw Error("Unsupported locale");var Se=Ae[de];return Se.keyCap||Se.code||"Undefined"}),s.identifyKey=function(de){if(!("code"in de)){var De=_(de);de.code=De?De.code:"",de.key=De&&"key"in De?De.key:"Unidentified",de.location="location"in de?de.location:"keyLocation"in de?de.keyLocation:De&&"location"in De?De.location:x,de.locale=""}}})(window)},{}],9:[function(o,c,f){(function(s,d){typeof f=="object"&&typeof c=="object"?c.exports=d():typeof f=="object"?f.nipplejs=d():s.nipplejs=d()})(window,function(){return function(s){function d(_){if(m[_])return m[_].exports;var y=m[_]={i:_,l:!1,exports:{}};return s[_].call(y.exports,y,y.exports,d),y.l=!0,y.exports}var m={};return d.m=s,d.c=m,d.d=function(_,y,x){d.o(_,y)||Object.defineProperty(_,y,{enumerable:!0,get:x})},d.r=function(_){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(_,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(_,"__esModule",{value:!0})},d.t=function(_,y){if(1&y&&(_=d(_)),8&y||4&y&&typeof _=="object"&&_&&_.__esModule)return _;var x=Object.create(null);if(d.r(x),Object.defineProperty(x,"default",{enumerable:!0,value:_}),2&y&&typeof _!="string")for(var R in _)d.d(x,R,function(C){return _[C]}.bind(null,R));return x},d.n=function(_){var y=_&&_.__esModule?function(){return _.default}:function(){return _};return d.d(y,"a",y),y},d.o=function(_,y){return Object.prototype.hasOwnProperty.call(_,y)},d.p="",d(d.s=0)}([function(s,d,m){function _(){}function y(A,T){return this.identifier=T.identifier,this.position=T.position,this.frontPosition=T.frontPosition,this.collection=A,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(T),this.options.mode==="dynamic"&&(this.options.restOpacity=0),this.id=y.id,y.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}function x(A,T){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=A,this.id=x.id,x.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(T),this.options.mode!=="static"&&this.options.mode!=="semi"||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var F=getComputedStyle(this.options.zone.parentElement);return F&&F.display==="flex"&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}function R(A){var T=this;T.ids={},T.index=0,T.collections=[],T.scroll=Ee(),T.config(A),T.prepareCollections();var F=function(){var j;T.collections.forEach(function(se){se.forEach(function(Te){j=Te.el.getBoundingClientRect(),Te.position={x:T.scroll.x+j.left,y:T.scroll.y+j.top}})})};$(window,"resize",function(){q(F)});var z=function(){T.scroll=Ee()};return $(window,"scroll",function(){q(z)}),T.collections}m.r(d);var C,L=function(A,T){var F=T.x-A.x,z=T.y-A.y;return Math.sqrt(F*F+z*z)},N=function(A){return A*(Math.PI/180)},B=new Map,q=function(A){B.has(A)&&clearTimeout(B.get(A)),B.set(A,setTimeout(A,100))},$=function(A,T,F){for(var z,j=T.split(/[ ,]+/g),se=0;se<j.length;se+=1)z=j[se],A.addEventListener?A.addEventListener(z,F,!1):A.attachEvent&&A.attachEvent(z,F)},he=function(A,T,F){for(var z,j=T.split(/[ ,]+/g),se=0;se<j.length;se+=1)z=j[se],A.removeEventListener?A.removeEventListener(z,F):A.detachEvent&&A.detachEvent(z,F)},ce=function(A){return A.preventDefault(),A.type.match(/^touch/)?A.changedTouches:A},Ee=function(){return{x:window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},Ye=function(A,T){T.top||T.right||T.bottom||T.left?(A.style.top=T.top,A.style.right=T.right,A.style.bottom=T.bottom,A.style.left=T.left):(A.style.left=T.x+"px",A.style.top=T.y+"px")},Ae=function(A,T,F){var z=ee(A);for(var j in z)if(z.hasOwnProperty(j))if(typeof T=="string")z[j]=T+" "+F;else{for(var se="",Te=0,ae=T.length;Te<ae;Te+=1)se+=T[Te]+" "+F+", ";z[j]=se.slice(0,-2)}return z},ee=function(A){var T={};return T[A]="",["webkit","Moz","o"].forEach(function(F){T[F+A.charAt(0).toUpperCase()+A.slice(1)]=""}),T},de=function(A,T){for(var F in T)T.hasOwnProperty(F)&&(A[F]=T[F]);return A},De=function(A,T){if(A.length)for(var F=0,z=A.length;F<z;F+=1)T(A[F]);else T(A)},Se="ontouchstart"in window,ve=!!window.PointerEvent,Ge=!!window.MSPointerEvent,Xt={start:"mousedown",move:"mousemove",end:"mouseup"},xt={};ve?C={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:Ge?C={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:Se?(C={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},xt=Xt):C=Xt,_.prototype.on=function(A,T){var F,z=A.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var j=0;j<z.length;j+=1)F=z[j],this._handlers_[F]=this._handlers_[F]||[],this._handlers_[F].push(T);return this},_.prototype.off=function(A,T){return this._handlers_=this._handlers_||{},A===void 0?this._handlers_={}:T===void 0?this._handlers_[A]=null:this._handlers_[A]&&this._handlers_[A].indexOf(T)>=0&&this._handlers_[A].splice(this._handlers_[A].indexOf(T),1),this},_.prototype.trigger=function(A,T){var F,z=this,j=A.split(/[ ,]+/g);z._handlers_=z._handlers_||{};for(var se=0;se<j.length;se+=1)F=j[se],z._handlers_[F]&&z._handlers_[F].length&&z._handlers_[F].forEach(function(Te){Te.call(z,{type:F,target:z},T)})},_.prototype.config=function(A){this.options=this.defaults||{},A&&(this.options=function(T,F){var z={};for(var j in T)T.hasOwnProperty(j)&&F.hasOwnProperty(j)?z[j]=F[j]:T.hasOwnProperty(j)&&(z[j]=T[j]);return z}(this.options,A))},_.prototype.bindEvt=function(A,T){var F=this;return F._domHandlers_=F._domHandlers_||{},F._domHandlers_[T]=function(){typeof F["on"+T]=="function"?F["on"+T].apply(F,arguments):console.warn('[WARNING] : Missing "on'+T+'" handler.')},$(A,C[T],F._domHandlers_[T]),xt[T]&&$(A,xt[T],F._domHandlers_[T]),F},_.prototype.unbindEvt=function(A,T){return this._domHandlers_=this._domHandlers_||{},he(A,C[T],this._domHandlers_[T]),xt[T]&&he(A,xt[T],this._domHandlers_[T]),delete this._domHandlers_[T],this};var At=_;y.prototype=new At,y.constructor=y,y.id=0,y.prototype.buildEl=function(A){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},y.prototype.stylize=function(){if(this.options.dataOnly)return this;var A=this.options.fadeTime+"ms",T=function(j,se){var Te=ee("borderRadius");for(var ae in Te)Te.hasOwnProperty(ae)&&(Te[ae]="50%");return Te}(),F=Ae("transition","opacity",A),z={};return z.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},z.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},z.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},de(z.el,F),this.options.shape==="circle"&&de(z.back,T),de(z.front,T),this.applyStyles(z),this},y.prototype.applyStyles=function(A){for(var T in this.ui)if(this.ui.hasOwnProperty(T))for(var F in A[T])this.ui[T].style[F]=A[T][F];return this},y.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},y.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},y.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},y.prototype.show=function(A){var T=this;return T.options.dataOnly||(clearTimeout(T.removeTimeout),clearTimeout(T.showTimeout),clearTimeout(T.restTimeout),T.addToDom(),T.restCallback(),setTimeout(function(){T.ui.el.style.opacity=1},0),T.showTimeout=setTimeout(function(){T.trigger("shown",T.instance),typeof A=="function"&&A.call(this)},T.options.fadeTime)),T},y.prototype.hide=function(A){var T=this;if(T.options.dataOnly)return T;if(T.ui.el.style.opacity=T.options.restOpacity,clearTimeout(T.removeTimeout),clearTimeout(T.showTimeout),clearTimeout(T.restTimeout),T.removeTimeout=setTimeout(function(){var j=T.options.mode==="dynamic"?"none":"block";T.ui.el.style.display=j,typeof A=="function"&&A.call(T),T.trigger("hidden",T.instance)},T.options.fadeTime),T.options.restJoystick){var F=T.options.restJoystick,z={};z.x=F===!0||F.x!==!1?0:T.instance.frontPosition.x,z.y=F===!0||F.y!==!1?0:T.instance.frontPosition.y,T.setPosition(A,z)}return T},y.prototype.setPosition=function(A,T){var F=this;F.frontPosition={x:T.x,y:T.y};var z=F.options.fadeTime+"ms",j={};j.front=Ae("transition",["transform"],z);var se={front:{}};se.front={transform:"translate("+F.frontPosition.x+"px,"+F.frontPosition.y+"px)"},F.applyStyles(j),F.applyStyles(se),F.restTimeout=setTimeout(function(){typeof A=="function"&&A.call(F),F.restCallback()},F.options.fadeTime)},y.prototype.restCallback=function(){var A={};A.front=Ae("transition","none",""),this.applyStyles(A),this.trigger("rested",this.instance)},y.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},y.prototype.computeDirection=function(A){var T,F,z,j=A.angle.radian,se=Math.PI/4,Te=Math.PI/2;if(j>se&&j<3*se&&!A.lockX?T="up":j>-se&&j<=se&&!A.lockY?T="left":j>3*-se&&j<=-se&&!A.lockX?T="down":A.lockY||(T="right"),A.lockY||(F=j>-Te&&j<Te?"left":"right"),A.lockX||(z=j>0?"up":"down"),A.force>this.options.threshold){var ae,wt={};for(ae in this.direction)this.direction.hasOwnProperty(ae)&&(wt[ae]=this.direction[ae]);var Fe={};for(ae in this.direction={x:F,y:z,angle:T},A.direction=this.direction,wt)wt[ae]===this.direction[ae]&&(Fe[ae]=!0);if(Fe.x&&Fe.y&&Fe.angle)return A;Fe.x&&Fe.y||this.trigger("plain",A),Fe.x||this.trigger("plain:"+F,A),Fe.y||this.trigger("plain:"+z,A),Fe.angle||this.trigger("dir dir:"+T,A)}else this.resetDirection();return A};var M=y;x.prototype=new At,x.constructor=x,x.id=0,x.prototype.prepareNipples=function(){var A=this.nipples;A.on=this.on.bind(this),A.off=this.off.bind(this),A.options=this.options,A.destroy=this.destroy.bind(this),A.ids=this.ids,A.id=this.id,A.processOnMove=this.processOnMove.bind(this),A.processOnEnd=this.processOnEnd.bind(this),A.get=function(T){if(T===void 0)return A[0];for(var F=0,z=A.length;F<z;F+=1)if(A[F].identifier===T)return A[F];return!1}},x.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},x.prototype.begin=function(){var A=this.options;if(A.mode==="static"){var T=this.createNipple(A.position,this.manager.getIdentifier());T.add(),this.idles.push(T)}},x.prototype.createNipple=function(A,T){var F=this.manager.scroll,z={},j=this.options,se=this.parentIsFlex?F.x:F.x+this.box.left,Te=this.parentIsFlex?F.y:F.y+this.box.top;if(A.x&&A.y)z={x:A.x-se,y:A.y-Te};else if(A.top||A.right||A.bottom||A.left){var ae=document.createElement("DIV");ae.style.display="hidden",ae.style.top=A.top,ae.style.right=A.right,ae.style.bottom=A.bottom,ae.style.left=A.left,ae.style.position="absolute",j.zone.appendChild(ae);var wt=ae.getBoundingClientRect();j.zone.removeChild(ae),z=A,A={x:wt.left+F.x,y:wt.top+F.y}}var Fe=new M(this,{color:j.color,size:j.size,threshold:j.threshold,fadeTime:j.fadeTime,dataOnly:j.dataOnly,restJoystick:j.restJoystick,restOpacity:j.restOpacity,mode:j.mode,identifier:T,position:A,zone:j.zone,frontPosition:{x:0,y:0},shape:j.shape});return j.dataOnly||(Ye(Fe.ui.el,z),Ye(Fe.ui.front,Fe.frontPosition)),this.nipples.push(Fe),this.trigger("added "+Fe.identifier+":added",Fe),this.manager.trigger("added "+Fe.identifier+":added",Fe),this.bindNipple(Fe),Fe},x.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},x.prototype.bindNipple=function(A){var T,F=this,z=function(j,se){T=j.type+" "+se.id+":"+j.type,F.trigger(T,se)};A.on("destroyed",F.onDestroyed.bind(F)),A.on("shown hidden rested dir plain",z),A.on("dir:up dir:right dir:down dir:left",z),A.on("plain:up plain:right plain:down plain:left",z)},x.prototype.pressureFn=function(A,T,F){var z=this,j=0;clearInterval(z.pressureIntervals[F]),z.pressureIntervals[F]=setInterval(function(){var se=A.force||A.pressure||A.webkitForce||0;se!==j&&(T.trigger("pressure",se),z.trigger("pressure "+T.identifier+":pressure",se),j=se)}.bind(z),100)},x.prototype.onstart=function(A){var T=this,F=T.options,z=A;return A=ce(A),T.updateBox(),De(A,function(j){T.actives.length<F.maxNumberOfNipples?T.processOnStart(j):z.type.match(/^touch/)&&(Object.keys(T.manager.ids).forEach(function(se){if(Object.values(z.touches).findIndex(function(ae){return ae.identifier===se})<0){var Te=[A[0]];Te.identifier=se,T.processOnEnd(Te)}}),T.actives.length<F.maxNumberOfNipples&&T.processOnStart(j))}),T.manager.bindDocument(),!1},x.prototype.processOnStart=function(A){var T,F=this,z=F.options,j=F.manager.getIdentifier(A),se=A.force||A.pressure||A.webkitForce||0,Te={x:A.pageX,y:A.pageY},ae=F.getOrCreate(j,Te);ae.identifier!==j&&F.manager.removeIdentifier(ae.identifier),ae.identifier=j;var wt=function(Fe){Fe.trigger("start",Fe),F.trigger("start "+Fe.id+":start",Fe),Fe.show(),se>0&&F.pressureFn(A,Fe,Fe.identifier),F.processOnMove(A)};if((T=F.idles.indexOf(ae))>=0&&F.idles.splice(T,1),F.actives.push(ae),F.ids.push(ae.identifier),z.mode!=="semi")wt(ae);else{if(!(L(Te,ae.position)<=z.catchDistance))return ae.destroy(),void F.processOnStart(A);wt(ae)}return ae},x.prototype.getOrCreate=function(A,T){var F,z=this.options;return/(semi|static)/.test(z.mode)?(F=this.idles[0])?(this.idles.splice(0,1),F):z.mode==="semi"?this.createNipple(T,A):(console.warn("Coudln't find the needed nipple."),!1):F=this.createNipple(T,A)},x.prototype.processOnMove=function(A){var T=this.options,F=this.manager.getIdentifier(A),z=this.nipples.get(F),j=this.manager.scroll;if(function(zt){return isNaN(zt.buttons)?zt.pressure!==0:zt.buttons!==0}(A)){if(!z)return console.error("Found zombie joystick with ID "+F),void this.manager.removeIdentifier(F);if(T.dynamicPage){var se=z.el.getBoundingClientRect();z.position={x:j.x+se.left,y:j.y+se.top}}z.identifier=F;var Te=z.options.size/2,ae={x:A.pageX,y:A.pageY};T.lockX&&(ae.y=z.position.y),T.lockY&&(ae.x=z.position.x);var wt,Fe,Re,ut,et,_t,rn,X,J,pe,Ce=L(ae,z.position),Ne=(wt=ae,Fe=z.position,Re=Fe.x-wt.x,ut=Fe.y-wt.y,function(zt){return zt*(180/Math.PI)}(Math.atan2(ut,Re))),Be=N(Ne),it=Ce/Te,tt={distance:Ce,position:ae};if(z.options.shape==="circle"?(et=Math.min(Ce,Te),rn=z.position,X=et,pe={x:0,y:0},J=N(J=Ne),pe.x=rn.x-X*Math.cos(J),pe.y=rn.y-X*Math.sin(J),_t=pe):(_t=function(zt,$t,fn){return{x:Math.min(Math.max(zt.x,$t.x-fn),$t.x+fn),y:Math.min(Math.max(zt.y,$t.y-fn),$t.y+fn)}}(ae,z.position,Te),et=L(_t,z.position)),T.follow){if(Ce>Te){var mt=ae.x-_t.x,Ie=ae.y-_t.y;z.position.x+=mt,z.position.y+=Ie,z.el.style.top=z.position.y-(this.box.top+j.y)+"px",z.el.style.left=z.position.x-(this.box.left+j.x)+"px",Ce=L(ae,z.position)}}else ae=_t,Ce=et;var Nt=ae.x-z.position.x,Tt=ae.y-z.position.y;z.frontPosition={x:Nt,y:Tt},T.dataOnly||(z.ui.front.style.transform="translate("+Nt+"px,"+Tt+"px)");var It={identifier:z.identifier,position:ae,force:it,pressure:A.force||A.pressure||A.webkitForce||0,distance:Ce,angle:{radian:Be,degree:Ne},vector:{x:Nt/Te,y:-Tt/Te},raw:tt,instance:z,lockX:T.lockX,lockY:T.lockY};(It=z.computeDirection(It)).angle={radian:N(180-Ne),degree:180-Ne},z.trigger("move",It),this.trigger("move "+z.id+":move",It)}else this.processOnEnd(A)},x.prototype.processOnEnd=function(A){var T=this,F=T.options,z=T.manager.getIdentifier(A),j=T.nipples.get(z),se=T.manager.removeIdentifier(j.identifier);j&&(F.dataOnly||j.hide(function(){F.mode==="dynamic"&&(j.trigger("removed",j),T.trigger("removed "+j.id+":removed",j),T.manager.trigger("removed "+j.id+":removed",j),j.destroy())}),clearInterval(T.pressureIntervals[j.identifier]),j.resetDirection(),j.trigger("end",j),T.trigger("end "+j.id+":end",j),T.ids.indexOf(j.identifier)>=0&&T.ids.splice(T.ids.indexOf(j.identifier),1),T.actives.indexOf(j)>=0&&T.actives.splice(T.actives.indexOf(j),1),/(semi|static)/.test(F.mode)?T.idles.push(j):T.nipples.indexOf(j)>=0&&T.nipples.splice(T.nipples.indexOf(j),1),T.manager.unbindDocument(),/(semi|static)/.test(F.mode)&&(T.manager.ids[se.id]=se.identifier))},x.prototype.onDestroyed=function(A,T){this.nipples.indexOf(T)>=0&&this.nipples.splice(this.nipples.indexOf(T),1),this.actives.indexOf(T)>=0&&this.actives.splice(this.actives.indexOf(T),1),this.idles.indexOf(T)>=0&&this.idles.splice(this.idles.indexOf(T),1),this.ids.indexOf(T.identifier)>=0&&this.ids.splice(this.ids.indexOf(T.identifier),1),this.manager.removeIdentifier(T.identifier),this.manager.unbindDocument()},x.prototype.destroy=function(){for(var A in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach(function(T){T.destroy()}),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(A)&&clearInterval(this.pressureIntervals[A]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var I=x;R.prototype=new At,R.constructor=R,R.prototype.prepareCollections=function(){var A=this;A.collections.create=A.create.bind(A),A.collections.on=A.on.bind(A),A.collections.off=A.off.bind(A),A.collections.destroy=A.destroy.bind(A),A.collections.get=function(T){var F;return A.collections.every(function(z){return!(F=z.get(T))}),F}},R.prototype.create=function(A){return this.createCollection(A)},R.prototype.createCollection=function(A){var T=new I(this,A);return this.bindCollection(T),this.collections.push(T),T},R.prototype.bindCollection=function(A){var T,F=this,z=function(j,se){T=j.type+" "+se.id+":"+j.type,F.trigger(T,se)};A.on("destroyed",F.onDestroyed.bind(F)),A.on("shown hidden rested dir plain",z),A.on("dir:up dir:right dir:down dir:left",z),A.on("plain:up plain:right plain:down plain:left",z)},R.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},R.prototype.unbindDocument=function(A){Object.keys(this.ids).length&&A!==!0||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},R.prototype.getIdentifier=function(A){var T;return A?(T=A.identifier===void 0?A.pointerId:A.identifier)===void 0&&(T=this.latest||0):T=this.index,this.ids[T]===void 0&&(this.ids[T]=this.index,this.index+=1),this.latest=T,this.ids[T]},R.prototype.removeIdentifier=function(A){var T={};for(var F in this.ids)if(this.ids[F]===A){T.id=F,T.identifier=this.ids[F],delete this.ids[F];break}return T},R.prototype.onmove=function(A){return this.onAny("move",A),!1},R.prototype.onend=function(A){return this.onAny("end",A),!1},R.prototype.oncancel=function(A){return this.onAny("end",A),!1},R.prototype.onAny=function(A,T){var F,z=this,j="processOn"+A.charAt(0).toUpperCase()+A.slice(1);return T=ce(T),De(T,function(se){F=z.getIdentifier(se),De(z.collections,function(Te,ae,wt){wt.ids.indexOf(ae)>=0&&(wt[j](Te),Te._found_=!0)}.bind(null,se,F)),se._found_||z.removeIdentifier(F)}),!1},R.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach(function(A){A.destroy()}),this.off()},R.prototype.onDestroyed=function(A,T){if(this.collections.indexOf(T)<0)return!1;this.collections.splice(this.collections.indexOf(T),1)};var O=new R;d.default={create:function(A){return O.create(A)},factory:O}}]).default})},{}],10:[function(o,c,f){var s=o("three");class d{static roundNumber(C,L){const N=Math.pow(10,L);return Math.round(C*N)/N}static sample(C){return C[Math.floor(Math.random()*C.length)]}static distanceToSquared(C,L){var N=C.x-L.x,B=C.y-L.y,q=C.z-L.z;return N*N+B*B+q*q}static isPointInPoly(C,L){for(var N=!1,B=-1,q=C.length,$=q-1;++B<q;$=B)(C[B].z<=L.z&&L.z<C[$].z||C[$].z<=L.z&&L.z<C[B].z)&&L.x<(C[$].x-C[B].x)*(L.z-C[B].z)/(C[$].z-C[B].z)+C[B].x&&(N=!N);return N}static isVectorInPolygon(C,L,N){var B=1e5,q=-1e5,$=[];return L.vertexIds.forEach(he=>{B=Math.min(N[he].y,B),q=Math.max(N[he].y,q),$.push(N[he])}),!!(C.y<q+.5&&C.y>B-.5&&this.isPointInPoly($,C))}static triarea2(C,L,N){return(N.x-C.x)*(L.z-C.z)-(L.x-C.x)*(N.z-C.z)}static vequal(C,L){return this.distanceToSquared(C,L)<1e-5}static mergeVertices(C,L=1e-4){L=Math.max(L,Number.EPSILON);for(var N={},B=C.getIndex(),q=C.getAttribute("position"),$=B?B.count:q.count,he=0,ce=[],Ee=[],Ye=Math.log10(1/L),Ae=Math.pow(10,Ye),ee=0;ee<$;ee++){var de=B?B.getX(ee):ee,De="";De+=~~(q.getX(de)*Ae)+",",De+=~~(q.getY(de)*Ae)+",",(De+=~~(q.getZ(de)*Ae)+",")in N?ce.push(N[De]):(Ee.push(q.getX(de)),Ee.push(q.getY(de)),Ee.push(q.getZ(de)),N[De]=he,ce.push(he),he++)}const Se=new s.BufferAttribute(new Float32Array(Ee),q.itemSize,q.normalized),ve=new s.BufferGeometry;return ve.setAttribute("position",Se),ve.setIndex(ce),ve}}class m{constructor(C){this.content=[],this.scoreFunction=C}push(C){this.content.push(C),this.sinkDown(this.content.length-1)}pop(){const C=this.content[0],L=this.content.pop();return this.content.length>0&&(this.content[0]=L,this.bubbleUp(0)),C}remove(C){const L=this.content.indexOf(C),N=this.content.pop();L!==this.content.length-1&&(this.content[L]=N,this.scoreFunction(N)<this.scoreFunction(C)?this.sinkDown(L):this.bubbleUp(L))}size(){return this.content.length}rescoreElement(C){this.sinkDown(this.content.indexOf(C))}sinkDown(C){const L=this.content[C];for(;C>0;){const N=(C+1>>1)-1,B=this.content[N];if(!(this.scoreFunction(L)<this.scoreFunction(B)))break;this.content[N]=L,this.content[C]=B,C=N}}bubbleUp(C){const L=this.content.length,N=this.content[C],B=this.scoreFunction(N);for(;;){const q=C+1<<1,$=q-1;let he,ce=null;if($<L&&(he=this.scoreFunction(this.content[$]))<B&&(ce=$),q<L&&this.scoreFunction(this.content[q])<(ce===null?B:he)&&(ce=q),ce===null)break;this.content[C]=this.content[ce],this.content[ce]=N,C=ce}}}class _{constructor(){this.portals=[]}push(C,L){L===void 0&&(L=C),this.portals.push({left:C,right:L})}stringPull(){const C=this.portals,L=[];let N,B,q,$=0,he=0,ce=0;N=C[0].left,B=C[0].left,q=C[0].right,L.push(N);for(let Ee=1;Ee<C.length;Ee++){const Ye=C[Ee].left,Ae=C[Ee].right;if(d.triarea2(N,q,Ae)<=0){if(!(d.vequal(N,q)||d.triarea2(N,B,Ae)>0)){L.push(B),B=N=B,q=N,he=$=he,ce=$,Ee=$;continue}q=Ae,ce=Ee}if(d.triarea2(N,B,Ye)>=0){if(!(d.vequal(N,B)||d.triarea2(N,q,Ye)<0)){L.push(q),B=N=q,q=N,he=$=ce,ce=$,Ee=$;continue}B=Ye,he=Ee}}return L.length!==0&&d.vequal(L[L.length-1],C[C.length-1].left)||L.push(C[C.length-1].left),this.path=L,L}}class y{constructor(){this.zones={}}static createZone(C,L=1e-4){return class{static buildZone(N,B){const q=this._buildNavigationMesh(N,B),$={};q.vertices.forEach(ce=>{ce.x=d.roundNumber(ce.x,2),ce.y=d.roundNumber(ce.y,2),ce.z=d.roundNumber(ce.z,2)}),$.vertices=q.vertices;const he=this._buildPolygonGroups(q);return $.groups=new Array(he.length),he.forEach((ce,Ee)=>{const Ye=new Map;ce.forEach((ee,de)=>{Ye.set(ee,de)});const Ae=new Array(ce.length);ce.forEach((ee,de)=>{const De=[];ee.neighbours.forEach(Ge=>De.push(Ye.get(Ge)));const Se=[];ee.neighbours.forEach(Ge=>Se.push(this._getSharedVerticesInOrder(ee,Ge)));const ve=new s.Vector3(0,0,0);ve.add($.vertices[ee.vertexIds[0]]),ve.add($.vertices[ee.vertexIds[1]]),ve.add($.vertices[ee.vertexIds[2]]),ve.divideScalar(3),ve.x=d.roundNumber(ve.x,2),ve.y=d.roundNumber(ve.y,2),ve.z=d.roundNumber(ve.z,2),Ae[de]={id:de,neighbours:De,vertexIds:ee.vertexIds,centroid:ve,portals:Se}}),$.groups[Ee]=Ae}),$}static _buildNavigationMesh(N,B){return N=d.mergeVertices(N,B),this._buildPolygonsFromGeometry(N)}static _spreadGroupId(N){let B=new Set([N]);for(;B.size>0;){const q=B;B=new Set,q.forEach($=>{$.group=N.group,$.neighbours.forEach(he=>{he.group===void 0&&B.add(he)})})}}static _buildPolygonGroups(N){const B=[];return N.polygons.forEach(q=>{q.group!==void 0?B[q.group].push(q):(q.group=B.length,this._spreadGroupId(q),B.push([q]))}),B}static _buildPolygonNeighbours(N,B){const q=new Set,$=B[N.vertexIds[1]],he=B[N.vertexIds[2]];return B[N.vertexIds[0]].forEach(ce=>{ce!==N&&($.includes(ce)||he.includes(ce))&&q.add(ce)}),$.forEach(ce=>{ce!==N&&he.includes(ce)&&q.add(ce)}),q}static _buildPolygonsFromGeometry(N){const B=[],q=[],$=N.attributes.position,he=N.index,ce=[];for(let Ee=0;Ee<$.count;Ee++)q.push(new s.Vector3().fromBufferAttribute($,Ee)),ce[Ee]=[];for(let Ee=0;Ee<N.index.count;Ee+=3){const Ye=he.getX(Ee),Ae=he.getX(Ee+1),ee=he.getX(Ee+2),de={vertexIds:[Ye,Ae,ee],neighbours:null};B.push(de),ce[Ye].push(de),ce[Ae].push(de),ce[ee].push(de)}return B.forEach(Ee=>{Ee.neighbours=this._buildPolygonNeighbours(Ee,ce)}),{polygons:B,vertices:q}}static _getSharedVerticesInOrder(N,B){const q=N.vertexIds,$=q[0],he=q[1],ce=q[2],Ee=B.vertexIds,Ye=Ee.includes($),Ae=Ee.includes(he),ee=Ee.includes(ce);return Ye&&Ae&&ee?Array.from(q):Ye&&Ae?[$,he]:Ae&&ee?[he,ce]:Ye&&ee?[ce,$]:(console.warn("Error processing navigation mesh neighbors; neighbors with <2 shared vertices found."),[])}}.buildZone(C,L)}setZoneData(C,L){this.zones[C]=L}getRandomNode(C,L,N,B){if(!this.zones[C])return new s.Vector3;N=N||null,B=B||0;const q=[];return this.zones[C].groups[L].forEach($=>{N&&B?d.distanceToSquared(N,$.centroid)<B*B&&q.push($.centroid):q.push($.centroid)}),d.sample(q)||new s.Vector3}getClosestNode(C,L,N,B=!1){const q=this.zones[L].vertices;let $=null,he=1/0;return this.zones[L].groups[N].forEach(ce=>{const Ee=d.distanceToSquared(ce.centroid,C);Ee<he&&(!B||d.isVectorInPolygon(C,ce,q))&&($=ce,he=Ee)}),$}findPath(C,L,N,B){const q=this.zones[N].groups[B],$=this.zones[N].vertices,he=this.getClosestNode(C,N,B,!0),ce=this.getClosestNode(L,N,B,!0);if(!he||!ce)return null;const Ee=class{static init(de){for(let De=0;De<de.length;De++){const Se=de[De];Se.f=0,Se.g=0,Se.h=0,Se.cost=1,Se.visited=!1,Se.closed=!1,Se.parent=null}}static cleanUp(de){for(let De=0;De<de.length;De++){const Se=de[De];delete Se.f,delete Se.g,delete Se.h,delete Se.cost,delete Se.visited,delete Se.closed,delete Se.parent}}static heap(){return new m(function(de){return de.f})}static search(de,De,Se){this.init(de);const ve=this.heap();for(ve.push(De);ve.size()>0;){const Ge=ve.pop();if(Ge===Se){let xt=Ge;const At=[];for(;xt.parent;)At.push(xt),xt=xt.parent;return this.cleanUp(At),At.reverse()}Ge.closed=!0;const Xt=this.neighbours(de,Ge);for(let xt=0,At=Xt.length;xt<At;xt++){const M=Xt[xt];if(M.closed)continue;const I=Ge.g+M.cost,O=M.visited;if(!O||I<M.g){if(M.visited=!0,M.parent=Ge,!M.centroid||!Se.centroid)throw new Error("Unexpected state");M.h=M.h||this.heuristic(M.centroid,Se.centroid),M.g=I,M.f=M.g+M.h,O?ve.rescoreElement(M):ve.push(M)}}}return[]}static heuristic(de,De){return d.distanceToSquared(de,De)}static neighbours(de,De){const Se=[];for(let ve=0;ve<De.neighbours.length;ve++)Se.push(de[De.neighbours[ve]]);return Se}}.search(q,he,ce),Ye=function(de,De){for(var Se=0;Se<de.neighbours.length;Se++)if(de.neighbours[Se]===De.id)return de.portals[Se]},Ae=new _;Ae.push(C);for(let de=0;de<Ee.length;de++){const De=Ee[de],Se=Ee[de+1];if(Se){const ve=Ye(De,Se);Ae.push($[ve[0]],$[ve[1]])}}Ae.push(L),Ae.stringPull();const ee=Ae.path.map(de=>new s.Vector3(de.x,de.y,de.z));return ee.shift(),ee}}y.prototype.getGroup=function(){const R=new s.Plane;return function(C,L,N=!1){if(!this.zones[C])return null;let B=null,q=Math.pow(50,2);const $=this.zones[C];for(let he=0;he<$.groups.length;he++){const ce=$.groups[he];for(const Ee of ce){if(N&&(R.setFromCoplanarPoints($.vertices[Ee.vertexIds[0]],$.vertices[Ee.vertexIds[1]],$.vertices[Ee.vertexIds[2]]),Math.abs(R.distanceToPoint(L))<.01)&&d.isPointInPoly([$.vertices[Ee.vertexIds[0]],$.vertices[Ee.vertexIds[1]],$.vertices[Ee.vertexIds[2]]],L))return he;const Ye=d.distanceToSquared(Ee.centroid,L);Ye<q&&(B=he,q=Ye)}}return B}}(),y.prototype.clampStep=function(){const R=new s.Vector3,C=new s.Plane,L=new s.Triangle,N=new s.Vector3;let B,q,$=new s.Vector3;return function(he,ce,Ee,Ye,Ae,ee){const de=this.zones[Ye].vertices,De=this.zones[Ye].groups[Ae],Se=[Ee],ve={};ve[Ee.id]=0,B=void 0,$.set(0,0,0),q=1/0,C.setFromCoplanarPoints(de[Ee.vertexIds[0]],de[Ee.vertexIds[1]],de[Ee.vertexIds[2]]),C.projectPoint(ce,R),N.copy(R);for(let Ge=Se.pop();Ge;Ge=Se.pop()){L.set(de[Ge.vertexIds[0]],de[Ge.vertexIds[1]],de[Ge.vertexIds[2]]),L.closestPointToPoint(N,R),R.distanceToSquared(N)<q&&(B=Ge,$.copy(R),q=R.distanceToSquared(N));const Xt=ve[Ge.id];if(!(Xt>2))for(let xt=0;xt<Ge.neighbours.length;xt++){const At=De[Ge.neighbours[xt]];At.id in ve||(Se.push(At),ve[At.id]=Xt+1)}}return ee.copy($),B}}();const x={PLAYER:new s.Color(15631215).convertSRGBToLinear().getHex(),TARGET:new s.Color(14469912).convertSRGBToLinear().getHex(),PATH:new s.Color(41903).convertSRGBToLinear().getHex(),WAYPOINT:new s.Color(41903).convertSRGBToLinear().getHex(),CLAMPED_STEP:new s.Color(14472114).convertSRGBToLinear().getHex(),CLOSEST_NODE:new s.Color(4417387).convertSRGBToLinear().getHex()};f.Pathfinding=y,f.PathfindingHelper=class extends s.Object3D{constructor(){super(),this._playerMarker=new s.Mesh(new s.SphereBufferGeometry(.25,32,32),new s.MeshBasicMaterial({color:x.PLAYER})),this._targetMarker=new s.Mesh(new s.BoxBufferGeometry(.3,.3,.3),new s.MeshBasicMaterial({color:x.TARGET})),this._nodeMarker=new s.Mesh(new s.BoxBufferGeometry(.1,.8,.1),new s.MeshBasicMaterial({color:x.CLOSEST_NODE})),this._stepMarker=new s.Mesh(new s.BoxBufferGeometry(.1,1,.1),new s.MeshBasicMaterial({color:x.CLAMPED_STEP})),this._pathMarker=new s.Object3D,this._pathLineMaterial=new s.LineBasicMaterial({color:x.PATH,linewidth:2}),this._pathPointMaterial=new s.MeshBasicMaterial({color:x.WAYPOINT}),this._pathPointGeometry=new s.SphereBufferGeometry(.08),this._markers=[this._playerMarker,this._targetMarker,this._nodeMarker,this._stepMarker,this._pathMarker],this._markers.forEach(R=>{R.visible=!1,this.add(R)})}setPath(R){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);R=[this._playerMarker.position].concat(R);const C=new s.BufferGeometry;C.setAttribute("position",new s.BufferAttribute(new Float32Array(3*R.length),3));for(let L=0;L<R.length;L++)C.attributes.position.setXYZ(L,R[L].x,R[L].y+.2,R[L].z);this._pathMarker.add(new s.Line(C,this._pathLineMaterial));for(let L=0;L<R.length-1;L++){const N=new s.Mesh(this._pathPointGeometry,this._pathPointMaterial);N.position.copy(R[L]),N.position.y+=.2,this._pathMarker.add(N)}return this._pathMarker.visible=!0,this}setPlayerPosition(R){return this._playerMarker.position.copy(R),this._playerMarker.visible=!0,this}setTargetPosition(R){return this._targetMarker.position.copy(R),this._targetMarker.visible=!0,this}setNodePosition(R){return this._nodeMarker.position.copy(R),this._nodeMarker.visible=!0,this}setStepPosition(R){return this._stepMarker.position.copy(R),this._stepMarker.visible=!0,this}reset(){for(;this._pathMarker.children.length;)this._pathMarker.children[0].visible=!1,this._pathMarker.remove(this._pathMarker.children[0]);return this._markers.forEach(R=>{R.visible=!1}),this}}},{three:11}],11:[function(o,c,f){(function(s,d){typeof f=="object"&&c!==void 0?d(f):(s=typeof globalThis<"u"?globalThis:s||self,d(s.THREE={}))})(this,function(s){function d(){}function m(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?Eo.getDataURL(n):n.data?{data:Array.prototype.slice.call(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}function _(n,e,t,i,r){for(let a=0,u=n.length-3;a<=u;a+=3){Mo.fromArray(n,a);const l=r.x*Math.abs(Mo.x)+r.y*Math.abs(Mo.y)+r.z*Math.abs(Mo.z),h=e.dot(Mo),p=t.dot(Mo),g=i.dot(Mo);if(Math.max(-Math.max(h,p,g),Math.min(h,p,g))>l)return!1}return!0}function y(){Object.defineProperty(this,"id",{value:Dv++}),this.uuid=Kt.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=y.DefaultUp.clone();const n=new U,e=new To,t=new ii,i=new U(1,1,1);e._onChange(function(){t.setFromEuler(e,!1)}),t._onChange(function(){e.setFromQuaternion(t,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:t},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Bt},normalMatrix:{value:new Qn}}),this.matrix=new Bt,this.matrixWorld=new Bt,this.matrixAutoUpdate=y.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new hh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}function x(){Object.defineProperty(this,"id",{value:Hv++}),this.uuid=Kt.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=ss,this.side=os,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Uu,this.blendDst=zu,this.blendEquation=vo,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=wl,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=mm,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ll,this.stencilZFail=Ll,this.stencilZPass=Ll,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function R(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+6*(e-n)*(2/3-t):n}function C(n){return n<.04045?.0773993808*n:Math.pow(.9478672986*n+.0521327014,2.4)}function L(n){return n<.0031308?12.92*n:1.055*Math.pow(n,.41666)-.055}function N(n,e,t){if(Array.isArray(n))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=n,this.itemSize=e,this.count=n!==void 0?n.length/e:0,this.normalized=t===!0,this.usage=ds,this.updateRange={offset:0,count:-1},this.version=0}function B(n,e,t){N.call(this,new Int8Array(n),e,t)}function q(n,e,t){N.call(this,new Uint8Array(n),e,t)}function $(n,e,t){N.call(this,new Uint8ClampedArray(n),e,t)}function he(n,e,t){N.call(this,new Int16Array(n),e,t)}function ce(n,e,t){N.call(this,new Uint16Array(n),e,t)}function Ee(n,e,t){N.call(this,new Int32Array(n),e,t)}function Ye(n,e,t){N.call(this,new Uint32Array(n),e,t)}function Ae(n,e,t){N.call(this,new Uint16Array(n),e,t)}function ee(n,e,t){N.call(this,new Float32Array(n),e,t)}function de(n,e,t){N.call(this,new Float64Array(n),e,t)}function De(n){if(n.length===0)return-1/0;let e=n[0];for(let t=1,i=n.length;t<i;++t)n[t]>e&&(e=n[t]);return e}function Se(n,e){return new Bv[n](e)}function ve(){Object.defineProperty(this,"id",{value:Uv++}),this.uuid=Kt.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Ge(n=new ve,e=new Pr){y.call(this),this.type="Mesh",this.geometry=n,this.material=e,this.updateMorphTargets()}function Xt(n,e,t,i,r,a,u,l,h,p,g,v){Kr.fromBufferAttribute(r,p),Zr.fromBufferAttribute(r,g),Jr.fromBufferAttribute(r,v);const b=n.morphTargetInfluences;if(e.morphTargets&&a&&b){Bl.set(0,0,0),Ul.set(0,0,0),zl.set(0,0,0);for(let S=0,D=a.length;S<D;S++){const P=b[S],k=a[S];P!==0&&(xh.fromBufferAttribute(k,p),_h.fromBufferAttribute(k,g),bh.fromBufferAttribute(k,v),u?(Bl.addScaledVector(xh,P),Ul.addScaledVector(_h,P),zl.addScaledVector(bh,P)):(Bl.addScaledVector(xh.sub(Kr),P),Ul.addScaledVector(_h.sub(Zr),P),zl.addScaledVector(bh.sub(Jr),P)))}Kr.add(Bl),Zr.add(Ul),Jr.add(zl)}n.isSkinnedMesh&&e.skinning&&(n.boneTransform(p,Kr),n.boneTransform(g,Zr),n.boneTransform(v,Jr));const E=function(S,D,P,k,H,G,W,K){if((D.side===Kn?k.intersectTriangle(W,G,H,!0,K):k.intersectTriangle(H,G,W,D.side!==ca,K))===null)return null;jl.copy(K),jl.applyMatrix4(S.matrixWorld);const Q=P.ray.origin.distanceTo(jl);return Q<P.near||Q>P.far?null:{distance:Q,point:jl.clone(),object:S}}(n,e,t,i,Kr,Zr,Jr,Eh);if(E){l&&(Gl.fromBufferAttribute(l,p),Vl.fromBufferAttribute(l,g),Wl.fromBufferAttribute(l,v),E.uv=Gn.getUV(Eh,Kr,Zr,Jr,Gl,Vl,Wl,new Je)),h&&(Gl.fromBufferAttribute(h,p),Vl.fromBufferAttribute(h,g),Wl.fromBufferAttribute(h,v),E.uv2=Gn.getUV(Eh,Kr,Zr,Jr,Gl,Vl,Wl,new Je));const S={a:p,b:g,c:v,normal:new U,materialIndex:0};Gn.getNormal(Kr,Zr,Jr,S.normal),E.face=S}return E}function xt(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function At(n){const e={};for(let t=0;t<n.length;t++){const i=xt(n[t]);for(const r in i)e[r]=i[r]}return e}function M(n){x.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=zv,this.fragmentShader=Gv,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,n!==void 0&&(n.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(n))}function I(){y.call(this),this.type="Camera",this.matrixWorldInverse=new Bt,this.projectionMatrix=new Bt,this.projectionMatrixInverse=new Bt}function O(n=50,e=1,t=.1,i=2e3){I.call(this),this.type="PerspectiveCamera",this.fov=n,this.zoom=1,this.near=t,this.far=i,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function A(){function n(a,u){i(a,u),r=e.requestAnimationFrame(n)}let e=null,t=!1,i=null,r=null;return{start:function(){t!==!0&&i!==null&&(r=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(a){i=a},setContext:function(a){e=a}}}function T(n,e){const t=e.isWebGL2,i=new WeakMap;return{get:function(r){return r.isInterleavedBufferAttribute&&(r=r.data),i.get(r)},remove:function(r){r.isInterleavedBufferAttribute&&(r=r.data);const a=i.get(r);a&&(n.deleteBuffer(a.buffer),i.delete(r))},update:function(r,a){if(r.isGLBufferAttribute){const l=i.get(r);return void((!l||l.version<r.version)&&i.set(r,{buffer:r.buffer,type:r.type,bytesPerElement:r.elementSize,version:r.version}))}r.isInterleavedBufferAttribute&&(r=r.data);const u=i.get(r);u===void 0?i.set(r,function(l,h){const p=l.array,g=l.usage,v=n.createBuffer();n.bindBuffer(h,v),n.bufferData(h,p,g),l.onUploadCallback();let b=n.FLOAT;return p instanceof Float32Array?b=n.FLOAT:p instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):p instanceof Uint16Array?l.isFloat16BufferAttribute?t?b=n.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):b=n.UNSIGNED_SHORT:p instanceof Int16Array?b=n.SHORT:p instanceof Uint32Array?b=n.UNSIGNED_INT:p instanceof Int32Array?b=n.INT:p instanceof Int8Array?b=n.BYTE:p instanceof Uint8Array&&(b=n.UNSIGNED_BYTE),{buffer:v,type:b,bytesPerElement:p.BYTES_PER_ELEMENT,version:l.version}}(r,a)):u.version<r.version&&(function(l,h,p){const g=h.array,v=h.updateRange;n.bindBuffer(p,l),v.count===-1?n.bufferSubData(p,0,g):(t?n.bufferSubData(p,v.offset*g.BYTES_PER_ELEMENT,g,v.offset,v.count):n.bufferSubData(p,v.offset*g.BYTES_PER_ELEMENT,g.subarray(v.offset,v.offset+v.count)),v.count=-1)}(u.buffer,r,a),u.version=r.version)}}}function F(n,e,t,i){function r(W){return i.isWebGL2?n.bindVertexArray(W):D.bindVertexArrayOES(W)}function a(W){return i.isWebGL2?n.deleteVertexArray(W):D.deleteVertexArrayOES(W)}function u(W){const K=[],Q=[],V=[];for(let ge=0;ge<S;ge++)K[ge]=0,Q[ge]=0,V[ge]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:K,enabledAttributes:Q,attributeDivisors:V,object:W,attributes:{},index:null}}function l(){const W=G.newAttributes;for(let K=0,Q=W.length;K<Q;K++)W[K]=0}function h(W){p(W,0)}function p(W,K){const Q=G.newAttributes,V=G.enabledAttributes,ge=G.attributeDivisors;Q[W]=1,V[W]===0&&(n.enableVertexAttribArray(W),V[W]=1),ge[W]!==K&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](W,K),ge[W]=K)}function g(){const W=G.newAttributes,K=G.enabledAttributes;for(let Q=0,V=K.length;Q<V;Q++)K[Q]!==W[Q]&&(n.disableVertexAttribArray(Q),K[Q]=0)}function v(W,K,Q,V,ge,Z){i.isWebGL2!==!0||Q!==n.INT&&Q!==n.UNSIGNED_INT?n.vertexAttribPointer(W,K,Q,V,ge,Z):n.vertexAttribIPointer(W,K,Q,ge,Z)}function b(){E(),G!==H&&r((G=H).object)}function E(){H.geometry=null,H.program=null,H.wireframe=!1}const S=n.getParameter(n.MAX_VERTEX_ATTRIBS),D=i.isWebGL2?null:e.get("OES_vertex_array_object"),P=i.isWebGL2||D!==null,k={},H=u(null);let G=H;return{setup:function(W,K,Q,V,ge){let Z=!1;if(P){const xe=function(we,be,Me){const $e=Me.wireframe===!0;let ct=k[we.id];ct===void 0&&(ct={},k[we.id]=ct);let Wt=ct[be.id];Wt===void 0&&(Wt={},ct[be.id]=Wt);let dt=Wt[$e];return dt===void 0&&(dt=u(i.isWebGL2?n.createVertexArray():D.createVertexArrayOES()),Wt[$e]=dt),dt}(V,Q,K);G!==xe&&r((G=xe).object),(Z=function(we,be){const Me=G.attributes,$e=we.attributes;let ct=0;for(const Wt in $e){const dt=Me[Wt],nt=$e[Wt];if(dt===void 0||dt.attribute!==nt||dt.data!==nt.data)return!0;ct++}return G.attributesNum!==ct||G.index!==be}(V,ge))&&function(we,be){const Me={},$e=we.attributes;let ct=0;for(const Wt in $e){const dt=$e[Wt],nt={};nt.attribute=dt,dt.data&&(nt.data=dt.data),Me[Wt]=nt,ct++}G.attributes=Me,G.attributesNum=ct,G.index=be}(V,ge)}else{const xe=K.wireframe===!0;G.geometry===V.id&&G.program===Q.id&&G.wireframe===xe||(G.geometry=V.id,G.program=Q.id,G.wireframe=xe,Z=!0)}W.isInstancedMesh===!0&&(Z=!0),ge!==null&&t.update(ge,n.ELEMENT_ARRAY_BUFFER),Z&&(function(xe,we,be,Me){if(i.isWebGL2===!1&&(xe.isInstancedMesh||Me.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;l();const $e=Me.attributes,ct=be.getAttributes(),Wt=we.defaultAttributeValues;for(const dt in ct){const nt=ct[dt];if(nt>=0){const Gt=$e[dt];if(Gt!==void 0){const Ot=Gt.normalized,cn=Gt.itemSize,oe=t.get(Gt);if(oe===void 0)continue;const re=oe.buffer,ot=oe.type,Ue=oe.bytesPerElement;if(Gt.isInterleavedBufferAttribute){const Xe=Gt.data,qt=Xe.stride,We=Gt.offset;Xe&&Xe.isInstancedInterleavedBuffer?(p(nt,Xe.meshPerAttribute),Me._maxInstanceCount===void 0&&(Me._maxInstanceCount=Xe.meshPerAttribute*Xe.count)):h(nt),n.bindBuffer(n.ARRAY_BUFFER,re),v(nt,cn,ot,Ot,qt*Ue,We*Ue)}else Gt.isInstancedBufferAttribute?(p(nt,Gt.meshPerAttribute),Me._maxInstanceCount===void 0&&(Me._maxInstanceCount=Gt.meshPerAttribute*Gt.count)):h(nt),n.bindBuffer(n.ARRAY_BUFFER,re),v(nt,cn,ot,Ot,0,0)}else if(dt==="instanceMatrix"){const Ot=t.get(xe.instanceMatrix);if(Ot===void 0)continue;const cn=Ot.buffer,oe=Ot.type;p(nt+0,1),p(nt+1,1),p(nt+2,1),p(nt+3,1),n.bindBuffer(n.ARRAY_BUFFER,cn),n.vertexAttribPointer(nt+0,4,oe,!1,64,0),n.vertexAttribPointer(nt+1,4,oe,!1,64,16),n.vertexAttribPointer(nt+2,4,oe,!1,64,32),n.vertexAttribPointer(nt+3,4,oe,!1,64,48)}else if(dt==="instanceColor"){const Ot=t.get(xe.instanceColor);if(Ot===void 0)continue;const cn=Ot.buffer,oe=Ot.type;p(nt,1),n.bindBuffer(n.ARRAY_BUFFER,cn),n.vertexAttribPointer(nt,3,oe,!1,12,0)}else if(Wt!==void 0){const Ot=Wt[dt];if(Ot!==void 0)switch(Ot.length){case 2:n.vertexAttrib2fv(nt,Ot);break;case 3:n.vertexAttrib3fv(nt,Ot);break;case 4:n.vertexAttrib4fv(nt,Ot);break;default:n.vertexAttrib1fv(nt,Ot)}}}}g()}(W,K,Q,V),ge!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(ge).buffer))},reset:b,resetDefaultState:E,dispose:function(){b();for(const W in k){const K=k[W];for(const Q in K){const V=K[Q];for(const ge in V)a(V[ge].object),delete V[ge];delete K[Q]}delete k[W]}},releaseStatesOfGeometry:function(W){if(k[W.id]===void 0)return;const K=k[W.id];for(const Q in K){const V=K[Q];for(const ge in V)a(V[ge].object),delete V[ge];delete K[Q]}delete k[W.id]},releaseStatesOfProgram:function(W){for(const K in k){const Q=k[K];if(Q[W.id]===void 0)continue;const V=Q[W.id];for(const ge in V)a(V[ge].object),delete V[ge];delete Q[W.id]}},initAttributes:l,enableAttribute:h,disableUnusedAttributes:g}}function z(n,e){return n[0]-e[0]}function j(n,e){return Math.abs(e[1])-Math.abs(n[1])}function se(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let a=Dm[r];if(a===void 0&&(a=new Float32Array(r),Dm[r]=a),e!==0){i.toArray(a,0);for(let u=1,l=0;u!==e;++u)l+=t,n[u].toArray(a,l)}return a}function Te(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function ae(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function wt(n,e){let t=Nm[e];t===void 0&&(t=new Int32Array(e),Nm[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function Fe(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function Re(n,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y||(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Te(t,e))return;n.uniform2fv(this.addr,e),ae(t,e)}}function ut(n,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z||(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)t[0]===e.r&&t[1]===e.g&&t[2]===e.b||(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Te(t,e))return;n.uniform3fv(this.addr,e),ae(t,e)}}function et(n,e){const t=this.cache;if(e.x!==void 0)t[0]===e.x&&t[1]===e.y&&t[2]===e.z&&t[3]===e.w||(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Te(t,e))return;n.uniform4fv(this.addr,e),ae(t,e)}}function _t(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Te(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),ae(t,e)}else{if(Te(t,i))return;km.set(i),n.uniformMatrix2fv(this.addr,!1,km),ae(t,i)}}function rn(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Te(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),ae(t,e)}else{if(Te(t,i))return;Om.set(i),n.uniformMatrix3fv(this.addr,!1,Om),ae(t,i)}}function X(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Te(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),ae(t,e)}else{if(Te(t,i))return;Im.set(i),n.uniformMatrix4fv(this.addr,!1,Im),ae(t,i)}}function J(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function pe(n,e){const t=this.cache;Te(t,e)||(n.uniform2iv(this.addr,e),ae(t,e))}function Ce(n,e){const t=this.cache;Te(t,e)||(n.uniform3iv(this.addr,e),ae(t,e))}function Ne(n,e){const t=this.cache;Te(t,e)||(n.uniform4iv(this.addr,e),ae(t,e))}function Be(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function it(n,e){const t=this.cache;Te(t,e)||(n.uniform2uiv(this.addr,e),ae(t,e))}function tt(n,e){const t=this.cache;Te(t,e)||(n.uniform3uiv(this.addr,e),ae(t,e))}function mt(n,e){const t=this.cache;Te(t,e)||(n.uniform4uiv(this.addr,e),ae(t,e))}function Ie(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.safeSetTexture2D(e||Lm,r)}function Nt(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||Wv,r)}function Tt(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.safeSetTextureCube(e||Pm,r)}function It(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Vv,r)}function zt(n,e){n.uniform1fv(this.addr,e)}function $t(n,e){const t=se(e,this.size,2);n.uniform2fv(this.addr,t)}function fn(n,e){const t=se(e,this.size,3);n.uniform3fv(this.addr,t)}function wn(n,e){const t=se(e,this.size,4);n.uniform4fv(this.addr,t)}function Mt(n,e){const t=se(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function li(n,e){const t=se(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function Y(n,e){const t=se(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function ne(n,e){n.uniform1iv(this.addr,e)}function ue(n,e){n.uniform2iv(this.addr,e)}function ye(n,e){n.uniform3iv(this.addr,e)}function fe(n,e){n.uniform4iv(this.addr,e)}function ke(n,e){n.uniform1uiv(this.addr,e)}function Oe(n,e){n.uniform2uiv(this.addr,e)}function Ze(n,e){n.uniform3uiv(this.addr,e)}function qe(n,e){n.uniform4uiv(this.addr,e)}function Ve(n,e,t){const i=e.length,r=wt(t,i);n.uniform1iv(this.addr,r);for(let a=0;a!==i;++a)t.safeSetTexture2D(e[a]||Lm,r[a])}function Le(n,e,t){const i=e.length,r=wt(t,i);n.uniform1iv(this.addr,r);for(let a=0;a!==i;++a)t.safeSetTextureCube(e[a]||Pm,r[a])}function rt(n,e,t){this.id=n,this.addr=t,this.cache=[],this.setValue=function(i){switch(i){case 5126:return Fe;case 35664:return Re;case 35665:return ut;case 35666:return et;case 35674:return _t;case 35675:return rn;case 35676:return X;case 5124:case 35670:return J;case 35667:case 35671:return pe;case 35668:case 35672:return Ce;case 35669:case 35673:return Ne;case 5125:return Be;case 36294:return it;case 36295:return tt;case 36296:return mt;case 35678:case 36198:case 36298:case 36306:case 35682:return Ie;case 35679:case 36299:case 36307:return Nt;case 35680:case 36300:case 36308:case 36293:return Tt;case 36289:case 36303:case 36311:case 36292:return It}}(e.type)}function gt(n,e,t){this.id=n,this.addr=t,this.cache=[],this.size=e.size,this.setValue=function(i){switch(i){case 5126:return zt;case 35664:return $t;case 35665:return fn;case 35666:return wn;case 35674:return Mt;case 35675:return li;case 35676:return Y;case 5124:case 35670:return ne;case 35667:case 35671:return ue;case 35668:case 35672:return ye;case 35669:case 35673:return fe;case 5125:return ke;case 36294:return Oe;case 36295:return Ze;case 36296:return qe;case 35678:case 36198:case 36298:case 36306:case 35682:return Ve;case 35680:case 36300:case 36308:case 36293:return Le}}(e.type)}function yt(n){this.id=n,this.seq=[],this.map={}}function ht(n,e){n.seq.push(e),n.map[e.id]=e}function lt(n,e,t){const i=n.name,r=i.length;for(Th.lastIndex=0;;){const a=Th.exec(i),u=Th.lastIndex;let l=a[1];const h=a[2]==="]",p=a[3];if(h&&(l|=0),p===void 0||p==="["&&u+2===r){ht(t,p===void 0?new rt(l,n,e):new gt(l,n,e));break}{let g=t.map[l];g===void 0&&ht(t,g=new yt(l)),t=g}}}function pt(n,e){this.seq=[],this.map={};const t=n.getProgramParameter(e,n.ACTIVE_UNIFORMS);for(let i=0;i<t;++i){const r=n.getActiveUniform(e,i);lt(r,n.getUniformLocation(e,r.name),this)}}function Dt(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}function kt(n){switch(n){case _i:return["Linear","( value )"];case xa:return["sRGB","( value )"];case Cl:return["RGBE","( value )"];case Qu:return["RGBM","( value, 7.0 )"];case eh:return["RGBM","( value, 16.0 )"];case th:return["RGBD","( value, 256.0 )"];case Rl:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case dm:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",n),["Linear","( value )"]}}function St(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();return i&&r===""?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+t+`
`+r+function(a){const u=a.split(`
`);for(let l=0;l<u.length;l++)u[l]=l+1+": "+u[l];return u.join(`
`)}(n.getShaderSource(e))}function an(n,e){const t=kt(e);return"vec4 "+n+"( vec4 value ) { return "+t[0]+"ToLinear"+t[1]+"; }"}function Qt(n){return n!==""}function Fn(n,e){return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function en(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function Dn(n){return n.replace(Xv,ci)}function ci(n,e){const t=pn[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Dn(t)}function ui(n){return n.replace(Yv,Vi).replace(qv,Li)}function Li(n,e,t,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Vi(n,e,t,i)}function Vi(n,e,t,i){let r="";for(let a=parseInt(e);a<parseInt(t);a++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function Cn(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function Ur(n,e,t,i){const r=n.getContext(),a=t.defines;let u=t.vertexShader,l=t.fragmentShader;const h=function(Z){let xe="SHADOWMAP_TYPE_BASIC";return Z.shadowMapType===Iu?xe="SHADOWMAP_TYPE_PCF":Z.shadowMapType===Xp?xe="SHADOWMAP_TYPE_PCF_SOFT":Z.shadowMapType===rs&&(xe="SHADOWMAP_TYPE_VSM"),xe}(t),p=function(Z){let xe="ENVMAP_TYPE_CUBE";if(Z.envMap)switch(Z.envMapMode){case ha:case da:xe="ENVMAP_TYPE_CUBE";break;case as:case pa:xe="ENVMAP_TYPE_CUBE_UV"}return xe}(t),g=function(Z){let xe="ENVMAP_MODE_REFLECTION";if(Z.envMap)switch(Z.envMapMode){case da:case pa:xe="ENVMAP_MODE_REFRACTION"}return xe}(t),v=function(Z){let xe="ENVMAP_BLENDING_NONE";if(Z.envMap)switch(Z.combine){case ua:xe="ENVMAP_BLENDING_MULTIPLY";break;case pf:xe="ENVMAP_BLENDING_MIX";break;case ff:xe="ENVMAP_BLENDING_ADD"}return xe}(t),b=n.gammaFactor>0?n.gammaFactor:1,E=t.isWebGL2?"":function(Z){return[Z.extensionDerivatives||Z.envMapCubeUV||Z.bumpMap||Z.tangentSpaceNormalMap||Z.clearcoatNormalMap||Z.flatShading||Z.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(Z.extensionFragDepth||Z.logarithmicDepthBuffer)&&Z.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",Z.extensionDrawBuffers&&Z.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(Z.extensionShaderTextureLOD||Z.envMap)&&Z.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Qt).join(`
`)}(t),S=function(Z){const xe=[];for(const we in Z){const be=Z[we];be!==!1&&xe.push("#define "+we+" "+be)}return xe.join(`
`)}(a),D=r.createProgram();let P,k,H=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?((P=[S].filter(Qt).join(`
`)).length>0&&(P+=`
`),(k=[E,S].filter(Qt).join(`
`)).length>0&&(k+=`
`)):(P=[Cn(t),"#define SHADER_NAME "+t.shaderName,S,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+b,"#define MAX_BONES "+t.maxBones,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+g:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.useVertexTexture?"#define BONE_TEXTURE":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Qt).join(`
`),k=[E,Cn(t),"#define SHADER_NAME "+t.shaderName,S,t.alphaTest?"#define ALPHATEST "+t.alphaTest+(t.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+b,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+g:"",t.envMap?"#define "+v:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.sheen?"#define USE_SHEEN":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+h:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(t.extensionShaderTextureLOD||t.envMap)&&t.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==yo?"#define TONE_MAPPING":"",t.toneMapping!==yo?pn.tonemapping_pars_fragment:"",t.toneMapping!==yo?function(Z,xe){let we;switch(xe){case mf:we="Linear";break;case gf:we="Reinhard";break;case vf:we="OptimizedCineon";break;case yf:we="ACESFilmic";break;case xf:we="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",xe),we="Linear"}return"vec3 "+Z+"( vec3 color ) { return "+we+"ToneMapping( color ); }"}("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",pn.encodings_pars_fragment,t.map?an("mapTexelToLinear",t.mapEncoding):"",t.matcap?an("matcapTexelToLinear",t.matcapEncoding):"",t.envMap?an("envMapTexelToLinear",t.envMapEncoding):"",t.emissiveMap?an("emissiveMapTexelToLinear",t.emissiveMapEncoding):"",t.lightMap?an("lightMapTexelToLinear",t.lightMapEncoding):"",function(Z,xe){const we=kt(xe);return"vec4 "+Z+"( vec4 value ) { return LinearTo"+we[0]+we[1]+"; }"}("linearToOutputTexel",t.outputEncoding),t.depthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Qt).join(`
`)),u=en(u=Fn(u=Dn(u),t),t),l=en(l=Fn(l=Dn(l),t),t),u=ui(u),l=ui(l),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(H=`#version 300 es
`,P=["#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+P,k=["#define varying in",t.glslVersion===nh?"":"out highp vec4 pc_fragColor;",t.glslVersion===nh?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+k);const G=H+P+u,W=H+k+l,K=Dt(r,r.VERTEX_SHADER,G),Q=Dt(r,r.FRAGMENT_SHADER,W);if(r.attachShader(D,K),r.attachShader(D,Q),t.index0AttributeName!==void 0?r.bindAttribLocation(D,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(D,0,"position"),r.linkProgram(D),n.debug.checkShaderErrors){const Z=r.getProgramInfoLog(D).trim(),xe=r.getShaderInfoLog(K).trim(),we=r.getShaderInfoLog(Q).trim();let be=!0,Me=!0;if(r.getProgramParameter(D,r.LINK_STATUS)===!1){be=!1;const $e=St(r,K,"vertex"),ct=St(r,Q,"fragment");console.error("THREE.WebGLProgram: shader error: ",r.getError(),"gl.VALIDATE_STATUS",r.getProgramParameter(D,r.VALIDATE_STATUS),"gl.getProgramInfoLog",Z,$e,ct)}else Z!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Z):xe!==""&&we!==""||(Me=!1);Me&&(this.diagnostics={runnable:be,programLog:Z,vertexShader:{log:xe,prefix:P},fragmentShader:{log:we,prefix:k}})}r.deleteShader(K),r.deleteShader(Q);let V;this.getUniforms=function(){return V===void 0&&(V=new pt(r,D)),V};let ge;return this.getAttributes=function(){return ge===void 0&&(ge=function(Z,xe){const we={},be=Z.getProgramParameter(xe,Z.ACTIVE_ATTRIBUTES);for(let Me=0;Me<be;Me++){const $e=Z.getActiveAttrib(xe,Me).name;we[$e]=Z.getAttribLocation(xe,$e)}return we}(r,D)),ge},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(D),this.program=void 0},this.name=t.shaderName,this.id=jv++,this.cacheKey=e,this.usedTimes=1,this.program=D,this.vertexShader=K,this.fragmentShader=Q,this}function hi(n,e,t,i,r,a){function u(P){let k;return P&&P.isTexture?k=P.encoding:P&&P.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),k=P.texture.encoding):k=_i,k}const l=[],h=i.isWebGL2,p=i.logarithmicDepthBuffer,g=i.floatVertexTextures,v=i.maxVertexUniforms,b=i.vertexTextures;let E=i.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},D=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];return{getParameters:function(P,k,H,G,W){const K=G.fog,Q=P.isMeshStandardMaterial?G.environment:null,V=e.get(P.envMap||Q),ge=S[P.type],Z=W.isSkinnedMesh?function(Me){const $e=Me.skeleton.bones;if(g)return 1024;{const ct=v,Wt=Math.floor((ct-20)/4),dt=Math.min(Wt,$e.length);return dt<$e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+$e.length+" bones. This GPU supports "+dt+"."),0):dt}}(W):0;P.precision!==null&&(E=i.getMaxPrecision(P.precision))!==P.precision&&console.warn("THREE.WebGLProgram.getParameters:",P.precision,"not supported, using",E,"instead.");let xe,we;if(ge){const Me=Ji[ge];xe=Me.vertexShader,we=Me.fragmentShader}else xe=P.vertexShader,we=P.fragmentShader;const be=n.getRenderTarget();return{isWebGL2:h,shaderID:ge,shaderName:P.type,vertexShader:xe,fragmentShader:we,defines:P.defines,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:E,instancing:W.isInstancedMesh===!0,instancingColor:W.isInstancedMesh===!0&&W.instanceColor!==null,supportsVertexTextures:b,outputEncoding:be!==null?u(be.texture):n.outputEncoding,map:!!P.map,mapEncoding:u(P.map),matcap:!!P.matcap,matcapEncoding:u(P.matcap),envMap:!!V,envMapMode:V&&V.mapping,envMapEncoding:u(V),envMapCubeUV:!!V&&(V.mapping===as||V.mapping===pa),lightMap:!!P.lightMap,lightMapEncoding:u(P.lightMap),aoMap:!!P.aoMap,emissiveMap:!!P.emissiveMap,emissiveMapEncoding:u(P.emissiveMap),bumpMap:!!P.bumpMap,normalMap:!!P.normalMap,objectSpaceNormalMap:P.normalMapType===fm,tangentSpaceNormalMap:P.normalMapType===_o,clearcoatMap:!!P.clearcoatMap,clearcoatRoughnessMap:!!P.clearcoatRoughnessMap,clearcoatNormalMap:!!P.clearcoatNormalMap,displacementMap:!!P.displacementMap,roughnessMap:!!P.roughnessMap,metalnessMap:!!P.metalnessMap,specularMap:!!P.specularMap,alphaMap:!!P.alphaMap,gradientMap:!!P.gradientMap,sheen:!!P.sheen,transmissionMap:!!P.transmissionMap,combine:P.combine,vertexTangents:P.normalMap&&P.vertexTangents,vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&W.geometry.attributes.color&&W.geometry.attributes.color.itemSize===4,vertexUvs:!!(P.map||P.bumpMap||P.normalMap||P.specularMap||P.alphaMap||P.emissiveMap||P.roughnessMap||P.metalnessMap||P.clearcoatMap||P.clearcoatRoughnessMap||P.clearcoatNormalMap||P.displacementMap||P.transmissionMap),uvsVertexOnly:!(P.map||P.bumpMap||P.normalMap||P.specularMap||P.alphaMap||P.emissiveMap||P.roughnessMap||P.metalnessMap||P.clearcoatNormalMap||P.transmissionMap||!P.displacementMap),fog:!!K,useFog:P.fog,fogExp2:K&&K.isFogExp2,flatShading:!!P.flatShading,sizeAttenuation:P.sizeAttenuation,logarithmicDepthBuffer:p,skinning:P.skinning&&Z>0,maxBones:Z,useVertexTexture:g,morphTargets:P.morphTargets,morphNormals:P.morphNormals,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:P.dithering,shadowMapEnabled:n.shadowMap.enabled&&H.length>0,shadowMapType:n.shadowMap.type,toneMapping:P.toneMapped?n.toneMapping:yo,physicallyCorrectLights:n.physicallyCorrectLights,premultipliedAlpha:P.premultipliedAlpha,alphaTest:P.alphaTest,doubleSided:P.side===ca,flipSided:P.side===Kn,depthPacking:P.depthPacking!==void 0&&P.depthPacking,index0AttributeName:P.index0AttributeName,extensionDerivatives:P.extensions&&P.extensions.derivatives,extensionFragDepth:P.extensions&&P.extensions.fragDepth,extensionDrawBuffers:P.extensions&&P.extensions.drawBuffers,extensionShaderTextureLOD:P.extensions&&P.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||t.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||t.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||t.has("EXT_shader_texture_lod"),customProgramCacheKey:P.customProgramCacheKey()}},getProgramCacheKey:function(P){const k=[];if(P.shaderID?k.push(P.shaderID):(k.push(P.fragmentShader),k.push(P.vertexShader)),P.defines!==void 0)for(const H in P.defines)k.push(H),k.push(P.defines[H]);if(P.isRawShaderMaterial===!1){for(let H=0;H<D.length;H++)k.push(P[D[H]]);k.push(n.outputEncoding),k.push(n.gammaFactor)}return k.push(P.customProgramCacheKey),k.join()},getUniforms:function(P){const k=S[P.type];let H;if(k){const G=Ji[k];H=Cm.clone(G.uniforms)}else H=P.uniforms;return H},acquireProgram:function(P,k){let H;for(let G=0,W=l.length;G<W;G++){const K=l[G];if(K.cacheKey===k){++(H=K).usedTimes;break}}return H===void 0&&(H=new Ur(n,k,P,r),l.push(H)),H},releaseProgram:function(P){if(--P.usedTimes==0){const k=l.indexOf(P);l[k]=l[l.length-1],l.pop(),P.destroy()}},programs:l}}function Hi(n){function e(l,h,p,g,v,b){let E=t[i];const S=n.get(p);return E===void 0?(E={id:l.id,object:l,geometry:h,material:p,program:S.program||u,groupOrder:g,renderOrder:l.renderOrder,z:v,group:b},t[i]=E):(E.id=l.id,E.object=l,E.geometry=h,E.material=p,E.program=S.program||u,E.groupOrder=g,E.renderOrder=l.renderOrder,E.z=v,E.group=b),i++,E}const t=[];let i=0;const r=[],a=[],u={id:-1};return{opaque:r,transparent:a,init:function(){i=0,r.length=0,a.length=0},push:function(l,h,p,g,v,b){const E=e(l,h,p,g,v,b);(p.transparent===!0?a:r).push(E)},unshift:function(l,h,p,g,v,b){const E=e(l,h,p,g,v,b);(p.transparent===!0?a:r).unshift(E)},finish:function(){for(let l=i,h=t.length;l<h;l++){const p=t[l];if(p.id===null)break;p.id=null,p.object=null,p.geometry=null,p.material=null,p.program=null,p.group=null}},sort:function(l,h){r.length>1&&r.sort(l||function(p,g){return p.groupOrder!==g.groupOrder?p.groupOrder-g.groupOrder:p.renderOrder!==g.renderOrder?p.renderOrder-g.renderOrder:p.program!==g.program?p.program.id-g.program.id:p.material.id!==g.material.id?p.material.id-g.material.id:p.z!==g.z?p.z-g.z:p.id-g.id}),a.length>1&&a.sort(h||function(p,g){return p.groupOrder!==g.groupOrder?p.groupOrder-g.groupOrder:p.renderOrder!==g.renderOrder?p.renderOrder-g.renderOrder:p.z!==g.z?g.z-p.z:p.id-g.id})}}}function Wi(n,e){return(e.castShadow?1:0)-(n.castShadow?1:0)}function Eu(n,e){const t=new function(){const h={};return{get:function(p){if(h[p.id]!==void 0)return h[p.id];let g;switch(p.type){case"DirectionalLight":g={direction:new U,color:new Rt};break;case"SpotLight":g={position:new U,direction:new U,color:new Rt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":g={position:new U,color:new Rt,distance:0,decay:0};break;case"HemisphereLight":g={direction:new U,skyColor:new Rt,groundColor:new Rt};break;case"RectAreaLight":g={color:new Rt,position:new U,halfWidth:new U,halfHeight:new U}}return h[p.id]=g,g}}},i=function(){const h={};return{get:function(p){if(h[p.id]!==void 0)return h[p.id];let g;switch(p.type){case"DirectionalLight":case"SpotLight":g={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je};break;case"PointLight":g={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Je,shadowCameraNear:1,shadowCameraFar:1e3}}return h[p.id]=g,g}}}(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let h=0;h<9;h++)r.probe.push(new U);const a=new U,u=new Bt,l=new Bt;return{setup:function(h){let p=0,g=0,v=0;for(let K=0;K<9;K++)r.probe[K].set(0,0,0);let b=0,E=0,S=0,D=0,P=0,k=0,H=0,G=0;h.sort(Wi);for(let K=0,Q=h.length;K<Q;K++){const V=h[K],ge=V.color,Z=V.intensity,xe=V.distance,we=V.shadow&&V.shadow.map?V.shadow.map.texture:null;if(V.isAmbientLight)p+=ge.r*Z,g+=ge.g*Z,v+=ge.b*Z;else if(V.isLightProbe)for(let be=0;be<9;be++)r.probe[be].addScaledVector(V.sh.coefficients[be],Z);else if(V.isDirectionalLight){const be=t.get(V);if(be.color.copy(V.color).multiplyScalar(V.intensity),V.castShadow){const Me=V.shadow,$e=i.get(V);$e.shadowBias=Me.bias,$e.shadowNormalBias=Me.normalBias,$e.shadowRadius=Me.radius,$e.shadowMapSize=Me.mapSize,r.directionalShadow[b]=$e,r.directionalShadowMap[b]=we,r.directionalShadowMatrix[b]=V.shadow.matrix,k++}r.directional[b]=be,b++}else if(V.isSpotLight){const be=t.get(V);if(be.position.setFromMatrixPosition(V.matrixWorld),be.color.copy(ge).multiplyScalar(Z),be.distance=xe,be.coneCos=Math.cos(V.angle),be.penumbraCos=Math.cos(V.angle*(1-V.penumbra)),be.decay=V.decay,V.castShadow){const Me=V.shadow,$e=i.get(V);$e.shadowBias=Me.bias,$e.shadowNormalBias=Me.normalBias,$e.shadowRadius=Me.radius,$e.shadowMapSize=Me.mapSize,r.spotShadow[S]=$e,r.spotShadowMap[S]=we,r.spotShadowMatrix[S]=V.shadow.matrix,G++}r.spot[S]=be,S++}else if(V.isRectAreaLight){const be=t.get(V);be.color.copy(ge).multiplyScalar(Z),be.halfWidth.set(.5*V.width,0,0),be.halfHeight.set(0,.5*V.height,0),r.rectArea[D]=be,D++}else if(V.isPointLight){const be=t.get(V);if(be.color.copy(V.color).multiplyScalar(V.intensity),be.distance=V.distance,be.decay=V.decay,V.castShadow){const Me=V.shadow,$e=i.get(V);$e.shadowBias=Me.bias,$e.shadowNormalBias=Me.normalBias,$e.shadowRadius=Me.radius,$e.shadowMapSize=Me.mapSize,$e.shadowCameraNear=Me.camera.near,$e.shadowCameraFar=Me.camera.far,r.pointShadow[E]=$e,r.pointShadowMap[E]=we,r.pointShadowMatrix[E]=V.shadow.matrix,H++}r.point[E]=be,E++}else if(V.isHemisphereLight){const be=t.get(V);be.skyColor.copy(V.color).multiplyScalar(Z),be.groundColor.copy(V.groundColor).multiplyScalar(Z),r.hemi[P]=be,P++}}D>0&&(e.isWebGL2||n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=Et.LTC_FLOAT_1,r.rectAreaLTC2=Et.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=Et.LTC_HALF_1,r.rectAreaLTC2=Et.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=p,r.ambient[1]=g,r.ambient[2]=v;const W=r.hash;W.directionalLength===b&&W.pointLength===E&&W.spotLength===S&&W.rectAreaLength===D&&W.hemiLength===P&&W.numDirectionalShadows===k&&W.numPointShadows===H&&W.numSpotShadows===G||(r.directional.length=b,r.spot.length=S,r.rectArea.length=D,r.point.length=E,r.hemi.length=P,r.directionalShadow.length=k,r.directionalShadowMap.length=k,r.pointShadow.length=H,r.pointShadowMap.length=H,r.spotShadow.length=G,r.spotShadowMap.length=G,r.directionalShadowMatrix.length=k,r.pointShadowMatrix.length=H,r.spotShadowMatrix.length=G,W.directionalLength=b,W.pointLength=E,W.spotLength=S,W.rectAreaLength=D,W.hemiLength=P,W.numDirectionalShadows=k,W.numPointShadows=H,W.numSpotShadows=G,r.version=Kv++)},setupView:function(h,p){let g=0,v=0,b=0,E=0,S=0;const D=p.matrixWorldInverse;for(let P=0,k=h.length;P<k;P++){const H=h[P];if(H.isDirectionalLight){const G=r.directional[g];G.direction.setFromMatrixPosition(H.matrixWorld),a.setFromMatrixPosition(H.target.matrixWorld),G.direction.sub(a),G.direction.transformDirection(D),g++}else if(H.isSpotLight){const G=r.spot[b];G.position.setFromMatrixPosition(H.matrixWorld),G.position.applyMatrix4(D),G.direction.setFromMatrixPosition(H.matrixWorld),a.setFromMatrixPosition(H.target.matrixWorld),G.direction.sub(a),G.direction.transformDirection(D),b++}else if(H.isRectAreaLight){const G=r.rectArea[E];G.position.setFromMatrixPosition(H.matrixWorld),G.position.applyMatrix4(D),l.identity(),u.copy(H.matrixWorld),u.premultiply(D),l.extractRotation(u),G.halfWidth.set(.5*H.width,0,0),G.halfHeight.set(0,.5*H.height,0),G.halfWidth.applyMatrix4(l),G.halfHeight.applyMatrix4(l),E++}else if(H.isPointLight){const G=r.point[v];G.position.setFromMatrixPosition(H.matrixWorld),G.position.applyMatrix4(D),v++}else if(H.isHemisphereLight){const G=r.hemi[S];G.direction.setFromMatrixPosition(H.matrixWorld),G.direction.transformDirection(D),G.direction.normalize(),S++}}},state:r}}function $o(n,e){const t=new Eu(n,e),i=[],r=[];return{init:function(){i.length=0,r.length=0},state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:function(){t.setup(i)},setupLightsView:function(a){t.setupView(i,a)},pushLight:function(a){i.push(a)},pushShadow:function(a){r.push(a)}}}function ji(n,e,t){function i(K,Q,V){const ge=K<<0|Q<<1|V<<2;let Z=v[ge];return Z===void 0&&(Z=new Kl({depthPacking:pm,morphTargets:K,skinning:Q}),v[ge]=Z),Z}function r(K,Q,V){const ge=K<<0|Q<<1|V<<2;let Z=b[ge];return Z===void 0&&(Z=new Zl({morphTargets:K,skinning:Q}),b[ge]=Z),Z}function a(K,Q,V,ge,Z,xe,we){let be=null,Me=i,$e=K.customDepthMaterial;if(ge.isPointLight===!0&&(Me=r,$e=K.customDistanceMaterial),$e===void 0){let ct=!1;V.morphTargets===!0&&(ct=Q.morphAttributes&&Q.morphAttributes.position&&Q.morphAttributes.position.length>0);let Wt=!1;K.isSkinnedMesh===!0&&(V.skinning===!0?Wt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",K)),be=Me(ct,Wt,K.isInstancedMesh===!0)}else be=$e;if(n.localClippingEnabled&&V.clipShadows===!0&&V.clippingPlanes.length!==0){const ct=be.uuid,Wt=V.uuid;let dt=E[ct];dt===void 0&&(dt={},E[ct]=dt);let nt=dt[Wt];nt===void 0&&(nt=be.clone(),dt[Wt]=nt),be=nt}return be.visible=V.visible,be.wireframe=V.wireframe,be.side=we===rs?V.shadowSide!==null?V.shadowSide:V.side:V.shadowSide!==null?V.shadowSide:D[V.side],be.clipShadows=V.clipShadows,be.clippingPlanes=V.clippingPlanes,be.clipIntersection=V.clipIntersection,be.wireframeLinewidth=V.wireframeLinewidth,be.linewidth=V.linewidth,ge.isPointLight===!0&&be.isMeshDistanceMaterial===!0&&(be.referencePosition.setFromMatrixPosition(ge.matrixWorld),be.nearDistance=Z,be.farDistance=xe),be}function u(K,Q,V,ge,Z){if(K.visible===!1)return;if(K.layers.test(Q.layers)&&(K.isMesh||K.isLine||K.isPoints)&&(K.castShadow||K.receiveShadow&&Z===rs)&&(!K.frustumCulled||l.intersectsObject(K))){K.modelViewMatrix.multiplyMatrices(V.matrixWorldInverse,K.matrixWorld);const we=e.update(K),be=K.material;if(Array.isArray(be)){const Me=we.groups;for(let $e=0,ct=Me.length;$e<ct;$e++){const Wt=Me[$e],dt=be[Wt.materialIndex];if(dt&&dt.visible){const nt=a(K,we,dt,ge,V.near,V.far,Z);n.renderBufferDirect(V,null,we,nt,K,Wt)}}}else if(be.visible){const Me=a(K,we,be,ge,V.near,V.far,Z);n.renderBufferDirect(V,null,we,Me,K,null)}}const xe=K.children;for(let we=0,be=xe.length;we<be;we++)u(xe[we],Q,V,ge,Z)}let l=new Ma;const h=new Je,p=new Je,g=new Mn,v=[],b=[],E={},S=t.maxTextureSize,D={0:Kn,1:os,2:ca},P=new M({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Je},radius:{value:4}},vertexShader:Jv,fragmentShader:Zv}),k=P.clone();k.defines.HORIZONTAL_PASS=1;const H=new ve;H.setAttribute("position",new N(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const G=new Ge(H,P),W=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Iu,this.render=function(K,Q,V){if(W.enabled===!1||W.autoUpdate===!1&&W.needsUpdate===!1||K.length===0)return;const ge=n.getRenderTarget(),Z=n.getActiveCubeFace(),xe=n.getActiveMipmapLevel(),we=n.state;we.setBlending(wr),we.buffers.color.setClear(1,1,1,1),we.buffers.depth.setTest(!0),we.setScissorTest(!1);for(let be=0,Me=K.length;be<Me;be++){const $e=K[be],ct=$e.shadow;if(ct===void 0){console.warn("THREE.WebGLShadowMap:",$e,"has no shadow.");continue}if(ct.autoUpdate===!1&&ct.needsUpdate===!1)continue;h.copy(ct.mapSize);const Wt=ct.getFrameExtents();if(h.multiply(Wt),p.copy(ct.mapSize),(h.x>S||h.y>S)&&(h.x>S&&(p.x=Math.floor(S/Wt.x),h.x=p.x*Wt.x,ct.mapSize.x=p.x),h.y>S&&(p.y=Math.floor(S/Wt.y),h.y=p.y*Wt.y,ct.mapSize.y=p.y)),ct.map===null&&!ct.isPointLightShadow&&this.type===rs){const nt={minFilter:$n,magFilter:$n,format:Di};ct.map=new Tr(h.x,h.y,nt),ct.map.texture.name=$e.name+".shadowMap",ct.mapPass=new Tr(h.x,h.y,nt),ct.camera.updateProjectionMatrix()}if(ct.map===null){const nt={minFilter:Jn,magFilter:Jn,format:Di};ct.map=new Tr(h.x,h.y,nt),ct.map.texture.name=$e.name+".shadowMap",ct.camera.updateProjectionMatrix()}n.setRenderTarget(ct.map),n.clear();const dt=ct.getViewportCount();for(let nt=0;nt<dt;nt++){const Gt=ct.getViewport(nt);g.set(p.x*Gt.x,p.y*Gt.y,p.x*Gt.z,p.y*Gt.w),we.viewport(g),ct.updateMatrices($e,nt),l=ct.getFrustum(),u(Q,V,ct.camera,$e,this.type)}ct.isPointLightShadow||this.type!==rs||function(nt,Gt){const Ot=e.update(G);P.uniforms.shadow_pass.value=nt.map.texture,P.uniforms.resolution.value=nt.mapSize,P.uniforms.radius.value=nt.radius,n.setRenderTarget(nt.mapPass),n.clear(),n.renderBufferDirect(Gt,null,Ot,P,G,null),k.uniforms.shadow_pass.value=nt.mapPass.texture,k.uniforms.resolution.value=nt.mapSize,k.uniforms.radius.value=nt.radius,n.setRenderTarget(nt.map),n.clear(),n.renderBufferDirect(Gt,null,Ot,k,G,null)}(ct,V),ct.needsUpdate=!1}W.needsUpdate=!1,n.setRenderTarget(ge,Z,xe)}}function Qo(n,e,t,i,r,a,u){function l(oe,re){return Wt?new OffscreenCanvas(oe,re):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function h(oe,re,ot,Ue){let Xe=1;if((oe.width>Ue||oe.height>Ue)&&(Xe=Ue/Math.max(oe.width,oe.height)),Xe<1||re===!0){if(typeof HTMLImageElement<"u"&&oe instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&oe instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&oe instanceof ImageBitmap){const qt=re?Kt.floorPowerOfTwo:Math.floor,We=qt(Xe*oe.width),Ke=qt(Xe*oe.height);ct===void 0&&(ct=l(We,Ke));const ze=ot?l(We,Ke):ct;return ze.width=We,ze.height=Ke,ze.getContext("2d").drawImage(oe,0,0,We,Ke),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+oe.width+"x"+oe.height+") to ("+We+"x"+Ke+")."),ze}return"data"in oe&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+oe.width+"x"+oe.height+")."),oe}return oe}function p(oe){return Kt.isPowerOfTwo(oe.width)&&Kt.isPowerOfTwo(oe.height)}function g(oe,re){return oe.generateMipmaps&&re&&oe.minFilter!==Jn&&oe.minFilter!==$n}function v(oe,re,ot,Ue){n.generateMipmap(oe),i.get(re).__maxMipLevel=Math.log2(Math.max(ot,Ue))}function b(oe,re,ot){if(Z===!1)return re;if(oe!==null){if(n[oe]!==void 0)return n[oe];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+oe+"'")}let Ue=re;return re===n.RED&&(ot===n.FLOAT&&(Ue=n.R32F),ot===n.HALF_FLOAT&&(Ue=n.R16F),ot===n.UNSIGNED_BYTE&&(Ue=n.R8)),re===n.RGB&&(ot===n.FLOAT&&(Ue=n.RGB32F),ot===n.HALF_FLOAT&&(Ue=n.RGB16F),ot===n.UNSIGNED_BYTE&&(Ue=n.RGB8)),re===n.RGBA&&(ot===n.FLOAT&&(Ue=n.RGBA32F),ot===n.HALF_FLOAT&&(Ue=n.RGBA16F),ot===n.UNSIGNED_BYTE&&(Ue=n.RGBA8)),Ue!==n.R16F&&Ue!==n.R32F&&Ue!==n.RGBA16F&&Ue!==n.RGBA32F||e.get("EXT_color_buffer_float"),Ue}function E(oe){return oe===Jn||oe===Sl||oe===Al?n.NEAREST:n.LINEAR}function S(oe){const re=oe.target;re.removeEventListener("dispose",S),function(ot){const Ue=i.get(ot);Ue.__webglInit!==void 0&&(n.deleteTexture(Ue.__webglTexture),i.remove(ot))}(re),re.isVideoTexture&&$e.delete(re),u.memory.textures--}function D(oe){const re=oe.target;re.removeEventListener("dispose",D),function(ot){const Ue=ot.texture,Xe=i.get(ot),qt=i.get(Ue);if(!!ot){if(qt.__webglTexture!==void 0&&n.deleteTexture(qt.__webglTexture),ot.depthTexture&&ot.depthTexture.dispose(),ot.isWebGLCubeRenderTarget)for(let We=0;We<6;We++)n.deleteFramebuffer(Xe.__webglFramebuffer[We]),Xe.__webglDepthbuffer&&n.deleteRenderbuffer(Xe.__webglDepthbuffer[We]);else n.deleteFramebuffer(Xe.__webglFramebuffer),Xe.__webglDepthbuffer&&n.deleteRenderbuffer(Xe.__webglDepthbuffer),Xe.__webglMultisampledFramebuffer&&n.deleteFramebuffer(Xe.__webglMultisampledFramebuffer),Xe.__webglColorRenderbuffer&&n.deleteRenderbuffer(Xe.__webglColorRenderbuffer),Xe.__webglDepthRenderbuffer&&n.deleteRenderbuffer(Xe.__webglDepthRenderbuffer);i.remove(Ue),i.remove(ot)}}(re),u.memory.textures--}function P(oe,re){const ot=i.get(oe);if(oe.isVideoTexture&&function(Ue){const Xe=u.render.frame;$e.get(Ue)!==Xe&&($e.set(Ue,Xe),Ue.update())}(oe),oe.version>0&&ot.__version!==oe.version){const Ue=oe.image;if(Ue===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(Ue.complete!==!1)return void W(ot,oe,re);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}t.activeTexture(n.TEXTURE0+re),t.bindTexture(n.TEXTURE_2D,ot.__webglTexture)}function k(oe,re){const ot=i.get(oe);oe.version>0&&ot.__version!==oe.version?function(Ue,Xe,qt){if(Xe.image.length!==6)return;G(Ue,Xe),t.activeTexture(n.TEXTURE0+qt),t.bindTexture(n.TEXTURE_CUBE_MAP,Ue.__webglTexture),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,Xe.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Xe.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,Xe.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const We=Xe&&(Xe.isCompressedTexture||Xe.image[0].isCompressedTexture),Ke=Xe.image[0]&&Xe.image[0].isDataTexture,ze=[];for(let ie=0;ie<6;ie++)ze[ie]=We||Ke?Ke?Xe.image[ie].image:Xe.image[ie]:h(Xe.image[ie],!1,!0,we);const Ct=ze[0],bt=p(Ct)||Z,Yt=a.convert(Xe.format),Pt=a.convert(Xe.type),nn=b(Xe.internalFormat,Yt,Pt);H(n.TEXTURE_CUBE_MAP,Xe,bt);let Tn;if(We){for(let ie=0;ie<6;ie++){Tn=ze[ie].mipmaps;for(let ln=0;ln<Tn.length;ln++){const gn=Tn[ln];Xe.format!==Di&&Xe.format!==Gr?Yt!==null?t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ie,ln,nn,gn.width,gn.height,0,gn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ie,ln,nn,gn.width,gn.height,0,Yt,Pt,gn.data)}}Ue.__maxMipLevel=Tn.length-1}else{Tn=Xe.mipmaps;for(let ie=0;ie<6;ie++)if(Ke){t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,nn,ze[ie].width,ze[ie].height,0,Yt,Pt,ze[ie].data);for(let ln=0;ln<Tn.length;ln++){const gn=Tn[ln].image[ie].image;t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ie,ln+1,nn,gn.width,gn.height,0,Yt,Pt,gn.data)}}else{t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,nn,Yt,Pt,ze[ie]);for(let ln=0;ln<Tn.length;ln++){const gn=Tn[ln];t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+ie,ln+1,nn,Yt,Pt,gn.image[ie])}}Ue.__maxMipLevel=Tn.length}g(Xe,bt)&&v(n.TEXTURE_CUBE_MAP,Xe,Ct.width,Ct.height),Ue.__version=Xe.version,Xe.onUpdate&&Xe.onUpdate(Xe)}(ot,oe,re):(t.activeTexture(n.TEXTURE0+re),t.bindTexture(n.TEXTURE_CUBE_MAP,ot.__webglTexture))}function H(oe,re,ot){if(ot?(n.texParameteri(oe,n.TEXTURE_WRAP_S,nt[re.wrapS]),n.texParameteri(oe,n.TEXTURE_WRAP_T,nt[re.wrapT]),oe!==n.TEXTURE_3D&&oe!==n.TEXTURE_2D_ARRAY||n.texParameteri(oe,n.TEXTURE_WRAP_R,nt[re.wrapR]),n.texParameteri(oe,n.TEXTURE_MAG_FILTER,Gt[re.magFilter]),n.texParameteri(oe,n.TEXTURE_MIN_FILTER,Gt[re.minFilter])):(n.texParameteri(oe,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(oe,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),oe!==n.TEXTURE_3D&&oe!==n.TEXTURE_2D_ARRAY||n.texParameteri(oe,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),re.wrapS===xi&&re.wrapT===xi||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(oe,n.TEXTURE_MAG_FILTER,E(re.magFilter)),n.texParameteri(oe,n.TEXTURE_MIN_FILTER,E(re.minFilter)),re.minFilter!==Jn&&re.minFilter!==$n&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const Ue=e.get("EXT_texture_filter_anisotropic");if(re.type===Mr&&e.has("OES_texture_float_linear")===!1||Z===!1&&re.type===ya&&e.has("OES_texture_half_float_linear")===!1)return;(re.anisotropy>1||i.get(re).__currentAnisotropy)&&(n.texParameterf(oe,Ue.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(re.anisotropy,r.getMaxAnisotropy())),i.get(re).__currentAnisotropy=re.anisotropy)}}function G(oe,re){oe.__webglInit===void 0&&(oe.__webglInit=!0,re.addEventListener("dispose",S),oe.__webglTexture=n.createTexture(),u.memory.textures++)}function W(oe,re,ot){let Ue=n.TEXTURE_2D;re.isDataTexture2DArray&&(Ue=n.TEXTURE_2D_ARRAY),re.isDataTexture3D&&(Ue=n.TEXTURE_3D),G(oe,re),t.activeTexture(n.TEXTURE0+ot),t.bindTexture(Ue,oe.__webglTexture),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,re.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,re.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,re.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,n.NONE);const Xe=function(Pt){return!Z&&(Pt.wrapS!==xi||Pt.wrapT!==xi||Pt.minFilter!==Jn&&Pt.minFilter!==$n)}(re)&&p(re.image)===!1,qt=h(re.image,Xe,!1,be),We=p(qt)||Z,Ke=a.convert(re.format);let ze=a.convert(re.type),Ct=b(re.internalFormat,Ke,ze);H(Ue,re,We);let bt;const Yt=re.mipmaps;if(re.isDepthTexture)Ct=n.DEPTH_COMPONENT,Z?Ct=re.type===Mr?n.DEPTH_COMPONENT32F:re.type===va?n.DEPTH_COMPONENT24:re.type===us?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT16:re.type===Mr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),re.format===xo&&Ct===n.DEPTH_COMPONENT&&re.type!==ga&&re.type!==va&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),re.type=ga,ze=a.convert(re.type)),re.format===hs&&Ct===n.DEPTH_COMPONENT&&(Ct=n.DEPTH_STENCIL,re.type!==us&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),re.type=us,ze=a.convert(re.type))),t.texImage2D(n.TEXTURE_2D,0,Ct,qt.width,qt.height,0,Ke,ze,null);else if(re.isDataTexture)if(Yt.length>0&&We){for(let Pt=0,nn=Yt.length;Pt<nn;Pt++)bt=Yt[Pt],t.texImage2D(n.TEXTURE_2D,Pt,Ct,bt.width,bt.height,0,Ke,ze,bt.data);re.generateMipmaps=!1,oe.__maxMipLevel=Yt.length-1}else t.texImage2D(n.TEXTURE_2D,0,Ct,qt.width,qt.height,0,Ke,ze,qt.data),oe.__maxMipLevel=0;else if(re.isCompressedTexture){for(let Pt=0,nn=Yt.length;Pt<nn;Pt++)bt=Yt[Pt],re.format!==Di&&re.format!==Gr?Ke!==null?t.compressedTexImage2D(n.TEXTURE_2D,Pt,Ct,bt.width,bt.height,0,bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):t.texImage2D(n.TEXTURE_2D,Pt,Ct,bt.width,bt.height,0,Ke,ze,bt.data);oe.__maxMipLevel=Yt.length-1}else if(re.isDataTexture2DArray)t.texImage3D(n.TEXTURE_2D_ARRAY,0,Ct,qt.width,qt.height,qt.depth,0,Ke,ze,qt.data),oe.__maxMipLevel=0;else if(re.isDataTexture3D)t.texImage3D(n.TEXTURE_3D,0,Ct,qt.width,qt.height,qt.depth,0,Ke,ze,qt.data),oe.__maxMipLevel=0;else if(Yt.length>0&&We){for(let Pt=0,nn=Yt.length;Pt<nn;Pt++)bt=Yt[Pt],t.texImage2D(n.TEXTURE_2D,Pt,Ct,Ke,ze,bt);re.generateMipmaps=!1,oe.__maxMipLevel=Yt.length-1}else t.texImage2D(n.TEXTURE_2D,0,Ct,Ke,ze,qt),oe.__maxMipLevel=0;g(re,We)&&v(Ue,re,qt.width,qt.height),oe.__version=re.version,re.onUpdate&&re.onUpdate(re)}function K(oe,re,ot,Ue){const Xe=re.texture,qt=a.convert(Xe.format),We=a.convert(Xe.type),Ke=b(Xe.internalFormat,qt,We);Ue===n.TEXTURE_3D||Ue===n.TEXTURE_2D_ARRAY?t.texImage3D(Ue,0,Ke,re.width,re.height,re.depth,0,qt,We,null):t.texImage2D(Ue,0,Ke,re.width,re.height,0,qt,We,null),t.bindFramebuffer(n.FRAMEBUFFER,oe),n.framebufferTexture2D(n.FRAMEBUFFER,ot,Ue,i.get(Xe).__webglTexture,0),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Q(oe,re,ot){if(n.bindRenderbuffer(n.RENDERBUFFER,oe),re.depthBuffer&&!re.stencilBuffer){let Ue=n.DEPTH_COMPONENT16;if(ot){const Xe=re.depthTexture;Xe&&Xe.isDepthTexture&&(Xe.type===Mr?Ue=n.DEPTH_COMPONENT32F:Xe.type===va&&(Ue=n.DEPTH_COMPONENT24));const qt=ge(re);n.renderbufferStorageMultisample(n.RENDERBUFFER,qt,Ue,re.width,re.height)}else n.renderbufferStorage(n.RENDERBUFFER,Ue,re.width,re.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,oe)}else if(re.depthBuffer&&re.stencilBuffer){if(ot){const Ue=ge(re);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ue,n.DEPTH24_STENCIL8,re.width,re.height)}else n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,re.width,re.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,oe)}else{const Ue=re.texture,Xe=a.convert(Ue.format),qt=a.convert(Ue.type),We=b(Ue.internalFormat,Xe,qt);if(ot){const Ke=ge(re);n.renderbufferStorageMultisample(n.RENDERBUFFER,Ke,We,re.width,re.height)}else n.renderbufferStorage(n.RENDERBUFFER,We,re.width,re.height)}n.bindRenderbuffer(n.RENDERBUFFER,null)}function V(oe){const re=i.get(oe),ot=oe.isWebGLCubeRenderTarget===!0;if(oe.depthTexture){if(ot)throw new Error("target.depthTexture not supported in Cube render targets");(function(Ue,Xe){if(Xe&&Xe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,Ue),!Xe.depthTexture||!Xe.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");i.get(Xe.depthTexture).__webglTexture&&Xe.depthTexture.image.width===Xe.width&&Xe.depthTexture.image.height===Xe.height||(Xe.depthTexture.image.width=Xe.width,Xe.depthTexture.image.height=Xe.height,Xe.depthTexture.needsUpdate=!0),P(Xe.depthTexture,0);const qt=i.get(Xe.depthTexture).__webglTexture;if(Xe.depthTexture.format===xo)n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,qt,0);else{if(Xe.depthTexture.format!==hs)throw new Error("Unknown depthTexture format");n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,qt,0)}})(re.__webglFramebuffer,oe)}else if(ot){re.__webglDepthbuffer=[];for(let Ue=0;Ue<6;Ue++)t.bindFramebuffer(n.FRAMEBUFFER,re.__webglFramebuffer[Ue]),re.__webglDepthbuffer[Ue]=n.createRenderbuffer(),Q(re.__webglDepthbuffer[Ue],oe,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,re.__webglFramebuffer),re.__webglDepthbuffer=n.createRenderbuffer(),Q(re.__webglDepthbuffer,oe,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function ge(oe){return Z&&oe.isWebGLMultisampleRenderTarget?Math.min(Me,oe.samples):0}const Z=r.isWebGL2,xe=r.maxTextures,we=r.maxCubemapSize,be=r.maxTextureSize,Me=r.maxSamples,$e=new WeakMap;let ct,Wt=!1;try{Wt=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}let dt=0;const nt={[fa]:n.REPEAT,[xi]:n.CLAMP_TO_EDGE,[ma]:n.MIRRORED_REPEAT},Gt={[Jn]:n.NEAREST,[Sl]:n.NEAREST_MIPMAP_NEAREST,[Al]:n.NEAREST_MIPMAP_LINEAR,[$n]:n.LINEAR,[Gu]:n.LINEAR_MIPMAP_NEAREST,[ls]:n.LINEAR_MIPMAP_LINEAR};let Ot=!1,cn=!1;this.allocateTextureUnit=function(){const oe=dt;return oe>=xe&&console.warn("THREE.WebGLTextures: Trying to use "+oe+" texture units while this GPU supports only "+xe),dt+=1,oe},this.resetTextureUnits=function(){dt=0},this.setTexture2D=P,this.setTexture2DArray=function(oe,re){const ot=i.get(oe);oe.version>0&&ot.__version!==oe.version?W(ot,oe,re):(t.activeTexture(n.TEXTURE0+re),t.bindTexture(n.TEXTURE_2D_ARRAY,ot.__webglTexture))},this.setTexture3D=function(oe,re){const ot=i.get(oe);oe.version>0&&ot.__version!==oe.version?W(ot,oe,re):(t.activeTexture(n.TEXTURE0+re),t.bindTexture(n.TEXTURE_3D,ot.__webglTexture))},this.setTextureCube=k,this.setupRenderTarget=function(oe){const re=oe.texture,ot=i.get(oe),Ue=i.get(re);oe.addEventListener("dispose",D),Ue.__webglTexture=n.createTexture(),Ue.__version=re.version,u.memory.textures++;const Xe=oe.isWebGLCubeRenderTarget===!0,qt=oe.isWebGLMultisampleRenderTarget===!0,We=re.isDataTexture3D||re.isDataTexture2DArray,Ke=p(oe)||Z;if(!Z||re.format!==Gr||re.type!==Mr&&re.type!==ya||(re.format=Di,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Xe){ot.__webglFramebuffer=[];for(let ze=0;ze<6;ze++)ot.__webglFramebuffer[ze]=n.createFramebuffer()}else if(ot.__webglFramebuffer=n.createFramebuffer(),qt)if(Z){ot.__webglMultisampledFramebuffer=n.createFramebuffer(),ot.__webglColorRenderbuffer=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,ot.__webglColorRenderbuffer);const ze=a.convert(re.format),Ct=a.convert(re.type),bt=b(re.internalFormat,ze,Ct),Yt=ge(oe);n.renderbufferStorageMultisample(n.RENDERBUFFER,Yt,bt,oe.width,oe.height),t.bindFramebuffer(n.FRAMEBUFFER,ot.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,ot.__webglColorRenderbuffer),n.bindRenderbuffer(n.RENDERBUFFER,null),oe.depthBuffer&&(ot.__webglDepthRenderbuffer=n.createRenderbuffer(),Q(ot.__webglDepthRenderbuffer,oe,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Xe){t.bindTexture(n.TEXTURE_CUBE_MAP,Ue.__webglTexture),H(n.TEXTURE_CUBE_MAP,re,Ke);for(let ze=0;ze<6;ze++)K(ot.__webglFramebuffer[ze],oe,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ze);g(re,Ke)&&v(n.TEXTURE_CUBE_MAP,re,oe.width,oe.height),t.bindTexture(n.TEXTURE_CUBE_MAP,null)}else{let ze=n.TEXTURE_2D;We&&(Z?ze=re.isDataTexture3D?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),t.bindTexture(ze,Ue.__webglTexture),H(ze,re,Ke),K(ot.__webglFramebuffer,oe,n.COLOR_ATTACHMENT0,ze),g(re,Ke)&&v(n.TEXTURE_2D,re,oe.width,oe.height),t.bindTexture(n.TEXTURE_2D,null)}oe.depthBuffer&&V(oe)},this.updateRenderTargetMipmap=function(oe){const re=oe.texture;if(g(re,p(oe)||Z)){const ot=oe.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Ue=i.get(re).__webglTexture;t.bindTexture(ot,Ue),v(ot,re,oe.width,oe.height),t.bindTexture(ot,null)}},this.updateMultisampleRenderTarget=function(oe){if(oe.isWebGLMultisampleRenderTarget)if(Z){const re=i.get(oe);t.bindFramebuffer(n.READ_FRAMEBUFFER,re.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,re.__webglFramebuffer);const ot=oe.width,Ue=oe.height;let Xe=n.COLOR_BUFFER_BIT;oe.depthBuffer&&(Xe|=n.DEPTH_BUFFER_BIT),oe.stencilBuffer&&(Xe|=n.STENCIL_BUFFER_BIT),n.blitFramebuffer(0,0,ot,Ue,0,0,ot,Ue,Xe,n.NEAREST),t.bindFramebuffer(n.FRAMEBUFFER,re.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(oe,re){oe&&oe.isWebGLRenderTarget&&(Ot===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ot=!0),oe=oe.texture),P(oe,re)},this.safeSetTextureCube=function(oe,re){oe&&oe.isWebGLCubeRenderTarget&&(cn===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),cn=!0),oe=oe.texture),k(oe,re)}}function ta(n,e,t){const i=t.isWebGL2;return{convert:function(r){let a;if(r===cs)return n.UNSIGNED_BYTE;if(r===wf)return n.UNSIGNED_SHORT_4_4_4_4;if(r===Mf)return n.UNSIGNED_SHORT_5_5_5_1;if(r===Tf)return n.UNSIGNED_SHORT_5_6_5;if(r===_f)return n.BYTE;if(r===bf)return n.SHORT;if(r===ga)return n.UNSIGNED_SHORT;if(r===Ef)return n.INT;if(r===va)return n.UNSIGNED_INT;if(r===Mr)return n.FLOAT;if(r===ya)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"))!==null?a.HALF_FLOAT_OES:null;if(r===Sf)return n.ALPHA;if(r===Gr)return n.RGB;if(r===Di)return n.RGBA;if(r===Af)return n.LUMINANCE;if(r===Rf)return n.LUMINANCE_ALPHA;if(r===xo)return n.DEPTH_COMPONENT;if(r===hs)return n.DEPTH_STENCIL;if(r===Lf)return n.RED;if(r===Pf)return n.RED_INTEGER;if(r===Df)return n.RG;if(r===Nf)return n.RG_INTEGER;if(r===If)return n.RGB_INTEGER;if(r===Of)return n.RGBA_INTEGER;if(r===Vu||r===Wu||r===ju||r===Xu){if((a=e.get("WEBGL_compressed_texture_s3tc"))===null)return null;if(r===Vu)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(r===Wu)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(r===ju)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(r===Xu)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(r===qu||r===Yu||r===Ku||r===Zu){if((a=e.get("WEBGL_compressed_texture_pvrtc"))===null)return null;if(r===qu)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(r===Yu)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(r===Ku)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(r===Zu)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(r===kf)return(a=e.get("WEBGL_compressed_texture_etc1"))!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if((r===Ju||r===$u)&&(a=e.get("WEBGL_compressed_texture_etc"))!==null){if(r===Ju)return a.COMPRESSED_RGB8_ETC2;if(r===$u)return a.COMPRESSED_RGBA8_ETC2_EAC}return r===Ff||r===Hf||r===Bf||r===Uf||r===zf||r===Gf||r===Vf||r===Wf||r===jf||r===Xf||r===qf||r===Yf||r===Kf||r===Zf||r===$f||r===Qf||r===em||r===tm||r===nm||r===im||r===rm||r===om||r===sm||r===am||r===lm||r===cm||r===um||r===hm?(a=e.get("WEBGL_compressed_texture_astc"))!==null?r:null:r===Jf?(a=e.get("EXT_texture_compression_bptc"))!==null?r:null:r===us?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"))!==null?a.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function ur(){this._targetRay=null,this._grip=null,this._hand=null}function Xi(n,e){function t(Z){const xe=S.get(Z.inputSource);xe&&xe.dispatchEvent({type:Z.type,data:Z.inputSource})}function i(){S.forEach(function(Z,xe){Z.disconnect(xe)}),S.clear(),G=null,W=null,l.bindXRFramebuffer(null),n.setRenderTarget(n.getRenderTarget()),ge.stop(),u.isPresenting=!1,u.dispatchEvent({type:"sessionend"})}function r(Z){const xe=h.inputSources;for(let we=0;we<E.length;we++)S.set(xe[we],E[we]);for(let we=0;we<Z.removed.length;we++){const be=Z.removed[we],Me=S.get(be);Me&&(Me.dispatchEvent({type:"disconnected",data:be}),S.delete(be))}for(let we=0;we<Z.added.length;we++){const be=Z.added[we],Me=S.get(be);Me&&Me.dispatchEvent({type:"connected",data:be})}}function a(Z,xe){xe===null?Z.matrixWorld.copy(Z.matrix):Z.matrixWorld.multiplyMatrices(xe.matrixWorld,Z.matrix),Z.matrixWorldInverse.copy(Z.matrixWorld).invert()}const u=this,l=n.state;let h=null,p=1,g=null,v="local-floor",b=null;const E=[],S=new Map,D=new O;D.layers.enable(1),D.viewport=new Mn;const P=new O;P.layers.enable(2),P.viewport=new Mn;const k=[D,P],H=new Sh;H.layers.enable(1),H.layers.enable(2);let G=null,W=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(Z){let xe=E[Z];return xe===void 0&&(xe=new ur,E[Z]=xe),xe.getTargetRaySpace()},this.getControllerGrip=function(Z){let xe=E[Z];return xe===void 0&&(xe=new ur,E[Z]=xe),xe.getGripSpace()},this.getHand=function(Z){let xe=E[Z];return xe===void 0&&(xe=new ur,E[Z]=xe),xe.getHandSpace()},this.setFramebufferScaleFactor=function(Z){p=Z,u.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Z){v=Z,u.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return g},this.getSession=function(){return h},this.setSession=async function(Z){if((h=Z)!==null){h.addEventListener("select",t),h.addEventListener("selectstart",t),h.addEventListener("selectend",t),h.addEventListener("squeeze",t),h.addEventListener("squeezestart",t),h.addEventListener("squeezeend",t),h.addEventListener("end",i),h.addEventListener("inputsourceschange",r);const xe=e.getContextAttributes();xe.xrCompatible!==!0&&await e.makeXRCompatible();const we={antialias:xe.antialias,alpha:xe.alpha,depth:xe.depth,stencil:xe.stencil,framebufferScaleFactor:p},be=new XRWebGLLayer(h,e,we);h.updateRenderState({baseLayer:be}),g=await h.requestReferenceSpace(v),ge.setContext(h),ge.start(),u.isPresenting=!0,u.dispatchEvent({type:"sessionstart"})}};const K=new U,Q=new U;this.getCamera=function(Z){H.near=P.near=D.near=Z.near,H.far=P.far=D.far=Z.far,G===H.near&&W===H.far||(h.updateRenderState({depthNear:H.near,depthFar:H.far}),G=H.near,W=H.far);const xe=Z.parent,we=H.cameras;a(H,xe);for(let Me=0;Me<we.length;Me++)a(we[Me],xe);Z.matrixWorld.copy(H.matrixWorld),Z.matrix.copy(H.matrix),Z.matrix.decompose(Z.position,Z.quaternion,Z.scale);const be=Z.children;for(let Me=0,$e=be.length;Me<$e;Me++)be[Me].updateMatrixWorld(!0);return we.length===2?function(Me,$e,ct){K.setFromMatrixPosition($e.matrixWorld),Q.setFromMatrixPosition(ct.matrixWorld);const Wt=K.distanceTo(Q),dt=$e.projectionMatrix.elements,nt=ct.projectionMatrix.elements,Gt=dt[14]/(dt[10]-1),Ot=dt[14]/(dt[10]+1),cn=(dt[9]+1)/dt[5],oe=(dt[9]-1)/dt[5],re=(dt[8]-1)/dt[0],ot=(nt[8]+1)/nt[0],Ue=Gt*re,Xe=Gt*ot,qt=Wt/(-re+ot),We=qt*-re;$e.matrixWorld.decompose(Me.position,Me.quaternion,Me.scale),Me.translateX(We),Me.translateZ(qt),Me.matrixWorld.compose(Me.position,Me.quaternion,Me.scale),Me.matrixWorldInverse.copy(Me.matrixWorld).invert();const Ke=Gt+qt,ze=Ot+qt,Ct=Ue-We,bt=Xe+(Wt-We),Yt=cn*Ot/ze*Ke,Pt=oe*Ot/ze*Ke;Me.projectionMatrix.makePerspective(Ct,bt,Yt,Pt,Ke,ze)}(H,D,P):H.projectionMatrix.copy(D.projectionMatrix),H};let V=null;const ge=new A;ge.setAnimationLoop(function(Z,xe){if((b=xe.getViewerPose(g))!==null){const be=b.views,Me=h.renderState.baseLayer;l.bindXRFramebuffer(Me.framebuffer);let $e=!1;be.length!==H.cameras.length&&(H.cameras.length=0,$e=!0);for(let ct=0;ct<be.length;ct++){const Wt=be[ct],dt=Me.getViewport(Wt),nt=k[ct];nt.matrix.fromArray(Wt.transform.matrix),nt.projectionMatrix.fromArray(Wt.projectionMatrix),nt.viewport.set(dt.x,dt.y,dt.width,dt.height),ct===0&&H.matrix.copy(nt.matrix),$e===!0&&H.cameras.push(nt)}}const we=h.inputSources;for(let be=0;be<E.length;be++){const Me=E[be],$e=we[be];Me.update($e,xe,g)}V&&V(Z,xe)}),this.setAnimationLoop=function(Z){V=Z},this.dispose=function(){}}function es(n){function e(i,r){i.opacity.value=r.opacity,r.color&&i.diffuse.value.copy(r.color),r.emissive&&i.emissive.value.copy(r.emissive).multiplyScalar(r.emissiveIntensity),r.map&&(i.map.value=r.map),r.alphaMap&&(i.alphaMap.value=r.alphaMap),r.specularMap&&(i.specularMap.value=r.specularMap);const a=n.get(r).envMap;if(a){i.envMap.value=a,i.flipEnvMap.value=a.isCubeTexture&&a._needsFlipEnvMap?-1:1,i.reflectivity.value=r.reflectivity,i.refractionRatio.value=r.refractionRatio;const h=n.get(a).__maxMipLevel;h!==void 0&&(i.maxMipLevel.value=h)}r.lightMap&&(i.lightMap.value=r.lightMap,i.lightMapIntensity.value=r.lightMapIntensity),r.aoMap&&(i.aoMap.value=r.aoMap,i.aoMapIntensity.value=r.aoMapIntensity);let u;r.map?u=r.map:r.specularMap?u=r.specularMap:r.displacementMap?u=r.displacementMap:r.normalMap?u=r.normalMap:r.bumpMap?u=r.bumpMap:r.roughnessMap?u=r.roughnessMap:r.metalnessMap?u=r.metalnessMap:r.alphaMap?u=r.alphaMap:r.emissiveMap?u=r.emissiveMap:r.clearcoatMap?u=r.clearcoatMap:r.clearcoatNormalMap?u=r.clearcoatNormalMap:r.clearcoatRoughnessMap&&(u=r.clearcoatRoughnessMap),u!==void 0&&(u.isWebGLRenderTarget&&(u=u.texture),u.matrixAutoUpdate===!0&&u.updateMatrix(),i.uvTransform.value.copy(u.matrix));let l;r.aoMap?l=r.aoMap:r.lightMap&&(l=r.lightMap),l!==void 0&&(l.isWebGLRenderTarget&&(l=l.texture),l.matrixAutoUpdate===!0&&l.updateMatrix(),i.uv2Transform.value.copy(l.matrix))}function t(i,r){i.roughness.value=r.roughness,i.metalness.value=r.metalness,r.roughnessMap&&(i.roughnessMap.value=r.roughnessMap),r.metalnessMap&&(i.metalnessMap.value=r.metalnessMap),r.emissiveMap&&(i.emissiveMap.value=r.emissiveMap),r.bumpMap&&(i.bumpMap.value=r.bumpMap,i.bumpScale.value=r.bumpScale,r.side===Kn&&(i.bumpScale.value*=-1)),r.normalMap&&(i.normalMap.value=r.normalMap,i.normalScale.value.copy(r.normalScale),r.side===Kn&&i.normalScale.value.negate()),r.displacementMap&&(i.displacementMap.value=r.displacementMap,i.displacementScale.value=r.displacementScale,i.displacementBias.value=r.displacementBias),n.get(r).envMap&&(i.envMapIntensity.value=r.envMapIntensity)}return{refreshFogUniforms:function(i,r){i.fogColor.value.copy(r.color),r.isFog?(i.fogNear.value=r.near,i.fogFar.value=r.far):r.isFogExp2&&(i.fogDensity.value=r.density)},refreshMaterialUniforms:function(i,r,a,u){r.isMeshBasicMaterial?e(i,r):r.isMeshLambertMaterial?(e(i,r),function(l,h){h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap)}(i,r)):r.isMeshToonMaterial?(e(i,r),function(l,h){h.gradientMap&&(l.gradientMap.value=h.gradientMap),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===Kn&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===Kn&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(i,r)):r.isMeshPhongMaterial?(e(i,r),function(l,h){l.specular.value.copy(h.specular),l.shininess.value=Math.max(h.shininess,1e-4),h.emissiveMap&&(l.emissiveMap.value=h.emissiveMap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===Kn&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===Kn&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(i,r)):r.isMeshStandardMaterial?(e(i,r),r.isMeshPhysicalMaterial?function(l,h){t(l,h),l.reflectivity.value=h.reflectivity,l.clearcoat.value=h.clearcoat,l.clearcoatRoughness.value=h.clearcoatRoughness,h.sheen&&l.sheen.value.copy(h.sheen),h.clearcoatMap&&(l.clearcoatMap.value=h.clearcoatMap),h.clearcoatRoughnessMap&&(l.clearcoatRoughnessMap.value=h.clearcoatRoughnessMap),h.clearcoatNormalMap&&(l.clearcoatNormalScale.value.copy(h.clearcoatNormalScale),l.clearcoatNormalMap.value=h.clearcoatNormalMap,h.side===Kn&&l.clearcoatNormalScale.value.negate()),l.transmission.value=h.transmission,h.transmissionMap&&(l.transmissionMap.value=h.transmissionMap)}(i,r):t(i,r)):r.isMeshMatcapMaterial?(e(i,r),function(l,h){h.matcap&&(l.matcap.value=h.matcap),h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===Kn&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===Kn&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(i,r)):r.isMeshDepthMaterial?(e(i,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(i,r)):r.isMeshDistanceMaterial?(e(i,r),function(l,h){h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias),l.referencePosition.value.copy(h.referencePosition),l.nearDistance.value=h.nearDistance,l.farDistance.value=h.farDistance}(i,r)):r.isMeshNormalMaterial?(e(i,r),function(l,h){h.bumpMap&&(l.bumpMap.value=h.bumpMap,l.bumpScale.value=h.bumpScale,h.side===Kn&&(l.bumpScale.value*=-1)),h.normalMap&&(l.normalMap.value=h.normalMap,l.normalScale.value.copy(h.normalScale),h.side===Kn&&l.normalScale.value.negate()),h.displacementMap&&(l.displacementMap.value=h.displacementMap,l.displacementScale.value=h.displacementScale,l.displacementBias.value=h.displacementBias)}(i,r)):r.isLineBasicMaterial?(function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity}(i,r),r.isLineDashedMaterial&&function(l,h){l.dashSize.value=h.dashSize,l.totalSize.value=h.dashSize+h.gapSize,l.scale.value=h.scale}(i,r)):r.isPointsMaterial?function(l,h,p,g){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.size.value=h.size*p,l.scale.value=.5*g,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let v;h.map?v=h.map:h.alphaMap&&(v=h.alphaMap),v!==void 0&&(v.matrixAutoUpdate===!0&&v.updateMatrix(),l.uvTransform.value.copy(v.matrix))}(i,r,a,u):r.isSpriteMaterial?function(l,h){l.diffuse.value.copy(h.color),l.opacity.value=h.opacity,l.rotation.value=h.rotation,h.map&&(l.map.value=h.map),h.alphaMap&&(l.alphaMap.value=h.alphaMap);let p;h.map?p=h.map:h.alphaMap&&(p=h.alphaMap),p!==void 0&&(p.matrixAutoUpdate===!0&&p.updateMatrix(),l.uvTransform.value.copy(p.matrix))}(i,r):r.isShadowMaterial?(i.color.value.copy(r.color),i.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function xn(n){function e(){return dt===null?Ue:1}function t(w,le){for(let te=0;te<w.length;te++){const me=w[te],_e=D.getContext(me,le);if(_e!==null)return _e}return null}function i(){ln=new function(w){function le(me){if(te[me]!==void 0)return te[me];let _e;switch(me){case"WEBGL_depth_texture":_e=w.getExtension("WEBGL_depth_texture")||w.getExtension("MOZ_WEBGL_depth_texture")||w.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_e=w.getExtension("EXT_texture_filter_anisotropic")||w.getExtension("MOZ_EXT_texture_filter_anisotropic")||w.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_e=w.getExtension("WEBGL_compressed_texture_s3tc")||w.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_e=w.getExtension("WEBGL_compressed_texture_pvrtc")||w.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:_e=w.getExtension(me)}return te[me]=_e,_e}const te={};return{has:function(me){return le(me)!==null},init:function(me){me.isWebGL2?le("EXT_color_buffer_float"):(le("WEBGL_depth_texture"),le("OES_texture_float"),le("OES_texture_half_float"),le("OES_texture_half_float_linear"),le("OES_standard_derivatives"),le("OES_element_index_uint"),le("OES_vertex_array_object"),le("ANGLE_instanced_arrays")),le("OES_texture_float_linear"),le("EXT_color_buffer_half_float")},get:function(me){const _e=le(me);return _e===null&&console.warn("THREE.WebGLRenderer: "+me+" extension not supported."),_e}}}(ie),gn=new function(w,le,te){function me(on){if(on==="highp"){if(w.getShaderPrecisionFormat(w.VERTEX_SHADER,w.HIGH_FLOAT).precision>0&&w.getShaderPrecisionFormat(w.FRAGMENT_SHADER,w.HIGH_FLOAT).precision>0)return"highp";on="mediump"}return on==="mediump"&&w.getShaderPrecisionFormat(w.VERTEX_SHADER,w.MEDIUM_FLOAT).precision>0&&w.getShaderPrecisionFormat(w.FRAGMENT_SHADER,w.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let _e;const He=typeof WebGL2RenderingContext<"u"&&w instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&w instanceof WebGL2ComputeRenderingContext;let Qe=te.precision!==void 0?te.precision:"highp";const at=me(Qe);at!==Qe&&(console.warn("THREE.WebGLRenderer:",Qe,"not supported, using",at,"instead."),Qe=at);const st=te.logarithmicDepthBuffer===!0,je=w.getParameter(w.MAX_TEXTURE_IMAGE_UNITS),vt=w.getParameter(w.MAX_VERTEX_TEXTURE_IMAGE_UNITS),ft=w.getParameter(w.MAX_TEXTURE_SIZE),Ut=w.getParameter(w.MAX_CUBE_MAP_TEXTURE_SIZE),Jt=w.getParameter(w.MAX_VERTEX_ATTRIBS),jt=w.getParameter(w.MAX_VERTEX_UNIFORM_VECTORS),Lt=w.getParameter(w.MAX_VARYING_VECTORS),Ft=w.getParameter(w.MAX_FRAGMENT_UNIFORM_VECTORS),Ht=vt>0,Vt=He||le.has("OES_texture_float");return{isWebGL2:He,getMaxAnisotropy:function(){if(_e!==void 0)return _e;if(le.has("EXT_texture_filter_anisotropic")===!0){const on=le.get("EXT_texture_filter_anisotropic");_e=w.getParameter(on.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else _e=0;return _e},getMaxPrecision:me,precision:Qe,logarithmicDepthBuffer:st,maxTextures:je,maxVertexTextures:vt,maxTextureSize:ft,maxCubemapSize:Ut,maxAttributes:Jt,maxVertexUniforms:jt,maxVaryings:Lt,maxFragmentUniforms:Ft,vertexTextures:Ht,floatFragmentTextures:Vt,floatVertexTextures:Ht&&Vt,maxSamples:He?w.getParameter(w.MAX_SAMPLES):0}}(ie,ln,n),ln.init(gn),nr=new ta(ie,ln,gn),dn=new function(w,le,te){function me(Pe,vn,yn){const jn=new Uint8Array(4),sn=w.createTexture();w.bindTexture(Pe,sn),w.texParameteri(Pe,w.TEXTURE_MIN_FILTER,w.NEAREST),w.texParameteri(Pe,w.TEXTURE_MAG_FILTER,w.NEAREST);for(let pi=0;pi<yn;pi++)w.texImage2D(vn+pi,0,w.RGBA,1,1,0,w.RGBA,w.UNSIGNED_BYTE,jn);return sn}function _e(Pe){Lt[Pe]!==!0&&(w.enable(Pe),Lt[Pe]=!0)}function He(Pe){Lt[Pe]!==!1&&(w.disable(Pe),Lt[Pe]=!1)}function Qe(Pe,vn,yn,jn,sn,pi,Oi,ki){if(Pe!==wr){if(on===!1&&(_e(w.BLEND),on=!0),Pe===qp)sn=sn||vn,pi=pi||yn,Oi=Oi||jn,vn===Wn&&sn===ja||(w.blendEquationSeparate(Fs[vn],Fs[sn]),Wn=vn,ja=sn),yn===ro&&jn===Fc&&pi===Hc&&Oi===Bc||(w.blendFuncSeparate(Wc[yn],Wc[jn],Wc[pi],Wc[Oi]),ro=yn,Fc=jn,Hc=pi,Bc=Oi),mn=Pe,Uc=null;else if(Pe!==mn||ki!==Uc){if(Wn===vo&&ja===vo||(w.blendEquation(w.FUNC_ADD),Wn=vo,ja=vo),ki)switch(Pe){case ss:w.blendFuncSeparate(w.ONE,w.ONE_MINUS_SRC_ALPHA,w.ONE,w.ONE_MINUS_SRC_ALPHA);break;case Ou:w.blendFunc(w.ONE,w.ONE);break;case ku:w.blendFuncSeparate(w.ZERO,w.ZERO,w.ONE_MINUS_SRC_COLOR,w.ONE_MINUS_SRC_ALPHA);break;case Fu:w.blendFuncSeparate(w.ZERO,w.SRC_COLOR,w.ZERO,w.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Pe)}else switch(Pe){case ss:w.blendFuncSeparate(w.SRC_ALPHA,w.ONE_MINUS_SRC_ALPHA,w.ONE,w.ONE_MINUS_SRC_ALPHA);break;case Ou:w.blendFunc(w.SRC_ALPHA,w.ONE);break;case ku:w.blendFunc(w.ZERO,w.ONE_MINUS_SRC_COLOR);break;case Fu:w.blendFunc(w.ZERO,w.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Pe)}ro=null,Fc=null,Hc=null,Bc=null,mn=Pe,Uc=ki}}else on===!0&&(He(w.BLEND),on=!1)}function at(Pe){vd!==Pe&&(Pe?w.frontFace(w.CW):w.frontFace(w.CCW),vd=Pe)}function st(Pe){Pe!==Wp?(_e(w.CULL_FACE),Pe!==yd&&(Pe===Nu?w.cullFace(w.BACK):Pe===jp?w.cullFace(w.FRONT):w.cullFace(w.FRONT_AND_BACK))):He(w.CULL_FACE),yd=Pe}function je(Pe,vn,yn){Pe?(_e(w.POLYGON_OFFSET_FILL),_d===vn&&bd===yn||(w.polygonOffset(vn,yn),_d=vn,bd=yn)):He(w.POLYGON_OFFSET_FILL)}function vt(Pe){Pe===void 0&&(Pe=w.TEXTURE0+Hy-1),Uo!==Pe&&(w.activeTexture(Pe),Uo=Pe)}const ft=te.isWebGL2,Ut=new function(){let Pe=!1;const vn=new Mn;let yn=null;const jn=new Mn(0,0,0,0);return{setMask:function(sn){yn===sn||Pe||(w.colorMask(sn,sn,sn,sn),yn=sn)},setLocked:function(sn){Pe=sn},setClear:function(sn,pi,Oi,ki,Xa){Xa===!0&&(sn*=ki,pi*=ki,Oi*=ki),vn.set(sn,pi,Oi,ki),jn.equals(vn)===!1&&(w.clearColor(sn,pi,Oi,ki),jn.copy(vn))},reset:function(){Pe=!1,yn=null,jn.set(-1,0,0,0)}}},Jt=new function(){let Pe=!1,vn=null,yn=null,jn=null;return{setTest:function(sn){sn?_e(w.DEPTH_TEST):He(w.DEPTH_TEST)},setMask:function(sn){vn===sn||Pe||(w.depthMask(sn),vn=sn)},setFunc:function(sn){if(yn!==sn){if(sn)switch(sn){case sf:w.depthFunc(w.NEVER);break;case af:w.depthFunc(w.ALWAYS);break;case lf:w.depthFunc(w.LESS);break;case wl:w.depthFunc(w.LEQUAL);break;case cf:w.depthFunc(w.EQUAL);break;case uf:w.depthFunc(w.GEQUAL);break;case hf:w.depthFunc(w.GREATER);break;case df:w.depthFunc(w.NOTEQUAL);break;default:w.depthFunc(w.LEQUAL)}else w.depthFunc(w.LEQUAL);yn=sn}},setLocked:function(sn){Pe=sn},setClear:function(sn){jn!==sn&&(w.clearDepth(sn),jn=sn)},reset:function(){Pe=!1,vn=null,yn=null,jn=null}}},jt=new function(){let Pe=!1,vn=null,yn=null,jn=null,sn=null,pi=null,Oi=null,ki=null,Xa=null;return{setTest:function(ti){Pe||(ti?_e(w.STENCIL_TEST):He(w.STENCIL_TEST))},setMask:function(ti){vn===ti||Pe||(w.stencilMask(ti),vn=ti)},setFunc:function(ti,zo,Go){yn===ti&&jn===zo&&sn===Go||(w.stencilFunc(ti,zo,Go),yn=ti,jn=zo,sn=Go)},setOp:function(ti,zo,Go){pi===ti&&Oi===zo&&ki===Go||(w.stencilOp(ti,zo,Go),pi=ti,Oi=zo,ki=Go)},setLocked:function(ti){Pe=ti},setClear:function(ti){Xa!==ti&&(w.clearStencil(ti),Xa=ti)},reset:function(){Pe=!1,vn=null,yn=null,jn=null,sn=null,pi=null,Oi=null,ki=null,Xa=null}}};let Lt={},Ft=null,Ht={},Vt=null,on=!1,mn=null,Wn=null,ro=null,Fc=null,ja=null,Hc=null,Bc=null,Uc=!1,vd=null,yd=null,xd=null,_d=null,bd=null;const Hy=w.getParameter(w.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Ed=!1,zc=0;const Gc=w.getParameter(w.VERSION);Gc.indexOf("WebGL")!==-1?(zc=parseFloat(/^WebGL (\d)/.exec(Gc)[1]),Ed=zc>=1):Gc.indexOf("OpenGL ES")!==-1&&(zc=parseFloat(/^OpenGL ES (\d)/.exec(Gc)[1]),Ed=zc>=2);let Uo=null,Vc={};const wd=new Mn(0,0,w.canvas.width,w.canvas.height),Md=new Mn(0,0,w.canvas.width,w.canvas.height),Td={};Td[w.TEXTURE_2D]=me(w.TEXTURE_2D,w.TEXTURE_2D,1),Td[w.TEXTURE_CUBE_MAP]=me(w.TEXTURE_CUBE_MAP,w.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ut.setClear(0,0,0,1),Jt.setClear(1),jt.setClear(0),_e(w.DEPTH_TEST),Jt.setFunc(wl),at(!1),st(Nu),_e(w.CULL_FACE),Qe(wr);const Fs={[vo]:w.FUNC_ADD,[Yp]:w.FUNC_SUBTRACT,[Kp]:w.FUNC_REVERSE_SUBTRACT};if(ft)Fs[Hu]=w.MIN,Fs[Bu]=w.MAX;else{const Pe=le.get("EXT_blend_minmax");Pe!==null&&(Fs[Hu]=Pe.MIN_EXT,Fs[Bu]=Pe.MAX_EXT)}const Wc={[Zp]:w.ZERO,[Jp]:w.ONE,[$p]:w.SRC_COLOR,[Uu]:w.SRC_ALPHA,[of]:w.SRC_ALPHA_SATURATE,[nf]:w.DST_COLOR,[ef]:w.DST_ALPHA,[Qp]:w.ONE_MINUS_SRC_COLOR,[zu]:w.ONE_MINUS_SRC_ALPHA,[rf]:w.ONE_MINUS_DST_COLOR,[tf]:w.ONE_MINUS_DST_ALPHA};return{buffers:{color:Ut,depth:Jt,stencil:jt},enable:_e,disable:He,bindFramebuffer:function(Pe,vn){vn===null&&Ft!==null&&(vn=Ft),Ht[Pe]!==vn&&(w.bindFramebuffer(Pe,vn),Ht[Pe]=vn)},bindXRFramebuffer:function(Pe){Pe!==Ft&&(w.bindFramebuffer(w.FRAMEBUFFER,Pe),Ft=Pe)},useProgram:function(Pe){return Vt!==Pe&&(w.useProgram(Pe),Vt=Pe,!0)},setBlending:Qe,setMaterial:function(Pe,vn){Pe.side===ca?He(w.CULL_FACE):_e(w.CULL_FACE);let yn=Pe.side===Kn;vn&&(yn=!yn),at(yn),Pe.blending===ss&&Pe.transparent===!1?Qe(wr):Qe(Pe.blending,Pe.blendEquation,Pe.blendSrc,Pe.blendDst,Pe.blendEquationAlpha,Pe.blendSrcAlpha,Pe.blendDstAlpha,Pe.premultipliedAlpha),Jt.setFunc(Pe.depthFunc),Jt.setTest(Pe.depthTest),Jt.setMask(Pe.depthWrite),Ut.setMask(Pe.colorWrite);const jn=Pe.stencilWrite;jt.setTest(jn),jn&&(jt.setMask(Pe.stencilWriteMask),jt.setFunc(Pe.stencilFunc,Pe.stencilRef,Pe.stencilFuncMask),jt.setOp(Pe.stencilFail,Pe.stencilZFail,Pe.stencilZPass)),je(Pe.polygonOffset,Pe.polygonOffsetFactor,Pe.polygonOffsetUnits),Pe.alphaToCoverage===!0?_e(w.SAMPLE_ALPHA_TO_COVERAGE):He(w.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:at,setCullFace:st,setLineWidth:function(Pe){Pe!==xd&&(Ed&&w.lineWidth(Pe),xd=Pe)},setPolygonOffset:je,setScissorTest:function(Pe){Pe?_e(w.SCISSOR_TEST):He(w.SCISSOR_TEST)},activeTexture:vt,bindTexture:function(Pe,vn){Uo===null&&vt();let yn=Vc[Uo];yn===void 0&&(yn={type:void 0,texture:void 0},Vc[Uo]=yn),yn.type===Pe&&yn.texture===vn||(w.bindTexture(Pe,vn||Td[Pe]),yn.type=Pe,yn.texture=vn)},unbindTexture:function(){const Pe=Vc[Uo];Pe!==void 0&&Pe.type!==void 0&&(w.bindTexture(Pe.type,null),Pe.type=void 0,Pe.texture=void 0)},compressedTexImage2D:function(){try{w.compressedTexImage2D.apply(w,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},texImage2D:function(){try{w.texImage2D.apply(w,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},texImage3D:function(){try{w.texImage3D.apply(w,arguments)}catch(Pe){console.error("THREE.WebGLState:",Pe)}},scissor:function(Pe){wd.equals(Pe)===!1&&(w.scissor(Pe.x,Pe.y,Pe.z,Pe.w),wd.copy(Pe))},viewport:function(Pe){Md.equals(Pe)===!1&&(w.viewport(Pe.x,Pe.y,Pe.z,Pe.w),Md.copy(Pe))},reset:function(){w.disable(w.BLEND),w.disable(w.CULL_FACE),w.disable(w.DEPTH_TEST),w.disable(w.POLYGON_OFFSET_FILL),w.disable(w.SCISSOR_TEST),w.disable(w.STENCIL_TEST),w.disable(w.SAMPLE_ALPHA_TO_COVERAGE),w.blendEquation(w.FUNC_ADD),w.blendFunc(w.ONE,w.ZERO),w.blendFuncSeparate(w.ONE,w.ZERO,w.ONE,w.ZERO),w.colorMask(!0,!0,!0,!0),w.clearColor(0,0,0,0),w.depthMask(!0),w.depthFunc(w.LESS),w.clearDepth(1),w.stencilMask(4294967295),w.stencilFunc(w.ALWAYS,0,4294967295),w.stencilOp(w.KEEP,w.KEEP,w.KEEP),w.clearStencil(0),w.cullFace(w.BACK),w.frontFace(w.CCW),w.polygonOffset(0,0),w.activeTexture(w.TEXTURE0),w.bindFramebuffer(w.FRAMEBUFFER,null),ft===!0&&(w.bindFramebuffer(w.DRAW_FRAMEBUFFER,null),w.bindFramebuffer(w.READ_FRAMEBUFFER,null)),w.useProgram(null),w.lineWidth(1),w.scissor(0,0,w.canvas.width,w.canvas.height),w.viewport(0,0,w.canvas.width,w.canvas.height),Lt={},Uo=null,Vc={},Ft=null,Ht={},Vt=null,on=!1,mn=null,Wn=null,ro=null,Fc=null,ja=null,Hc=null,Bc=null,Uc=!1,vd=null,yd=null,xd=null,_d=null,bd=null,wd.set(0,0,w.canvas.width,w.canvas.height),Md.set(0,0,w.canvas.width,w.canvas.height),Ut.reset(),Jt.reset(),jt.reset()}}}(ie,ln,gn),Zn=new function(w){const le={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:le,programs:null,autoReset:!0,reset:function(){le.frame++,le.calls=0,le.triangles=0,le.points=0,le.lines=0},update:function(te,me,_e){switch(le.calls++,me){case w.TRIANGLES:le.triangles+=_e*(te/3);break;case w.LINES:le.lines+=_e*(te/2);break;case w.LINE_STRIP:le.lines+=_e*(te-1);break;case w.LINE_LOOP:le.lines+=_e*te;break;case w.POINTS:le.points+=_e*te;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",me)}}}}(ie),Sn=new function(){let w=new WeakMap;return{get:function(le){let te=w.get(le);return te===void 0&&(te={},w.set(le,te)),te},remove:function(le){w.delete(le)},update:function(le,te,me){w.get(le)[te]=me},dispose:function(){w=new WeakMap}}},mi=new Qo(ie,ln,dn,Sn,gn,nr,Zn),Ir=new function(w){function le(_e,He){return He===Ml?_e.mapping=ha:He===Tl&&(_e.mapping=da),_e}function te(_e){const He=_e.target;He.removeEventListener("dispose",te);const Qe=me.get(He);Qe!==void 0&&(me.delete(He),Qe.dispose())}let me=new WeakMap;return{get:function(_e){if(_e&&_e.isTexture){const He=_e.mapping;if(He===Ml||He===Tl){if(me.has(_e))return le(me.get(_e).texture,_e.mapping);{const Qe=_e.image;if(Qe&&Qe.height>0){const at=w.getRenderTarget(),st=new ql(Qe.height/2);return st.fromEquirectangularTexture(w,_e),me.set(_e,st),w.setRenderTarget(at),_e.addEventListener("dispose",te),le(st.texture,_e.mapping)}return null}}}return _e},dispose:function(){me=new WeakMap}}}(Me),no=new T(ie,gn),Ti=new F(ie,ln,no,gn),fd=new function(w,le,te,me){function _e(st){const je=st.target;je.index!==null&&le.remove(je.index);for(const ft in je.attributes)le.remove(je.attributes[ft]);je.removeEventListener("dispose",_e),delete Qe[je.id];const vt=at.get(je);vt&&(le.remove(vt),at.delete(je)),me.releaseStatesOfGeometry(je),je.isInstancedBufferGeometry===!0&&delete je._maxInstanceCount,te.memory.geometries--}function He(st){const je=[],vt=st.index,ft=st.attributes.position;let Ut=0;if(vt!==null){const Lt=vt.array;Ut=vt.version;for(let Ft=0,Ht=Lt.length;Ft<Ht;Ft+=3){const Vt=Lt[Ft+0],on=Lt[Ft+1],mn=Lt[Ft+2];je.push(Vt,on,on,mn,mn,Vt)}}else{const Lt=ft.array;Ut=ft.version;for(let Ft=0,Ht=Lt.length/3-1;Ft<Ht;Ft+=3){const Vt=Ft+0,on=Ft+1,mn=Ft+2;je.push(Vt,on,on,mn,mn,Vt)}}const Jt=new(De(je)>65535?Ye:ce)(je,1);Jt.version=Ut;const jt=at.get(st);jt&&le.remove(jt),at.set(st,Jt)}const Qe={},at=new WeakMap;return{get:function(st,je){return Qe[je.id]===!0||(je.addEventListener("dispose",_e),Qe[je.id]=!0,te.memory.geometries++),je},update:function(st){const je=st.attributes;for(const ft in je)le.update(je[ft],w.ARRAY_BUFFER);const vt=st.morphAttributes;for(const ft in vt){const Ut=vt[ft];for(let Jt=0,jt=Ut.length;Jt<jt;Jt++)le.update(Ut[Jt],w.ARRAY_BUFFER)}},getWireframeAttribute:function(st){const je=at.get(st);if(je){const vt=st.index;vt!==null&&je.version<vt.version&&He(st)}else He(st);return at.get(st)}}}(ie,no,Zn,Ti),ks=new function(w,le,te,me){function _e(Qe){const at=Qe.target;at.removeEventListener("dispose",_e),te.remove(at.instanceMatrix),at.instanceColor!==null&&te.remove(at.instanceColor)}let He=new WeakMap;return{update:function(Qe){const at=me.render.frame,st=Qe.geometry,je=le.get(Qe,st);return He.get(je)!==at&&(le.update(je),He.set(je,at)),Qe.isInstancedMesh&&(Qe.hasEventListener("dispose",_e)===!1&&Qe.addEventListener("dispose",_e),te.update(Qe.instanceMatrix,w.ARRAY_BUFFER),Qe.instanceColor!==null&&te.update(Qe.instanceColor,w.ARRAY_BUFFER)),je},dispose:function(){He=new WeakMap}}}(ie,fd,no,Zn),Qg=new function(w){const le={},te=new Float32Array(8),me=[];for(let _e=0;_e<8;_e++)me[_e]=[_e,0];return{update:function(_e,He,Qe,at){const st=_e.morphTargetInfluences,je=st===void 0?0:st.length;let vt=le[He.id];if(vt===void 0){vt=[];for(let Lt=0;Lt<je;Lt++)vt[Lt]=[Lt,0];le[He.id]=vt}for(let Lt=0;Lt<je;Lt++){const Ft=vt[Lt];Ft[0]=Lt,Ft[1]=st[Lt]}vt.sort(j);for(let Lt=0;Lt<8;Lt++)Lt<je&&vt[Lt][1]?(me[Lt][0]=vt[Lt][0],me[Lt][1]=vt[Lt][1]):(me[Lt][0]=Number.MAX_SAFE_INTEGER,me[Lt][1]=0);me.sort(z);const ft=Qe.morphTargets&&He.morphAttributes.position,Ut=Qe.morphNormals&&He.morphAttributes.normal;let Jt=0;for(let Lt=0;Lt<8;Lt++){const Ft=me[Lt],Ht=Ft[0],Vt=Ft[1];Ht!==Number.MAX_SAFE_INTEGER&&Vt?(ft&&He.getAttribute("morphTarget"+Lt)!==ft[Ht]&&He.setAttribute("morphTarget"+Lt,ft[Ht]),Ut&&He.getAttribute("morphNormal"+Lt)!==Ut[Ht]&&He.setAttribute("morphNormal"+Lt,Ut[Ht]),te[Lt]=Vt,Jt+=Vt):(ft&&He.hasAttribute("morphTarget"+Lt)===!0&&He.deleteAttribute("morphTarget"+Lt),Ut&&He.hasAttribute("morphNormal"+Lt)===!0&&He.deleteAttribute("morphNormal"+Lt),te[Lt]=0)}const jt=He.morphTargetsRelative?1:1-Jt;at.getUniforms().setValue(w,"morphTargetBaseInfluence",jt),at.getUniforms().setValue(w,"morphTargetInfluences",te)}}}(ie),Or=new function(w){function le(){vt.value!==_e&&(vt.value=_e,vt.needsUpdate=He>0),me.numPlanes=He,me.numIntersection=0}function te(ft,Ut,Jt,jt){const Lt=ft!==null?ft.length:0;let Ft=null;if(Lt!==0){if(Ft=vt.value,jt!==!0||Ft===null){const Ht=Jt+4*Lt,Vt=Ut.matrixWorldInverse;je.getNormalMatrix(Vt),(Ft===null||Ft.length<Ht)&&(Ft=new Float32Array(Ht));for(let on=0,mn=Jt;on!==Lt;++on,mn+=4)st.copy(ft[on]).applyMatrix4(Vt,je),st.normal.toArray(Ft,mn),Ft[mn+3]=st.constant}vt.value=Ft,vt.needsUpdate=!0}return me.numPlanes=Lt,me.numIntersection=0,Ft}const me=this;let _e=null,He=0,Qe=!1,at=!1;const st=new Yi,je=new Qn,vt={value:null,needsUpdate:!1};this.uniform=vt,this.numPlanes=0,this.numIntersection=0,this.init=function(ft,Ut,Jt){const jt=ft.length!==0||Ut||He!==0||Qe;return Qe=Ut,_e=te(ft,Jt,0),He=ft.length,jt},this.beginShadows=function(){at=!0,te(null)},this.endShadows=function(){at=!1,le()},this.setState=function(ft,Ut,Jt){const jt=ft.clippingPlanes,Lt=ft.clipIntersection,Ft=ft.clipShadows,Ht=w.get(ft);if(!Qe||jt===null||jt.length===0||at&&!Ft)at?te(null):le();else{const Vt=at?0:He,on=4*Vt;let mn=Ht.clippingState||null;vt.value=mn,mn=te(jt,Ut,on,Jt);for(let Wn=0;Wn!==on;++Wn)mn[Wn]=_e[Wn];Ht.clippingState=mn,this.numIntersection=Lt?this.numPlanes:0,this.numPlanes+=Vt}}}(Sn),Ho=new hi(Me,Ir,ln,gn,Ti,Or),md=new es(Sn),Oc=new function(w){let le=new WeakMap;return{get:function(te,me){let _e;return le.has(te)===!1?(_e=new Hi(w),le.set(te,[_e])):me>=le.get(te).length?(_e=new Hi(w),le.get(te).push(_e)):_e=le.get(te)[me],_e},dispose:function(){le=new WeakMap}}}(Sn),kc=new function(w,le){let te=new WeakMap;return{get:function(me,_e=0){let He;return te.has(me)===!1?(He=new $o(w,le),te.set(me,[He])):_e>=te.get(me).length?(He=new $o(w,le),te.get(me).push(He)):He=te.get(me)[_e],He},dispose:function(){te=new WeakMap}}}(ln,gn),io=new function(w,le,te,me,_e){function He(Jt,jt){te.buffers.color.setClear(Jt.r,Jt.g,Jt.b,jt,_e)}const Qe=new Rt(0);let at,st,je=0,vt=null,ft=0,Ut=null;return{getClearColor:function(){return Qe},setClearColor:function(Jt,jt=1){Qe.set(Jt),He(Qe,je=jt)},getClearAlpha:function(){return je},setClearAlpha:function(Jt){He(Qe,je=Jt)},render:function(Jt,jt,Lt,Ft){let Ht=jt.isScene===!0?jt.background:null;Ht&&Ht.isTexture&&(Ht=le.get(Ht));const Vt=w.xr,on=Vt.getSession&&Vt.getSession();on&&on.environmentBlendMode==="additive"&&(Ht=null),Ht===null?He(Qe,je):Ht&&Ht.isColor&&(He(Ht,1),Ft=!0),(w.autoClear||Ft)&&w.clear(w.autoClearColor,w.autoClearDepth,w.autoClearStencil),Ht&&(Ht.isCubeTexture||Ht.mapping===as)?(st===void 0&&((st=new Ge(new So(1,1,1),new M({name:"BackgroundCubeMaterial",uniforms:xt(Ji.cube.uniforms),vertexShader:Ji.cube.vertexShader,fragmentShader:Ji.cube.fragmentShader,side:Kn,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),st.geometry.deleteAttribute("uv"),st.onBeforeRender=function(mn,Wn,ro){this.matrixWorld.copyPosition(ro.matrixWorld)},Object.defineProperty(st.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),me.update(st)),st.material.uniforms.envMap.value=Ht,st.material.uniforms.flipEnvMap.value=Ht.isCubeTexture&&Ht._needsFlipEnvMap?-1:1,vt===Ht&&ft===Ht.version&&Ut===w.toneMapping||(st.material.needsUpdate=!0,vt=Ht,ft=Ht.version,Ut=w.toneMapping),Jt.unshift(st,st.geometry,st.material,0,0,null)):Ht&&Ht.isTexture&&(at===void 0&&((at=new Ge(new Ta(2,2),new M({name:"BackgroundMaterial",uniforms:xt(Ji.background.uniforms),vertexShader:Ji.background.vertexShader,fragmentShader:Ji.background.fragmentShader,side:os,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(at.material,"map",{get:function(){return this.uniforms.t2D.value}}),me.update(at)),at.material.uniforms.t2D.value=Ht,Ht.matrixAutoUpdate===!0&&Ht.updateMatrix(),at.material.uniforms.uvTransform.value.copy(Ht.matrix),vt===Ht&&ft===Ht.version&&Ut===w.toneMapping||(at.material.needsUpdate=!0,vt=Ht,ft=Ht.version,Ut=w.toneMapping),Jt.unshift(at,at.geometry,at.material,0,0,null))}}}(Me,Ir,dn,ks,K),tr=new ji(Me,ks,gn),e0=new function(w,le,te,me){const _e=me.isWebGL2;let He;this.setMode=function(Qe){He=Qe},this.render=function(Qe,at){w.drawArrays(He,Qe,at),te.update(at,He,1)},this.renderInstances=function(Qe,at,st){if(st===0)return;let je,vt;if(_e)je=w,vt="drawArraysInstanced";else if(je=le.get("ANGLE_instanced_arrays"),vt="drawArraysInstancedANGLE",je===null)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");je[vt](He,Qe,at,st),te.update(at,He,st)}}(ie,ln,Zn,gn),t0=new function(w,le,te,me){const _e=me.isWebGL2;let He,Qe,at;this.setMode=function(st){He=st},this.setIndex=function(st){Qe=st.type,at=st.bytesPerElement},this.render=function(st,je){w.drawElements(He,je,Qe,st*at),te.update(je,He,1)},this.renderInstances=function(st,je,vt){if(vt===0)return;let ft,Ut;if(_e)ft=w,Ut="drawElementsInstanced";else if(ft=le.get("ANGLE_instanced_arrays"),Ut="drawElementsInstancedANGLE",ft===null)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ft[Ut](He,je,Qe,st*at,vt),te.update(je,He,vt)}}(ie,ln,Zn,gn),Zn.programs=Ho.programs,Me.capabilities=gn,Me.extensions=ln,Me.properties=Sn,Me.renderLists=Oc,Me.shadowMap=tr,Me.state=dn,Me.info=Zn}function r(w){w.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),$e=!0}function a(){console.log("THREE.WebGLRenderer: Context Restored."),$e=!1;const w=Zn.autoReset,le=tr.enabled,te=tr.autoUpdate,me=tr.needsUpdate,_e=tr.type;i(),Zn.autoReset=w,tr.enabled=le,tr.autoUpdate=te,tr.needsUpdate=me,tr.type=_e}function u(w){const le=w.target;le.removeEventListener("dispose",u),function(te){(function(me){const _e=Sn.get(me).programs;_e!==void 0&&_e.forEach(function(He){Ho.releaseProgram(He)})})(te),Sn.remove(te)}(le)}function l(){Bo.stop()}function h(){Bo.start()}function p(w,le,te,me){if(w.visible===!1)return;if(w.layers.test(le.layers)){if(w.isGroup)te=w.renderOrder;else if(w.isLOD)w.autoUpdate===!0&&w.update(le);else if(w.isLight)xe.pushLight(w),w.castShadow&&xe.pushShadow(w);else if(w.isSprite){if(!w.frustumCulled||Ct.intersectsSprite(w)){me&&nn.setFromMatrixPosition(w.matrixWorld).applyMatrix4(Pt);const He=ks.update(w),Qe=w.material;Qe.visible&&Z.push(w,He,Qe,te,nn.z,null)}}else if(w.isImmediateRenderObject)me&&nn.setFromMatrixPosition(w.matrixWorld).applyMatrix4(Pt),Z.push(w,null,w.material,te,nn.z,null);else if((w.isMesh||w.isLine||w.isPoints)&&(w.isSkinnedMesh&&w.skeleton.frame!==Zn.render.frame&&(w.skeleton.update(),w.skeleton.frame=Zn.render.frame),!w.frustumCulled||Ct.intersectsObject(w))){me&&nn.setFromMatrixPosition(w.matrixWorld).applyMatrix4(Pt);const He=ks.update(w),Qe=w.material;if(Array.isArray(Qe)){const at=He.groups;for(let st=0,je=at.length;st<je;st++){const vt=at[st],ft=Qe[vt.materialIndex];ft&&ft.visible&&Z.push(w,He,ft,te,nn.z,vt)}}else Qe.visible&&Z.push(w,He,Qe,te,nn.z,null)}}const _e=w.children;for(let He=0,Qe=_e.length;He<Qe;He++)p(_e[He],le,te,me)}function g(w,le,te){const me=le.isScene===!0?le.overrideMaterial:null;for(let _e=0,He=w.length;_e<He;_e++){const Qe=w[_e],at=Qe.object,st=Qe.geometry,je=me===null?Qe.material:me,vt=Qe.group;if(te.isArrayCamera){const ft=te.cameras;for(let Ut=0,Jt=ft.length;Ut<Jt;Ut++){const jt=ft[Ut];at.layers.test(jt.layers)&&(dn.viewport(Ot.copy(jt.viewport)),xe.setupLightsView(jt),v(at,le,jt,st,je,vt))}}else v(at,le,te,st,je,vt)}}function v(w,le,te,me,_e,He){if(w.onBeforeRender(Me,le,te,me,_e,He),w.modelViewMatrix.multiplyMatrices(te.matrixWorldInverse,w.matrixWorld),w.normalMatrix.getNormalMatrix(w.modelViewMatrix),w.isImmediateRenderObject){const Qe=S(te,le,_e,w);dn.setMaterial(_e),Ti.reset(),function(at,st){at.render(function(je){Me.renderBufferImmediate(je,st)})}(w,Qe)}else Me.renderBufferDirect(te,le,me,_e,w,He);w.onAfterRender(Me,le,te,me,_e,He)}function b(w,le,te){le.isScene!==!0&&(le=Tn);const me=Sn.get(w),_e=xe.state.lights,He=xe.state.shadowsArray,Qe=_e.state.version,at=Ho.getParameters(w,_e.state,He,le,te),st=Ho.getProgramCacheKey(at);let je=me.programs;me.environment=w.isMeshStandardMaterial?le.environment:null,me.fog=le.fog,me.envMap=Ir.get(w.envMap||me.environment),je===void 0&&(w.addEventListener("dispose",u),je=new Map,me.programs=je);let vt=je.get(st);if(vt!==void 0){if(me.currentProgram===vt&&me.lightsStateVersion===Qe)return E(w,at),vt}else at.uniforms=Ho.getUniforms(w),w.onBeforeCompile(at,Me),vt=Ho.acquireProgram(at,st),je.set(st,vt),me.uniforms=at.uniforms;const ft=me.uniforms;(w.isShaderMaterial||w.isRawShaderMaterial)&&w.clipping!==!0||(ft.clippingPlanes=Or.uniform),E(w,at),me.needsLights=function(jt){return jt.isMeshLambertMaterial||jt.isMeshToonMaterial||jt.isMeshPhongMaterial||jt.isMeshStandardMaterial||jt.isShadowMaterial||jt.isShaderMaterial&&jt.lights===!0}(w),me.lightsStateVersion=Qe,me.needsLights&&(ft.ambientLightColor.value=_e.state.ambient,ft.lightProbe.value=_e.state.probe,ft.directionalLights.value=_e.state.directional,ft.directionalLightShadows.value=_e.state.directionalShadow,ft.spotLights.value=_e.state.spot,ft.spotLightShadows.value=_e.state.spotShadow,ft.rectAreaLights.value=_e.state.rectArea,ft.ltc_1.value=_e.state.rectAreaLTC1,ft.ltc_2.value=_e.state.rectAreaLTC2,ft.pointLights.value=_e.state.point,ft.pointLightShadows.value=_e.state.pointShadow,ft.hemisphereLights.value=_e.state.hemi,ft.directionalShadowMap.value=_e.state.directionalShadowMap,ft.directionalShadowMatrix.value=_e.state.directionalShadowMatrix,ft.spotShadowMap.value=_e.state.spotShadowMap,ft.spotShadowMatrix.value=_e.state.spotShadowMatrix,ft.pointShadowMap.value=_e.state.pointShadowMap,ft.pointShadowMatrix.value=_e.state.pointShadowMatrix);const Ut=vt.getUniforms(),Jt=pt.seqWithValue(Ut.seq,ft);return me.currentProgram=vt,me.uniformsList=Jt,vt}function E(w,le){const te=Sn.get(w);te.outputEncoding=le.outputEncoding,te.instancing=le.instancing,te.numClippingPlanes=le.numClippingPlanes,te.numIntersection=le.numClipIntersection,te.vertexAlphas=le.vertexAlphas}function S(w,le,te,me){le.isScene!==!0&&(le=Tn),mi.resetTextureUnits();const _e=le.fog,He=te.isMeshStandardMaterial?le.environment:null,Qe=dt===null?Me.outputEncoding:dt.texture.encoding,at=Ir.get(te.envMap||He),st=te.vertexColors===!0&&me.geometry.attributes.color&&me.geometry.attributes.color.itemSize===4,je=Sn.get(te),vt=xe.state.lights;if(bt===!0&&(Yt===!0||w!==Gt)){const Vt=w===Gt&&te.id===nt;Or.setState(te,w,Vt)}let ft=!1;te.version===je.__version?je.needsLights&&je.lightsStateVersion!==vt.state.version||je.outputEncoding!==Qe||me.isInstancedMesh&&je.instancing===!1?ft=!0:me.isInstancedMesh||je.instancing!==!0?je.envMap!==at||te.fog&&je.fog!==_e?ft=!0:je.numClippingPlanes===void 0||je.numClippingPlanes===Or.numPlanes&&je.numIntersection===Or.numIntersection?je.vertexAlphas!==st&&(ft=!0):ft=!0:ft=!0:(ft=!0,je.__version=te.version);let Ut=je.currentProgram;ft===!0&&(Ut=b(te,le,me));let Jt=!1,jt=!1,Lt=!1;const Ft=Ut.getUniforms(),Ht=je.uniforms;if(dn.useProgram(Ut.program)&&(Jt=!0,jt=!0,Lt=!0),te.id!==nt&&(nt=te.id,jt=!0),Jt||Gt!==w){if(Ft.setValue(ie,"projectionMatrix",w.projectionMatrix),gn.logarithmicDepthBuffer&&Ft.setValue(ie,"logDepthBufFC",2/(Math.log(w.far+1)/Math.LN2)),Gt!==w&&(Gt=w,jt=!0,Lt=!0),te.isShaderMaterial||te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshStandardMaterial||te.envMap){const Vt=Ft.map.cameraPosition;Vt!==void 0&&Vt.setValue(ie,nn.setFromMatrixPosition(w.matrixWorld))}(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial)&&Ft.setValue(ie,"isOrthographic",w.isOrthographicCamera===!0),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial||te.isShadowMaterial||te.skinning)&&Ft.setValue(ie,"viewMatrix",w.matrixWorldInverse)}if(te.skinning){Ft.setOptional(ie,me,"bindMatrix"),Ft.setOptional(ie,me,"bindMatrixInverse");const Vt=me.skeleton;if(Vt){const on=Vt.bones;if(gn.floatVertexTextures){if(Vt.boneTexture===null){let mn=Math.sqrt(4*on.length);mn=Kt.ceilPowerOfTwo(mn),mn=Math.max(mn,4);const Wn=new Float32Array(mn*mn*4);Wn.set(Vt.boneMatrices);const ro=new Ms(Wn,mn,mn,Di,Mr);Vt.boneMatrices=Wn,Vt.boneTexture=ro,Vt.boneTextureSize=mn}Ft.setValue(ie,"boneTexture",Vt.boneTexture,mi),Ft.setValue(ie,"boneTextureSize",Vt.boneTextureSize)}else Ft.setOptional(ie,Vt,"boneMatrices")}}return(jt||je.receiveShadow!==me.receiveShadow)&&(je.receiveShadow=me.receiveShadow,Ft.setValue(ie,"receiveShadow",me.receiveShadow)),jt&&(Ft.setValue(ie,"toneMappingExposure",Me.toneMappingExposure),je.needsLights&&function(Vt,on){Vt.ambientLightColor.needsUpdate=on,Vt.lightProbe.needsUpdate=on,Vt.directionalLights.needsUpdate=on,Vt.directionalLightShadows.needsUpdate=on,Vt.pointLights.needsUpdate=on,Vt.pointLightShadows.needsUpdate=on,Vt.spotLights.needsUpdate=on,Vt.spotLightShadows.needsUpdate=on,Vt.rectAreaLights.needsUpdate=on,Vt.hemisphereLights.needsUpdate=on}(Ht,Lt),_e&&te.fog&&md.refreshFogUniforms(Ht,_e),md.refreshMaterialUniforms(Ht,te,Ue,ot),pt.upload(ie,je.uniformsList,Ht,mi)),te.isShaderMaterial&&te.uniformsNeedUpdate===!0&&(pt.upload(ie,je.uniformsList,Ht,mi),te.uniformsNeedUpdate=!1),te.isSpriteMaterial&&Ft.setValue(ie,"center",me.center),Ft.setValue(ie,"modelViewMatrix",me.modelViewMatrix),Ft.setValue(ie,"normalMatrix",me.normalMatrix),Ft.setValue(ie,"modelMatrix",me.matrixWorld),Ut}const D=(n=n||{}).canvas!==void 0?n.canvas:function(){const w=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return w.style.display="block",w}(),P=n.context!==void 0?n.context:null,k=n.alpha!==void 0&&n.alpha,H=n.depth===void 0||n.depth,G=n.stencil===void 0||n.stencil,W=n.antialias!==void 0&&n.antialias,K=n.premultipliedAlpha===void 0||n.premultipliedAlpha,Q=n.preserveDrawingBuffer!==void 0&&n.preserveDrawingBuffer,V=n.powerPreference!==void 0?n.powerPreference:"default",ge=n.failIfMajorPerformanceCaveat!==void 0&&n.failIfMajorPerformanceCaveat;let Z=null,xe=null;const we=[],be=[];this.domElement=D,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=_i,this.physicallyCorrectLights=!1,this.toneMapping=yo,this.toneMappingExposure=1;const Me=this;let $e=!1,ct=0,Wt=0,dt=null,nt=-1,Gt=null;const Ot=new Mn,cn=new Mn;let oe=null,re=D.width,ot=D.height,Ue=1,Xe=null,qt=null;const We=new Mn(0,0,re,ot),Ke=new Mn(0,0,re,ot);let ze=!1;const Ct=new Ma;let bt=!1,Yt=!1;const Pt=new Bt,nn=new U,Tn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let ie=P;try{const w={alpha:k,depth:H,stencil:G,antialias:W,premultipliedAlpha:K,preserveDrawingBuffer:Q,powerPreference:V,failIfMajorPerformanceCaveat:ge};if(D.addEventListener("webglcontextlost",r,!1),D.addEventListener("webglcontextrestored",a,!1),ie===null){const le=["webgl2","webgl","experimental-webgl"];if(Me.isWebGL1Renderer===!0&&le.shift(),(ie=t(le,w))===null)throw t(le)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ie.getShaderPrecisionFormat===void 0&&(ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(w){throw console.error("THREE.WebGLRenderer: "+w.message),w}let ln,gn,dn,Zn,Sn,mi,Ir,no,fd,ks,Ho,md,Oc,kc,Or,tr,io,Qg,e0,t0,nr,Ti;i();const ir=new Xi(Me,ie);this.xr=ir,this.getContext=function(){return ie},this.getContextAttributes=function(){return ie.getContextAttributes()},this.forceContextLoss=function(){const w=ln.get("WEBGL_lose_context");w&&w.loseContext()},this.forceContextRestore=function(){const w=ln.get("WEBGL_lose_context");w&&w.restoreContext()},this.getPixelRatio=function(){return Ue},this.setPixelRatio=function(w){w!==void 0&&(Ue=w,this.setSize(re,ot,!1))},this.getSize=function(w){return w===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),w=new Je),w.set(re,ot)},this.setSize=function(w,le,te){ir.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(re=w,ot=le,D.width=Math.floor(w*Ue),D.height=Math.floor(le*Ue),te!==!1&&(D.style.width=w+"px",D.style.height=le+"px"),this.setViewport(0,0,w,le))},this.getDrawingBufferSize=function(w){return w===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),w=new Je),w.set(re*Ue,ot*Ue).floor()},this.setDrawingBufferSize=function(w,le,te){re=w,ot=le,Ue=te,D.width=Math.floor(w*te),D.height=Math.floor(le*te),this.setViewport(0,0,w,le)},this.getCurrentViewport=function(w){return w===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),w=new Mn),w.copy(Ot)},this.getViewport=function(w){return w.copy(We)},this.setViewport=function(w,le,te,me){w.isVector4?We.set(w.x,w.y,w.z,w.w):We.set(w,le,te,me),dn.viewport(Ot.copy(We).multiplyScalar(Ue).floor())},this.getScissor=function(w){return w.copy(Ke)},this.setScissor=function(w,le,te,me){w.isVector4?Ke.set(w.x,w.y,w.z,w.w):Ke.set(w,le,te,me),dn.scissor(cn.copy(Ke).multiplyScalar(Ue).floor())},this.getScissorTest=function(){return ze},this.setScissorTest=function(w){dn.setScissorTest(ze=w)},this.setOpaqueSort=function(w){Xe=w},this.setTransparentSort=function(w){qt=w},this.getClearColor=function(w){return w===void 0&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),w=new Rt),w.copy(io.getClearColor())},this.setClearColor=function(){io.setClearColor.apply(io,arguments)},this.getClearAlpha=function(){return io.getClearAlpha()},this.setClearAlpha=function(){io.setClearAlpha.apply(io,arguments)},this.clear=function(w,le,te){let me=0;(w===void 0||w)&&(me|=ie.COLOR_BUFFER_BIT),(le===void 0||le)&&(me|=ie.DEPTH_BUFFER_BIT),(te===void 0||te)&&(me|=ie.STENCIL_BUFFER_BIT),ie.clear(me)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){D.removeEventListener("webglcontextlost",r,!1),D.removeEventListener("webglcontextrestored",a,!1),Oc.dispose(),kc.dispose(),Sn.dispose(),Ir.dispose(),ks.dispose(),Ti.dispose(),ir.dispose(),ir.removeEventListener("sessionstart",l),ir.removeEventListener("sessionend",h),Bo.stop()},this.renderBufferImmediate=function(w,le){Ti.initAttributes();const te=Sn.get(w);w.hasPositions&&!te.position&&(te.position=ie.createBuffer()),w.hasNormals&&!te.normal&&(te.normal=ie.createBuffer()),w.hasUvs&&!te.uv&&(te.uv=ie.createBuffer()),w.hasColors&&!te.color&&(te.color=ie.createBuffer());const me=le.getAttributes();w.hasPositions&&(ie.bindBuffer(ie.ARRAY_BUFFER,te.position),ie.bufferData(ie.ARRAY_BUFFER,w.positionArray,ie.DYNAMIC_DRAW),Ti.enableAttribute(me.position),ie.vertexAttribPointer(me.position,3,ie.FLOAT,!1,0,0)),w.hasNormals&&(ie.bindBuffer(ie.ARRAY_BUFFER,te.normal),ie.bufferData(ie.ARRAY_BUFFER,w.normalArray,ie.DYNAMIC_DRAW),Ti.enableAttribute(me.normal),ie.vertexAttribPointer(me.normal,3,ie.FLOAT,!1,0,0)),w.hasUvs&&(ie.bindBuffer(ie.ARRAY_BUFFER,te.uv),ie.bufferData(ie.ARRAY_BUFFER,w.uvArray,ie.DYNAMIC_DRAW),Ti.enableAttribute(me.uv),ie.vertexAttribPointer(me.uv,2,ie.FLOAT,!1,0,0)),w.hasColors&&(ie.bindBuffer(ie.ARRAY_BUFFER,te.color),ie.bufferData(ie.ARRAY_BUFFER,w.colorArray,ie.DYNAMIC_DRAW),Ti.enableAttribute(me.color),ie.vertexAttribPointer(me.color,3,ie.FLOAT,!1,0,0)),Ti.disableUnusedAttributes(),ie.drawArrays(ie.TRIANGLES,0,w.count),w.count=0},this.renderBufferDirect=function(w,le,te,me,_e,He){le===null&&(le=Tn);const Qe=_e.isMesh&&_e.matrixWorld.determinant()<0,at=S(w,le,me,_e);dn.setMaterial(me,Qe);let st=te.index;const je=te.attributes.position;if(st===null){if(je===void 0||je.count===0)return}else if(st.count===0)return;let vt=1;me.wireframe===!0&&(st=fd.getWireframeAttribute(te),vt=2),(me.morphTargets||me.morphNormals)&&Qg.update(_e,te,me,at),Ti.setup(_e,me,at,te,st);let ft,Ut=e0;st!==null&&(ft=no.get(st),(Ut=t0).setIndex(ft));const Jt=st!==null?st.count:je.count,jt=te.drawRange.start*vt,Lt=te.drawRange.count*vt,Ft=He!==null?He.start*vt:0,Ht=He!==null?He.count*vt:1/0,Vt=Math.max(jt,Ft),on=Math.min(Jt,jt+Lt,Ft+Ht)-1,mn=Math.max(0,on-Vt+1);if(mn!==0){if(_e.isMesh)me.wireframe===!0?(dn.setLineWidth(me.wireframeLinewidth*e()),Ut.setMode(ie.LINES)):Ut.setMode(ie.TRIANGLES);else if(_e.isLine){let Wn=me.linewidth;Wn===void 0&&(Wn=1),dn.setLineWidth(Wn*e()),_e.isLineSegments?Ut.setMode(ie.LINES):_e.isLineLoop?Ut.setMode(ie.LINE_LOOP):Ut.setMode(ie.LINE_STRIP)}else _e.isPoints?Ut.setMode(ie.POINTS):_e.isSprite&&Ut.setMode(ie.TRIANGLES);if(_e.isInstancedMesh)Ut.renderInstances(Vt,mn,_e.count);else if(te.isInstancedBufferGeometry){const Wn=Math.min(te.instanceCount,te._maxInstanceCount);Ut.renderInstances(Vt,mn,Wn)}else Ut.render(Vt,mn)}},this.compile=function(w,le){(xe=kc.get(w)).init(),w.traverseVisible(function(te){te.isLight&&te.layers.test(le.layers)&&(xe.pushLight(te),te.castShadow&&xe.pushShadow(te))}),xe.setupLights(),w.traverse(function(te){const me=te.material;if(me)if(Array.isArray(me))for(let _e=0;_e<me.length;_e++)b(me[_e],w,te);else b(me,w,te)})};let gd=null;const Bo=new A;Bo.setAnimationLoop(function(w){gd&&gd(w)}),typeof window<"u"&&Bo.setContext(window),this.setAnimationLoop=function(w){gd=w,ir.setAnimationLoop(w),w===null?Bo.stop():Bo.start()},ir.addEventListener("sessionstart",l),ir.addEventListener("sessionend",h),this.render=function(w,le){let te,me;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),te=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),me=arguments[3]),le!==void 0&&le.isCamera!==!0)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if($e===!0)return;w.autoUpdate===!0&&w.updateMatrixWorld(),le.parent===null&&le.updateMatrixWorld(),ir.enabled===!0&&ir.isPresenting===!0&&(le=ir.getCamera(le)),w.isScene===!0&&w.onBeforeRender(Me,w,le,te||dt),(xe=kc.get(w,be.length)).init(),be.push(xe),Pt.multiplyMatrices(le.projectionMatrix,le.matrixWorldInverse),Ct.setFromProjectionMatrix(Pt),Yt=this.localClippingEnabled,bt=Or.init(this.clippingPlanes,Yt,le),(Z=Oc.get(w,we.length)).init(),we.push(Z),p(w,le,0,Me.sortObjects),Z.finish(),Me.sortObjects===!0&&Z.sort(Xe,qt),bt===!0&&Or.beginShadows();const _e=xe.state.shadowsArray;tr.render(_e,w,le),xe.setupLights(),xe.setupLightsView(le),bt===!0&&Or.endShadows(),this.info.autoReset===!0&&this.info.reset(),te!==void 0&&this.setRenderTarget(te),io.render(Z,w,le,me);const He=Z.opaque,Qe=Z.transparent;He.length>0&&g(He,w,le),Qe.length>0&&g(Qe,w,le),dt!==null&&(mi.updateRenderTargetMipmap(dt),mi.updateMultisampleRenderTarget(dt)),w.isScene===!0&&w.onAfterRender(Me,w,le),dn.buffers.depth.setTest(!0),dn.buffers.depth.setMask(!0),dn.buffers.color.setMask(!0),dn.setPolygonOffset(!1),Ti.resetDefaultState(),nt=-1,Gt=null,be.pop(),xe=be.length>0?be[be.length-1]:null,we.pop(),Z=we.length>0?we[we.length-1]:null},this.getActiveCubeFace=function(){return ct},this.getActiveMipmapLevel=function(){return Wt},this.getRenderTarget=function(){return dt},this.setRenderTarget=function(w,le=0,te=0){dt=w,ct=le,Wt=te,w&&Sn.get(w).__webglFramebuffer===void 0&&mi.setupRenderTarget(w);let me=null,_e=!1,He=!1;if(w){const Qe=w.texture;(Qe.isDataTexture3D||Qe.isDataTexture2DArray)&&(He=!0);const at=Sn.get(w).__webglFramebuffer;w.isWebGLCubeRenderTarget?(me=at[le],_e=!0):me=w.isWebGLMultisampleRenderTarget?Sn.get(w).__webglMultisampledFramebuffer:at,Ot.copy(w.viewport),cn.copy(w.scissor),oe=w.scissorTest}else Ot.copy(We).multiplyScalar(Ue).floor(),cn.copy(Ke).multiplyScalar(Ue).floor(),oe=ze;if(dn.bindFramebuffer(ie.FRAMEBUFFER,me),dn.viewport(Ot),dn.scissor(cn),dn.setScissorTest(oe),_e){const Qe=Sn.get(w.texture);ie.framebufferTexture2D(ie.FRAMEBUFFER,ie.COLOR_ATTACHMENT0,ie.TEXTURE_CUBE_MAP_POSITIVE_X+le,Qe.__webglTexture,te)}else if(He){const Qe=Sn.get(w.texture),at=le||0;ie.framebufferTextureLayer(ie.FRAMEBUFFER,ie.COLOR_ATTACHMENT0,Qe.__webglTexture,te||0,at)}},this.readRenderTargetPixels=function(w,le,te,me,_e,He,Qe){if(!w||!w.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let at=Sn.get(w).__webglFramebuffer;if(w.isWebGLCubeRenderTarget&&Qe!==void 0&&(at=at[Qe]),at){dn.bindFramebuffer(ie.FRAMEBUFFER,at);try{const st=w.texture,je=st.format,vt=st.type;if(je!==Di&&nr.convert(je)!==ie.getParameter(ie.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ft=vt===ya&&(ln.has("EXT_color_buffer_half_float")||gn.isWebGL2&&ln.has("EXT_color_buffer_float"));if(!(vt===cs||nr.convert(vt)===ie.getParameter(ie.IMPLEMENTATION_COLOR_READ_TYPE)||vt===Mr&&(gn.isWebGL2||ln.has("OES_texture_float")||ln.has("WEBGL_color_buffer_float"))||ft))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ie.checkFramebufferStatus(ie.FRAMEBUFFER)===ie.FRAMEBUFFER_COMPLETE?le>=0&&le<=w.width-me&&te>=0&&te<=w.height-_e&&ie.readPixels(le,te,me,_e,nr.convert(je),nr.convert(vt),He):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const st=dt!==null?Sn.get(dt).__webglFramebuffer:null;dn.bindFramebuffer(ie.FRAMEBUFFER,st)}}},this.copyFramebufferToTexture=function(w,le,te=0){const me=Math.pow(2,-te),_e=Math.floor(le.image.width*me),He=Math.floor(le.image.height*me),Qe=nr.convert(le.format);mi.setTexture2D(le,0),ie.copyTexImage2D(ie.TEXTURE_2D,te,Qe,w.x,w.y,_e,He,0),dn.unbindTexture()},this.copyTextureToTexture=function(w,le,te,me=0){const _e=le.image.width,He=le.image.height,Qe=nr.convert(te.format),at=nr.convert(te.type);mi.setTexture2D(te,0),ie.pixelStorei(ie.UNPACK_FLIP_Y_WEBGL,te.flipY),ie.pixelStorei(ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,te.premultiplyAlpha),ie.pixelStorei(ie.UNPACK_ALIGNMENT,te.unpackAlignment),le.isDataTexture?ie.texSubImage2D(ie.TEXTURE_2D,me,w.x,w.y,_e,He,Qe,at,le.image.data):le.isCompressedTexture?ie.compressedTexSubImage2D(ie.TEXTURE_2D,me,w.x,w.y,le.mipmaps[0].width,le.mipmaps[0].height,Qe,le.mipmaps[0].data):ie.texSubImage2D(ie.TEXTURE_2D,me,w.x,w.y,Qe,at,le.image),me===0&&te.generateMipmaps&&ie.generateMipmap(ie.TEXTURE_2D),dn.unbindTexture()},this.copyTextureToTexture3D=function(w,le,te,me,_e=0){if(Me.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const{width:He,height:Qe,data:at}=te.image,st=nr.convert(me.format),je=nr.convert(me.type);let vt;if(me.isDataTexture3D)mi.setTexture3D(me,0),vt=ie.TEXTURE_3D;else{if(!me.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");mi.setTexture2DArray(me,0),vt=ie.TEXTURE_2D_ARRAY}ie.pixelStorei(ie.UNPACK_FLIP_Y_WEBGL,me.flipY),ie.pixelStorei(ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,me.premultiplyAlpha),ie.pixelStorei(ie.UNPACK_ALIGNMENT,me.unpackAlignment);const ft=ie.getParameter(ie.UNPACK_ROW_LENGTH),Ut=ie.getParameter(ie.UNPACK_IMAGE_HEIGHT),Jt=ie.getParameter(ie.UNPACK_SKIP_PIXELS),jt=ie.getParameter(ie.UNPACK_SKIP_ROWS),Lt=ie.getParameter(ie.UNPACK_SKIP_IMAGES);ie.pixelStorei(ie.UNPACK_ROW_LENGTH,He),ie.pixelStorei(ie.UNPACK_IMAGE_HEIGHT,Qe),ie.pixelStorei(ie.UNPACK_SKIP_PIXELS,w.min.x),ie.pixelStorei(ie.UNPACK_SKIP_ROWS,w.min.y),ie.pixelStorei(ie.UNPACK_SKIP_IMAGES,w.min.z),ie.texSubImage3D(vt,_e,le.x,le.y,le.z,w.max.x-w.min.x+1,w.max.y-w.min.y+1,w.max.z-w.min.z+1,st,je,at),ie.pixelStorei(ie.UNPACK_ROW_LENGTH,ft),ie.pixelStorei(ie.UNPACK_IMAGE_HEIGHT,Ut),ie.pixelStorei(ie.UNPACK_SKIP_PIXELS,Jt),ie.pixelStorei(ie.UNPACK_SKIP_ROWS,jt),ie.pixelStorei(ie.UNPACK_SKIP_IMAGES,Lt),_e===0&&me.generateMipmaps&&ie.generateMipmap(vt),dn.unbindTexture()},this.initTexture=function(w){mi.setTexture2D(w,0),dn.unbindTexture()},this.resetState=function(){ct=0,Wt=0,dt=null,dn.reset(),Ti.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function qn(n,e){this.array=n,this.stride=e,this.count=n!==void 0?n.length/e:0,this.usage=ds,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Kt.generateUUID()}function hr(n,e,t,i){this.name="",this.data=n,this.itemSize=e,this.offset=t,this.normalized=i===!0}function br(n,e,t,i,r,a){Cs.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(Ca.x=a*Cs.x-r*Cs.y,Ca.y=r*Cs.x+a*Cs.y):Ca.copy(Cs),n.copy(e),n.x+=Ca.x,n.y+=Ca.y,n.applyMatrix4(Hm)}function wi(n,e){Ge.call(this,n,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Bt,this.bindMatrixInverse=new Bt}function Yn(){y.call(this),this.type="Bone"}function Bi(n,e,t){Ge.call(this,n,e),this.instanceMatrix=new N(new Float32Array(16*t),16),this.instanceColor=null,this.count=t,this.frustumCulled=!1}function Nn(n=new ve,e=new oi){y.call(this),this.type="Line",this.geometry=n,this.material=e,this.updateMorphTargets()}function vi(n,e){Nn.call(this,n,e),this.type="LineSegments"}function ts(n=new ve,e=new Ro){y.call(this),this.type="Points",this.geometry=n,this.material=e,this.updateMorphTargets()}function Sp(n,e,t,i,r,a,u){const l=Lh.distanceSqToPoint(n);if(l<t){const h=new U;Lh.closestPointToPoint(n,h),h.applyMatrix4(i);const p=r.ray.origin.distanceTo(h);if(p<r.near||p>r.far)return;a.push({distance:p,distanceToRay:Math.sqrt(l),point:h,index:e,face:null,object:u})}}function Ap(n,e,t,i,r){let a,u;if(r===function(l,h,p,g){let v=0;for(let b=h,E=p-g;b<p;b+=g)v+=(l[E]-l[b])*(l[b+1]+l[E+1]),E=b;return v}(n,e,t,i)>0)for(a=e;a<t;a+=i)u=Lp(a,n[a],n[a+1],u);else for(a=t-i;a>=e;a-=i)u=Lp(a,n[a],n[a+1],u);return u&&dl(u,u.next)&&(ra(u),u=u.next),u}function zr(n,e){if(!n)return n;e||(e=n);let t,i=n;do if(t=!1,i.steiner||!dl(i,i.next)&&kn(i.prev,i,i.next)!==0)i=i.next;else{if(ra(i),(i=e=i.prev)===i.next)break;t=!0}while(t||i!==e);return e}function na(n,e,t,i,r,a,u){if(!n)return;!u&&a&&function(g,v,b,E){let S=g;do S.z===null&&(S.z=wu(S.x,S.y,v,b,E)),S.prevZ=S.prev,S.nextZ=S.next,S=S.next;while(S!==g);S.prevZ.nextZ=null,S.prevZ=null,function(D){let P,k,H,G,W,K,Q,V,ge=1;do{for(k=D,D=null,W=null,K=0;k;){for(K++,H=k,Q=0,P=0;P<ge&&(Q++,H=H.nextZ);P++);for(V=ge;Q>0||V>0&&H;)Q!==0&&(V===0||!H||k.z<=H.z)?(G=k,k=k.nextZ,Q--):(G=H,H=H.nextZ,V--),W?W.nextZ=G:D=G,G.prevZ=W,W=G;k=H}W.nextZ=null,ge*=2}while(K>1)}(S)}(n,i,r,a);let l,h,p=n;for(;n.prev!==n.next;)if(l=n.prev,h=n.next,a?function(g,v,b,E){const S=g.prev,D=g,P=g.next;if(kn(S,D,P)>=0)return!1;const k=S.x<D.x?S.x<P.x?S.x:P.x:D.x<P.x?D.x:P.x,H=S.y<D.y?S.y<P.y?S.y:P.y:D.y<P.y?D.y:P.y,G=S.x>D.x?S.x>P.x?S.x:P.x:D.x>P.x?D.x:P.x,W=S.y>D.y?S.y>P.y?S.y:P.y:D.y>P.y?D.y:P.y,K=wu(k,H,v,b,E),Q=wu(G,W,v,b,E);let V=g.prevZ,ge=g.nextZ;for(;V&&V.z>=K&&ge&&ge.z<=Q;){if(V!==g.prev&&V!==g.next&&ns(S.x,S.y,D.x,D.y,P.x,P.y,V.x,V.y)&&kn(V.prev,V,V.next)>=0||(V=V.prevZ,ge!==g.prev&&ge!==g.next&&ns(S.x,S.y,D.x,D.y,P.x,P.y,ge.x,ge.y)&&kn(ge.prev,ge,ge.next)>=0))return!1;ge=ge.nextZ}for(;V&&V.z>=K;){if(V!==g.prev&&V!==g.next&&ns(S.x,S.y,D.x,D.y,P.x,P.y,V.x,V.y)&&kn(V.prev,V,V.next)>=0)return!1;V=V.prevZ}for(;ge&&ge.z<=Q;){if(ge!==g.prev&&ge!==g.next&&ns(S.x,S.y,D.x,D.y,P.x,P.y,ge.x,ge.y)&&kn(ge.prev,ge,ge.next)>=0)return!1;ge=ge.nextZ}return!0}(n,i,r,a):function(g){const v=g.prev,b=g,E=g.next;if(kn(v,b,E)>=0)return!1;let S=g.next.next;for(;S!==g.prev;){if(ns(v.x,v.y,b.x,b.y,E.x,E.y,S.x,S.y)&&kn(S.prev,S,S.next)>=0)return!1;S=S.next}return!0}(n))e.push(l.i/t),e.push(n.i/t),e.push(h.i/t),ra(n),n=h.next,p=h.next;else if((n=h)===p){u?u===1?na(n=function(g,v,b){let E=g;do{const S=E.prev,D=E.next.next;!dl(S,D)&&Rp(S,E,E.next,D)&&ia(S,D)&&ia(D,S)&&(v.push(S.i/b),v.push(E.i/b),v.push(D.i/b),ra(E),ra(E.next),E=g=D),E=E.next}while(E!==g);return zr(E)}(zr(n),e,t),e,t,i,r,a,2):u===2&&function(g,v,b,E,S,D){let P=g;do{let k=P.next.next;for(;k!==P.prev;){if(P.i!==k.i&&function(H,G){return H.next.i!==G.i&&H.prev.i!==G.i&&!function(W,K){let Q=W;do{if(Q.i!==W.i&&Q.next.i!==W.i&&Q.i!==K.i&&Q.next.i!==K.i&&Rp(Q,Q.next,W,K))return!0;Q=Q.next}while(Q!==W);return!1}(H,G)&&(ia(H,G)&&ia(G,H)&&function(W,K){let Q=W,V=!1;const ge=(W.x+K.x)/2,Z=(W.y+K.y)/2;do Q.y>Z!=Q.next.y>Z&&Q.next.y!==Q.y&&ge<(Q.next.x-Q.x)*(Z-Q.y)/(Q.next.y-Q.y)+Q.x&&(V=!V),Q=Q.next;while(Q!==W);return V}(H,G)&&(kn(H.prev,H,G.prev)||kn(H,G.prev,G))||dl(H,G)&&kn(H.prev,H,H.next)>0&&kn(G.prev,G,G.next)>0)}(P,k)){let H=Cp(P,k);return P=zr(P,P.next),H=zr(H,H.next),na(P,v,b,E,S,D),void na(H,v,b,E,S,D)}k=k.next}P=P.next}while(P!==g)}(n,e,t,i,r,a):na(zr(n),e,t,i,r,a,1);break}}function Mv(n,e,t,i){const r=[];let a,u,l;for(a=0,u=e.length;a<u;a++)(l=Ap(n,e[a]*i,a<u-1?e[a+1]*i:n.length,i,!1))===l.next&&(l.steiner=!0),r.push(function(h){let p=h,g=h;do(p.x<g.x||p.x===g.x&&p.y<g.y)&&(g=p),p=p.next;while(p!==h);return g}(l));for(r.sort(Tv),a=0;a<r.length;a++)(function(h,p){if(p=function(g,v){let b=v;const E=g.x,S=g.y;let D,P=-1/0;do{if(S<=b.y&&S>=b.next.y&&b.next.y!==b.y){const Q=b.x+(S-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(Q<=E&&Q>P){if(P=Q,Q===E){if(S===b.y)return b;if(S===b.next.y)return b.next}D=b.x<b.next.x?b:b.next}}b=b.next}while(b!==v);if(!D)return null;if(E===P)return D;const k=D,H=D.x,G=D.y;let W,K=1/0;b=D;do E>=b.x&&b.x>=H&&E!==b.x&&ns(S<G?E:P,S,H,G,S<G?P:E,S,b.x,b.y)&&(W=Math.abs(S-b.y)/(E-b.x),ia(b,g)&&(W<K||W===K&&(b.x>D.x||b.x===D.x&&function(Q,V){return kn(Q.prev,Q,V.prev)<0&&kn(V.next,Q,Q.next)<0}(D,b)))&&(D=b,K=W)),b=b.next;while(b!==k);return D}(h,p)){const g=Cp(p,h);zr(p,p.next),zr(g,g.next)}})(r[a],t),t=zr(t,t.next);return t}function Tv(n,e){return n.x-e.x}function wu(n,e,t,i,r){return n=32767*(n-t)*r,e=32767*(e-i)*r,n=16711935&(n|n<<8),n=252645135&(n|n<<4),n=858993459&(n|n<<2),n=1431655765&(n|n<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),n|e<<1}function ns(n,e,t,i,r,a,u,l){return(r-u)*(e-l)-(n-u)*(a-l)>=0&&(n-u)*(i-l)-(t-u)*(e-l)>=0&&(t-u)*(a-l)-(r-u)*(i-l)>=0}function kn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function dl(n,e){return n.x===e.x&&n.y===e.y}function Rp(n,e,t,i){const r=fl(kn(n,e,t)),a=fl(kn(n,e,i)),u=fl(kn(t,i,n)),l=fl(kn(t,i,e));return r!==a&&u!==l||!(r!==0||!pl(n,t,e))||!(a!==0||!pl(n,i,e))||!(u!==0||!pl(t,n,i))||!(l!==0||!pl(t,e,i))}function pl(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function fl(n){return n>0?1:n<0?-1:0}function ia(n,e){return kn(n.prev,n,n.next)<0?kn(n,e,n.next)>=0&&kn(n,n.prev,e)>=0:kn(n,e,n.prev)<0||kn(n,n.next,e)<0}function Cp(n,e){const t=new Mu(n.i,n.x,n.y),i=new Mu(e.i,e.x,e.y),r=n.next,a=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,a.next=i,i.prev=a,i}function Lp(n,e,t,i){const r=new Mu(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function ra(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function Mu(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pp(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function Dp(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}function is(n,e,t){ve.call(this),this.type="ParametricGeometry",this.parameters={func:n,slices:e,stacks:t};const i=[],r=[],a=[],u=[],l=new U,h=new U,p=new U,g=new U,v=new U;n.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const b=e+1;for(let E=0;E<=t;E++){const S=E/t;for(let D=0;D<=e;D++){const P=D/e;n(P,S,h),r.push(h.x,h.y,h.z),P-1e-5>=0?(n(P-1e-5,S,p),g.subVectors(h,p)):(n(P+1e-5,S,p),g.subVectors(p,h)),S-1e-5>=0?(n(P,S-1e-5,p),v.subVectors(h,p)):(n(P,S+1e-5,p),v.subVectors(p,h)),l.crossVectors(g,v).normalize(),a.push(l.x,l.y,l.z),u.push(P,S)}}for(let E=0;E<t;E++)for(let S=0;S<e;S++){const D=E*b+S,P=E*b+S+1,k=(E+1)*b+S+1,H=(E+1)*b+S;i.push(D,P,H),i.push(P,k,H)}this.setIndex(i),this.setAttribute("position",new ee(r,3)),this.setAttribute("normal",new ee(a,3)),this.setAttribute("uv",new ee(u,2))}function Er(n){x.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Rt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Rt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_o,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(n)}function go(n){Er.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Je(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=Kt.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(n)}function Pi(n,e,t,i){this.parameterPositions=n,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new e.constructor(t),this.sampleValues=e,this.valueSize=t}function ml(n,e,t,i){Pi.call(this,n,e,t,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function oa(n,e,t,i){Pi.call(this,n,e,t,i)}function gl(n,e,t,i){Pi.call(this,n,e,t,i)}function vl(n,e,t,i){Pi.call(this,n,e,t,i)}function Sv(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Oa;case"vector":case"vector2":case"vector3":case"vector4":return ka;case"color":return Gh;case"quaternion":return Ds;case"bool":case"boolean":return Co;case"string":return Lo}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}(n.type);if(n.times===void 0){const t=[],i=[];Pn.flattenJSON(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}function Tu(n,e,t){const i=this;let r=!1,a=0,u=0,l;const h=[];this.onStart=void 0,this.onLoad=n,this.onProgress=e,this.onError=t,this.itemStart=function(p){u++,r===!1&&i.onStart!==void 0&&i.onStart(p,a,u),r=!0},this.itemEnd=function(p){a++,i.onProgress!==void 0&&i.onProgress(p,a,u),a===u&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(p){i.onError!==void 0&&i.onError(p)},this.resolveURL=function(p){return l?l(p):p},this.setURLModifier=function(p){return l=p,this},this.addHandler=function(p,g){return h.push(p,g),this},this.removeHandler=function(p){const g=h.indexOf(p);return g!==-1&&h.splice(g,2),this},this.getHandler=function(p){for(let g=0,v=h.length;g<v;g+=2){const b=h[g],E=h[g+1];if(b.global&&(b.lastIndex=0),b.test(p))return E}return null}}function Hn(n){this.manager=n!==void 0?n:og,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}function Ui(n){Hn.call(this,n)}function Su(n){Hn.call(this,n)}function yl(n){Hn.call(this,n)}function xl(n){Hn.call(this,n)}function yi(){this.type="Curve",this.arcLengthDivisions=200}function Au(){function n(a,u,l,h){e=a,t=l,i=-3*a+3*u-2*l-h,r=2*a-2*u+l+h}let e=0,t=0,i=0,r=0;return{initCatmullRom:function(a,u,l,h,p){n(u,l,p*(l-a),p*(h-u))},initNonuniformCatmullRom:function(a,u,l,h,p,g,v){let b=(u-a)/p-(l-a)/(p+g)+(l-u)/g,E=(l-u)/g-(h-u)/(g+v)+(h-l)/v;n(u,l,b*=g,E*=g)},calc:function(a){const u=a*a;return e+t*a+i*u+r*(u*a)}}}function Np(n,e,t,i,r){const a=.5*(i-e),u=.5*(r-t),l=n*n;return(2*t-2*i+a+u)*(n*l)+(-3*t+3*i-2*a-u)*l+a*n+t}function sa(n,e,t,i){return function(r,a){const u=1-r;return u*u*a}(n,e)+function(r,a){return 2*(1-r)*r*a}(n,t)+function(r,a){return r*r*a}(n,i)}function aa(n,e,t,i,r){return function(a,u){const l=1-a;return l*l*l*u}(n,e)+function(a,u){const l=1-a;return 3*l*l*a*u}(n,t)+function(a,u){return 3*(1-a)*a*a*u}(n,i)+function(a,u){return a*a*a*u}(n,r)}function la(){ve.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function _l(n,e,t,i){typeof t=="number"&&(i=t,t=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),N.call(this,n,e,t),this.meshPerAttribute=i||1}function Ru(n){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Hn.call(this,n),this.options={premultiplyAlpha:"none"}}function Av(n,e,t){const i=Array.from(n),r=e/t.resolution,a=(t.boundingBox.yMax-t.boundingBox.yMin+t.underlineThickness)*r,u=[];let l=0,h=0;for(let p=0;p<i.length;p++){const g=i[p];if(g===`
`)l=0,h-=a;else{const v=function(b,E,S,D,P){const k=P.glyphs[b]||P.glyphs["?"];if(!k)return void console.error('THREE.Font: character "'+b+'" does not exists in font family '+P.familyName+".");const H=new _g;let G,W,K,Q,V,ge,Z,xe;if(k.o){const we=k._cachedOutline||(k._cachedOutline=k.o.split(" "));for(let be=0,Me=we.length;be<Me;)switch(we[be++]){case"m":G=we[be++]*E+S,W=we[be++]*E+D,H.moveTo(G,W);break;case"l":G=we[be++]*E+S,W=we[be++]*E+D,H.lineTo(G,W);break;case"q":K=we[be++]*E+S,Q=we[be++]*E+D,V=we[be++]*E+S,ge=we[be++]*E+D,H.quadraticCurveTo(V,ge,K,Q);break;case"b":K=we[be++]*E+S,Q=we[be++]*E+D,V=we[be++]*E+S,ge=we[be++]*E+D,Z=we[be++]*E+S,xe=we[be++]*E+D,H.bezierCurveTo(V,ge,Z,xe,K,Q)}}return{offsetX:k.ha*E,path:H}}(g,r,l,h,t);l+=v.offsetX,u.push(v.path)}}return u}function Ip(){return(typeof performance>"u"?Date:performance).now()}function Op(n,e,t){const i=t||fi.parseTrackName(e);this._targetGroup=n,this._bindings=n.subscribe_(e,i)}function fi(n,e,t){this.path=e,this.parsedPath=t||fi.parseTrackName(e),this.node=fi.findNode(n,this.parsedPath.nodeName)||n,this.rootNode=n}function Cu(n,e,t){qn.call(this,n,e),this.meshPerAttribute=t||1}function Lu(n,e,t,i,r){this.buffer=n,this.type=e,this.itemSize=t,this.elementSize=i,this.count=r,this.version=0}function Pu(n,e,t=0,i=1/0){this.ray=new qr(n,e),this.near=t,this.far=i,this.camera=null,this.layers=new hh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function kp(n,e){return n.distance-e.distance}function Du(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let a=0,u=r.length;a<u;a++)Du(r[a],e,t,!0)}}function bl(n){y.call(this),this.material=n,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}function Fp(n){const e=[];n&&n.isBone&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,Fp(n.children[t]));return e}function zn(n,e,t,i,r,a,u){Dc.set(r,a,u).unproject(i);const l=e[n];if(l!==void 0){const h=t.getAttribute("position");for(let p=0,g=l.length;p<g;p++)h.setXYZ(l[p],Dc.x,Dc.y,Dc.z)}}function Hp(n){const e=Math.max(n.r,n.g,n.b),t=Math.min(Math.max(Math.ceil(Math.log2(e)),-128),127);return n.multiplyScalar(Math.pow(2,-t)),(t+128)/255}function Bp(n){const e=new Tr(3*pr,3*pr,n);return e.texture.mapping=as,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function El(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function Up(){const n=new Je(1,1);return new Ps({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:n},inputEncoding:{value:fr[_i]},outputEncoding:{value:fr[_i]}},vertexShader:Gp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			${Vp()}

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x += texelSize.x;
				vec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.y += texelSize.y;
				vec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:wr,depthTest:!1,depthWrite:!1})}function zp(){return new Ps({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:fr[_i]},outputEncoding:{value:fr[_i]}},vertexShader:Gp(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			${Vp()}

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;
				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:wr,depthTest:!1,depthWrite:!1})}function Gp(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Vp(){return`

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	`}const Wp=0,Nu=1,jp=2,Iu=1,Xp=2,rs=3,os=0,Kn=1,ca=2,wr=0,ss=1,Ou=2,ku=3,Fu=4,qp=5,vo=100,Yp=101,Kp=102,Hu=103,Bu=104,Zp=200,Jp=201,$p=202,Qp=203,Uu=204,zu=205,ef=206,tf=207,nf=208,rf=209,of=210,sf=0,af=1,lf=2,wl=3,cf=4,uf=5,hf=6,df=7,ua=0,pf=1,ff=2,yo=0,mf=1,gf=2,vf=3,yf=4,xf=5,ha=301,da=302,Ml=303,Tl=304,as=306,pa=307,fa=1e3,xi=1001,ma=1002,Jn=1003,Sl=1004,Al=1005,$n=1006,Gu=1007,ls=1008,cs=1009,_f=1010,bf=1011,ga=1012,Ef=1013,va=1014,Mr=1015,ya=1016,wf=1017,Mf=1018,Tf=1019,us=1020,Sf=1021,Gr=1022,Di=1023,Af=1024,Rf=1025,Cf=Di,xo=1026,hs=1027,Lf=1028,Pf=1029,Df=1030,Nf=1031,If=1032,Of=1033,Vu=33776,Wu=33777,ju=33778,Xu=33779,qu=35840,Yu=35841,Ku=35842,Zu=35843,kf=36196,Ju=37492,$u=37496,Ff=37808,Hf=37809,Bf=37810,Uf=37811,zf=37812,Gf=37813,Vf=37814,Wf=37815,jf=37816,Xf=37817,qf=37818,Yf=37819,Kf=37820,Zf=37821,Jf=36492,$f=37840,Qf=37841,em=37842,tm=37843,nm=37844,im=37845,rm=37846,om=37847,sm=37848,am=37849,lm=37850,cm=37851,um=37852,hm=37853,_i=3e3,xa=3001,Rl=3007,Cl=3002,dm=3003,Qu=3004,eh=3005,th=3006,pm=3201,_o=0,fm=1,Ll=7680,mm=519,ds=35044,bo=35048,nh="300 es";Object.assign(d.prototype,{addEventListener:function(n,e){this._listeners===void 0&&(this._listeners={});const t=this._listeners;t[n]===void 0&&(t[n]=[]),t[n].indexOf(e)===-1&&t[n].push(e)},hasEventListener:function(n,e){if(this._listeners===void 0)return!1;const t=this._listeners;return t[n]!==void 0&&t[n].indexOf(e)!==-1},removeEventListener:function(n,e){if(this._listeners===void 0)return;const t=this._listeners[n];if(t!==void 0){const i=t.indexOf(e);i!==-1&&t.splice(i,1)}},dispatchEvent:function(n){if(this._listeners===void 0)return;const e=this._listeners[n.type];if(e!==void 0){n.target=this;const t=e.slice(0);for(let i=0,r=t.length;i<r;i++)t[i].call(this,n);n.target=null}}});const di=[];for(let n=0;n<256;n++)di[n]=(n<16?"0":"")+n.toString(16);let ih=1234567;const Kt={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const n=4294967295*Math.random()|0,e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(di[255&n]+di[n>>8&255]+di[n>>16&255]+di[n>>24&255]+"-"+di[255&e]+di[e>>8&255]+"-"+di[e>>16&15|64]+di[e>>24&255]+"-"+di[63&t|128]+di[t>>8&255]+"-"+di[t>>16&255]+di[t>>24&255]+di[255&i]+di[i>>8&255]+di[i>>16&255]+di[i>>24&255]).toUpperCase()},clamp:function(n,e,t){return Math.max(e,Math.min(t,n))},euclideanModulo:function(n,e){return(n%e+e)%e},mapLinear:function(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)},inverseLerp:function(n,e,t){return n!==e?(t-n)/(e-n):0},lerp:function(n,e,t){return(1-t)*n+t*e},damp:function(n,e,t,i){return Kt.lerp(n,e,1-Math.exp(-t*i))},pingpong:function(n,e=1){return e-Math.abs(Kt.euclideanModulo(n,2*e)-e)},smoothstep:function(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*(3-2*n)},smootherstep:function(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e))*n*n*(n*(6*n-15)+10)},randInt:function(n,e){return n+Math.floor(Math.random()*(e-n+1))},randFloat:function(n,e){return n+Math.random()*(e-n)},randFloatSpread:function(n){return n*(.5-Math.random())},seededRandom:function(n){return n!==void 0&&(ih=n%2147483647),((ih=16807*ih%2147483647)-1)/2147483646},degToRad:function(n){return n*Kt.DEG2RAD},radToDeg:function(n){return n*Kt.RAD2DEG},isPowerOfTwo:function(n){return(n&n-1)==0&&n!==0},ceilPowerOfTwo:function(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},floorPowerOfTwo:function(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))},setQuaternionFromProperEuler:function(n,e,t,i,r){const a=Math.cos,u=Math.sin,l=a(t/2),h=u(t/2),p=a((e+i)/2),g=u((e+i)/2),v=a((e-i)/2),b=u((e-i)/2),E=a((i-e)/2),S=u((i-e)/2);switch(r){case"XYX":n.set(l*g,h*v,h*b,l*p);break;case"YZY":n.set(h*b,l*g,h*v,l*p);break;case"ZXZ":n.set(h*v,h*b,l*g,l*p);break;case"XZX":n.set(l*g,h*S,h*E,l*p);break;case"YXY":n.set(h*E,l*g,h*S,l*p);break;case"ZYZ":n.set(h*S,h*E,l*g,l*p);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};class Je{constructor(e=0,t=0){this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),a=this.x-e.x,u=this.y-e.y;return this.x=a*i-u*r+e.x,this.y=a*r+u*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Je.prototype.isVector2=!0;class Qn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,a,u,l,h,p){const g=this.elements;return g[0]=e,g[1]=r,g[2]=l,g[3]=t,g[4]=a,g[5]=h,g[6]=i,g[7]=u,g[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,a=this.elements,u=i[0],l=i[3],h=i[6],p=i[1],g=i[4],v=i[7],b=i[2],E=i[5],S=i[8],D=r[0],P=r[3],k=r[6],H=r[1],G=r[4],W=r[7],K=r[2],Q=r[5],V=r[8];return a[0]=u*D+l*H+h*K,a[3]=u*P+l*G+h*Q,a[6]=u*k+l*W+h*V,a[1]=p*D+g*H+v*K,a[4]=p*P+g*G+v*Q,a[7]=p*k+g*W+v*V,a[2]=b*D+E*H+S*K,a[5]=b*P+E*G+S*Q,a[8]=b*k+E*W+S*V,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],h=e[6],p=e[7],g=e[8];return t*u*g-t*l*p-i*a*g+i*l*h+r*a*p-r*u*h}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],h=e[6],p=e[7],g=e[8],v=g*u-l*p,b=l*h-g*a,E=p*a-u*h,S=t*v+i*b+r*E;if(S===0)return this.set(0,0,0,0,0,0,0,0,0);const D=1/S;return e[0]=v*D,e[1]=(r*p-g*i)*D,e[2]=(l*i-r*u)*D,e[3]=b*D,e[4]=(g*t-r*h)*D,e[5]=(r*a-l*t)*D,e[6]=E*D,e[7]=(i*h-p*t)*D,e[8]=(u*t-i*a)*D,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,a,u,l){const h=Math.cos(a),p=Math.sin(a);return this.set(i*h,i*p,-i*(h*u+p*l)+u+e,-r*p,r*h,-r*(-p*u+h*l)+l+t,0,0,1),this}scale(e,t){const i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=t,i[4]*=t,i[7]*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),r=this.elements,a=r[0],u=r[3],l=r[6],h=r[1],p=r[4],g=r[7];return r[0]=t*a+i*h,r[3]=t*u+i*p,r[6]=t*l+i*g,r[1]=-i*a+t*h,r[4]=-i*u+t*p,r[7]=-i*l+t*g,this}translate(e,t){const i=this.elements;return i[0]+=e*i[2],i[3]+=e*i[5],i[6]+=e*i[8],i[1]+=t*i[2],i[4]+=t*i[5],i[7]+=t*i[8],this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}Qn.prototype.isMatrix3=!0;let ps;const Eo={getDataURL:function(n){if(/^data:/i.test(n.src)||typeof HTMLCanvasElement>"u")return n.src;let e;if(n instanceof HTMLCanvasElement)e=n;else{ps===void 0&&(ps=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),ps.width=n.width,ps.height=n.height;const t=ps.getContext("2d");n instanceof ImageData?t.putImageData(n,0,0):t.drawImage(n,0,0,n.width,n.height),e=ps}return e.width>2048||e.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",n),e.toDataURL("image/jpeg",.6)):e.toDataURL("image/png")}};let Rv=0;class ei extends d{constructor(e=ei.DEFAULT_IMAGE,t=ei.DEFAULT_MAPPING,i=xi,r=xi,a=$n,u=ls,l=Di,h=cs,p=1,g=_i){super(),Object.defineProperty(this,"id",{value:Rv++}),this.uuid=Kt.generateUUID(),this.name="",this.image=e,this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=r,this.magFilter=a,this.minFilter=u,this.anisotropy=p,this.format=l,this.internalFormat=null,this.type=h,this.offset=new Je(0,0),this.repeat=new Je(1,1),this.center=new Je(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Qn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=g,this.version=0,this.onUpdate=null}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const r=this.image;if(r.uuid===void 0&&(r.uuid=Kt.generateUUID()),!t&&e.images[r.uuid]===void 0){let a;if(Array.isArray(r)){a=[];for(let u=0,l=r.length;u<l;u++)r[u].isDataTexture?a.push(m(r[u].image)):a.push(m(r[u]))}else a=m(r);e.images[r.uuid]={uuid:r.uuid,url:a}}i.image=r.uuid}return t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case fa:e.x=e.x-Math.floor(e.x);break;case xi:e.x=e.x<0?0:1;break;case ma:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case fa:e.y=e.y-Math.floor(e.y);break;case xi:e.y=e.y<0?0:1;break;case ma:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&this.version++}}ei.DEFAULT_IMAGE=void 0,ei.DEFAULT_MAPPING=300,ei.prototype.isTexture=!0;class Mn{constructor(e=0,t=0,i=0,r=1){this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,a=this.w,u=e.elements;return this.x=u[0]*t+u[4]*i+u[8]*r+u[12]*a,this.y=u[1]*t+u[5]*i+u[9]*r+u[13]*a,this.z=u[2]*t+u[6]*i+u[10]*r+u[14]*a,this.w=u[3]*t+u[7]*i+u[11]*r+u[15]*a,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,a;const u=e.elements,l=u[0],h=u[4],p=u[8],g=u[1],v=u[5],b=u[9],E=u[2],S=u[6],D=u[10];if(Math.abs(h-g)<.01&&Math.abs(p-E)<.01&&Math.abs(b-S)<.01){if(Math.abs(h+g)<.1&&Math.abs(p+E)<.1&&Math.abs(b+S)<.1&&Math.abs(l+v+D-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const k=(l+1)/2,H=(v+1)/2,G=(D+1)/2,W=(h+g)/4,K=(p+E)/4,Q=(b+S)/4;return k>H&&k>G?k<.01?(i=0,r=.707106781,a=.707106781):(r=W/(i=Math.sqrt(k)),a=K/i):H>G?H<.01?(i=.707106781,r=0,a=.707106781):(i=W/(r=Math.sqrt(H)),a=Q/r):G<.01?(i=.707106781,r=.707106781,a=0):(i=K/(a=Math.sqrt(G)),r=Q/a),this.set(i,r,a,t),this}let P=Math.sqrt((S-b)*(S-b)+(p-E)*(p-E)+(g-h)*(g-h));return Math.abs(P)<.001&&(P=1),this.x=(S-b)/P,this.y=(p-E)/P,this.z=(g-h)/P,this.w=Math.acos((l+v+D-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Mn.prototype.isVector4=!0;class Tr extends d{constructor(e,t,i){super(),this.width=e,this.height=t,this.depth=1,this.scissor=new Mn(0,0,e,t),this.scissorTest=!1,this.viewport=new Mn(0,0,e,t),i=i||{},this.texture=new ei(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=1,this.texture.generateMipmaps=i.generateMipmaps!==void 0&&i.generateMipmaps,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:$n,this.depthBuffer=i.depthBuffer===void 0||i.depthBuffer,this.stencilBuffer=i.stencilBuffer!==void 0&&i.stencilBuffer,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,t,i=1){this.width===e&&this.height===t&&this.depth===i||(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}Tr.prototype.isWebGLRenderTarget=!0;class gm extends Tr{constructor(e,t,i){super(e,t,i),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}gm.prototype.isWebGLMultisampleRenderTarget=!0;class ii{constructor(e=0,t=0,i=0,r=1){this._x=e,this._y=t,this._z=i,this._w=r}static slerp(e,t,i,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(e,t,r)}static slerpFlat(e,t,i,r,a,u,l){let h=i[r+0],p=i[r+1],g=i[r+2],v=i[r+3];const b=a[u+0],E=a[u+1],S=a[u+2],D=a[u+3];if(l===0)return e[t+0]=h,e[t+1]=p,e[t+2]=g,void(e[t+3]=v);if(l===1)return e[t+0]=b,e[t+1]=E,e[t+2]=S,void(e[t+3]=D);if(v!==D||h!==b||p!==E||g!==S){let P=1-l;const k=h*b+p*E+g*S+v*D,H=k>=0?1:-1,G=1-k*k;if(G>Number.EPSILON){const K=Math.sqrt(G),Q=Math.atan2(K,k*H);P=Math.sin(P*Q)/K,l=Math.sin(l*Q)/K}const W=l*H;if(h=h*P+b*W,p=p*P+E*W,g=g*P+S*W,v=v*P+D*W,P===1-l){const K=1/Math.sqrt(h*h+p*p+g*g+v*v);h*=K,p*=K,g*=K,v*=K}}e[t]=h,e[t+1]=p,e[t+2]=g,e[t+3]=v}static multiplyQuaternionsFlat(e,t,i,r,a,u){const l=i[r],h=i[r+1],p=i[r+2],g=i[r+3],v=a[u],b=a[u+1],E=a[u+2],S=a[u+3];return e[t]=l*S+g*v+h*E-p*b,e[t+1]=h*S+g*b+p*v-l*E,e[t+2]=p*S+g*E+l*b-h*v,e[t+3]=g*S-l*v-h*b-p*E,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=e._x,r=e._y,a=e._z,u=e._order,l=Math.cos,h=Math.sin,p=l(i/2),g=l(r/2),v=l(a/2),b=h(i/2),E=h(r/2),S=h(a/2);switch(u){case"XYZ":this._x=b*g*v+p*E*S,this._y=p*E*v-b*g*S,this._z=p*g*S+b*E*v,this._w=p*g*v-b*E*S;break;case"YXZ":this._x=b*g*v+p*E*S,this._y=p*E*v-b*g*S,this._z=p*g*S-b*E*v,this._w=p*g*v+b*E*S;break;case"ZXY":this._x=b*g*v-p*E*S,this._y=p*E*v+b*g*S,this._z=p*g*S+b*E*v,this._w=p*g*v-b*E*S;break;case"ZYX":this._x=b*g*v-p*E*S,this._y=p*E*v+b*g*S,this._z=p*g*S-b*E*v,this._w=p*g*v+b*E*S;break;case"YZX":this._x=b*g*v+p*E*S,this._y=p*E*v+b*g*S,this._z=p*g*S-b*E*v,this._w=p*g*v-b*E*S;break;case"XZY":this._x=b*g*v-p*E*S,this._y=p*E*v-b*g*S,this._z=p*g*S+b*E*v,this._w=p*g*v+b*E*S;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],a=t[8],u=t[1],l=t[5],h=t[9],p=t[2],g=t[6],v=t[10],b=i+l+v;if(b>0){const E=.5/Math.sqrt(b+1);this._w=.25/E,this._x=(g-h)*E,this._y=(a-p)*E,this._z=(u-r)*E}else if(i>l&&i>v){const E=2*Math.sqrt(1+i-l-v);this._w=(g-h)/E,this._x=.25*E,this._y=(r+u)/E,this._z=(a+p)/E}else if(l>v){const E=2*Math.sqrt(1+l-i-v);this._w=(a-p)/E,this._x=(r+u)/E,this._y=.25*E,this._z=(h+g)/E}else{const E=2*Math.sqrt(1+v-i-l);this._w=(u-r)/E,this._x=(a+p)/E,this._y=(h+g)/E,this._z=.25*E}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Kt.clamp(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,a=e._z,u=e._w,l=t._x,h=t._y,p=t._z,g=t._w;return this._x=i*g+u*l+r*p-a*h,this._y=r*g+u*h+a*l-i*p,this._z=a*g+u*p+i*h-r*l,this._w=u*g-i*l-r*h-a*p,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,a=this._z,u=this._w;let l=u*e._w+i*e._x+r*e._y+a*e._z;if(l<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,l=-l):this.copy(e),l>=1)return this._w=u,this._x=i,this._y=r,this._z=a,this;const h=1-l*l;if(h<=Number.EPSILON){const E=1-t;return this._w=E*u+t*this._w,this._x=E*i+t*this._x,this._y=E*r+t*this._y,this._z=E*a+t*this._z,this.normalize(),this._onChangeCallback(),this}const p=Math.sqrt(h),g=Math.atan2(p,l),v=Math.sin((1-t)*g)/p,b=Math.sin(t*g)/p;return this._w=u*v+this._w*b,this._x=i*v+this._x*b,this._y=r*v+this._y*b,this._z=a*v+this._z*b,this._onChangeCallback(),this}slerpQuaternions(e,t,i){this.copy(e).slerp(t,i)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}ii.prototype.isQuaternion=!0;class U{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(vm.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(vm.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[3]*i+a[6]*r,this.y=a[1]*t+a[4]*i+a[7]*r,this.z=a[2]*t+a[5]*i+a[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,a=e.elements,u=1/(a[3]*t+a[7]*i+a[11]*r+a[15]);return this.x=(a[0]*t+a[4]*i+a[8]*r+a[12])*u,this.y=(a[1]*t+a[5]*i+a[9]*r+a[13])*u,this.z=(a[2]*t+a[6]*i+a[10]*r+a[14])*u,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,a=e.x,u=e.y,l=e.z,h=e.w,p=h*t+u*r-l*i,g=h*i+l*t-a*r,v=h*r+a*i-u*t,b=-a*t-u*i-l*r;return this.x=p*h+b*-a+g*-l-v*-u,this.y=g*h+b*-u+v*-a-p*-l,this.z=v*h+b*-l+p*-u-g*-a,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*r,this.y=a[1]*t+a[5]*i+a[9]*r,this.z=a[2]*t+a[6]*i+a[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,a=e.z,u=t.x,l=t.y,h=t.z;return this.x=r*h-a*l,this.y=a*u-i*h,this.z=i*l-r*u,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return rh.copy(this).projectOnVector(e),this.sub(rh)}reflect(e){return this.sub(rh.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Kt.clamp(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}U.prototype.isVector3=!0;const rh=new U,vm=new ii;class Mi{constructor(e=new U(1/0,1/0,1/0),t=new U(-1/0,-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,r=1/0,a=-1/0,u=-1/0,l=-1/0;for(let h=0,p=e.length;h<p;h+=3){const g=e[h],v=e[h+1],b=e[h+2];g<t&&(t=g),v<i&&(i=v),b<r&&(r=b),g>a&&(a=g),v>u&&(u=v),b>l&&(l=b)}return this.min.set(t,i,r),this.max.set(a,u,l),this}setFromBufferAttribute(e){let t=1/0,i=1/0,r=1/0,a=-1/0,u=-1/0,l=-1/0;for(let h=0,p=e.count;h<p;h++){const g=e.getX(h),v=e.getY(h),b=e.getZ(h);g<t&&(t=g),v<i&&(i=v),b<r&&(r=b),g>a&&(a=g),v>u&&(u=v),b>l&&(l=b)}return this.min.set(t,i,r),this.max.set(a,u,l),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=_a.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new U),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new U),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),oh.copy(t.boundingBox),oh.applyMatrix4(e.matrixWorld),this.union(oh));const i=e.children;for(let r=0,a=i.length;r<a;r++)this.expandByObject(i[r]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new U),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,_a),_a.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(ba),Pl.subVectors(this.max,ba),fs.subVectors(e.a,ba),ms.subVectors(e.b,ba),gs.subVectors(e.c,ba),Vr.subVectors(ms,fs),Wr.subVectors(gs,ms),wo.subVectors(fs,gs);let t=[0,-Vr.z,Vr.y,0,-Wr.z,Wr.y,0,-wo.z,wo.y,Vr.z,0,-Vr.x,Wr.z,0,-Wr.x,wo.z,0,-wo.x,-Vr.y,Vr.x,0,-Wr.y,Wr.x,0,-wo.y,wo.x,0];return!!_(t,fs,ms,gs,Pl)&&(t=[1,0,0,0,1,0,0,0,1],!!_(t,fs,ms,gs,Pl)&&(Dl.crossVectors(Vr,Wr),t=[Dl.x,Dl.y,Dl.z],_(t,fs,ms,gs,Pl)))}clampPoint(e,t){return t===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new U),t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return _a.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(_a).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(Sr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Sr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Sr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Sr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Sr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Sr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Sr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Sr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Sr),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Mi.prototype.isBox3=!0;const Sr=[new U,new U,new U,new U,new U,new U,new U,new U],_a=new U,oh=new Mi,fs=new U,ms=new U,gs=new U,Vr=new U,Wr=new U,wo=new U,ba=new U,Pl=new U,Dl=new U,Mo=new U,Cv=new Mi,ym=new U,sh=new U,ah=new U;class jr{constructor(e=new U,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):Cv.setFromPoints(e).getCenter(i);let r=0;for(let a=0,u=e.length;a<u;a++)r=Math.max(r,i.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new U),t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new Mi),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){ah.subVectors(e,this.center);const t=ah.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=.5*(i-this.radius);this.center.add(ah.multiplyScalar(r/i)),this.radius+=r}return this}union(e){return sh.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(ym.copy(e.center).add(sh)),this.expandByPoint(ym.copy(e.center).sub(sh)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ar=new U,lh=new U,Nl=new U,Xr=new U,ch=new U,Il=new U,uh=new U;class qr{constructor(e=new U,t=new U(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t===void 0&&(console.warn("THREE.Ray: .at() target is now required"),t=new U),t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ar)),this}closestPointToPoint(e,t){t===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new U),t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ar.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ar.copy(this.direction).multiplyScalar(t).add(this.origin),Ar.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){lh.copy(e).add(t).multiplyScalar(.5),Nl.copy(t).sub(e).normalize(),Xr.copy(this.origin).sub(lh);const a=.5*e.distanceTo(t),u=-this.direction.dot(Nl),l=Xr.dot(this.direction),h=-Xr.dot(Nl),p=Xr.lengthSq(),g=Math.abs(1-u*u);let v,b,E,S;if(g>0)if(v=u*h-l,b=u*l-h,S=a*g,v>=0)if(b>=-S)if(b<=S){const D=1/g;E=(v*=D)*(v+u*(b*=D)+2*l)+b*(u*v+b+2*h)+p}else b=a,E=-(v=Math.max(0,-(u*b+l)))*v+b*(b+2*h)+p;else b=-a,E=-(v=Math.max(0,-(u*b+l)))*v+b*(b+2*h)+p;else b<=-S?E=-(v=Math.max(0,-(-u*a+l)))*v+(b=v>0?-a:Math.min(Math.max(-a,-h),a))*(b+2*h)+p:b<=S?(v=0,E=(b=Math.min(Math.max(-a,-h),a))*(b+2*h)+p):E=-(v=Math.max(0,-(u*a+l)))*v+(b=v>0?a:Math.min(Math.max(-a,-h),a))*(b+2*h)+p;else b=u>0?-a:a,E=-(v=Math.max(0,-(u*b+l)))*v+b*(b+2*h)+p;return i&&i.copy(this.direction).multiplyScalar(v).add(this.origin),r&&r.copy(Nl).multiplyScalar(b).add(lh),E}intersectSphere(e,t){Ar.subVectors(e.center,this.origin);const i=Ar.dot(this.direction),r=Ar.dot(Ar)-i*i,a=e.radius*e.radius;if(r>a)return null;const u=Math.sqrt(a-r),l=i-u,h=i+u;return l<0&&h<0?null:l<0?this.at(h,t):this.at(l,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0?!0:e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,a,u,l,h;const p=1/this.direction.x,g=1/this.direction.y,v=1/this.direction.z,b=this.origin;return p>=0?(i=(e.min.x-b.x)*p,r=(e.max.x-b.x)*p):(i=(e.max.x-b.x)*p,r=(e.min.x-b.x)*p),g>=0?(a=(e.min.y-b.y)*g,u=(e.max.y-b.y)*g):(a=(e.max.y-b.y)*g,u=(e.min.y-b.y)*g),i>u||a>r?null:((a>i||i!=i)&&(i=a),(u<r||r!=r)&&(r=u),v>=0?(l=(e.min.z-b.z)*v,h=(e.max.z-b.z)*v):(l=(e.max.z-b.z)*v,h=(e.min.z-b.z)*v),i>h||l>r?null:((l>i||i!=i)&&(i=l),(h<r||r!=r)&&(r=h),r<0?null:this.at(i>=0?i:r,t)))}intersectsBox(e){return this.intersectBox(e,Ar)!==null}intersectTriangle(e,t,i,r,a){ch.subVectors(t,e),Il.subVectors(i,e),uh.crossVectors(ch,Il);let u,l=this.direction.dot(uh);if(l>0){if(r)return null;u=1}else{if(!(l<0))return null;u=-1,l=-l}Xr.subVectors(this.origin,e);const h=u*this.direction.dot(Il.crossVectors(Xr,Il));if(h<0)return null;const p=u*this.direction.dot(ch.cross(Xr));if(p<0||h+p>l)return null;const g=-u*Xr.dot(uh);return g<0?null:this.at(g/l,a)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Bt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,t,i,r,a,u,l,h,p,g,v,b,E,S,D,P){const k=this.elements;return k[0]=e,k[4]=t,k[8]=i,k[12]=r,k[1]=a,k[5]=u,k[9]=l,k[13]=h,k[2]=p,k[6]=g,k[10]=v,k[14]=b,k[3]=E,k[7]=S,k[11]=D,k[15]=P,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Bt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/vs.setFromMatrixColumn(e,0).length(),a=1/vs.setFromMatrixColumn(e,1).length(),u=1/vs.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*a,t[5]=i[5]*a,t[6]=i[6]*a,t[7]=0,t[8]=i[8]*u,t[9]=i[9]*u,t[10]=i[10]*u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const t=this.elements,i=e.x,r=e.y,a=e.z,u=Math.cos(i),l=Math.sin(i),h=Math.cos(r),p=Math.sin(r),g=Math.cos(a),v=Math.sin(a);if(e.order==="XYZ"){const b=u*g,E=u*v,S=l*g,D=l*v;t[0]=h*g,t[4]=-h*v,t[8]=p,t[1]=E+S*p,t[5]=b-D*p,t[9]=-l*h,t[2]=D-b*p,t[6]=S+E*p,t[10]=u*h}else if(e.order==="YXZ"){const b=h*g,E=h*v,S=p*g,D=p*v;t[0]=b+D*l,t[4]=S*l-E,t[8]=u*p,t[1]=u*v,t[5]=u*g,t[9]=-l,t[2]=E*l-S,t[6]=D+b*l,t[10]=u*h}else if(e.order==="ZXY"){const b=h*g,E=h*v,S=p*g,D=p*v;t[0]=b-D*l,t[4]=-u*v,t[8]=S+E*l,t[1]=E+S*l,t[5]=u*g,t[9]=D-b*l,t[2]=-u*p,t[6]=l,t[10]=u*h}else if(e.order==="ZYX"){const b=u*g,E=u*v,S=l*g,D=l*v;t[0]=h*g,t[4]=S*p-E,t[8]=b*p+D,t[1]=h*v,t[5]=D*p+b,t[9]=E*p-S,t[2]=-p,t[6]=l*h,t[10]=u*h}else if(e.order==="YZX"){const b=u*h,E=u*p,S=l*h,D=l*p;t[0]=h*g,t[4]=D-b*v,t[8]=S*v+E,t[1]=v,t[5]=u*g,t[9]=-l*g,t[2]=-p*g,t[6]=E*v+S,t[10]=b-D*v}else if(e.order==="XZY"){const b=u*h,E=u*p,S=l*h,D=l*p;t[0]=h*g,t[4]=-v,t[8]=p*g,t[1]=b*v+D,t[5]=u*g,t[9]=E*v-S,t[2]=S*v-E,t[6]=l*g,t[10]=D*v+b}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Lv,e,Pv)}lookAt(e,t,i){const r=this.elements;return Ni.subVectors(e,t),Ni.lengthSq()===0&&(Ni.z=1),Ni.normalize(),Yr.crossVectors(i,Ni),Yr.lengthSq()===0&&(Math.abs(i.z)===1?Ni.x+=1e-4:Ni.z+=1e-4,Ni.normalize(),Yr.crossVectors(i,Ni)),Yr.normalize(),Ol.crossVectors(Ni,Yr),r[0]=Yr.x,r[4]=Ol.x,r[8]=Ni.x,r[1]=Yr.y,r[5]=Ol.y,r[9]=Ni.y,r[2]=Yr.z,r[6]=Ol.z,r[10]=Ni.z,this}multiply(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,a=this.elements,u=i[0],l=i[4],h=i[8],p=i[12],g=i[1],v=i[5],b=i[9],E=i[13],S=i[2],D=i[6],P=i[10],k=i[14],H=i[3],G=i[7],W=i[11],K=i[15],Q=r[0],V=r[4],ge=r[8],Z=r[12],xe=r[1],we=r[5],be=r[9],Me=r[13],$e=r[2],ct=r[6],Wt=r[10],dt=r[14],nt=r[3],Gt=r[7],Ot=r[11],cn=r[15];return a[0]=u*Q+l*xe+h*$e+p*nt,a[4]=u*V+l*we+h*ct+p*Gt,a[8]=u*ge+l*be+h*Wt+p*Ot,a[12]=u*Z+l*Me+h*dt+p*cn,a[1]=g*Q+v*xe+b*$e+E*nt,a[5]=g*V+v*we+b*ct+E*Gt,a[9]=g*ge+v*be+b*Wt+E*Ot,a[13]=g*Z+v*Me+b*dt+E*cn,a[2]=S*Q+D*xe+P*$e+k*nt,a[6]=S*V+D*we+P*ct+k*Gt,a[10]=S*ge+D*be+P*Wt+k*Ot,a[14]=S*Z+D*Me+P*dt+k*cn,a[3]=H*Q+G*xe+W*$e+K*nt,a[7]=H*V+G*we+W*ct+K*Gt,a[11]=H*ge+G*be+W*Wt+K*Ot,a[15]=H*Z+G*Me+W*dt+K*cn,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],a=e[12],u=e[1],l=e[5],h=e[9],p=e[13],g=e[2],v=e[6],b=e[10],E=e[14];return e[3]*(+a*h*v-r*p*v-a*l*b+i*p*b+r*l*E-i*h*E)+e[7]*(+t*h*E-t*p*b+a*u*b-r*u*E+r*p*g-a*h*g)+e[11]*(+t*p*v-t*l*E-a*u*v+i*u*E+a*l*g-i*p*g)+e[15]*(-r*l*g-t*h*v+t*l*b+r*u*v-i*u*b+i*h*g)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],a=e[3],u=e[4],l=e[5],h=e[6],p=e[7],g=e[8],v=e[9],b=e[10],E=e[11],S=e[12],D=e[13],P=e[14],k=e[15],H=v*P*p-D*b*p+D*h*E-l*P*E-v*h*k+l*b*k,G=S*b*p-g*P*p-S*h*E+u*P*E+g*h*k-u*b*k,W=g*D*p-S*v*p+S*l*E-u*D*E-g*l*k+u*v*k,K=S*v*h-g*D*h-S*l*b+u*D*b+g*l*P-u*v*P,Q=t*H+i*G+r*W+a*K;if(Q===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const V=1/Q;return e[0]=H*V,e[1]=(D*b*a-v*P*a-D*r*E+i*P*E+v*r*k-i*b*k)*V,e[2]=(l*P*a-D*h*a+D*r*p-i*P*p-l*r*k+i*h*k)*V,e[3]=(v*h*a-l*b*a-v*r*p+i*b*p+l*r*E-i*h*E)*V,e[4]=G*V,e[5]=(g*P*a-S*b*a+S*r*E-t*P*E-g*r*k+t*b*k)*V,e[6]=(S*h*a-u*P*a-S*r*p+t*P*p+u*r*k-t*h*k)*V,e[7]=(u*b*a-g*h*a+g*r*p-t*b*p-u*r*E+t*h*E)*V,e[8]=W*V,e[9]=(S*v*a-g*D*a-S*i*E+t*D*E+g*i*k-t*v*k)*V,e[10]=(u*D*a-S*l*a+S*i*p-t*D*p-u*i*k+t*l*k)*V,e[11]=(g*l*a-u*v*a-g*i*p+t*v*p+u*i*E-t*l*E)*V,e[12]=K*V,e[13]=(g*D*r-S*v*r+S*i*b-t*D*b-g*i*P+t*v*P)*V,e[14]=(S*l*r-u*D*r-S*i*h+t*D*h+u*i*P-t*l*P)*V,e[15]=(u*v*r-g*l*r+g*i*h-t*v*h-u*i*b+t*l*b)*V,this}scale(e){const t=this.elements,i=e.x,r=e.y,a=e.z;return t[0]*=i,t[4]*=r,t[8]*=a,t[1]*=i,t[5]*=r,t[9]*=a,t[2]*=i,t[6]*=r,t[10]*=a,t[3]*=i,t[7]*=r,t[11]*=a,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),a=1-i,u=e.x,l=e.y,h=e.z,p=a*u,g=a*l;return this.set(p*u+i,p*l-r*h,p*h+r*l,0,p*l+r*h,g*l+i,g*h-r*u,0,p*h-r*l,g*h+r*u,a*h*h+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i){return this.set(1,t,i,0,e,1,i,0,e,t,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,a=t._x,u=t._y,l=t._z,h=t._w,p=a+a,g=u+u,v=l+l,b=a*p,E=a*g,S=a*v,D=u*g,P=u*v,k=l*v,H=h*p,G=h*g,W=h*v,K=i.x,Q=i.y,V=i.z;return r[0]=(1-(D+k))*K,r[1]=(E+W)*K,r[2]=(S-G)*K,r[3]=0,r[4]=(E-W)*Q,r[5]=(1-(b+k))*Q,r[6]=(P+H)*Q,r[7]=0,r[8]=(S+G)*V,r[9]=(P-H)*V,r[10]=(1-(b+D))*V,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let a=vs.set(r[0],r[1],r[2]).length();const u=vs.set(r[4],r[5],r[6]).length(),l=vs.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],qi.copy(this);const h=1/a,p=1/u,g=1/l;return qi.elements[0]*=h,qi.elements[1]*=h,qi.elements[2]*=h,qi.elements[4]*=p,qi.elements[5]*=p,qi.elements[6]*=p,qi.elements[8]*=g,qi.elements[9]*=g,qi.elements[10]*=g,t.setFromRotationMatrix(qi),i.x=a,i.y=u,i.z=l,this}makePerspective(e,t,i,r,a,u){u===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const l=this.elements,h=2*a/(t-e),p=2*a/(i-r),g=(t+e)/(t-e),v=(i+r)/(i-r),b=-(u+a)/(u-a),E=-2*u*a/(u-a);return l[0]=h,l[4]=0,l[8]=g,l[12]=0,l[1]=0,l[5]=p,l[9]=v,l[13]=0,l[2]=0,l[6]=0,l[10]=b,l[14]=E,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,t,i,r,a,u){const l=this.elements,h=1/(t-e),p=1/(i-r),g=1/(u-a),v=(t+e)*h,b=(i+r)*p,E=(u+a)*g;return l[0]=2*h,l[4]=0,l[8]=0,l[12]=-v,l[1]=0,l[5]=2*p,l[9]=0,l[13]=-b,l[2]=0,l[6]=0,l[10]=-2*g,l[14]=-E,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}Bt.prototype.isMatrix4=!0;const vs=new U,qi=new Bt,Lv=new U(0,0,0),Pv=new U(1,1,1),Yr=new U,Ol=new U,Ni=new U,xm=new Bt,_m=new ii;class To{constructor(e=0,t=0,i=0,r=To.DefaultOrder){this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._order=r||this._order,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t,i){const r=Kt.clamp,a=e.elements,u=a[0],l=a[4],h=a[8],p=a[1],g=a[5],v=a[9],b=a[2],E=a[6],S=a[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-v,S),this._z=Math.atan2(-l,u)):(this._x=Math.atan2(E,g),this._z=0);break;case"YXZ":this._x=Math.asin(-r(v,-1,1)),Math.abs(v)<.9999999?(this._y=Math.atan2(h,S),this._z=Math.atan2(p,g)):(this._y=Math.atan2(-b,u),this._z=0);break;case"ZXY":this._x=Math.asin(r(E,-1,1)),Math.abs(E)<.9999999?(this._y=Math.atan2(-b,S),this._z=Math.atan2(-l,g)):(this._y=0,this._z=Math.atan2(p,u));break;case"ZYX":this._y=Math.asin(-r(b,-1,1)),Math.abs(b)<.9999999?(this._x=Math.atan2(E,S),this._z=Math.atan2(p,u)):(this._x=0,this._z=Math.atan2(-l,g));break;case"YZX":this._z=Math.asin(r(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-v,g),this._y=Math.atan2(-b,u)):(this._x=0,this._y=Math.atan2(h,S));break;case"XZY":this._z=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(E,g),this._y=Math.atan2(h,u)):(this._x=Math.atan2(-v,S),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i!==!1&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return xm.makeRotationFromQuaternion(e),this.setFromRotationMatrix(xm,t,i)}setFromVector3(e,t){return this.set(e.x,e.y,e.z,t||this._order)}reorder(e){return _m.setFromEuler(this),this.setFromQuaternion(_m,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new U(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}To.prototype.isEuler=!0,To.DefaultOrder="XYZ",To.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class hh{constructor(){this.mask=1}set(e){this.mask=1<<e|0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}}let Dv=0;const bm=new U,ys=new ii,Rr=new Bt,kl=new U,Ea=new U,Nv=new U,Iv=new ii,Em=new U(1,0,0),wm=new U(0,1,0),Mm=new U(0,0,1),Ov={type:"added"},Tm={type:"removed"};y.DefaultUp=new U(0,1,0),y.DefaultMatrixAutoUpdate=!0,y.prototype=Object.assign(Object.create(d.prototype),{constructor:y,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(n){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(n),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(n){return this.quaternion.premultiply(n),this},setRotationFromAxisAngle:function(n,e){this.quaternion.setFromAxisAngle(n,e)},setRotationFromEuler:function(n){this.quaternion.setFromEuler(n,!0)},setRotationFromMatrix:function(n){this.quaternion.setFromRotationMatrix(n)},setRotationFromQuaternion:function(n){this.quaternion.copy(n)},rotateOnAxis:function(n,e){return ys.setFromAxisAngle(n,e),this.quaternion.multiply(ys),this},rotateOnWorldAxis:function(n,e){return ys.setFromAxisAngle(n,e),this.quaternion.premultiply(ys),this},rotateX:function(n){return this.rotateOnAxis(Em,n)},rotateY:function(n){return this.rotateOnAxis(wm,n)},rotateZ:function(n){return this.rotateOnAxis(Mm,n)},translateOnAxis:function(n,e){return bm.copy(n).applyQuaternion(this.quaternion),this.position.add(bm.multiplyScalar(e)),this},translateX:function(n){return this.translateOnAxis(Em,n)},translateY:function(n){return this.translateOnAxis(wm,n)},translateZ:function(n){return this.translateOnAxis(Mm,n)},localToWorld:function(n){return n.applyMatrix4(this.matrixWorld)},worldToLocal:function(n){return n.applyMatrix4(Rr.copy(this.matrixWorld).invert())},lookAt:function(n,e,t){n.isVector3?kl.copy(n):kl.set(n,e,t);const i=this.parent;this.updateWorldMatrix(!0,!1),Ea.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Rr.lookAt(Ea,kl,this.up):Rr.lookAt(kl,Ea,this.up),this.quaternion.setFromRotationMatrix(Rr),i&&(Rr.extractRotation(i.matrixWorld),ys.setFromRotationMatrix(Rr),this.quaternion.premultiply(ys.invert()))},add:function(n){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return n===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",n),this):(n&&n.isObject3D?(n.parent!==null&&n.parent.remove(n),n.parent=this,this.children.push(n),n.dispatchEvent(Ov)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",n),this)},remove:function(n){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}const e=this.children.indexOf(n);return e!==-1&&(n.parent=null,this.children.splice(e,1),n.dispatchEvent(Tm)),this},clear:function(){for(let n=0;n<this.children.length;n++){const e=this.children[n];e.parent=null,e.dispatchEvent(Tm)}return this.children.length=0,this},attach:function(n){return this.updateWorldMatrix(!0,!1),Rr.copy(this.matrixWorld).invert(),n.parent!==null&&(n.parent.updateWorldMatrix(!0,!1),Rr.multiply(n.parent.matrixWorld)),n.applyMatrix4(Rr),this.add(n),n.updateWorldMatrix(!1,!0),this},getObjectById:function(n){return this.getObjectByProperty("id",n)},getObjectByName:function(n){return this.getObjectByProperty("name",n)},getObjectByProperty:function(n,e){if(this[n]===e)return this;for(let t=0,i=this.children.length;t<i;t++){const r=this.children[t].getObjectByProperty(n,e);if(r!==void 0)return r}},getWorldPosition:function(n){return n===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),n=new U),this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(n){return n===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),n=new ii),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ea,n,Nv),n},getWorldScale:function(n){return n===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new U),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Ea,Iv,n),n},getWorldDirection:function(n){n===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),n=new U),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return n.set(e[8],e[9],e[10]).normalize()},raycast:function(){},traverse:function(n){n(this);const e=this.children;for(let t=0,i=e.length;t<i;t++)e[t].traverse(n)},traverseVisible:function(n){if(this.visible===!1)return;n(this);const e=this.children;for(let t=0,i=e.length;t<i;t++)e[t].traverseVisible(n)},traverseAncestors:function(n){const e=this.parent;e!==null&&(n(e),e.traverseAncestors(n))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(n){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||n)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0);const e=this.children;for(let t=0,i=e.length;t<i;t++)e[t].updateMatrixWorld(n)},updateWorldMatrix:function(n,e){const t=this.parent;if(n===!0&&t!==null&&t.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),e===!0){const i=this.children;for(let r=0,a=i.length;r<a;r++)i[r].updateWorldMatrix(!1,!0)}},toJSON:function(n){function e(u,l){return u[l.uuid]===void 0&&(u[l.uuid]=l.toJSON(n)),l.uuid}function t(u){const l=[];for(const h in u){const p=u[h];delete p.metadata,l.push(p)}return l}const i=n===void 0||typeof n=="string",r={};i&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},r.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const a={};if(a.uuid=this.uuid,a.type=this.type,this.name!==""&&(a.name=this.name),this.castShadow===!0&&(a.castShadow=!0),this.receiveShadow===!0&&(a.receiveShadow=!0),this.visible===!1&&(a.visible=!1),this.frustumCulled===!1&&(a.frustumCulled=!1),this.renderOrder!==0&&(a.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(a.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){a.geometry=e(n.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const l=u.shapes;if(Array.isArray(l))for(let h=0,p=l.length;h<p;h++){const g=l[h];e(n.shapes,g)}else e(n.shapes,l)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(e(n.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let l=0,h=this.material.length;l<h;l++)u.push(e(n.materials,this.material[l]));a.material=u}else a.material=e(n.materials,this.material);if(this.children.length>0){a.children=[];for(let u=0;u<this.children.length;u++)a.children.push(this.children[u].toJSON(n).object)}if(this.animations.length>0){a.animations=[];for(let u=0;u<this.animations.length;u++){const l=this.animations[u];a.animations.push(e(n.animations,l))}}if(i){const u=t(n.geometries),l=t(n.materials),h=t(n.textures),p=t(n.images),g=t(n.shapes),v=t(n.skeletons),b=t(n.animations);u.length>0&&(r.geometries=u),l.length>0&&(r.materials=l),h.length>0&&(r.textures=h),p.length>0&&(r.images=p),g.length>0&&(r.shapes=g),v.length>0&&(r.skeletons=v),b.length>0&&(r.animations=b)}return r.object=a,r},clone:function(n){return new this.constructor().copy(this,n)},copy:function(n,e=!0){if(this.name=n.name,this.up.copy(n.up),this.position.copy(n.position),this.rotation.order=n.rotation.order,this.quaternion.copy(n.quaternion),this.scale.copy(n.scale),this.matrix.copy(n.matrix),this.matrixWorld.copy(n.matrixWorld),this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrixWorldNeedsUpdate=n.matrixWorldNeedsUpdate,this.layers.mask=n.layers.mask,this.visible=n.visible,this.castShadow=n.castShadow,this.receiveShadow=n.receiveShadow,this.frustumCulled=n.frustumCulled,this.renderOrder=n.renderOrder,this.userData=JSON.parse(JSON.stringify(n.userData)),e===!0)for(let t=0;t<n.children.length;t++){const i=n.children[t];this.add(i.clone())}return this}});const dh=new U,kv=new U,Fv=new Qn;class Yi{constructor(e=new U(1,0,0),t=0){this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=dh.subVectors(i,t).cross(kv.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new U),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){t===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new U);const i=e.delta(dh),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?null:t.copy(i).multiplyScalar(a).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new U),e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||Fv.getNormalMatrix(e),r=this.coplanarPoint(dh).applyMatrix4(e),a=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(a),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}Yi.prototype.isPlane=!0;const Ki=new U,Cr=new U,ph=new U,Lr=new U,xs=new U,_s=new U,Sm=new U,fh=new U,mh=new U,gh=new U;class Gn{constructor(e=new U,t=new U,i=new U){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new U),r.subVectors(i,t),Ki.subVectors(e,t),r.cross(Ki);const a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}static getBarycoord(e,t,i,r,a){Ki.subVectors(r,t),Cr.subVectors(i,t),ph.subVectors(e,t);const u=Ki.dot(Ki),l=Ki.dot(Cr),h=Ki.dot(ph),p=Cr.dot(Cr),g=Cr.dot(ph),v=u*p-l*l;if(a===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),a=new U),v===0)return a.set(-2,-1,-1);const b=1/v,E=(p*h-l*g)*b,S=(u*g-l*h)*b;return a.set(1-E-S,S,E)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,Lr),Lr.x>=0&&Lr.y>=0&&Lr.x+Lr.y<=1}static getUV(e,t,i,r,a,u,l,h){return this.getBarycoord(e,t,i,r,Lr),h.set(0,0),h.addScaledVector(a,Lr.x),h.addScaledVector(u,Lr.y),h.addScaledVector(l,Lr.z),h}static isFrontFacing(e,t,i,r){return Ki.subVectors(i,t),Cr.subVectors(e,t),Ki.cross(Cr).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Ki.subVectors(this.c,this.b),Cr.subVectors(this.a,this.b),.5*Ki.cross(Cr).length()}getMidpoint(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new U),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Gn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new Yi),e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Gn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,a){return Gn.getUV(e,this.a,this.b,this.c,t,i,r,a)}containsPoint(e){return Gn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Gn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){t===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new U);const i=this.a,r=this.b,a=this.c;let u,l;xs.subVectors(r,i),_s.subVectors(a,i),fh.subVectors(e,i);const h=xs.dot(fh),p=_s.dot(fh);if(h<=0&&p<=0)return t.copy(i);mh.subVectors(e,r);const g=xs.dot(mh),v=_s.dot(mh);if(g>=0&&v<=g)return t.copy(r);const b=h*v-g*p;if(b<=0&&h>=0&&g<=0)return u=h/(h-g),t.copy(i).addScaledVector(xs,u);gh.subVectors(e,a);const E=xs.dot(gh),S=_s.dot(gh);if(S>=0&&E<=S)return t.copy(a);const D=E*p-h*S;if(D<=0&&p>=0&&S<=0)return l=p/(p-S),t.copy(i).addScaledVector(_s,l);const P=g*S-E*v;if(P<=0&&v-g>=0&&E-S>=0)return Sm.subVectors(a,r),l=(v-g)/(v-g+(E-S)),t.copy(r).addScaledVector(Sm,l);const k=1/(P+D+b);return u=D*k,l=b*k,t.copy(i).addScaledVector(xs,u).addScaledVector(_s,l)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Hv=0;x.prototype=Object.assign(Object.create(d.prototype),{constructor:x,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(n){if(n!==void 0)for(const e in n){const t=n[e];if(t===void 0){console.warn("THREE.Material: '"+e+"' parameter is undefined.");continue}if(e==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===1;continue}const i=this[e];i!==void 0?i&&i.isColor?i.set(t):i&&i.isVector3&&t&&t.isVector3?i.copy(t):this[e]=t:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}},toJSON:function(n){function e(r){const a=[];for(const u in r){const l=r[u];delete l.metadata,a.push(l)}return a}const t=n===void 0||typeof n=="string";t&&(n={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(i.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(n).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(n).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(n).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(n).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(n).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(n).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(n).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(n).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(n).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(n).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(n).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(n).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(n).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(n).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(n).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(n).uuid,i.reflectivity=this.reflectivity,i.refractionRatio=this.refractionRatio,this.combine!==void 0&&(i.combine=this.combine),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(n).uuid),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==ss&&(i.blending=this.blending),this.side!==os&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(i.morphTargets=!0),this.morphNormals===!0&&(i.morphNormals=!0),this.skinning===!0&&(i.skinning=!0),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),t){const r=e(n.textures),a=e(n.images);r.length>0&&(i.textures=r),a.length>0&&(i.images=a)}return i},clone:function(){return new this.constructor().copy(this)},copy:function(n){this.name=n.name,this.fog=n.fog,this.blending=n.blending,this.side=n.side,this.vertexColors=n.vertexColors,this.opacity=n.opacity,this.transparent=n.transparent,this.blendSrc=n.blendSrc,this.blendDst=n.blendDst,this.blendEquation=n.blendEquation,this.blendSrcAlpha=n.blendSrcAlpha,this.blendDstAlpha=n.blendDstAlpha,this.blendEquationAlpha=n.blendEquationAlpha,this.depthFunc=n.depthFunc,this.depthTest=n.depthTest,this.depthWrite=n.depthWrite,this.stencilWriteMask=n.stencilWriteMask,this.stencilFunc=n.stencilFunc,this.stencilRef=n.stencilRef,this.stencilFuncMask=n.stencilFuncMask,this.stencilFail=n.stencilFail,this.stencilZFail=n.stencilZFail,this.stencilZPass=n.stencilZPass,this.stencilWrite=n.stencilWrite;const e=n.clippingPlanes;let t=null;if(e!==null){const i=e.length;t=new Array(i);for(let r=0;r!==i;++r)t[r]=e[r].clone()}return this.clippingPlanes=t,this.clipIntersection=n.clipIntersection,this.clipShadows=n.clipShadows,this.shadowSide=n.shadowSide,this.colorWrite=n.colorWrite,this.precision=n.precision,this.polygonOffset=n.polygonOffset,this.polygonOffsetFactor=n.polygonOffsetFactor,this.polygonOffsetUnits=n.polygonOffsetUnits,this.dithering=n.dithering,this.alphaTest=n.alphaTest,this.alphaToCoverage=n.alphaToCoverage,this.premultipliedAlpha=n.premultipliedAlpha,this.visible=n.visible,this.toneMapped=n.toneMapped,this.userData=JSON.parse(JSON.stringify(n.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(x.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}});const Am={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Zi={h:0,s:0,l:0},Fl={h:0,s:0,l:0};class Rt{constructor(e,t,i){return t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,t,i){return this.r=e,this.g=t,this.b=i,this}setHSL(e,t,i){if(e=Kt.euclideanModulo(e,1),t=Kt.clamp(t,0,1),i=Kt.clamp(i,0,1),t===0)this.r=this.g=this.b=i;else{const r=i<=.5?i*(1+t):i+t-i*t,a=2*i-r;this.r=R(a,r,e+1/3),this.g=R(a,r,e),this.b=R(a,r,e-1/3)}return this}setStyle(e){function t(r){r!==void 0&&parseFloat(r)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let r;const a=i[1],u=i[2];switch(a){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u)){const l=parseFloat(r[1])/360,h=parseInt(r[2],10)/100,p=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(l,h,p)}}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const r=i[1],a=r.length;if(a===3)return this.r=parseInt(r.charAt(0)+r.charAt(0),16)/255,this.g=parseInt(r.charAt(1)+r.charAt(1),16)/255,this.b=parseInt(r.charAt(2)+r.charAt(2),16)/255,this;if(a===6)return this.r=parseInt(r.charAt(0)+r.charAt(1),16)/255,this.g=parseInt(r.charAt(2)+r.charAt(3),16)/255,this.b=parseInt(r.charAt(4)+r.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const t=Am[e];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,t=2){return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}copyLinearToGamma(e,t=2){const i=t>0?1/t:1;return this.r=Math.pow(e.r,i),this.g=Math.pow(e.g,i),this.b=Math.pow(e.b,i),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=C(e.r),this.g=C(e.g),this.b=C(e.b),this}copyLinearToSRGB(e){return this.r=L(e.r),this.g=L(e.g),this.b=L(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});const t=this.r,i=this.g,r=this.b,a=Math.max(t,i,r),u=Math.min(t,i,r);let l,h;const p=(u+a)/2;if(u===a)l=0,h=0;else{const g=a-u;switch(h=p<=.5?g/(a+u):g/(2-a-u),a){case t:l=(i-r)/g+(i<r?6:0);break;case i:l=(r-t)/g+2;break;case r:l=(t-i)/g+4}l/=6}return e.h=l,e.s=h,e.l=p,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,t,i){return this.getHSL(Zi),Zi.h+=e,Zi.s+=t,Zi.l+=i,this.setHSL(Zi.h,Zi.s,Zi.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Zi),e.getHSL(Fl);const i=Kt.lerp(Zi.h,Fl.h,t),r=Kt.lerp(Zi.s,Fl.s,t),a=Kt.lerp(Zi.l,Fl.l,t);return this.setHSL(i,r,a),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),e.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Rt.NAMES=Am,Rt.prototype.isColor=!0,Rt.prototype.r=1,Rt.prototype.g=1,Rt.prototype.b=1;class Pr extends x{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new Rt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ua,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}}Pr.prototype.isMeshBasicMaterial=!0;const Ln=new U,Hl=new Je;Object.defineProperty(N.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}}),Object.assign(N.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(n){return this.usage=n,this},copy:function(n){return this.name=n.name,this.array=new n.array.constructor(n.array),this.itemSize=n.itemSize,this.count=n.count,this.normalized=n.normalized,this.usage=n.usage,this},copyAt:function(n,e,t){n*=this.itemSize,t*=e.itemSize;for(let i=0,r=this.itemSize;i<r;i++)this.array[n+i]=e.array[t+i];return this},copyArray:function(n){return this.array.set(n),this},copyColorsArray:function(n){const e=this.array;let t=0;for(let i=0,r=n.length;i<r;i++){let a=n[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new Rt),e[t++]=a.r,e[t++]=a.g,e[t++]=a.b}return this},copyVector2sArray:function(n){const e=this.array;let t=0;for(let i=0,r=n.length;i<r;i++){let a=n[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new Je),e[t++]=a.x,e[t++]=a.y}return this},copyVector3sArray:function(n){const e=this.array;let t=0;for(let i=0,r=n.length;i<r;i++){let a=n[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new U),e[t++]=a.x,e[t++]=a.y,e[t++]=a.z}return this},copyVector4sArray:function(n){const e=this.array;let t=0;for(let i=0,r=n.length;i<r;i++){let a=n[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new Mn),e[t++]=a.x,e[t++]=a.y,e[t++]=a.z,e[t++]=a.w}return this},applyMatrix3:function(n){if(this.itemSize===2)for(let e=0,t=this.count;e<t;e++)Hl.fromBufferAttribute(this,e),Hl.applyMatrix3(n),this.setXY(e,Hl.x,Hl.y);else if(this.itemSize===3)for(let e=0,t=this.count;e<t;e++)Ln.fromBufferAttribute(this,e),Ln.applyMatrix3(n),this.setXYZ(e,Ln.x,Ln.y,Ln.z);return this},applyMatrix4:function(n){for(let e=0,t=this.count;e<t;e++)Ln.x=this.getX(e),Ln.y=this.getY(e),Ln.z=this.getZ(e),Ln.applyMatrix4(n),this.setXYZ(e,Ln.x,Ln.y,Ln.z);return this},applyNormalMatrix:function(n){for(let e=0,t=this.count;e<t;e++)Ln.x=this.getX(e),Ln.y=this.getY(e),Ln.z=this.getZ(e),Ln.applyNormalMatrix(n),this.setXYZ(e,Ln.x,Ln.y,Ln.z);return this},transformDirection:function(n){for(let e=0,t=this.count;e<t;e++)Ln.x=this.getX(e),Ln.y=this.getY(e),Ln.z=this.getZ(e),Ln.transformDirection(n),this.setXYZ(e,Ln.x,Ln.y,Ln.z);return this},set:function(n,e=0){return this.array.set(n,e),this},getX:function(n){return this.array[n*this.itemSize]},setX:function(n,e){return this.array[n*this.itemSize]=e,this},getY:function(n){return this.array[n*this.itemSize+1]},setY:function(n,e){return this.array[n*this.itemSize+1]=e,this},getZ:function(n){return this.array[n*this.itemSize+2]},setZ:function(n,e){return this.array[n*this.itemSize+2]=e,this},getW:function(n){return this.array[n*this.itemSize+3]},setW:function(n,e){return this.array[n*this.itemSize+3]=e,this},setXY:function(n,e,t){return n*=this.itemSize,this.array[n+0]=e,this.array[n+1]=t,this},setXYZ:function(n,e,t,i){return n*=this.itemSize,this.array[n+0]=e,this.array[n+1]=t,this.array[n+2]=i,this},setXYZW:function(n,e,t,i,r){return n*=this.itemSize,this.array[n+0]=e,this.array[n+1]=t,this.array[n+2]=i,this.array[n+3]=r,this},onUpload:function(n){return this.onUploadCallback=n,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){const n={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(n.name=this.name),this.usage!==ds&&(n.usage=this.usage),this.updateRange.offset===0&&this.updateRange.count===-1||(n.updateRange=this.updateRange),n}}),(B.prototype=Object.create(N.prototype)).constructor=B,(q.prototype=Object.create(N.prototype)).constructor=q,($.prototype=Object.create(N.prototype)).constructor=$,(he.prototype=Object.create(N.prototype)).constructor=he,(ce.prototype=Object.create(N.prototype)).constructor=ce,(Ee.prototype=Object.create(N.prototype)).constructor=Ee,(Ye.prototype=Object.create(N.prototype)).constructor=Ye,(Ae.prototype=Object.create(N.prototype)).constructor=Ae,Ae.prototype.isFloat16BufferAttribute=!0,(ee.prototype=Object.create(N.prototype)).constructor=ee,(de.prototype=Object.create(N.prototype)).constructor=de;const Bv={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};let Uv=0;const dr=new Bt,vh=new y,bs=new U,Ii=new Mi,wa=new Mi,ri=new U;ve.prototype=Object.assign(Object.create(d.prototype),{constructor:ve,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(n){return Array.isArray(n)?this.index=new(De(n)>65535?Ye:ce)(n,1):this.index=n,this},getAttribute:function(n){return this.attributes[n]},setAttribute:function(n,e){return this.attributes[n]=e,this},deleteAttribute:function(n){return delete this.attributes[n],this},hasAttribute:function(n){return this.attributes[n]!==void 0},addGroup:function(n,e,t=0){this.groups.push({start:n,count:e,materialIndex:t})},clearGroups:function(){this.groups=[]},setDrawRange:function(n,e){this.drawRange.start=n,this.drawRange.count=e},applyMatrix4:function(n){const e=this.attributes.position;e!==void 0&&(e.applyMatrix4(n),e.needsUpdate=!0);const t=this.attributes.normal;if(t!==void 0){const r=new Qn().getNormalMatrix(n);t.applyNormalMatrix(r),t.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(n),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(n){return dr.makeRotationX(n),this.applyMatrix4(dr),this},rotateY:function(n){return dr.makeRotationY(n),this.applyMatrix4(dr),this},rotateZ:function(n){return dr.makeRotationZ(n),this.applyMatrix4(dr),this},translate:function(n,e,t){return dr.makeTranslation(n,e,t),this.applyMatrix4(dr),this},scale:function(n,e,t){return dr.makeScale(n,e,t),this.applyMatrix4(dr),this},lookAt:function(n){return vh.lookAt(n),vh.updateMatrix(),this.applyMatrix4(vh.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(bs).negate(),this.translate(bs.x,bs.y,bs.z),this},setFromPoints:function(n){const e=[];for(let t=0,i=n.length;t<i;t++){const r=n[t];e.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new ee(e,3)),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new Mi);const n=this.attributes.position,e=this.morphAttributes.position;if(n&&n.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new U(-1/0,-1/0,-1/0),new U(1/0,1/0,1/0));if(n!==void 0){if(this.boundingBox.setFromBufferAttribute(n),e)for(let t=0,i=e.length;t<i;t++){const r=e[t];Ii.setFromBufferAttribute(r),this.morphTargetsRelative?(ri.addVectors(this.boundingBox.min,Ii.min),this.boundingBox.expandByPoint(ri),ri.addVectors(this.boundingBox.max,Ii.max),this.boundingBox.expandByPoint(ri)):(this.boundingBox.expandByPoint(Ii.min),this.boundingBox.expandByPoint(Ii.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new jr);const n=this.attributes.position,e=this.morphAttributes.position;if(n&&n.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new U,1/0);if(n){const t=this.boundingSphere.center;if(Ii.setFromBufferAttribute(n),e)for(let r=0,a=e.length;r<a;r++){const u=e[r];wa.setFromBufferAttribute(u),this.morphTargetsRelative?(ri.addVectors(Ii.min,wa.min),Ii.expandByPoint(ri),ri.addVectors(Ii.max,wa.max),Ii.expandByPoint(ri)):(Ii.expandByPoint(wa.min),Ii.expandByPoint(wa.max))}Ii.getCenter(t);let i=0;for(let r=0,a=n.count;r<a;r++)ri.fromBufferAttribute(n,r),i=Math.max(i,t.distanceToSquared(ri));if(e)for(let r=0,a=e.length;r<a;r++){const u=e[r],l=this.morphTargetsRelative;for(let h=0,p=u.count;h<p;h++)ri.fromBufferAttribute(u,h),l&&(bs.fromBufferAttribute(n,h),ri.add(bs)),i=Math.max(i,t.distanceToSquared(ri))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){function n(Z,xe,we){b.fromArray(a,3*Z),E.fromArray(a,3*xe),S.fromArray(a,3*we),D.fromArray(l,2*Z),P.fromArray(l,2*xe),k.fromArray(l,2*we),E.sub(b),S.sub(b),P.sub(D),k.sub(D);const be=1/(P.x*k.y-k.x*P.y);isFinite(be)&&(H.copy(E).multiplyScalar(k.y).addScaledVector(S,-P.y).multiplyScalar(be),G.copy(S).multiplyScalar(P.x).addScaledVector(E,-k.x).multiplyScalar(be),g[Z].add(H),g[xe].add(H),g[we].add(H),v[Z].add(G),v[xe].add(G),v[we].add(G))}function e(Z){V.fromArray(u,3*Z),ge.copy(V);const xe=g[Z];K.copy(xe),K.sub(V.multiplyScalar(V.dot(xe))).normalize(),Q.crossVectors(ge,xe);const we=Q.dot(v[Z])<0?-1:1;p[4*Z]=K.x,p[4*Z+1]=K.y,p[4*Z+2]=K.z,p[4*Z+3]=we}const t=this.index,i=this.attributes;if(t===null||i.position===void 0||i.normal===void 0||i.uv===void 0)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const r=t.array,a=i.position.array,u=i.normal.array,l=i.uv.array,h=a.length/3;i.tangent===void 0&&this.setAttribute("tangent",new N(new Float32Array(4*h),4));const p=i.tangent.array,g=[],v=[];for(let Z=0;Z<h;Z++)g[Z]=new U,v[Z]=new U;const b=new U,E=new U,S=new U,D=new Je,P=new Je,k=new Je,H=new U,G=new U;let W=this.groups;W.length===0&&(W=[{start:0,count:r.length}]);for(let Z=0,xe=W.length;Z<xe;++Z){const we=W[Z],be=we.start;for(let Me=be,$e=be+we.count;Me<$e;Me+=3)n(r[Me+0],r[Me+1],r[Me+2])}const K=new U,Q=new U,V=new U,ge=new U;for(let Z=0,xe=W.length;Z<xe;++Z){const we=W[Z],be=we.start;for(let Me=be,$e=be+we.count;Me<$e;Me+=3)e(r[Me+0]),e(r[Me+1]),e(r[Me+2])}},computeVertexNormals:function(){const n=this.index,e=this.getAttribute("position");if(e!==void 0){let t=this.getAttribute("normal");if(t===void 0)t=new N(new Float32Array(3*e.count),3),this.setAttribute("normal",t);else for(let v=0,b=t.count;v<b;v++)t.setXYZ(v,0,0,0);const i=new U,r=new U,a=new U,u=new U,l=new U,h=new U,p=new U,g=new U;if(n)for(let v=0,b=n.count;v<b;v+=3){const E=n.getX(v+0),S=n.getX(v+1),D=n.getX(v+2);i.fromBufferAttribute(e,E),r.fromBufferAttribute(e,S),a.fromBufferAttribute(e,D),p.subVectors(a,r),g.subVectors(i,r),p.cross(g),u.fromBufferAttribute(t,E),l.fromBufferAttribute(t,S),h.fromBufferAttribute(t,D),u.add(p),l.add(p),h.add(p),t.setXYZ(E,u.x,u.y,u.z),t.setXYZ(S,l.x,l.y,l.z),t.setXYZ(D,h.x,h.y,h.z)}else for(let v=0,b=e.count;v<b;v+=3)i.fromBufferAttribute(e,v+0),r.fromBufferAttribute(e,v+1),a.fromBufferAttribute(e,v+2),p.subVectors(a,r),g.subVectors(i,r),p.cross(g),t.setXYZ(v+0,p.x,p.y,p.z),t.setXYZ(v+1,p.x,p.y,p.z),t.setXYZ(v+2,p.x,p.y,p.z);this.normalizeNormals(),t.needsUpdate=!0}},merge:function(n,e){if(!n||!n.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",n);e===void 0&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const t=this.attributes;for(const i in t){if(n.attributes[i]===void 0)continue;const r=t[i].array,a=n.attributes[i],u=a.array,l=a.itemSize*e,h=Math.min(u.length,r.length-l);for(let p=0,g=l;p<h;p++,g++)r[g]=u[p]}return this},normalizeNormals:function(){const n=this.attributes.normal;for(let e=0,t=n.count;e<t;e++)ri.fromBufferAttribute(n,e),ri.normalize(),n.setXYZ(e,ri.x,ri.y,ri.z)},toNonIndexed:function(){function n(u,l){const h=u.array,p=u.itemSize,g=u.normalized,v=new h.constructor(l.length*p);let b=0,E=0;for(let S=0,D=l.length;S<D;S++){b=l[S]*p;for(let P=0;P<p;P++)v[E++]=h[b++]}return new N(v,p,g)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const e=new ve,t=this.index.array,i=this.attributes;for(const u in i){const l=n(i[u],t);e.setAttribute(u,l)}const r=this.morphAttributes;for(const u in r){const l=[],h=r[u];for(let p=0,g=h.length;p<g;p++){const v=n(h[p],t);l.push(v)}e.morphAttributes[u]=l}e.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let u=0,l=a.length;u<l;u++){const h=a[u];e.addGroup(h.start,h.count,h.materialIndex)}return e},toJSON:function(){const n={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),Object.keys(this.userData).length>0&&(n.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const h in l)l[h]!==void 0&&(n[h]=l[h]);return n}n.data={attributes:{}};const e=this.index;e!==null&&(n.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});const t=this.attributes;for(const l in t){const h=t[l];n.data.attributes[l]=h.toJSON(n.data)}const i={};let r=!1;for(const l in this.morphAttributes){const h=this.morphAttributes[l],p=[];for(let g=0,v=h.length;g<v;g++){const b=h[g];p.push(b.toJSON(n.data))}p.length>0&&(i[l]=p,r=!0)}r&&(n.data.morphAttributes=i,n.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(n.data.groups=JSON.parse(JSON.stringify(a)));const u=this.boundingSphere;return u!==null&&(n.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),n},clone:function(){return new ve().copy(this)},copy:function(n){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const e={};this.name=n.name;const t=n.index;t!==null&&this.setIndex(t.clone(e));const i=n.attributes;for(const h in i){const p=i[h];this.setAttribute(h,p.clone(e))}const r=n.morphAttributes;for(const h in r){const p=[],g=r[h];for(let v=0,b=g.length;v<b;v++)p.push(g[v].clone(e));this.morphAttributes[h]=p}this.morphTargetsRelative=n.morphTargetsRelative;const a=n.groups;for(let h=0,p=a.length;h<p;h++){const g=a[h];this.addGroup(g.start,g.count,g.materialIndex)}const u=n.boundingBox;u!==null&&(this.boundingBox=u.clone());const l=n.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=n.drawRange.start,this.drawRange.count=n.drawRange.count,this.userData=n.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Rm=new Bt,Es=new qr,yh=new jr,Kr=new U,Zr=new U,Jr=new U,xh=new U,_h=new U,bh=new U,Bl=new U,Ul=new U,zl=new U,Gl=new Je,Vl=new Je,Wl=new Je,Eh=new U,jl=new U;Ge.prototype=Object.assign(Object.create(y.prototype),{constructor:Ge,isMesh:!0,copy:function(n){return y.prototype.copy.call(this,n),n.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=n.morphTargetInfluences.slice()),n.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},n.morphTargetDictionary)),this.material=n.material,this.geometry=n.geometry,this},updateMorphTargets:function(){const n=this.geometry;if(n.isBufferGeometry){const e=n.morphAttributes,t=Object.keys(e);if(t.length>0){const i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=i.length;r<a;r++){const u=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=r}}}}else{const e=n.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(n,e){const t=this.geometry,i=this.material,r=this.matrixWorld;if(i===void 0||(t.boundingSphere===null&&t.computeBoundingSphere(),yh.copy(t.boundingSphere),yh.applyMatrix4(r),n.ray.intersectsSphere(yh)===!1)||(Rm.copy(r).invert(),Es.copy(n.ray).applyMatrix4(Rm),t.boundingBox!==null&&Es.intersectsBox(t.boundingBox)===!1))return;let a;if(t.isBufferGeometry){const u=t.index,l=t.attributes.position,h=t.morphAttributes.position,p=t.morphTargetsRelative,g=t.attributes.uv,v=t.attributes.uv2,b=t.groups,E=t.drawRange;if(u!==null)if(Array.isArray(i))for(let S=0,D=b.length;S<D;S++){const P=b[S],k=i[P.materialIndex];for(let H=Math.max(P.start,E.start),G=Math.min(P.start+P.count,E.start+E.count);H<G;H+=3){const W=u.getX(H),K=u.getX(H+1),Q=u.getX(H+2);(a=Xt(this,k,n,Es,l,h,p,g,v,W,K,Q))&&(a.faceIndex=Math.floor(H/3),a.face.materialIndex=P.materialIndex,e.push(a))}}else for(let S=Math.max(0,E.start),D=Math.min(u.count,E.start+E.count);S<D;S+=3){const P=u.getX(S),k=u.getX(S+1),H=u.getX(S+2);(a=Xt(this,i,n,Es,l,h,p,g,v,P,k,H))&&(a.faceIndex=Math.floor(S/3),e.push(a))}else if(l!==void 0)if(Array.isArray(i))for(let S=0,D=b.length;S<D;S++){const P=b[S],k=i[P.materialIndex];for(let H=Math.max(P.start,E.start),G=Math.min(P.start+P.count,E.start+E.count);H<G;H+=3)(a=Xt(this,k,n,Es,l,h,p,g,v,H,H+1,H+2))&&(a.faceIndex=Math.floor(H/3),a.face.materialIndex=P.materialIndex,e.push(a))}else for(let S=Math.max(0,E.start),D=Math.min(l.count,E.start+E.count);S<D;S+=3)(a=Xt(this,i,n,Es,l,h,p,g,v,S,S+1,S+2))&&(a.faceIndex=Math.floor(S/3),e.push(a))}else t.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});class So extends ve{constructor(e=1,t=1,i=1,r=1,a=1,u=1){function l(D,P,k,H,G,W,K,Q,V,ge,Z){const xe=W/V,we=K/ge,be=W/2,Me=K/2,$e=Q/2,ct=V+1,Wt=ge+1;let dt=0,nt=0;const Gt=new U;for(let Ot=0;Ot<Wt;Ot++){const cn=Ot*we-Me;for(let oe=0;oe<ct;oe++){const re=oe*xe-be;Gt[D]=re*H,Gt[P]=cn*G,Gt[k]=$e,g.push(Gt.x,Gt.y,Gt.z),Gt[D]=0,Gt[P]=0,Gt[k]=Q>0?1:-1,v.push(Gt.x,Gt.y,Gt.z),b.push(oe/V),b.push(1-Ot/ge),dt+=1}}for(let Ot=0;Ot<ge;Ot++)for(let cn=0;cn<V;cn++){const oe=E+cn+ct*Ot,re=E+cn+ct*(Ot+1),ot=E+(cn+1)+ct*(Ot+1),Ue=E+(cn+1)+ct*Ot;p.push(oe,re,Ue),p.push(re,ot,Ue),nt+=6}h.addGroup(S,nt,Z),S+=nt,E+=dt}super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:a,depthSegments:u};const h=this;r=Math.floor(r),a=Math.floor(a);const p=[],g=[],v=[],b=[];let E=0,S=0;l("z","y","x",-1,-1,i,t,e,u=Math.floor(u),a,0),l("z","y","x",1,-1,i,t,-e,u,a,1),l("x","z","y",1,1,e,i,t,r,u,2),l("x","z","y",1,-1,e,i,-t,r,u,3),l("x","y","z",1,-1,e,t,i,r,a,4),l("x","y","z",-1,-1,e,t,-i,r,a,5),this.setIndex(p),this.setAttribute("position",new ee(g,3)),this.setAttribute("normal",new ee(v,3)),this.setAttribute("uv",new ee(b,2))}}const Cm={clone:xt,merge:At};var zv=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Gv=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;(M.prototype=Object.create(x.prototype)).constructor=M,M.prototype.isShaderMaterial=!0,M.prototype.copy=function(n){return x.prototype.copy.call(this,n),this.fragmentShader=n.fragmentShader,this.vertexShader=n.vertexShader,this.uniforms=xt(n.uniforms),this.defines=Object.assign({},n.defines),this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.lights=n.lights,this.clipping=n.clipping,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this.extensions=Object.assign({},n.extensions),this.glslVersion=n.glslVersion,this},M.prototype.toJSON=function(n){const e=x.prototype.toJSON.call(this,n);e.glslVersion=this.glslVersion,e.uniforms={};for(const i in this.uniforms){const r=this.uniforms[i].value;r&&r.isTexture?e.uniforms[i]={type:"t",value:r.toJSON(n).uuid}:r&&r.isColor?e.uniforms[i]={type:"c",value:r.getHex()}:r&&r.isVector2?e.uniforms[i]={type:"v2",value:r.toArray()}:r&&r.isVector3?e.uniforms[i]={type:"v3",value:r.toArray()}:r&&r.isVector4?e.uniforms[i]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?e.uniforms[i]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?e.uniforms[i]={type:"m4",value:r.toArray()}:e.uniforms[i]={value:r}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;const t={};for(const i in this.extensions)this.extensions[i]===!0&&(t[i]=!0);return Object.keys(t).length>0&&(e.extensions=t),e},I.prototype=Object.assign(Object.create(y.prototype),{constructor:I,isCamera:!0,copy:function(n,e){return y.prototype.copy.call(this,n,e),this.matrixWorldInverse.copy(n.matrixWorldInverse),this.projectionMatrix.copy(n.projectionMatrix),this.projectionMatrixInverse.copy(n.projectionMatrixInverse),this},getWorldDirection:function(n){n===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),n=new U),this.updateWorldMatrix(!0,!1);const e=this.matrixWorld.elements;return n.set(-e[8],-e[9],-e[10]).normalize()},updateMatrixWorld:function(n){y.prototype.updateMatrixWorld.call(this,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(n,e){y.prototype.updateWorldMatrix.call(this,n,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return new this.constructor().copy(this)}}),O.prototype=Object.assign(Object.create(I.prototype),{constructor:O,isPerspectiveCamera:!0,copy:function(n,e){return I.prototype.copy.call(this,n,e),this.fov=n.fov,this.zoom=n.zoom,this.near=n.near,this.far=n.far,this.focus=n.focus,this.aspect=n.aspect,this.view=n.view===null?null:Object.assign({},n.view),this.filmGauge=n.filmGauge,this.filmOffset=n.filmOffset,this},setFocalLength:function(n){const e=.5*this.getFilmHeight()/n;this.fov=2*Kt.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){const n=Math.tan(.5*Kt.DEG2RAD*this.fov);return .5*this.getFilmHeight()/n},getEffectiveFOV:function(){return 2*Kt.RAD2DEG*Math.atan(Math.tan(.5*Kt.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(n,e,t,i,r,a){this.aspect=n/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=e,this.view.offsetX=t,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const n=this.near;let e=n*Math.tan(.5*Kt.DEG2RAD*this.fov)/this.zoom,t=2*e,i=this.aspect*t,r=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,h=a.fullHeight;r+=a.offsetX*i/l,e-=a.offsetY*t/h,i*=a.width/l,t*=a.height/h}const u=this.filmOffset;u!==0&&(r+=n*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,e,e-t,n,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(n){const e=y.prototype.toJSON.call(this,n);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}});class Xl extends y{constructor(e,t,i){if(super(),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=i;const r=new O(90,1,e,t);r.layers=this.layers,r.up.set(0,-1,0),r.lookAt(new U(1,0,0)),this.add(r);const a=new O(90,1,e,t);a.layers=this.layers,a.up.set(0,-1,0),a.lookAt(new U(-1,0,0)),this.add(a);const u=new O(90,1,e,t);u.layers=this.layers,u.up.set(0,0,1),u.lookAt(new U(0,1,0)),this.add(u);const l=new O(90,1,e,t);l.layers=this.layers,l.up.set(0,0,-1),l.lookAt(new U(0,-1,0)),this.add(l);const h=new O(90,1,e,t);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new U(0,0,1)),this.add(h);const p=new O(90,1,e,t);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new U(0,0,-1)),this.add(p)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[r,a,u,l,h,p]=this.children,g=e.xr.enabled,v=e.getRenderTarget();e.xr.enabled=!1;const b=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,a),e.setRenderTarget(i,2),e.render(t,u),e.setRenderTarget(i,3),e.render(t,l),e.setRenderTarget(i,4),e.render(t,h),i.texture.generateMipmaps=b,e.setRenderTarget(i,5),e.render(t,p),e.setRenderTarget(v),e.xr.enabled=g}}class ws extends ei{constructor(e,t,i,r,a,u,l,h,p,g){super(e=e!==void 0?e:[],t=t!==void 0?t:ha,i,r,a,u,l=l!==void 0?l:Gr,h,p,g),this._needsFlipEnvMap=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}ws.prototype.isCubeTexture=!0;class ql extends Tr{constructor(e,t,i){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=i),super(e,e,t),t=t||{},this.texture=new ws(void 0,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.generateMipmaps=t.generateMipmaps!==void 0&&t.generateMipmaps,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:$n,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.format=Di,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new So(5,5,5),a=new M({name:"CubemapFromEquirect",uniforms:xt(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Kn,blending:wr});a.uniforms.tEquirect.value=t;const u=new Ge(r,a),l=t.minFilter;return t.minFilter===ls&&(t.minFilter=$n),new Xl(1,10,this).update(e,u),t.minFilter=l,u.geometry.dispose(),u.material.dispose(),this}clear(e,t,i,r){const a=e.getRenderTarget();for(let u=0;u<6;u++)e.setRenderTarget(this,u),e.clear(t,i,r);e.setRenderTarget(a)}}ql.prototype.isWebGLCubeRenderTarget=!0;class Ms extends ei{constructor(e,t,i,r,a,u,l,h,p,g,v,b){super(null,u,l,h,p,g,r,a,v,b),this.image={data:e||null,width:t||1,height:i||1},this.magFilter=p!==void 0?p:Jn,this.minFilter=g!==void 0?g:Jn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Ms.prototype.isDataTexture=!0;const Ts=new jr,Yl=new U;class Ma{constructor(e=new Yi,t=new Yi,i=new Yi,r=new Yi,a=new Yi,u=new Yi){this.planes=[e,t,i,r,a,u]}set(e,t,i,r,a,u){const l=this.planes;return l[0].copy(e),l[1].copy(t),l[2].copy(i),l[3].copy(r),l[4].copy(a),l[5].copy(u),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,r=i[0],a=i[1],u=i[2],l=i[3],h=i[4],p=i[5],g=i[6],v=i[7],b=i[8],E=i[9],S=i[10],D=i[11],P=i[12],k=i[13],H=i[14],G=i[15];return t[0].setComponents(l-r,v-h,D-b,G-P).normalize(),t[1].setComponents(l+r,v+h,D+b,G+P).normalize(),t[2].setComponents(l+a,v+p,D+E,G+k).normalize(),t[3].setComponents(l-a,v-p,D-E,G-k).normalize(),t[4].setComponents(l-u,v-g,D-S,G-H).normalize(),t[5].setComponents(l+u,v+g,D+S,G+H).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Ts.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ts)}intersectsSprite(e){return Ts.center.set(0,0,0),Ts.radius=.7071067811865476,Ts.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ts)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let a=0;a<6;a++)if(t[a].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(Yl.x=r.normal.x>0?e.max.x:e.min.x,Yl.y=r.normal.y>0?e.max.y:e.min.y,Yl.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Yl)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Ta extends ve{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const a=e/2,u=t/2,l=Math.floor(i),h=Math.floor(r),p=l+1,g=h+1,v=e/l,b=t/h,E=[],S=[],D=[],P=[];for(let k=0;k<g;k++){const H=k*b-u;for(let G=0;G<p;G++){const W=G*v-a;S.push(W,-H,0),D.push(0,0,1),P.push(G/l),P.push(1-k/h)}}for(let k=0;k<h;k++)for(let H=0;H<l;H++){const G=H+p*k,W=H+p*(k+1),K=H+1+p*(k+1),Q=H+1+p*k;E.push(G,W,Q),E.push(W,K,Q)}this.setIndex(E),this.setAttribute("position",new ee(S,3)),this.setAttribute("normal",new ee(D,3)),this.setAttribute("uv",new ee(P,2))}}const pn={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,color_pars_vertex:`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,color_vertex:`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,common:`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );
		vec2 f = fract( uv );
		uv += 0.5 - f;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		vec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x += texelSize;
		vec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.y += texelSize;
		vec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		uv.x -= texelSize;
		vec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;
		vec3 tm = mix( tl, tr, f.x );
		vec3 bm = mix( bl, br, f.x );
		return mix( tm, bm, f.y );
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value ) {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( -viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
			vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = - mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3 diffuseColor;
	float specularRoughness;
	vec3 specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
		uniform float morphTargetInfluences[ 8 ];
	#else
		uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
		transformed += morphTarget4 * morphTargetInfluences[ 4 ];
		transformed += morphTarget5 * morphTargetInfluences[ 5 ];
		transformed += morphTarget6 * morphTargetInfluences[ 6 ];
		transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,transmissionmap_fragment:`#ifdef USE_TRANSMISSIONMAP
	totalTransmission *= texture2D( transmissionMap, vUv ).r;
#endif`,transmissionmap_pars_fragment:`#ifdef USE_TRANSMISSIONMAP
	uniform sampler2D transmissionMap;
#endif`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSMISSION
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSMISSION
	uniform float transmission;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <transmissionmap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#ifdef TRANSMISSION
		float totalTransmission = transmission;
	#endif
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <transmissionmap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSMISSION
		diffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},Et={common:{diffuse:{value:new Rt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Qn},uv2Transform:{value:new Qn},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Je(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Rt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Rt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Qn}},sprite:{diffuse:{value:new Rt(15658734)},opacity:{value:1},center:{value:new Je(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Qn}}},Ji={basic:{uniforms:At([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.fog]),vertexShader:pn.meshbasic_vert,fragmentShader:pn.meshbasic_frag},lambert:{uniforms:At([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.fog,Et.lights,{emissive:{value:new Rt(0)}}]),vertexShader:pn.meshlambert_vert,fragmentShader:pn.meshlambert_frag},phong:{uniforms:At([Et.common,Et.specularmap,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,Et.lights,{emissive:{value:new Rt(0)},specular:{value:new Rt(1118481)},shininess:{value:30}}]),vertexShader:pn.meshphong_vert,fragmentShader:pn.meshphong_frag},standard:{uniforms:At([Et.common,Et.envmap,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.roughnessmap,Et.metalnessmap,Et.fog,Et.lights,{emissive:{value:new Rt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:pn.meshphysical_vert,fragmentShader:pn.meshphysical_frag},toon:{uniforms:At([Et.common,Et.aomap,Et.lightmap,Et.emissivemap,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.gradientmap,Et.fog,Et.lights,{emissive:{value:new Rt(0)}}]),vertexShader:pn.meshtoon_vert,fragmentShader:pn.meshtoon_frag},matcap:{uniforms:At([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,Et.fog,{matcap:{value:null}}]),vertexShader:pn.meshmatcap_vert,fragmentShader:pn.meshmatcap_frag},points:{uniforms:At([Et.points,Et.fog]),vertexShader:pn.points_vert,fragmentShader:pn.points_frag},dashed:{uniforms:At([Et.common,Et.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:pn.linedashed_vert,fragmentShader:pn.linedashed_frag},depth:{uniforms:At([Et.common,Et.displacementmap]),vertexShader:pn.depth_vert,fragmentShader:pn.depth_frag},normal:{uniforms:At([Et.common,Et.bumpmap,Et.normalmap,Et.displacementmap,{opacity:{value:1}}]),vertexShader:pn.normal_vert,fragmentShader:pn.normal_frag},sprite:{uniforms:At([Et.sprite,Et.fog]),vertexShader:pn.sprite_vert,fragmentShader:pn.sprite_frag},background:{uniforms:{uvTransform:{value:new Qn},t2D:{value:null}},vertexShader:pn.background_vert,fragmentShader:pn.background_frag},cube:{uniforms:At([Et.envmap,{opacity:{value:1}}]),vertexShader:pn.cube_vert,fragmentShader:pn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:pn.equirect_vert,fragmentShader:pn.equirect_frag},distanceRGBA:{uniforms:At([Et.common,Et.displacementmap,{referencePosition:{value:new U},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:pn.distanceRGBA_vert,fragmentShader:pn.distanceRGBA_frag},shadow:{uniforms:At([Et.lights,Et.fog,{color:{value:new Rt(0)},opacity:{value:1}}]),vertexShader:pn.shadow_vert,fragmentShader:pn.shadow_frag}};Ji.physical={uniforms:At([Ji.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Je(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Rt(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:pn.meshphysical_vert,fragmentShader:pn.meshphysical_frag};class wh extends ei{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=Jn,this.minFilter=Jn,this.wrapR=xi,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}wh.prototype.isDataTexture2DArray=!0;class Mh extends ei{constructor(e=null,t=1,i=1,r=1){super(null),this.image={data:e,width:t,height:i,depth:r},this.magFilter=Jn,this.minFilter=Jn,this.wrapR=xi,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}}Mh.prototype.isDataTexture3D=!0;const Lm=new ei,Vv=new wh,Wv=new Mh,Pm=new ws,Dm=[],Nm=[],Im=new Float32Array(16),Om=new Float32Array(9),km=new Float32Array(4);gt.prototype.updateCache=function(n){const e=this.cache;n instanceof Float32Array&&e.length!==n.length&&(this.cache=new Float32Array(n.length)),ae(e,n)},yt.prototype.setValue=function(n,e,t){const i=this.seq;for(let r=0,a=i.length;r!==a;++r){const u=i[r];u.setValue(n,e[u.id],t)}};const Th=/(\w+)(\])?(\[|\.)?/g;pt.prototype.setValue=function(n,e,t,i){const r=this.map[e];r!==void 0&&r.setValue(n,t,i)},pt.prototype.setOptional=function(n,e,t){const i=e[t];i!==void 0&&this.setValue(n,t,i)},pt.upload=function(n,e,t,i){for(let r=0,a=e.length;r!==a;++r){const u=e[r],l=t[u.id];l.needsUpdate!==!1&&u.setValue(n,l.value,i)}},pt.seqWithValue=function(n,e){const t=[];for(let i=0,r=n.length;i!==r;++i){const a=n[i];a.id in e&&t.push(a)}return t};let jv=0;const Xv=/^[ \t]*#include +<([\w\d./]+)>/gm,qv=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Yv=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;let Kv=0;class Kl extends x{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Kl.prototype.isMeshDepthMaterial=!0;class Zl extends x{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new U,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}Zl.prototype.isMeshDistanceMaterial=!0;var Zv=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	float mean = 0.0;
	float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );
	for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean * HALF_SAMPLE_RATE;
	squared_mean = squared_mean * HALF_SAMPLE_RATE;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,Jv=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;class Sh extends O{constructor(e=[]){super(),this.cameras=e}}Sh.prototype.isArrayCamera=!0;class Ao extends y{constructor(){super(),this.type="Group"}}Ao.prototype.isGroup=!0,Object.assign(ur.prototype,{constructor:ur,getHandSpace:function(){return this._hand===null&&(this._hand=new Ao,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Ao,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Ao,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(n){return this._targetRay!==null&&this._targetRay.dispatchEvent(n),this._grip!==null&&this._grip.dispatchEvent(n),this._hand!==null&&this._hand.dispatchEvent(n),this},disconnect:function(n){return this.dispatchEvent({type:"disconnected",data:n}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this},update:function(n,e,t){let i=null,r=null,a=null;const u=this._targetRay,l=this._grip,h=this._hand;if(n&&e.session.visibilityState!=="visible-blurred")if(u!==null&&(i=e.getPose(n.targetRaySpace,t))!==null&&(u.matrix.fromArray(i.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale)),h&&n.hand){a=!0;for(const b of n.hand.values()){const E=e.getJointPose(b,t);if(h.joints[b.jointName]===void 0){const D=new Ao;D.matrixAutoUpdate=!1,D.visible=!1,h.joints[b.jointName]=D,h.add(D)}const S=h.joints[b.jointName];E!==null&&(S.matrix.fromArray(E.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=E.radius),S.visible=E!==null}const p=h.joints["index-finger-tip"],g=h.joints["thumb-tip"],v=p.position.distanceTo(g.position);h.inputState.pinching&&v>.025?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:n.handedness,target:this})):!h.inputState.pinching&&v<=.015&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:n.handedness,target:this}))}else l!==null&&n.gripSpace&&(r=e.getPose(n.gripSpace,t))!==null&&(l.matrix.fromArray(r.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale));return u!==null&&(u.visible=i!==null),l!==null&&(l.visible=r!==null),h!==null&&(h.visible=a!==null),this}}),Object.assign(Xi.prototype,d.prototype);class Fm extends xn{}Fm.prototype.isWebGL1Renderer=!0;class Sa{constructor(e,t=25e-5){this.name="",this.color=new Rt(e),this.density=t}clone(){return new Sa(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Sa.prototype.isFogExp2=!0;class Aa{constructor(e,t=1,i=1e3){this.name="",this.color=new Rt(e),this.near=t,this.far=i}clone(){return new Aa(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Aa.prototype.isFog=!0;class Jl extends y{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.background!==null&&(t.object.background=this.background.toJSON(e)),this.environment!==null&&(t.object.environment=this.environment.toJSON(e)),this.fog!==null&&(t.object.fog=this.fog.toJSON()),t}}Jl.prototype.isScene=!0,Object.defineProperty(qn.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}}),Object.assign(qn.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(n){return this.usage=n,this},copy:function(n){return this.array=new n.array.constructor(n.array),this.count=n.count,this.stride=n.stride,this.usage=n.usage,this},copyAt:function(n,e,t){n*=this.stride,t*=e.stride;for(let i=0,r=this.stride;i<r;i++)this.array[n+i]=e.array[t+i];return this},set:function(n,e=0){return this.array.set(n,e),this},clone:function(n){n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Kt.generateUUID()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const e=new qn(new this.array.constructor(n.arrayBuffers[this.array.buffer._uuid]),this.stride);return e.setUsage(this.usage),e},onUpload:function(n){return this.onUploadCallback=n,this},toJSON:function(n){return n.arrayBuffers===void 0&&(n.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Kt.generateUUID()),n.arrayBuffers[this.array.buffer._uuid]===void 0&&(n.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const Vn=new U;Object.defineProperties(hr.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(n){this.data.needsUpdate=n}}}),Object.assign(hr.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(n){for(let e=0,t=this.data.count;e<t;e++)Vn.x=this.getX(e),Vn.y=this.getY(e),Vn.z=this.getZ(e),Vn.applyMatrix4(n),this.setXYZ(e,Vn.x,Vn.y,Vn.z);return this},applyNormalMatrix:function(n){for(let e=0,t=this.count;e<t;e++)Vn.x=this.getX(e),Vn.y=this.getY(e),Vn.z=this.getZ(e),Vn.applyNormalMatrix(n),this.setXYZ(e,Vn.x,Vn.y,Vn.z);return this},transformDirection:function(n){for(let e=0,t=this.count;e<t;e++)Vn.x=this.getX(e),Vn.y=this.getY(e),Vn.z=this.getZ(e),Vn.transformDirection(n),this.setXYZ(e,Vn.x,Vn.y,Vn.z);return this},setX:function(n,e){return this.data.array[n*this.data.stride+this.offset]=e,this},setY:function(n,e){return this.data.array[n*this.data.stride+this.offset+1]=e,this},setZ:function(n,e){return this.data.array[n*this.data.stride+this.offset+2]=e,this},setW:function(n,e){return this.data.array[n*this.data.stride+this.offset+3]=e,this},getX:function(n){return this.data.array[n*this.data.stride+this.offset]},getY:function(n){return this.data.array[n*this.data.stride+this.offset+1]},getZ:function(n){return this.data.array[n*this.data.stride+this.offset+2]},getW:function(n){return this.data.array[n*this.data.stride+this.offset+3]},setXY:function(n,e,t){return n=n*this.data.stride+this.offset,this.data.array[n+0]=e,this.data.array[n+1]=t,this},setXYZ:function(n,e,t,i){return n=n*this.data.stride+this.offset,this.data.array[n+0]=e,this.data.array[n+1]=t,this.data.array[n+2]=i,this},setXYZW:function(n,e,t,i,r){return n=n*this.data.stride+this.offset,this.data.array[n+0]=e,this.data.array[n+1]=t,this.data.array[n+2]=i,this.data.array[n+3]=r,this},clone:function(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const i=t*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return new N(new this.array.constructor(e),this.itemSize,this.normalized)}return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.clone(n)),new hr(n.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(n){if(n===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const e=[];for(let t=0;t<this.count;t++){const i=t*this.data.stride+this.offset;for(let r=0;r<this.itemSize;r++)e.push(this.data.array[i+r])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return n.interleavedBuffers===void 0&&(n.interleavedBuffers={}),n.interleavedBuffers[this.data.uuid]===void 0&&(n.interleavedBuffers[this.data.uuid]=this.data.toJSON(n)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});class $l extends x{constructor(e){super(),this.type="SpriteMaterial",this.color=new Rt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}$l.prototype.isSpriteMaterial=!0;let Ss;const Ra=new U,As=new U,Rs=new U,Cs=new Je,Ca=new Je,Hm=new Bt,Ql=new U,La=new U,ec=new U,Bm=new Je,Ah=new Je,Um=new Je;class tc extends y{constructor(e){if(super(),this.type="Sprite",Ss===void 0){Ss=new ve;const t=new qn(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Ss.setIndex([0,1,2,0,2,3]),Ss.setAttribute("position",new hr(t,3,0,!1)),Ss.setAttribute("uv",new hr(t,2,3,!1))}this.geometry=Ss,this.material=e!==void 0?e:new $l,this.center=new Je(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),As.setFromMatrixScale(this.matrixWorld),Hm.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Rs.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&As.multiplyScalar(-Rs.z);const i=this.material.rotation;let r,a;i!==0&&(a=Math.cos(i),r=Math.sin(i));const u=this.center;br(Ql.set(-.5,-.5,0),Rs,u,As,r,a),br(La.set(.5,-.5,0),Rs,u,As,r,a),br(ec.set(.5,.5,0),Rs,u,As,r,a),Bm.set(0,0),Ah.set(1,0),Um.set(1,1);let l=e.ray.intersectTriangle(Ql,La,ec,!1,Ra);if(l===null&&(br(La.set(-.5,.5,0),Rs,u,As,r,a),Ah.set(0,1),(l=e.ray.intersectTriangle(Ql,ec,La,!1,Ra))===null))return;const h=e.ray.origin.distanceTo(Ra);h<e.near||h>e.far||t.push({distance:h,point:Ra.clone(),uv:Gn.getUV(Ra,Ql,La,ec,Bm,Ah,Um,new Je),face:null,object:this})}copy(e){return super.copy(e),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}tc.prototype.isSprite=!0;const nc=new U,zm=new U;class Gm extends y{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const a=t[i];this.addLevel(a.object.clone(),a.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0){t=Math.abs(t);const i=this.levels;let r;for(r=0;r<i.length&&!(t<i[r].distance);r++);return i.splice(r,0,{distance:t,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r&&!(e<t[i].distance);i++);return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){nc.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(nc);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){nc.setFromMatrixPosition(e.matrixWorld),zm.setFromMatrixPosition(this.matrixWorld);const i=nc.distanceTo(zm)/e.zoom;t[0].object.visible=!0;let r,a;for(r=1,a=t.length;r<a&&i>=t[r].distance;r++)t[r-1].object.visible=!1,t[r].object.visible=!0;for(this._currentLevel=r-1;r<a;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,a=i.length;r<a;r++){const u=i[r];t.object.levels.push({object:u.object.uuid,distance:u.distance})}return t}}const Vm=new U,Wm=new Mn,jm=new Mn,$v=new U,Xm=new Bt;wi.prototype=Object.assign(Object.create(Ge.prototype),{constructor:wi,isSkinnedMesh:!0,copy:function(n){return Ge.prototype.copy.call(this,n),this.bindMode=n.bindMode,this.bindMatrix.copy(n.bindMatrix),this.bindMatrixInverse.copy(n.bindMatrixInverse),this.skeleton=n.skeleton,this},bind:function(n,e){this.skeleton=n,e===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.copy(e).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const n=new Mn,e=this.geometry.attributes.skinWeight;for(let t=0,i=e.count;t<i;t++){n.x=e.getX(t),n.y=e.getY(t),n.z=e.getZ(t),n.w=e.getW(t);const r=1/n.manhattanLength();r!==1/0?n.multiplyScalar(r):n.set(1,0,0,0),e.setXYZW(t,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(n){Ge.prototype.updateMatrixWorld.call(this,n),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(n,e){const t=this.skeleton,i=this.geometry;Wm.fromBufferAttribute(i.attributes.skinIndex,n),jm.fromBufferAttribute(i.attributes.skinWeight,n),Vm.fromBufferAttribute(i.attributes.position,n).applyMatrix4(this.bindMatrix),e.set(0,0,0);for(let r=0;r<4;r++){const a=jm.getComponent(r);if(a!==0){const u=Wm.getComponent(r);Xm.multiplyMatrices(t.bones[u].matrixWorld,t.boneInverses[u]),e.addScaledVector($v.copy(Vm).applyMatrix4(Xm),a)}}return e.applyMatrix4(this.bindMatrixInverse)}}),Yn.prototype=Object.assign(Object.create(y.prototype),{constructor:Yn,isBone:!0});const qm=new Bt,Qv=new Bt;class ic{constructor(e=[],t=[]){this.uuid=Kt.generateUUID(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Bt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Bt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let a=0,u=e.length;a<u;a++){const l=e[a]?e[a].matrixWorld:Qv;qm.multiplyMatrices(l,t[a]),qm.toArray(i,16*a)}r!==null&&(r.needsUpdate=!0)}clone(){return new ic(this.bones,this.boneInverses)}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const a=e.bones[i];let u=t[a];u===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),u=new Yn),this.bones.push(u),this.boneInverses.push(new Bt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,a=t.length;r<a;r++){const u=t[r];e.bones.push(u.uuid);const l=i[r];e.boneInverses.push(l.toArray())}return e}}const Ym=new Bt,Km=new Bt,rc=[],Pa=new Ge;Bi.prototype=Object.assign(Object.create(Ge.prototype),{constructor:Bi,isInstancedMesh:!0,copy:function(n){return Ge.prototype.copy.call(this,n),this.instanceMatrix.copy(n.instanceMatrix),n.instanceColor!==null&&(this.instanceColor=n.instanceColor.clone()),this.count=n.count,this},getColorAt:function(n,e){e.fromArray(this.instanceColor.array,3*n)},getMatrixAt:function(n,e){e.fromArray(this.instanceMatrix.array,16*n)},raycast:function(n,e){const t=this.matrixWorld,i=this.count;if(Pa.geometry=this.geometry,Pa.material=this.material,Pa.material!==void 0)for(let r=0;r<i;r++){this.getMatrixAt(r,Ym),Km.multiplyMatrices(t,Ym),Pa.matrixWorld=Km,Pa.raycast(n,rc);for(let a=0,u=rc.length;a<u;a++){const l=rc[a];l.instanceId=r,l.object=this,e.push(l)}rc.length=0}},setColorAt:function(n,e){this.instanceColor===null&&(this.instanceColor=new N(new Float32Array(3*this.count),3)),e.toArray(this.instanceColor.array,3*n)},setMatrixAt:function(n,e){e.toArray(this.instanceMatrix.array,16*n)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});class oi extends x{constructor(e){super(),this.type="LineBasicMaterial",this.color=new Rt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}oi.prototype.isLineBasicMaterial=!0;const Zm=new U,Jm=new U,$m=new Bt,Rh=new qr,oc=new jr;Nn.prototype=Object.assign(Object.create(y.prototype),{constructor:Nn,isLine:!0,copy:function(n){return y.prototype.copy.call(this,n),this.material=n.material,this.geometry=n.geometry,this},computeLineDistances:function(){const n=this.geometry;if(n.isBufferGeometry)if(n.index===null){const e=n.attributes.position,t=[0];for(let i=1,r=e.count;i<r;i++)Zm.fromBufferAttribute(e,i-1),Jm.fromBufferAttribute(e,i),t[i]=t[i-1],t[i]+=Zm.distanceTo(Jm);n.setAttribute("lineDistance",new ee(t,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else n.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(n,e){const t=this.geometry,i=this.matrixWorld,r=n.params.Line.threshold,a=t.drawRange;if(t.boundingSphere===null&&t.computeBoundingSphere(),oc.copy(t.boundingSphere),oc.applyMatrix4(i),oc.radius+=r,n.ray.intersectsSphere(oc)===!1)return;$m.copy(i).invert(),Rh.copy(n.ray).applyMatrix4($m);const u=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u,h=new U,p=new U,g=new U,v=new U,b=this.isLineSegments?2:1;if(t.isBufferGeometry){const E=t.index,S=t.attributes.position;if(E!==null)for(let D=Math.max(0,a.start),P=Math.min(E.count,a.start+a.count)-1;D<P;D+=b){const k=E.getX(D),H=E.getX(D+1);if(h.fromBufferAttribute(S,k),p.fromBufferAttribute(S,H),Rh.distanceSqToSegment(h,p,v,g)>l)continue;v.applyMatrix4(this.matrixWorld);const G=n.ray.origin.distanceTo(v);G<n.near||G>n.far||e.push({distance:G,point:g.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}else for(let D=Math.max(0,a.start),P=Math.min(S.count,a.start+a.count)-1;D<P;D+=b){if(h.fromBufferAttribute(S,D),p.fromBufferAttribute(S,D+1),Rh.distanceSqToSegment(h,p,v,g)>l)continue;v.applyMatrix4(this.matrixWorld);const k=n.ray.origin.distanceTo(v);k<n.near||k>n.far||e.push({distance:k,point:g.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}}else t.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const n=this.geometry;if(n.isBufferGeometry){const e=n.morphAttributes,t=Object.keys(e);if(t.length>0){const i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=i.length;r<a;r++){const u=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=r}}}}else{const e=n.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Qm=new U,eg=new U;vi.prototype=Object.assign(Object.create(Nn.prototype),{constructor:vi,isLineSegments:!0,computeLineDistances:function(){const n=this.geometry;if(n.isBufferGeometry)if(n.index===null){const e=n.attributes.position,t=[];for(let i=0,r=e.count;i<r;i+=2)Qm.fromBufferAttribute(e,i),eg.fromBufferAttribute(e,i+1),t[i]=i===0?0:t[i-1],t[i+1]=t[i]+Qm.distanceTo(eg);n.setAttribute("lineDistance",new ee(t,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else n.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});class Ch extends Nn{constructor(e,t){super(e,t),this.type="LineLoop"}}Ch.prototype.isLineLoop=!0;class Ro extends x{constructor(e){super(),this.type="PointsMaterial",this.color=new Rt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}Ro.prototype.isPointsMaterial=!0;const tg=new Bt,Lh=new qr,sc=new jr,ac=new U;ts.prototype=Object.assign(Object.create(y.prototype),{constructor:ts,isPoints:!0,copy:function(n){return y.prototype.copy.call(this,n),this.material=n.material,this.geometry=n.geometry,this},raycast:function(n,e){const t=this.geometry,i=this.matrixWorld,r=n.params.Points.threshold,a=t.drawRange;if(t.boundingSphere===null&&t.computeBoundingSphere(),sc.copy(t.boundingSphere),sc.applyMatrix4(i),sc.radius+=r,n.ray.intersectsSphere(sc)===!1)return;tg.copy(i).invert(),Lh.copy(n.ray).applyMatrix4(tg);const u=r/((this.scale.x+this.scale.y+this.scale.z)/3),l=u*u;if(t.isBufferGeometry){const h=t.index,p=t.attributes.position;if(h!==null)for(let g=Math.max(0,a.start),v=Math.min(h.count,a.start+a.count);g<v;g++){const b=h.getX(g);ac.fromBufferAttribute(p,b),Sp(ac,b,l,i,n,e,this)}else for(let g=Math.max(0,a.start),v=Math.min(p.count,a.start+a.count);g<v;g++)ac.fromBufferAttribute(p,g),Sp(ac,g,l,i,n,e,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},updateMorphTargets:function(){const n=this.geometry;if(n.isBufferGeometry){const e=n.morphAttributes,t=Object.keys(e);if(t.length>0){const i=e[t[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let r=0,a=i.length;r<a;r++){const u=i[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=r}}}}else{const e=n.morphTargets;e!==void 0&&e.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});class ng extends ei{constructor(e,t,i,r,a,u,l,h,p){function g(){v.needsUpdate=!0,e.requestVideoFrameCallback(g)}super(e,t,i,r,a,u,l,h,p),this.format=l!==void 0?l:Gr,this.minFilter=u!==void 0?u:$n,this.magFilter=a!==void 0?a:$n,this.generateMipmaps=!1;const v=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(g)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}ng.prototype.isVideoTexture=!0;class Ph extends ei{constructor(e,t,i,r,a,u,l,h,p,g,v,b){super(null,u,l,h,p,g,r,a,v,b),this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Ph.prototype.isCompressedTexture=!0;class ig extends ei{constructor(e,t,i,r,a,u,l,h,p){super(e,t,i,r,a,u,l,h,p),this.needsUpdate=!0}}ig.prototype.isCanvasTexture=!0;class rg extends ei{constructor(e,t,i,r,a,u,l,h,p,g){if((g=g!==void 0?g:xo)!==xo&&g!==hs)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&g===xo&&(i=ga),i===void 0&&g===hs&&(i=us),super(null,r,a,u,l,h,g,i,p),this.image={width:e,height:t},this.magFilter=l!==void 0?l:Jn,this.minFilter=h!==void 0?h:Jn,this.flipY=!1,this.generateMipmaps=!1}}rg.prototype.isDepthTexture=!0;class lc extends ve{constructor(e=1,t=8,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const a=[],u=[],l=[],h=[],p=new U,g=new Je;u.push(0,0,0),l.push(0,0,1),h.push(.5,.5);for(let v=0,b=3;v<=t;v++,b+=3){const E=i+v/t*r;p.x=e*Math.cos(E),p.y=e*Math.sin(E),u.push(p.x,p.y,p.z),l.push(0,0,1),g.x=(u[b]/e+1)/2,g.y=(u[b+1]/e+1)/2,h.push(g.x,g.y)}for(let v=1;v<=t;v++)a.push(v,v+1,0);this.setIndex(a),this.setAttribute("position",new ee(u,3)),this.setAttribute("normal",new ee(l,3)),this.setAttribute("uv",new ee(h,2))}}class Ls extends ve{constructor(e=1,t=1,i=1,r=8,a=1,u=!1,l=0,h=2*Math.PI){function p(G){const W=D,K=new Je,Q=new U;let V=0;const ge=G===!0?e:t,Z=G===!0?1:-1;for(let we=1;we<=r;we++)b.push(0,k*Z,0),E.push(0,Z,0),S.push(.5,.5),D++;const xe=D;for(let we=0;we<=r;we++){const be=we/r*h+l,Me=Math.cos(be),$e=Math.sin(be);Q.x=ge*$e,Q.y=k*Z,Q.z=ge*Me,b.push(Q.x,Q.y,Q.z),E.push(0,Z,0),K.x=.5*Me+.5,K.y=.5*$e*Z+.5,S.push(K.x,K.y),D++}for(let we=0;we<r;we++){const be=W+we,Me=xe+we;G===!0?v.push(Me,Me+1,be):v.push(Me+1,Me,be),V+=3}g.addGroup(H,V,G===!0?1:2),H+=V}super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:a,openEnded:u,thetaStart:l,thetaLength:h};const g=this;r=Math.floor(r),a=Math.floor(a);const v=[],b=[],E=[],S=[];let D=0;const P=[],k=i/2;let H=0;(function(){const G=new U,W=new U;let K=0;const Q=(t-e)/i;for(let V=0;V<=a;V++){const ge=[],Z=V/a,xe=Z*(t-e)+e;for(let we=0;we<=r;we++){const be=we/r,Me=be*h+l,$e=Math.sin(Me),ct=Math.cos(Me);W.x=xe*$e,W.y=-Z*i+k,W.z=xe*ct,b.push(W.x,W.y,W.z),G.set($e,Q,ct).normalize(),E.push(G.x,G.y,G.z),S.push(be,1-Z),ge.push(D++)}P.push(ge)}for(let V=0;V<r;V++)for(let ge=0;ge<a;ge++){const Z=P[ge][V],xe=P[ge+1][V],we=P[ge+1][V+1],be=P[ge][V+1];v.push(Z,xe,be),v.push(xe,we,be),K+=6}g.addGroup(H,K,0),H+=K})(),u===!1&&(e>0&&p(!0),t>0&&p(!1)),this.setIndex(v),this.setAttribute("position",new ee(b,3)),this.setAttribute("normal",new ee(E,3)),this.setAttribute("uv",new ee(S,2))}}class cc extends Ls{constructor(e=1,t=1,i=8,r=1,a=!1,u=0,l=2*Math.PI){super(0,e,t,i,r,a,u,l),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:u,thetaLength:l}}}class $r extends ve{constructor(e,t,i=1,r=0){function a(v){p.push(v.x,v.y,v.z)}function u(v,b){const E=3*v;b.x=e[E+0],b.y=e[E+1],b.z=e[E+2]}function l(v,b,E,S){S<0&&v.x===1&&(g[b]=v.x-1),E.x===0&&E.z===0&&(g[b]=S/2/Math.PI+.5)}function h(v){return Math.atan2(v.z,-v.x)}super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const p=[],g=[];(function(v){const b=new U,E=new U,S=new U;for(let D=0;D<t.length;D+=3)u(t[D+0],b),u(t[D+1],E),u(t[D+2],S),function(P,k,H,G){const W=G+1,K=[];for(let Q=0;Q<=W;Q++){K[Q]=[];const V=P.clone().lerp(H,Q/W),ge=k.clone().lerp(H,Q/W),Z=W-Q;for(let xe=0;xe<=Z;xe++)K[Q][xe]=xe===0&&Q===W?V:V.clone().lerp(ge,xe/Z)}for(let Q=0;Q<W;Q++)for(let V=0;V<2*(W-Q)-1;V++){const ge=Math.floor(V/2);V%2==0?(a(K[Q][ge+1]),a(K[Q+1][ge]),a(K[Q][ge])):(a(K[Q][ge+1]),a(K[Q+1][ge+1]),a(K[Q+1][ge]))}}(b,E,S,v)})(r),function(v){const b=new U;for(let E=0;E<p.length;E+=3)b.x=p[E+0],b.y=p[E+1],b.z=p[E+2],b.normalize().multiplyScalar(v),p[E+0]=b.x,p[E+1]=b.y,p[E+2]=b.z}(i),function(){const v=new U;for(let b=0;b<p.length;b+=3){v.x=p[b+0],v.y=p[b+1],v.z=p[b+2];const E=h(v)/2/Math.PI+.5,S=function(D){return Math.atan2(-D.y,Math.sqrt(D.x*D.x+D.z*D.z))}(v)/Math.PI+.5;g.push(E,1-S)}(function(){const b=new U,E=new U,S=new U,D=new U,P=new Je,k=new Je,H=new Je;for(let G=0,W=0;G<p.length;G+=9,W+=6){b.set(p[G+0],p[G+1],p[G+2]),E.set(p[G+3],p[G+4],p[G+5]),S.set(p[G+6],p[G+7],p[G+8]),P.set(g[W+0],g[W+1]),k.set(g[W+2],g[W+3]),H.set(g[W+4],g[W+5]),D.copy(b).add(E).add(S).divideScalar(3);const K=h(D);l(P,W+0,b,K),l(k,W+2,E,K),l(H,W+4,S,K)}})(),function(){for(let b=0;b<g.length;b+=6){const E=g[b+0],S=g[b+2],D=g[b+4],P=Math.max(E,S,D),k=Math.min(E,S,D);P>.9&&k<.1&&(E<.2&&(g[b+0]+=1),S<.2&&(g[b+2]+=1),D<.2&&(g[b+4]+=1))}}()}(),this.setAttribute("position",new ee(p,3)),this.setAttribute("normal",new ee(p.slice(),3)),this.setAttribute("uv",new ee(g,2)),r===0?this.computeVertexNormals():this.normalizeNormals()}}class uc extends $r{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}}const hc=new U,dc=new U,Dh=new U,pc=new Gn;class Nh extends ve{constructor(e,t){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=t!==void 0?t:1,e.isGeometry===!0)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const i=Math.pow(10,4),r=Math.cos(Kt.DEG2RAD*t),a=e.getIndex(),u=e.getAttribute("position"),l=a?a.count:u.count,h=[0,0,0],p=["a","b","c"],g=new Array(3),v={},b=[];for(let E=0;E<l;E+=3){a?(h[0]=a.getX(E),h[1]=a.getX(E+1),h[2]=a.getX(E+2)):(h[0]=E,h[1]=E+1,h[2]=E+2);const{a:S,b:D,c:P}=pc;if(S.fromBufferAttribute(u,h[0]),D.fromBufferAttribute(u,h[1]),P.fromBufferAttribute(u,h[2]),pc.getNormal(Dh),g[0]=`${Math.round(S.x*i)},${Math.round(S.y*i)},${Math.round(S.z*i)}`,g[1]=`${Math.round(D.x*i)},${Math.round(D.y*i)},${Math.round(D.z*i)}`,g[2]=`${Math.round(P.x*i)},${Math.round(P.y*i)},${Math.round(P.z*i)}`,g[0]!==g[1]&&g[1]!==g[2]&&g[2]!==g[0])for(let k=0;k<3;k++){const H=(k+1)%3,G=g[k],W=g[H],K=pc[p[k]],Q=pc[p[H]],V=`${G}_${W}`,ge=`${W}_${G}`;ge in v&&v[ge]?(Dh.dot(v[ge].normal)<=r&&(b.push(K.x,K.y,K.z),b.push(Q.x,Q.y,Q.z)),v[ge]=null):V in v||(v[V]={index0:h[k],index1:h[H],normal:Dh.clone()})}}for(const E in v)if(v[E]){const{index0:S,index1:D}=v[E];hc.fromBufferAttribute(u,S),dc.fromBufferAttribute(u,D),b.push(hc.x,hc.y,hc.z),b.push(dc.x,dc.y,dc.z)}this.setAttribute("position",new ee(b,3))}}const ey={triangulate:function(n,e,t){t=t||2;const i=e&&e.length,r=i?e[0]*t:n.length;let a=Ap(n,0,r,t,!0);const u=[];if(!a||a.next===a.prev)return u;let l,h,p,g,v,b,E;if(i&&(a=Mv(n,e,a,t)),n.length>80*t){l=p=n[0],h=g=n[1];for(let S=t;S<r;S+=t)v=n[S],b=n[S+1],v<l&&(l=v),b<h&&(h=b),v>p&&(p=v),b>g&&(g=b);E=(E=Math.max(p-l,g-h))!==0?1/E:0}return na(a,u,t,l,h,E),u}},Dr={area:function(n){const e=n.length;let t=0;for(let i=e-1,r=0;r<e;i=r++)t+=n[i].x*n[r].y-n[r].x*n[i].y;return .5*t},isClockWise:function(n){return Dr.area(n)<0},triangulateShape:function(n,e){const t=[],i=[],r=[];Pp(n),Dp(t,n);let a=n.length;e.forEach(Pp);for(let l=0;l<e.length;l++)i.push(a),a+=e[l].length,Dp(t,e[l]);const u=ey.triangulate(t,i);for(let l=0;l<u.length;l+=3)r.push(u.slice(l,l+3));return r}};class Nr extends ve{constructor(e,t){function i(l){function h(We,Ke,ze){return Ke||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ke.clone().multiplyScalar(ze).add(We)}function p(We,Ke,ze){let Ct,bt,Yt;const Pt=We.x-Ke.x,nn=We.y-Ke.y,Tn=ze.x-We.x,ie=ze.y-We.y,ln=Pt*Pt+nn*nn,gn=Pt*ie-nn*Tn;if(Math.abs(gn)>Number.EPSILON){const dn=Math.sqrt(ln),Zn=Math.sqrt(Tn*Tn+ie*ie),Sn=Ke.x-nn/dn,mi=Ke.y+Pt/dn,Ir=((ze.x-ie/Zn-Sn)*ie-(ze.y+Tn/Zn-mi)*Tn)/(Pt*ie-nn*Tn),no=(Ct=Sn+Pt*Ir-We.x)*Ct+(bt=mi+nn*Ir-We.y)*bt;if(no<=2)return new Je(Ct,bt);Yt=Math.sqrt(no/2)}else{let dn=!1;Pt>Number.EPSILON?Tn>Number.EPSILON&&(dn=!0):Pt<-Number.EPSILON?Tn<-Number.EPSILON&&(dn=!0):Math.sign(nn)===Math.sign(ie)&&(dn=!0),dn?(Ct=-nn,bt=Pt,Yt=Math.sqrt(ln)):(Ct=Pt,bt=nn,Yt=Math.sqrt(ln/2))}return new Je(Ct/Yt,bt/Yt)}function g(We,Ke){let ze=We.length;for(;--ze>=0;){const Ct=ze;let bt=ze-1;bt<0&&(bt=We.length-1);for(let Yt=0,Pt=k+2*V;Yt<Pt;Yt++){const nn=cn*Yt,Tn=cn*(Yt+1);(function(ie,ln,gn,dn){E(ie),E(ln),E(dn),E(ln),E(gn),E(dn);const Zn=a.length/3,Sn=Z.generateSideWallUV(r,a,Zn-6,Zn-3,Zn-2,Zn-1);S(Sn[0]),S(Sn[1]),S(Sn[3]),S(Sn[1]),S(Sn[2]),S(Sn[3])})(Ke+Ct+nn,Ke+bt+nn,Ke+bt+Tn,Ke+Ct+Tn)}}}function v(We,Ke,ze){D.push(We),D.push(Ke),D.push(ze)}function b(We,Ke,ze){E(We),E(Ke),E(ze);const Ct=a.length/3,bt=Z.generateTopUV(r,a,Ct-3,Ct-2,Ct-1);S(bt[0]),S(bt[1]),S(bt[2])}function E(We){a.push(D[3*We+0]),a.push(D[3*We+1]),a.push(D[3*We+2])}function S(We){u.push(We.x),u.push(We.y)}const D=[],P=t.curveSegments!==void 0?t.curveSegments:12,k=t.steps!==void 0?t.steps:1;let H=t.depth!==void 0?t.depth:100,G=t.bevelEnabled===void 0||t.bevelEnabled,W=t.bevelThickness!==void 0?t.bevelThickness:6,K=t.bevelSize!==void 0?t.bevelSize:W-2,Q=t.bevelOffset!==void 0?t.bevelOffset:0,V=t.bevelSegments!==void 0?t.bevelSegments:3;const ge=t.extrudePath,Z=t.UVGenerator!==void 0?t.UVGenerator:ty;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),H=t.amount);let xe,we,be,Me,$e,ct=!1;ge&&(xe=ge.getSpacedPoints(k),ct=!0,G=!1,we=ge.computeFrenetFrames(k,!1),be=new U,Me=new U,$e=new U),G||(V=0,W=0,K=0,Q=0);const Wt=l.extractPoints(P);let dt=Wt.shape;const nt=Wt.holes;if(!Dr.isClockWise(dt)){dt=dt.reverse();for(let We=0,Ke=nt.length;We<Ke;We++){const ze=nt[We];Dr.isClockWise(ze)&&(nt[We]=ze.reverse())}}const Gt=Dr.triangulateShape(dt,nt),Ot=dt;for(let We=0,Ke=nt.length;We<Ke;We++){const ze=nt[We];dt=dt.concat(ze)}const cn=dt.length,oe=Gt.length,re=[];for(let We=0,Ke=Ot.length,ze=Ke-1,Ct=We+1;We<Ke;We++,ze++,Ct++)ze===Ke&&(ze=0),Ct===Ke&&(Ct=0),re[We]=p(Ot[We],Ot[ze],Ot[Ct]);const ot=[];let Ue,Xe=re.concat();for(let We=0,Ke=nt.length;We<Ke;We++){const ze=nt[We];Ue=[];for(let Ct=0,bt=ze.length,Yt=bt-1,Pt=Ct+1;Ct<bt;Ct++,Yt++,Pt++)Yt===bt&&(Yt=0),Pt===bt&&(Pt=0),Ue[Ct]=p(ze[Ct],ze[Yt],ze[Pt]);ot.push(Ue),Xe=Xe.concat(Ue)}for(let We=0;We<V;We++){const Ke=We/V,ze=W*Math.cos(Ke*Math.PI/2),Ct=K*Math.sin(Ke*Math.PI/2)+Q;for(let bt=0,Yt=Ot.length;bt<Yt;bt++){const Pt=h(Ot[bt],re[bt],Ct);v(Pt.x,Pt.y,-ze)}for(let bt=0,Yt=nt.length;bt<Yt;bt++){const Pt=nt[bt];Ue=ot[bt];for(let nn=0,Tn=Pt.length;nn<Tn;nn++){const ie=h(Pt[nn],Ue[nn],Ct);v(ie.x,ie.y,-ze)}}}const qt=K+Q;for(let We=0;We<cn;We++){const Ke=G?h(dt[We],Xe[We],qt):dt[We];ct?(Me.copy(we.normals[0]).multiplyScalar(Ke.x),be.copy(we.binormals[0]).multiplyScalar(Ke.y),$e.copy(xe[0]).add(Me).add(be),v($e.x,$e.y,$e.z)):v(Ke.x,Ke.y,0)}for(let We=1;We<=k;We++)for(let Ke=0;Ke<cn;Ke++){const ze=G?h(dt[Ke],Xe[Ke],qt):dt[Ke];ct?(Me.copy(we.normals[We]).multiplyScalar(ze.x),be.copy(we.binormals[We]).multiplyScalar(ze.y),$e.copy(xe[We]).add(Me).add(be),v($e.x,$e.y,$e.z)):v(ze.x,ze.y,H/k*We)}for(let We=V-1;We>=0;We--){const Ke=We/V,ze=W*Math.cos(Ke*Math.PI/2),Ct=K*Math.sin(Ke*Math.PI/2)+Q;for(let bt=0,Yt=Ot.length;bt<Yt;bt++){const Pt=h(Ot[bt],re[bt],Ct);v(Pt.x,Pt.y,H+ze)}for(let bt=0,Yt=nt.length;bt<Yt;bt++){const Pt=nt[bt];Ue=ot[bt];for(let nn=0,Tn=Pt.length;nn<Tn;nn++){const ie=h(Pt[nn],Ue[nn],Ct);ct?v(ie.x,ie.y+xe[k-1].y,xe[k-1].x+ze):v(ie.x,ie.y,H+ze)}}}(function(){const We=a.length/3;if(G){let Ke=0,ze=cn*Ke;for(let Ct=0;Ct<oe;Ct++){const bt=Gt[Ct];b(bt[2]+ze,bt[1]+ze,bt[0]+ze)}ze=cn*(Ke=k+2*V);for(let Ct=0;Ct<oe;Ct++){const bt=Gt[Ct];b(bt[0]+ze,bt[1]+ze,bt[2]+ze)}}else{for(let Ke=0;Ke<oe;Ke++){const ze=Gt[Ke];b(ze[2],ze[1],ze[0])}for(let Ke=0;Ke<oe;Ke++){const ze=Gt[Ke];b(ze[0]+cn*k,ze[1]+cn*k,ze[2]+cn*k)}}r.addGroup(We,a.length/3-We,0)})(),function(){const We=a.length/3;let Ke=0;g(Ot,Ke),Ke+=Ot.length;for(let ze=0,Ct=nt.length;ze<Ct;ze++){const bt=nt[ze];g(bt,Ke),Ke+=bt.length}r.addGroup(We,a.length/3-We,1)}()}super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t};const r=this,a=[],u=[];for(let l=0,h=(e=Array.isArray(e)?e:[e]).length;l<h;l++)i(e[l]);this.setAttribute("position",new ee(a,3)),this.setAttribute("uv",new ee(u,2)),this.computeVertexNormals()}toJSON(){const e=ve.prototype.toJSON.call(this);return function(t,i,r){if(r.shapes=[],Array.isArray(t))for(let a=0,u=t.length;a<u;a++){const l=t[a];r.shapes.push(l.uuid)}else r.shapes.push(t.uuid);return i.extrudePath!==void 0&&(r.options.extrudePath=i.extrudePath.toJSON()),r}(this.parameters.shapes,this.parameters.options,e)}}const ty={generateTopUV:function(n,e,t,i,r){const a=e[3*t],u=e[3*t+1],l=e[3*i],h=e[3*i+1],p=e[3*r],g=e[3*r+1];return[new Je(a,u),new Je(l,h),new Je(p,g)]},generateSideWallUV:function(n,e,t,i,r,a){const u=e[3*t],l=e[3*t+1],h=e[3*t+2],p=e[3*i],g=e[3*i+1],v=e[3*i+2],b=e[3*r],E=e[3*r+1],S=e[3*r+2],D=e[3*a],P=e[3*a+1],k=e[3*a+2];return Math.abs(l-g)<.01?[new Je(u,1-h),new Je(p,1-v),new Je(b,1-S),new Je(D,1-k)]:[new Je(l,1-h),new Je(g,1-v),new Je(E,1-S),new Je(P,1-k)]}};class fc extends $r{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2;super([-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}}class mc extends ve{constructor(e,t=12,i=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=Kt.clamp(r,0,2*Math.PI);const a=[],u=[],l=[],h=1/t,p=new U,g=new Je;for(let v=0;v<=t;v++){const b=i+v*h*r,E=Math.sin(b),S=Math.cos(b);for(let D=0;D<=e.length-1;D++)p.x=e[D].x*E,p.y=e[D].y,p.z=e[D].x*S,u.push(p.x,p.y,p.z),g.x=v/t,g.y=D/(e.length-1),l.push(g.x,g.y)}for(let v=0;v<t;v++)for(let b=0;b<e.length-1;b++){const E=b+v*e.length,S=E,D=E+e.length,P=E+e.length+1,k=E+1;a.push(S,D,k),a.push(D,P,k)}if(this.setIndex(a),this.setAttribute("position",new ee(u,3)),this.setAttribute("uv",new ee(l,2)),this.computeVertexNormals(),r===2*Math.PI){const v=this.attributes.normal.array,b=new U,E=new U,S=new U,D=t*e.length*3;for(let P=0,k=0;P<e.length;P++,k+=3)b.x=v[k+0],b.y=v[k+1],b.z=v[k+2],E.x=v[D+k+0],E.y=v[D+k+1],E.z=v[D+k+2],S.addVectors(b,E).normalize(),v[k+0]=v[D+k+0]=S.x,v[k+1]=v[D+k+1]=S.y,v[k+2]=v[D+k+2]=S.z}}}class Da extends $r{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}}(is.prototype=Object.create(ve.prototype)).constructor=is;class gc extends ve{constructor(e=.5,t=1,i=8,r=1,a=0,u=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:a,thetaLength:u},i=Math.max(3,i);const l=[],h=[],p=[],g=[];let v=e;const b=(t-e)/(r=Math.max(1,r)),E=new U,S=new Je;for(let D=0;D<=r;D++){for(let P=0;P<=i;P++){const k=a+P/i*u;E.x=v*Math.cos(k),E.y=v*Math.sin(k),h.push(E.x,E.y,E.z),p.push(0,0,1),S.x=(E.x/t+1)/2,S.y=(E.y/t+1)/2,g.push(S.x,S.y)}v+=b}for(let D=0;D<r;D++){const P=D*(i+1);for(let k=0;k<i;k++){const H=k+P,G=H,W=H+i+1,K=H+i+2,Q=H+1;l.push(G,W,Q),l.push(W,K,Q)}}this.setIndex(l),this.setAttribute("position",new ee(h,3)),this.setAttribute("normal",new ee(p,3)),this.setAttribute("uv",new ee(g,2))}}class Na extends ve{constructor(e,t=12){function i(g){const v=a.length/3,b=g.extractPoints(t);let E=b.shape;const S=b.holes;Dr.isClockWise(E)===!1&&(E=E.reverse());for(let P=0,k=S.length;P<k;P++){const H=S[P];Dr.isClockWise(H)===!0&&(S[P]=H.reverse())}const D=Dr.triangulateShape(E,S);for(let P=0,k=S.length;P<k;P++){const H=S[P];E=E.concat(H)}for(let P=0,k=E.length;P<k;P++){const H=E[P];a.push(H.x,H.y,0),u.push(0,0,1),l.push(H.x,H.y)}for(let P=0,k=D.length;P<k;P++){const H=D[P],G=H[0]+v,W=H[1]+v,K=H[2]+v;r.push(G,W,K),p+=3}}super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const r=[],a=[],u=[],l=[];let h=0,p=0;if(Array.isArray(e)===!1)i(e);else for(let g=0;g<e.length;g++)i(e[g]),this.addGroup(h,p,g),h+=p,p=0;this.setIndex(r),this.setAttribute("position",new ee(a,3)),this.setAttribute("normal",new ee(u,3)),this.setAttribute("uv",new ee(l,2))}toJSON(){const e=ve.prototype.toJSON.call(this);return function(t,i){if(i.shapes=[],Array.isArray(t))for(let r=0,a=t.length;r<a;r++){const u=t[r];i.shapes.push(u.uuid)}else i.shapes.push(t.uuid);return i}(this.parameters.shapes,e)}}class Ia extends ve{constructor(e=1,t=8,i=6,r=0,a=2*Math.PI,u=0,l=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:a,thetaStart:u,thetaLength:l},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const h=Math.min(u+l,Math.PI);let p=0;const g=[],v=new U,b=new U,E=[],S=[],D=[],P=[];for(let k=0;k<=i;k++){const H=[],G=k/i;let W=0;k==0&&u==0?W=.5/t:k==i&&h==Math.PI&&(W=-.5/t);for(let K=0;K<=t;K++){const Q=K/t;v.x=-e*Math.cos(r+Q*a)*Math.sin(u+G*l),v.y=e*Math.cos(u+G*l),v.z=e*Math.sin(r+Q*a)*Math.sin(u+G*l),S.push(v.x,v.y,v.z),b.copy(v).normalize(),D.push(b.x,b.y,b.z),P.push(Q+W,1-G),H.push(p++)}g.push(H)}for(let k=0;k<i;k++)for(let H=0;H<t;H++){const G=g[k][H+1],W=g[k][H],K=g[k+1][H],Q=g[k+1][H+1];(k!==0||u>0)&&E.push(G,W,Q),(k!==i-1||h<Math.PI)&&E.push(W,K,Q)}this.setIndex(E),this.setAttribute("position",new ee(S,3)),this.setAttribute("normal",new ee(D,3)),this.setAttribute("uv",new ee(P,2))}}class vc extends $r{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}}class yc extends Nr{constructor(e,t={}){const i=t.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ve;const r=i.generateShapes(e,t.size);t.depth=t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),super(r,t),this.type="TextGeometry"}}class xc extends ve{constructor(e=1,t=.4,i=8,r=6,a=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:a},i=Math.floor(i),r=Math.floor(r);const u=[],l=[],h=[],p=[],g=new U,v=new U,b=new U;for(let E=0;E<=i;E++)for(let S=0;S<=r;S++){const D=S/r*a,P=E/i*Math.PI*2;v.x=(e+t*Math.cos(P))*Math.cos(D),v.y=(e+t*Math.cos(P))*Math.sin(D),v.z=t*Math.sin(P),l.push(v.x,v.y,v.z),g.x=e*Math.cos(D),g.y=e*Math.sin(D),b.subVectors(v,g).normalize(),h.push(b.x,b.y,b.z),p.push(S/r),p.push(E/i)}for(let E=1;E<=i;E++)for(let S=1;S<=r;S++){const D=(r+1)*E+S-1,P=(r+1)*(E-1)+S-1,k=(r+1)*(E-1)+S,H=(r+1)*E+S;u.push(D,P,H),u.push(P,k,H)}this.setIndex(u),this.setAttribute("position",new ee(l,3)),this.setAttribute("normal",new ee(h,3)),this.setAttribute("uv",new ee(p,2))}}class _c extends ve{constructor(e=1,t=.4,i=64,r=8,a=2,u=3){function l(G,W,K,Q,V){const ge=Math.cos(G),Z=Math.sin(G),xe=K/W*G,we=Math.cos(xe);V.x=Q*(2+we)*.5*ge,V.y=Q*(2+we)*Z*.5,V.z=Q*Math.sin(xe)*.5}super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:a,q:u},i=Math.floor(i),r=Math.floor(r);const h=[],p=[],g=[],v=[],b=new U,E=new U,S=new U,D=new U,P=new U,k=new U,H=new U;for(let G=0;G<=i;++G){const W=G/i*a*Math.PI*2;l(W,a,u,e,S),l(W+.01,a,u,e,D),k.subVectors(D,S),H.addVectors(D,S),P.crossVectors(k,H),H.crossVectors(P,k),P.normalize(),H.normalize();for(let K=0;K<=r;++K){const Q=K/r*Math.PI*2,V=-t*Math.cos(Q),ge=t*Math.sin(Q);b.x=S.x+(V*H.x+ge*P.x),b.y=S.y+(V*H.y+ge*P.y),b.z=S.z+(V*H.z+ge*P.z),p.push(b.x,b.y,b.z),E.subVectors(b,S).normalize(),g.push(E.x,E.y,E.z),v.push(G/i),v.push(K/r)}}for(let G=1;G<=i;G++)for(let W=1;W<=r;W++){const K=(r+1)*(G-1)+(W-1),Q=(r+1)*G+(W-1),V=(r+1)*G+W,ge=(r+1)*(G-1)+W;h.push(K,Q,ge),h.push(Q,V,ge)}this.setIndex(h),this.setAttribute("position",new ee(p,3)),this.setAttribute("normal",new ee(g,3)),this.setAttribute("uv",new ee(v,2))}}class bc extends ve{constructor(e,t=64,i=1,r=8,a=!1){function u(P){v=e.getPointAt(P/t,v);const k=l.normals[P],H=l.binormals[P];for(let G=0;G<=r;G++){const W=G/r*Math.PI*2,K=Math.sin(W),Q=-Math.cos(W);p.x=Q*k.x+K*H.x,p.y=Q*k.y+K*H.y,p.z=Q*k.z+K*H.z,p.normalize(),E.push(p.x,p.y,p.z),h.x=v.x+i*p.x,h.y=v.y+i*p.y,h.z=v.z+i*p.z,b.push(h.x,h.y,h.z)}}super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:a};const l=e.computeFrenetFrames(t,a);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;const h=new U,p=new U,g=new Je;let v=new U;const b=[],E=[],S=[],D=[];(function(){for(let P=0;P<t;P++)u(P);u(a===!1?t:0),function(){for(let P=0;P<=t;P++)for(let k=0;k<=r;k++)g.x=P/t,g.y=k/r,S.push(g.x,g.y)}(),function(){for(let P=1;P<=t;P++)for(let k=1;k<=r;k++){const H=(r+1)*(P-1)+(k-1),G=(r+1)*P+(k-1),W=(r+1)*P+k,K=(r+1)*(P-1)+k;D.push(H,G,K),D.push(G,W,K)}}()})(),this.setIndex(D),this.setAttribute("position",new ee(b,3)),this.setAttribute("normal",new ee(E,3)),this.setAttribute("uv",new ee(S,2))}toJSON(){const e=ve.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e}}class Ih extends ve{constructor(e){if(super(),this.type="WireframeGeometry",e.isGeometry===!0)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const t=[],i=[0,0],r={},a=new U;if(e.index!==null){const u=e.attributes.position,l=e.index;let h=e.groups;h.length===0&&(h=[{start:0,count:l.count,materialIndex:0}]);for(let p=0,g=h.length;p<g;++p){const v=h[p],b=v.start;for(let E=b,S=b+v.count;E<S;E+=3)for(let D=0;D<3;D++){const P=l.getX(E+D),k=l.getX(E+(D+1)%3);i[0]=Math.min(P,k),i[1]=Math.max(P,k);const H=i[0]+","+i[1];r[H]===void 0&&(r[H]={index1:i[0],index2:i[1]})}}for(const p in r){const g=r[p];a.fromBufferAttribute(u,g.index1),t.push(a.x,a.y,a.z),a.fromBufferAttribute(u,g.index2),t.push(a.x,a.y,a.z)}}else{const u=e.attributes.position;for(let l=0,h=u.count/3;l<h;l++)for(let p=0;p<3;p++){const g=3*l+p;a.fromBufferAttribute(u,g),t.push(a.x,a.y,a.z);const v=3*l+(p+1)%3;a.fromBufferAttribute(u,v),t.push(a.x,a.y,a.z)}}this.setAttribute("position",new ee(t,3))}}var bi=Object.freeze({__proto__:null,BoxGeometry:So,BoxBufferGeometry:So,CircleGeometry:lc,CircleBufferGeometry:lc,ConeGeometry:cc,ConeBufferGeometry:cc,CylinderGeometry:Ls,CylinderBufferGeometry:Ls,DodecahedronGeometry:uc,DodecahedronBufferGeometry:uc,EdgesGeometry:Nh,ExtrudeGeometry:Nr,ExtrudeBufferGeometry:Nr,IcosahedronGeometry:fc,IcosahedronBufferGeometry:fc,LatheGeometry:mc,LatheBufferGeometry:mc,OctahedronGeometry:Da,OctahedronBufferGeometry:Da,ParametricGeometry:is,ParametricBufferGeometry:is,PlaneGeometry:Ta,PlaneBufferGeometry:Ta,PolyhedronGeometry:$r,PolyhedronBufferGeometry:$r,RingGeometry:gc,RingBufferGeometry:gc,ShapeGeometry:Na,ShapeBufferGeometry:Na,SphereGeometry:Ia,SphereBufferGeometry:Ia,TetrahedronGeometry:vc,TetrahedronBufferGeometry:vc,TextGeometry:yc,TextBufferGeometry:yc,TorusGeometry:xc,TorusBufferGeometry:xc,TorusKnotGeometry:_c,TorusKnotBufferGeometry:_c,TubeGeometry:bc,TubeBufferGeometry:bc,WireframeGeometry:Ih});class Oh extends x{constructor(e){super(),this.type="ShadowMaterial",this.color=new Rt(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}Oh.prototype.isShadowMaterial=!0;class Ps extends M{constructor(e){super(e),this.type="RawShaderMaterial"}}Ps.prototype.isRawShaderMaterial=!0,(Er.prototype=Object.create(x.prototype)).constructor=Er,Er.prototype.isMeshStandardMaterial=!0,Er.prototype.copy=function(n){return x.prototype.copy.call(this,n),this.defines={STANDARD:""},this.color.copy(n.color),this.roughness=n.roughness,this.metalness=n.metalness,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.roughnessMap=n.roughnessMap,this.metalnessMap=n.metalnessMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapIntensity=n.envMapIntensity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.skinning=n.skinning,this.morphTargets=n.morphTargets,this.morphNormals=n.morphNormals,this.flatShading=n.flatShading,this.vertexTangents=n.vertexTangents,this},(go.prototype=Object.create(Er.prototype)).constructor=go,go.prototype.isMeshPhysicalMaterial=!0,go.prototype.copy=function(n){return Er.prototype.copy.call(this,n),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=n.clearcoat,this.clearcoatMap=n.clearcoatMap,this.clearcoatRoughness=n.clearcoatRoughness,this.clearcoatRoughnessMap=n.clearcoatRoughnessMap,this.clearcoatNormalMap=n.clearcoatNormalMap,this.clearcoatNormalScale.copy(n.clearcoatNormalScale),this.reflectivity=n.reflectivity,n.sheen?this.sheen=(this.sheen||new Rt).copy(n.sheen):this.sheen=null,this.transmission=n.transmission,this.transmissionMap=n.transmissionMap,this};class kh extends x{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new Rt(16777215),this.specular=new Rt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Rt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_o,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ua,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}kh.prototype.isMeshPhongMaterial=!0;class Fh extends x{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Rt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Rt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_o,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}Fh.prototype.isMeshToonMaterial=!0;class Hh extends x{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_o,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Hh.prototype.isMeshNormalMaterial=!0;class Bh extends x{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new Rt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Rt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ua,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}Bh.prototype.isMeshLambertMaterial=!0;class Uh extends x{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Rt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=_o,this.normalScale=new Je(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}Uh.prototype.isMeshMatcapMaterial=!0;class zh extends oi{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}zh.prototype.isLineDashedMaterial=!0;var ny=Object.freeze({__proto__:null,ShadowMaterial:Oh,SpriteMaterial:$l,RawShaderMaterial:Ps,ShaderMaterial:M,PointsMaterial:Ro,MeshPhysicalMaterial:go,MeshStandardMaterial:Er,MeshPhongMaterial:kh,MeshToonMaterial:Fh,MeshNormalMaterial:Hh,MeshLambertMaterial:Bh,MeshDepthMaterial:Kl,MeshDistanceMaterial:Zl,MeshBasicMaterial:Pr,MeshMatcapMaterial:Uh,LineDashedMaterial:zh,LineBasicMaterial:oi,Material:x});const Pn={arraySlice:function(n,e,t){return Pn.isTypedArray(n)?new n.constructor(n.subarray(e,t!==void 0?t:n.length)):n.slice(e,t)},convertArray:function(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)},isTypedArray:function(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)},getKeyframeOrder:function(n){const e=n.length,t=new Array(e);for(let i=0;i!==e;++i)t[i]=i;return t.sort(function(i,r){return n[i]-n[r]}),t},sortedArray:function(n,e,t){const i=n.length,r=new n.constructor(i);for(let a=0,u=0;u!==i;++a){const l=t[a]*e;for(let h=0;h!==e;++h)r[u++]=n[l+h]}return r},flattenJSON:function(n,e,t,i){let r=1,a=n[0];for(;a!==void 0&&a[i]===void 0;)a=n[r++];if(a===void 0)return;let u=a[i];if(u!==void 0)if(Array.isArray(u))do(u=a[i])!==void 0&&(e.push(a.time),t.push.apply(t,u)),a=n[r++];while(a!==void 0);else if(u.toArray!==void 0)do(u=a[i])!==void 0&&(e.push(a.time),u.toArray(t,t.length)),a=n[r++];while(a!==void 0);else do(u=a[i])!==void 0&&(e.push(a.time),t.push(u)),a=n[r++];while(a!==void 0)},subclip:function(n,e,t,i,r=30){const a=n.clone();a.name=e;const u=[];for(let h=0;h<a.tracks.length;++h){const p=a.tracks[h],g=p.getValueSize(),v=[],b=[];for(let E=0;E<p.times.length;++E){const S=p.times[E]*r;if(!(S<t||S>=i)){v.push(p.times[E]);for(let D=0;D<g;++D)b.push(p.values[E*g+D])}}v.length!==0&&(p.times=Pn.convertArray(v,p.times.constructor),p.values=Pn.convertArray(b,p.values.constructor),u.push(p))}a.tracks=u;let l=1/0;for(let h=0;h<a.tracks.length;++h)l>a.tracks[h].times[0]&&(l=a.tracks[h].times[0]);for(let h=0;h<a.tracks.length;++h)a.tracks[h].shift(-1*l);return a.resetDuration(),a},makeClipAdditive:function(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,a=e/i;for(let u=0;u<r;++u){const l=t.tracks[u],h=l.ValueTypeName;if(h==="bool"||h==="string")continue;const p=n.tracks.find(function(k){return k.name===l.name&&k.ValueTypeName===h});if(p===void 0)continue;let g=0;const v=l.getValueSize();l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(g=v/3);let b=0;const E=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(b=E/3);const S=l.times.length-1;let D;if(a<=l.times[0]){const k=g,H=v-g;D=Pn.arraySlice(l.values,k,H)}else if(a>=l.times[S]){const k=S*v+g,H=k+v-g;D=Pn.arraySlice(l.values,k,H)}else{const k=l.createInterpolant(),H=g,G=v-g;k.evaluate(a),D=Pn.arraySlice(k.resultBuffer,H,G)}h==="quaternion"&&new ii().fromArray(D).normalize().conjugate().toArray(D);const P=p.times.length;for(let k=0;k<P;++k){const H=k*E+b;if(h==="quaternion")ii.multiplyQuaternionsFlat(p.values,H,D,0,p.values,H);else{const G=E-2*b;for(let W=0;W<G;++W)p.values[H+W]-=D[W]}}}return n.blendMode=2501,n}};Object.assign(Pi.prototype,{evaluate:function(n){const e=this.parameterPositions;let t=this._cachedIndex,i=e[t],r=e[t-1];e:{t:{let a;n:{i:if(!(n<i)){for(let u=t+2;;){if(i===void 0){if(n<r)break i;return t=e.length,this._cachedIndex=t,this.afterEnd_(t-1,n,r)}if(t===u)break;if(r=i,i=e[++t],n<i)break t}a=e.length;break n}if(n>=r)break e;{const u=e[1];n<u&&(t=2,r=u);for(let l=t-2;;){if(r===void 0)return this._cachedIndex=0,this.beforeStart_(0,n,i);if(t===l)break;if(i=r,r=e[--t-1],n>=r)break t}a=t,t=0}}for(;t<a;){const u=t+a>>>1;n<e[u]?a=u:t=u+1}if(i=e[t],(r=e[t-1])===void 0)return this._cachedIndex=0,this.beforeStart_(0,n,i);if(i===void 0)return t=e.length,this._cachedIndex=t,this.afterEnd_(t-1,r,n)}this._cachedIndex=t,this.intervalChanged_(t,r,i)}return this.interpolate_(t,r,n,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(n){const e=this.resultBuffer,t=this.sampleValues,i=this.valueSize,r=n*i;for(let a=0;a!==i;++a)e[a]=t[r+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Pi.prototype,{beforeStart_:Pi.prototype.copySampleValue_,afterEnd_:Pi.prototype.copySampleValue_}),ml.prototype=Object.assign(Object.create(Pi.prototype),{constructor:ml,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(n,e,t){const i=this.parameterPositions;let r=n-2,a=n+1,u=i[r],l=i[a];if(u===void 0)switch(this.getSettings_().endingStart){case 2401:r=n,u=2*e-t;break;case 2402:u=e+i[r=i.length-2]-i[r+1];break;default:r=n,u=t}if(l===void 0)switch(this.getSettings_().endingEnd){case 2401:a=n,l=2*t-e;break;case 2402:a=1,l=t+i[1]-i[0];break;default:a=n-1,l=e}const h=.5*(t-e),p=this.valueSize;this._weightPrev=h/(e-u),this._weightNext=h/(l-t),this._offsetPrev=r*p,this._offsetNext=a*p},interpolate_:function(n,e,t,i){const r=this.resultBuffer,a=this.sampleValues,u=this.valueSize,l=n*u,h=l-u,p=this._offsetPrev,g=this._offsetNext,v=this._weightPrev,b=this._weightNext,E=(t-e)/(i-e),S=E*E,D=S*E,P=-v*D+2*v*S-v*E,k=(1+v)*D+(-1.5-2*v)*S+(-.5+v)*E+1,H=(-1-b)*D+(1.5+b)*S+.5*E,G=b*D-b*S;for(let W=0;W!==u;++W)r[W]=P*a[p+W]+k*a[h+W]+H*a[l+W]+G*a[g+W];return r}}),oa.prototype=Object.assign(Object.create(Pi.prototype),{constructor:oa,interpolate_:function(n,e,t,i){const r=this.resultBuffer,a=this.sampleValues,u=this.valueSize,l=n*u,h=l-u,p=(t-e)/(i-e),g=1-p;for(let v=0;v!==u;++v)r[v]=a[h+v]*g+a[l+v]*p;return r}}),gl.prototype=Object.assign(Object.create(Pi.prototype),{constructor:gl,interpolate_:function(n){return this.copySampleValue_(n-1)}});class $i{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Pn.convertArray(t,this.TimeBufferType),this.values=Pn.convertArray(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:Pn.convertArray(e.times,Array),values:Pn.convertArray(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new gl(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new oa(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ml(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0){if(e===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let a=0,u=r-1;for(;a!==r&&i[a]<e;)++a;for(;u!==-1&&i[u]>t;)--u;if(++u,a!==0||u!==r){a>=u&&(a=(u=Math.max(u,1))-1);const l=this.getValueSize();this.times=Pn.arraySlice(i,a,u),this.values=Pn.arraySlice(this.values,a*l,u*l)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,a=i.length;a===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let u=null;for(let l=0;l!==a;l++){const h=i[l];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,l,h),e=!1;break}if(u!==null&&u>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,l,h,u),e=!1;break}u=h}if(r!==void 0&&Pn.isTypedArray(r))for(let l=0,h=r.length;l!==h;++l){const p=r[l];if(isNaN(p)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,p),e=!1;break}}return e}optimize(){const e=Pn.arraySlice(this.times),t=Pn.arraySlice(this.values),i=this.getValueSize(),r=this.getInterpolation()===2302,a=e.length-1;let u=1;for(let l=1;l<a;++l){let h=!1;const p=e[l];if(p!==e[l+1]&&(l!==1||p!==e[0]))if(r)h=!0;else{const g=l*i,v=g-i,b=g+i;for(let E=0;E!==i;++E){const S=t[g+E];if(S!==t[v+E]||S!==t[b+E]){h=!0;break}}}if(h){if(l!==u){e[u]=e[l];const g=l*i,v=u*i;for(let b=0;b!==i;++b)t[v+b]=t[g+b]}++u}}if(a>0){e[u]=e[a];for(let l=a*i,h=u*i,p=0;p!==i;++p)t[h+p]=t[l+p];++u}return u!==e.length?(this.times=Pn.arraySlice(e,0,u),this.values=Pn.arraySlice(t,0,u*i)):(this.times=e,this.values=t),this}clone(){const e=Pn.arraySlice(this.times,0),t=Pn.arraySlice(this.values,0),i=new this.constructor(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}$i.prototype.TimeBufferType=Float32Array,$i.prototype.ValueBufferType=Float32Array,$i.prototype.DefaultInterpolation=2301;class Co extends $i{}Co.prototype.ValueTypeName="bool",Co.prototype.ValueBufferType=Array,Co.prototype.DefaultInterpolation=2300,Co.prototype.InterpolantFactoryMethodLinear=void 0,Co.prototype.InterpolantFactoryMethodSmooth=void 0;class Gh extends $i{}Gh.prototype.ValueTypeName="color";class Oa extends $i{}Oa.prototype.ValueTypeName="number",vl.prototype=Object.assign(Object.create(Pi.prototype),{constructor:vl,interpolate_:function(n,e,t,i){const r=this.resultBuffer,a=this.sampleValues,u=this.valueSize,l=(t-e)/(i-e);let h=n*u;for(let p=h+u;h!==p;h+=4)ii.slerpFlat(r,0,a,h-u,a,h,l);return r}});class Ds extends $i{InterpolantFactoryMethodLinear(e){return new vl(this.times,this.values,this.getValueSize(),e)}}Ds.prototype.ValueTypeName="quaternion",Ds.prototype.DefaultInterpolation=2301,Ds.prototype.InterpolantFactoryMethodSmooth=void 0;class Lo extends $i{}Lo.prototype.ValueTypeName="string",Lo.prototype.ValueBufferType=Array,Lo.prototype.DefaultInterpolation=2300,Lo.prototype.InterpolantFactoryMethodLinear=void 0,Lo.prototype.InterpolantFactoryMethodSmooth=void 0;class ka extends $i{}ka.prototype.ValueTypeName="vector";class Fa{constructor(e,t=-1,i,r=2500){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=Kt.generateUUID(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let u=0,l=i.length;u!==l;++u)t.push(Sv(i[u]).scale(r));const a=new this(e.name,e.duration,t,e.blendMode);return a.uuid=e.uuid,a}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let a=0,u=i.length;a!==u;++a)t.push($i.toJSON(i[a]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const a=t.length,u=[];for(let l=0;l<a;l++){let h=[],p=[];h.push((l+a-1)%a,l,(l+1)%a),p.push(0,1,0);const g=Pn.getKeyframeOrder(h);h=Pn.sortedArray(h,1,g),p=Pn.sortedArray(p,1,g),r||h[0]!==0||(h.push(a),p.push(p[0])),u.push(new Oa(".morphTargetInfluences["+t[l].name+"]",h,p).scale(1/i))}return new this(e,-1,u)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},a=/^([\w-]*?)([\d]+)$/;for(let l=0,h=e.length;l<h;l++){const p=e[l],g=p.name.match(a);if(g&&g.length>1){const v=g[1];let b=r[v];b||(r[v]=b=[]),b.push(p)}}const u=[];for(const l in r)u.push(this.CreateFromMorphTargetSequence(l,r[l],t,i));return u}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(g,v,b,E,S){if(b.length!==0){const D=[],P=[];Pn.flattenJSON(b,D,P,E),D.length!==0&&S.push(new g(v,D,P))}},r=[],a=e.name||"default",u=e.fps||30,l=e.blendMode;let h=e.length||-1;const p=e.hierarchy||[];for(let g=0;g<p.length;g++){const v=p[g].keys;if(v&&v.length!==0)if(v[0].morphTargets){const b={};let E;for(E=0;E<v.length;E++)if(v[E].morphTargets)for(let S=0;S<v[E].morphTargets.length;S++)b[v[E].morphTargets[S]]=-1;for(const S in b){const D=[],P=[];for(let k=0;k!==v[E].morphTargets.length;++k){const H=v[E];D.push(H.time),P.push(H.morphTarget===S?1:0)}r.push(new Oa(".morphTargetInfluence["+S+"]",D,P))}h=b.length*(u||1)}else{const b=".bones["+t[g].name+"]";i(ka,b+".position",v,"pos",r),i(Ds,b+".quaternion",v,"rot",r),i(ka,b+".scale",v,"scl",r)}}return r.length===0?null:new this(a,h,r,l)}resetDuration(){let e=0;for(let t=0,i=this.tracks.length;t!==i;++t){const r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}const Po={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}},og=new Tu;Object.assign(Hn.prototype,{load:function(){},loadAsync:function(n,e){const t=this;return new Promise(function(i,r){t.load(n,i,e,r)})},parse:function(){},setCrossOrigin:function(n){return this.crossOrigin=n,this},setWithCredentials:function(n){return this.withCredentials=n,this},setPath:function(n){return this.path=n,this},setResourcePath:function(n){return this.resourcePath=n,this},setRequestHeader:function(n){return this.requestHeader=n,this}});const Qi={};Ui.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Ui,load:function(n,e,t,i){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const r=this,a=Po.get(n);if(a!==void 0)return r.manager.itemStart(n),setTimeout(function(){e&&e(a),r.manager.itemEnd(n)},0),a;if(Qi[n]!==void 0)return void Qi[n].push({onLoad:e,onProgress:t,onError:i});const u=n.match(/^data:(.*?)(;base64)?,(.*)$/);let l;if(u){const h=u[1],p=!!u[2];let g=u[3];g=decodeURIComponent(g),p&&(g=atob(g));try{let v;const b=(this.responseType||"").toLowerCase();switch(b){case"arraybuffer":case"blob":const E=new Uint8Array(g.length);for(let D=0;D<g.length;D++)E[D]=g.charCodeAt(D);v=b==="blob"?new Blob([E.buffer],{type:h}):E.buffer;break;case"document":v=new DOMParser().parseFromString(g,h);break;case"json":v=JSON.parse(g);break;default:v=g}setTimeout(function(){e&&e(v),r.manager.itemEnd(n)},0)}catch(v){setTimeout(function(){i&&i(v),r.manager.itemError(n),r.manager.itemEnd(n)},0)}}else{Qi[n]=[],Qi[n].push({onLoad:e,onProgress:t,onError:i}),(l=new XMLHttpRequest).open("GET",n,!0),l.addEventListener("load",function(h){const p=this.response,g=Qi[n];if(delete Qi[n],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Po.add(n,p);for(let v=0,b=g.length;v<b;v++){const E=g[v];E.onLoad&&E.onLoad(p)}r.manager.itemEnd(n)}else{for(let v=0,b=g.length;v<b;v++){const E=g[v];E.onError&&E.onError(h)}r.manager.itemError(n),r.manager.itemEnd(n)}},!1),l.addEventListener("progress",function(h){const p=Qi[n];for(let g=0,v=p.length;g<v;g++){const b=p[g];b.onProgress&&b.onProgress(h)}},!1),l.addEventListener("error",function(h){const p=Qi[n];delete Qi[n];for(let g=0,v=p.length;g<v;g++){const b=p[g];b.onError&&b.onError(h)}r.manager.itemError(n),r.manager.itemEnd(n)},!1),l.addEventListener("abort",function(h){const p=Qi[n];delete Qi[n];for(let g=0,v=p.length;g<v;g++){const b=p[g];b.onError&&b.onError(h)}r.manager.itemError(n),r.manager.itemEnd(n)},!1),this.responseType!==void 0&&(l.responseType=this.responseType),this.withCredentials!==void 0&&(l.withCredentials=this.withCredentials),l.overrideMimeType&&l.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(const h in this.requestHeader)l.setRequestHeader(h,this.requestHeader[h]);l.send(null)}return r.manager.itemStart(n),l},setResponseType:function(n){return this.responseType=n,this},setMimeType:function(n){return this.mimeType=n,this}});class iy extends Hn{constructor(e){super(e)}load(e,t,i,r){const a=this,u=new Ui(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(l){try{t(a.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),a.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=Fa.parse(e[i]);t.push(r)}return t}}Su.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Su,load:function(n,e,t,i){function r(g){h.load(n[g],function(v){const b=a.parse(v,!0);u[g]={width:b.width,height:b.height,format:b.format,mipmaps:b.mipmaps},(p+=1)===6&&(b.mipmapCount===1&&(l.minFilter=$n),l.image=u,l.format=b.format,l.needsUpdate=!0,e&&e(l))},t,i)}const a=this,u=[],l=new Ph,h=new Ui(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(a.withCredentials);let p=0;if(Array.isArray(n))for(let g=0,v=n.length;g<v;++g)r(g);else h.load(n,function(g){const v=a.parse(g,!0);if(v.isCubemap){const b=v.mipmaps.length/v.mipmapCount;for(let E=0;E<b;E++){u[E]={mipmaps:[]};for(let S=0;S<v.mipmapCount;S++)u[E].mipmaps.push(v.mipmaps[E*v.mipmapCount+S]),u[E].format=v.format,u[E].width=v.width,u[E].height=v.height}l.image=u}else l.image.width=v.width,l.image.height=v.height,l.mipmaps=v.mipmaps;v.mipmapCount===1&&(l.minFilter=$n),l.format=v.format,l.needsUpdate=!0,e&&e(l)},t,i);return l}});class Ec extends Hn{constructor(e){super(e)}load(e,t,i,r){function a(){p.removeEventListener("load",a,!1),p.removeEventListener("error",u,!1),Po.add(e,this),t&&t(this),l.manager.itemEnd(e)}function u(g){p.removeEventListener("load",a,!1),p.removeEventListener("error",u,!1),r&&r(g),l.manager.itemError(e),l.manager.itemEnd(e)}this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const l=this,h=Po.get(e);if(h!==void 0)return l.manager.itemStart(e),setTimeout(function(){t&&t(h),l.manager.itemEnd(e)},0),h;const p=document.createElementNS("http://www.w3.org/1999/xhtml","img");return p.addEventListener("load",a,!1),p.addEventListener("error",u,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(p.crossOrigin=this.crossOrigin),l.manager.itemStart(e),p.src=e,p}}class sg extends Hn{constructor(e){super(e)}load(e,t,i,r){function a(p){l.load(e[p],function(g){u.images[p]=g,++h===6&&(u.needsUpdate=!0,t&&t(u))},void 0,r)}const u=new ws,l=new Ec(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);let h=0;for(let p=0;p<e.length;++p)a(p);return u}}yl.prototype=Object.assign(Object.create(Hn.prototype),{constructor:yl,load:function(n,e,t,i){const r=this,a=new Ms,u=new Ui(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(r.withCredentials),u.load(n,function(l){const h=r.parse(l);h&&(h.image!==void 0?a.image=h.image:h.data!==void 0&&(a.image.width=h.width,a.image.height=h.height,a.image.data=h.data),a.wrapS=h.wrapS!==void 0?h.wrapS:xi,a.wrapT=h.wrapT!==void 0?h.wrapT:xi,a.magFilter=h.magFilter!==void 0?h.magFilter:$n,a.minFilter=h.minFilter!==void 0?h.minFilter:$n,a.anisotropy=h.anisotropy!==void 0?h.anisotropy:1,h.encoding!==void 0&&(a.encoding=h.encoding),h.flipY!==void 0&&(a.flipY=h.flipY),h.format!==void 0&&(a.format=h.format),h.type!==void 0&&(a.type=h.type),h.mipmaps!==void 0&&(a.mipmaps=h.mipmaps,a.minFilter=ls),h.mipmapCount===1&&(a.minFilter=$n),h.generateMipmaps!==void 0&&(a.generateMipmaps=h.generateMipmaps),a.needsUpdate=!0,e&&e(a,h))},t,i),a}}),xl.prototype=Object.assign(Object.create(Hn.prototype),{constructor:xl,load:function(n,e,t,i){const r=new ei,a=new Ec(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(n,function(u){r.image=u;const l=n.search(/\.jpe?g($|\?)/i)>0||n.search(/^data\:image\/jpeg/)===0;r.format=l?Gr:Di,r.needsUpdate=!0,e!==void 0&&e(r)},t,i),r}}),Object.assign(yi.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(n,e){const t=this.getUtoTmapping(n);return this.getPoint(t,e)},getPoints:function(n=5){const e=[];for(let t=0;t<=n;t++)e.push(this.getPoint(t/n));return e},getSpacedPoints:function(n=5){const e=[];for(let t=0;t<=n;t++)e.push(this.getPointAt(t/n));return e},getLength:function(){const n=this.getLengths();return n[n.length-1]},getLengths:function(n){if(n===void 0&&(n=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===n+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const e=[];let t,i=this.getPoint(0),r=0;e.push(0);for(let a=1;a<=n;a++)r+=(t=this.getPoint(a/n)).distanceTo(i),e.push(r),i=t;return this.cacheArcLengths=e,e},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(n,e){const t=this.getLengths();let i=0;const r=t.length;let a;a=e||n*t[r-1];let u,l=0,h=r-1;for(;l<=h;)if(i=Math.floor(l+(h-l)/2),(u=t[i]-a)<0)l=i+1;else{if(!(u>0)){h=i;break}h=i-1}if(i=h,t[i]===a)return i/(r-1);const p=t[i];return(i+(a-p)/(t[i+1]-p))/(r-1)},getTangent:function(n,e){let t=n-1e-4,i=n+1e-4;t<0&&(t=0),i>1&&(i=1);const r=this.getPoint(t),a=this.getPoint(i),u=e||(r.isVector2?new Je:new U);return u.copy(a).sub(r).normalize(),u},getTangentAt:function(n,e){const t=this.getUtoTmapping(n);return this.getTangent(t,e)},computeFrenetFrames:function(n,e){const t=new U,i=[],r=[],a=[],u=new U,l=new Bt;for(let b=0;b<=n;b++){const E=b/n;i[b]=this.getTangentAt(E,new U),i[b].normalize()}r[0]=new U,a[0]=new U;let h=Number.MAX_VALUE;const p=Math.abs(i[0].x),g=Math.abs(i[0].y),v=Math.abs(i[0].z);p<=h&&(h=p,t.set(1,0,0)),g<=h&&(h=g,t.set(0,1,0)),v<=h&&t.set(0,0,1),u.crossVectors(i[0],t).normalize(),r[0].crossVectors(i[0],u),a[0].crossVectors(i[0],r[0]);for(let b=1;b<=n;b++){if(r[b]=r[b-1].clone(),a[b]=a[b-1].clone(),u.crossVectors(i[b-1],i[b]),u.length()>Number.EPSILON){u.normalize();const E=Math.acos(Kt.clamp(i[b-1].dot(i[b]),-1,1));r[b].applyMatrix4(l.makeRotationAxis(u,E))}a[b].crossVectors(i[b],r[b])}if(e===!0){let b=Math.acos(Kt.clamp(r[0].dot(r[n]),-1,1));b/=n,i[0].dot(u.crossVectors(r[0],r[n]))>0&&(b=-b);for(let E=1;E<=n;E++)r[E].applyMatrix4(l.makeRotationAxis(i[E],b*E)),a[E].crossVectors(i[E],r[E])}return{tangents:i,normals:r,binormals:a}},clone:function(){return new this.constructor().copy(this)},copy:function(n){return this.arcLengthDivisions=n.arcLengthDivisions,this},toJSON:function(){const n={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return n.arcLengthDivisions=this.arcLengthDivisions,n.type=this.type,n},fromJSON:function(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}});class Ha extends yi{constructor(e=0,t=0,i=1,r=1,a=0,u=2*Math.PI,l=!1,h=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=a,this.aEndAngle=u,this.aClockwise=l,this.aRotation=h}getPoint(e,t){const i=t||new Je,r=2*Math.PI;let a=this.aEndAngle-this.aStartAngle;const u=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=r;for(;a>r;)a-=r;a<Number.EPSILON&&(a=u?0:r),this.aClockwise!==!0||u||(a===r?a=-r:a-=r);const l=this.aStartAngle+e*a;let h=this.aX+this.xRadius*Math.cos(l),p=this.aY+this.yRadius*Math.sin(l);if(this.aRotation!==0){const g=Math.cos(this.aRotation),v=Math.sin(this.aRotation),b=h-this.aX,E=p-this.aY;h=b*g-E*v+this.aX,p=b*v+E*g+this.aY}return i.set(h,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Ha.prototype.isEllipseCurve=!0;class Vh extends Ha{constructor(e,t,i,r,a,u){super(e,t,i,i,r,a,u),this.type="ArcCurve"}}Vh.prototype.isArcCurve=!0;const wc=new U,Wh=new Au,jh=new Au,Xh=new Au;class qh extends yi{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new U){const i=t,r=this.points,a=r.length,u=(a-(this.closed?0:1))*e;let l=Math.floor(u),h=u-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/a)+1)*a:h===0&&l===a-1&&(l=a-2,h=1);let p,g;this.closed||l>0?p=r[(l-1)%a]:(wc.subVectors(r[0],r[1]).add(r[0]),p=wc);const v=r[l%a],b=r[(l+1)%a];if(this.closed||l+2<a?g=r[(l+2)%a]:(wc.subVectors(r[a-1],r[a-2]).add(r[a-1]),g=wc),this.curveType==="centripetal"||this.curveType==="chordal"){const E=this.curveType==="chordal"?.5:.25;let S=Math.pow(p.distanceToSquared(v),E),D=Math.pow(v.distanceToSquared(b),E),P=Math.pow(b.distanceToSquared(g),E);D<1e-4&&(D=1),S<1e-4&&(S=D),P<1e-4&&(P=D),Wh.initNonuniformCatmullRom(p.x,v.x,b.x,g.x,S,D,P),jh.initNonuniformCatmullRom(p.y,v.y,b.y,g.y,S,D,P),Xh.initNonuniformCatmullRom(p.z,v.z,b.z,g.z,S,D,P)}else this.curveType==="catmullrom"&&(Wh.initCatmullRom(p.x,v.x,b.x,g.x,this.tension),jh.initCatmullRom(p.y,v.y,b.y,g.y,this.tension),Xh.initCatmullRom(p.z,v.z,b.z,g.z,this.tension));return i.set(Wh.calc(h),jh.calc(h),Xh.calc(h)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new U().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}qh.prototype.isCatmullRomCurve3=!0;class Mc extends yi{constructor(e=new Je,t=new Je,i=new Je,r=new Je){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new Je){const i=t,r=this.v0,a=this.v1,u=this.v2,l=this.v3;return i.set(aa(e,r.x,a.x,u.x,l.x),aa(e,r.y,a.y,u.y,l.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Mc.prototype.isCubicBezierCurve=!0;class Yh extends yi{constructor(e=new U,t=new U,i=new U,r=new U){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new U){const i=t,r=this.v0,a=this.v1,u=this.v2,l=this.v3;return i.set(aa(e,r.x,a.x,u.x,l.x),aa(e,r.y,a.y,u.y,l.y),aa(e,r.z,a.z,u.z,l.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}Yh.prototype.isCubicBezierCurve3=!0;class Ba extends yi{constructor(e=new Je,t=new Je){super(),this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new Je){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t){const i=t||new Je;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Ba.prototype.isLineCurve=!0;class ag extends yi{constructor(e=new U,t=new U){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=t}getPoint(e,t=new U){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Tc extends yi{constructor(e=new Je,t=new Je,i=new Je){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new Je){const i=t,r=this.v0,a=this.v1,u=this.v2;return i.set(sa(e,r.x,a.x,u.x),sa(e,r.y,a.y,u.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Tc.prototype.isQuadraticBezierCurve=!0;class Kh extends yi{constructor(e=new U,t=new U,i=new U){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new U){const i=t,r=this.v0,a=this.v1,u=this.v2;return i.set(sa(e,r.x,a.x,u.x),sa(e,r.y,a.y,u.y),sa(e,r.z,a.z,u.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Kh.prototype.isQuadraticBezierCurve3=!0;class Sc extends yi{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,t=new Je){const i=t,r=this.points,a=(r.length-1)*e,u=Math.floor(a),l=a-u,h=r[u===0?u:u-1],p=r[u],g=r[u>r.length-2?r.length-1:u+1],v=r[u>r.length-3?r.length-1:u+2];return i.set(Np(l,h.x,p.x,g.x,v.x),Np(l,h.y,p.y,g.y,v.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new Je().fromArray(r))}return this}}Sc.prototype.isSplineCurve=!0;var Zh=Object.freeze({__proto__:null,ArcCurve:Vh,CatmullRomCurve3:qh,CubicBezierCurve:Mc,CubicBezierCurve3:Yh,EllipseCurve:Ha,LineCurve:Ba,LineCurve3:ag,QuadraticBezierCurve:Tc,QuadraticBezierCurve3:Kh,SplineCurve:Sc});class lg extends yi{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ba(t,e))}getPoint(e){const t=e*this.getLength(),i=this.getCurveLengths();let r=0;for(;r<i.length;){if(i[r]>=t){const a=i[r]-t,u=this.curves[r],l=u.getLength(),h=l===0?0:1-a/l;return u.getPointAt(h)}r++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,a=this.curves;r<a.length;r++){const u=a[r],l=u&&u.isEllipseCurve?2*e:u&&(u.isLineCurve||u.isLineCurve3)?1:u&&u.isSplineCurve?e*u.points.length:e,h=u.getPoints(l);for(let p=0;p<h.length;p++){const g=h[p];i&&i.equals(g)||(t.push(g),i=g)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new Zh[r.type]().fromJSON(r))}return this}}class Ua extends lg{constructor(e){super(),this.type="Path",this.currentPoint=new Je,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new Ba(this.currentPoint.clone(),new Je(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const a=new Tc(this.currentPoint.clone(),new Je(e,t),new Je(i,r));return this.curves.push(a),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,a,u){const l=new Mc(this.currentPoint.clone(),new Je(e,t),new Je(i,r),new Je(a,u));return this.curves.push(l),this.currentPoint.set(a,u),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new Sc(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,a,u){const l=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(e+l,t+h,i,r,a,u),this}absarc(e,t,i,r,a,u){return this.absellipse(e,t,i,i,r,a,u),this}ellipse(e,t,i,r,a,u,l,h){const p=this.currentPoint.x,g=this.currentPoint.y;return this.absellipse(e+p,t+g,i,r,a,u,l,h),this}absellipse(e,t,i,r,a,u,l,h){const p=new Ha(e,t,i,r,a,u,l,h);if(this.curves.length>0){const v=p.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(p);const g=p.getPoint(1);return this.currentPoint.copy(g),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Qr extends Ua{constructor(e){super(e),this.uuid=Kt.generateUUID(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Ua().fromJSON(r))}return this}}class er extends y{constructor(e,t=1){super(),this.type="Light",this.color=new Rt(e),this.intensity=t}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}er.prototype.isLight=!0;class Jh extends er{constructor(e,t,i){super(e,i),this.type="HemisphereLight",this.position.copy(y.DefaultUp),this.updateMatrix(),this.groundColor=new Rt(t)}copy(e){return er.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}Jh.prototype.isHemisphereLight=!0;const cg=new Bt,ug=new U,hg=new U;class $h{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Je(512,512),this.map=null,this.mapPass=null,this.matrix=new Bt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ma,this._frameExtents=new Je(1,1),this._viewportCount=1,this._viewports=[new Mn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;ug.setFromMatrixPosition(e.matrixWorld),t.position.copy(ug),hg.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(hg),t.updateMatrixWorld(),cg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cg),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(t.projectionMatrix),i.multiply(t.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),this.mapSize.x===512&&this.mapSize.y===512||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class dg extends $h{constructor(){super(new O(50,1,.5,500)),this.focus=1}updateMatrices(e){const t=this.camera,i=2*Kt.RAD2DEG*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,a=e.distance||t.far;i===t.fov&&r===t.aspect&&a===t.far||(t.fov=i,t.aspect=r,t.far=a,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}dg.prototype.isSpotLightShadow=!0;class Qh extends er{constructor(e,t,i=0,r=Math.PI/3,a=0,u=1){super(e,t),this.type="SpotLight",this.position.copy(y.DefaultUp),this.updateMatrix(),this.target=new y,this.distance=i,this.angle=r,this.penumbra=a,this.decay=u,this.shadow=new dg}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Qh.prototype.isSpotLight=!0;const pg=new Bt,za=new U,ed=new U;class fg extends $h{constructor(){super(new O(90,1,.5,500)),this._frameExtents=new Je(4,2),this._viewportCount=6,this._viewports=[new Mn(2,1,1,1),new Mn(0,1,1,1),new Mn(3,1,1,1),new Mn(1,1,1,1),new Mn(3,0,1,1),new Mn(1,0,1,1)],this._cubeDirections=[new U(1,0,0),new U(-1,0,0),new U(0,0,1),new U(0,0,-1),new U(0,1,0),new U(0,-1,0)],this._cubeUps=[new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,1,0),new U(0,0,1),new U(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,a=e.distance||i.far;a!==i.far&&(i.far=a,i.updateProjectionMatrix()),za.setFromMatrixPosition(e.matrixWorld),i.position.copy(za),ed.copy(i.position),ed.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(ed),i.updateMatrixWorld(),r.makeTranslation(-za.x,-za.y,-za.z),pg.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(pg)}}fg.prototype.isPointLightShadow=!0;class td extends er{constructor(e,t,i=0,r=1){super(e,t),this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new fg}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}td.prototype.isPointLight=!0;class Ga extends I{constructor(e=-1,t=1,i=1,r=-1,a=.1,u=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=a,this.far=u,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,a,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let a=i-e,u=i+e,l=r+t,h=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;u=(a+=p*this.view.offsetX)+p*this.view.width,h=(l-=g*this.view.offsetY)-g*this.view.height}this.projectionMatrix.makeOrthographic(a,u,l,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=y.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}Ga.prototype.isOrthographicCamera=!0;class mg extends $h{constructor(){super(new Ga(-5,5,5,-5,.5,500))}}mg.prototype.isDirectionalLightShadow=!0;class nd extends er{constructor(e,t){super(e,t),this.type="DirectionalLight",this.position.copy(y.DefaultUp),this.updateMatrix(),this.target=new y,this.shadow=new mg}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}nd.prototype.isDirectionalLight=!0;class id extends er{constructor(e,t){super(e,t),this.type="AmbientLight"}}id.prototype.isAmbientLight=!0;class rd extends er{constructor(e,t,i=10,r=10){super(e,t),this.type="RectAreaLight",this.width=i,this.height=r}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}rd.prototype.isRectAreaLight=!0;class od{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new U)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,a=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.282095),t.addScaledVector(u[1],.488603*r),t.addScaledVector(u[2],.488603*a),t.addScaledVector(u[3],.488603*i),t.addScaledVector(u[4],i*r*1.092548),t.addScaledVector(u[5],r*a*1.092548),t.addScaledVector(u[6],.315392*(3*a*a-1)),t.addScaledVector(u[7],i*a*1.092548),t.addScaledVector(u[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,a=e.z,u=this.coefficients;return t.copy(u[0]).multiplyScalar(.886227),t.addScaledVector(u[1],1.023328*r),t.addScaledVector(u[2],1.023328*a),t.addScaledVector(u[3],1.023328*i),t.addScaledVector(u[4],.858086*i*r),t.addScaledVector(u[5],.858086*r*a),t.addScaledVector(u[6],.743125*a*a-.247708),t.addScaledVector(u[7],.858086*i*a),t.addScaledVector(u[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){const i=e.x,r=e.y,a=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*a,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*a,t[6]=.315392*(3*a*a-1),t[7]=1.092548*i*a,t[8]=.546274*(i*i-r*r)}}od.prototype.isSphericalHarmonics3=!0;class Va extends er{constructor(e=new od,t=1){super(void 0,t),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}Va.prototype.isLightProbe=!0;class gg extends Hn{constructor(e){super(e),this.textures={}}load(e,t,i,r){const a=this,u=new Ui(a.manager);u.setPath(a.path),u.setRequestHeader(a.requestHeader),u.setWithCredentials(a.withCredentials),u.load(e,function(l){try{t(a.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),a.manager.itemError(e)}},i,r)}parse(e){function t(a){return i[a]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",a),i[a]}const i=this.textures,r=new ny[e.type];if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=new Rt().setHex(e.sheen)),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==1&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(r.skinning=e.skinning),e.morphTargets!==void 0&&(r.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(r.morphNormals=e.morphNormals),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.vertexTangents!==void 0&&(r.vertexTangents=e.vertexTangents),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const a in e.uniforms){const u=e.uniforms[a];switch(r.uniforms[a]={},u.type){case"t":r.uniforms[a].value=t(u.value);break;case"c":r.uniforms[a].value=new Rt().setHex(u.value);break;case"v2":r.uniforms[a].value=new Je().fromArray(u.value);break;case"v3":r.uniforms[a].value=new U().fromArray(u.value);break;case"v4":r.uniforms[a].value=new Mn().fromArray(u.value);break;case"m3":r.uniforms[a].value=new Qn().fromArray(u.value);break;case"m4":r.uniforms[a].value=new Bt().fromArray(u.value);break;default:r.uniforms[a].value=u.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(const a in e.extensions)r.extensions[a]=e.extensions[a];if(e.shading!==void 0&&(r.flatShading=e.shading===1),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=t(e.map)),e.matcap!==void 0&&(r.matcap=t(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=t(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=t(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=t(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let a=e.normalScale;Array.isArray(a)===!1&&(a=[a,a]),r.normalScale=new Je().fromArray(a)}return e.displacementMap!==void 0&&(r.displacementMap=t(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=t(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=t(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=t(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=t(e.specularMap)),e.envMap!==void 0&&(r.envMap=t(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=t(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=t(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=t(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=t(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=t(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=t(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new Je().fromArray(e.clearcoatNormalScale)),e.transmission!==void 0&&(r.transmission=e.transmission),e.transmissionMap!==void 0&&(r.transmissionMap=t(e.transmissionMap)),r}setTextures(e){return this.textures=e,this}}const sd={decodeText:function(n){if(typeof TextDecoder<"u")return new TextDecoder().decode(n);let e="";for(let t=0,i=n.length;t<i;t++)e+=String.fromCharCode(n[t]);try{return decodeURIComponent(escape(e))}catch{return e}},extractUrlBase:function(n){const e=n.lastIndexOf("/");return e===-1?"./":n.substr(0,e+1)}};la.prototype=Object.assign(Object.create(ve.prototype),{constructor:la,isInstancedBufferGeometry:!0,copy:function(n){return ve.prototype.copy.call(this,n),this.instanceCount=n.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){const n=ve.prototype.toJSON.call(this);return n.instanceCount=this.instanceCount,n.isInstancedBufferGeometry=!0,n}}),_l.prototype=Object.assign(Object.create(N.prototype),{constructor:_l,isInstancedBufferAttribute:!0,copy:function(n){return N.prototype.copy.call(this,n),this.meshPerAttribute=n.meshPerAttribute,this},toJSON:function(){const n=N.prototype.toJSON.call(this);return n.meshPerAttribute=this.meshPerAttribute,n.isInstancedBufferAttribute=!0,n}});class vg extends Hn{constructor(e){super(e)}load(e,t,i,r){const a=this,u=new Ui(a.manager);u.setPath(a.path),u.setRequestHeader(a.requestHeader),u.setWithCredentials(a.withCredentials),u.load(e,function(l){try{t(a.parse(JSON.parse(l)))}catch(h){r?r(h):console.error(h),a.manager.itemError(e)}},i,r)}parse(e){function t(v,b){if(i[b]!==void 0)return i[b];const E=v.interleavedBuffers[b],S=function(P,k){if(r[k]!==void 0)return r[k];const H=P.arrayBuffers[k],G=new Uint32Array(H).buffer;return r[k]=G,G}(v,E.buffer),D=new qn(Se(E.type,S),E.stride);return D.uuid=E.uuid,i[b]=D,D}const i={},r={},a=e.isInstancedBufferGeometry?new la:new ve,u=e.data.index;if(u!==void 0){const v=Se(u.type,u.array);a.setIndex(new N(v,1))}const l=e.data.attributes;for(const v in l){const b=l[v];let E;if(b.isInterleavedBufferAttribute)E=new hr(t(e.data,b.data),b.itemSize,b.offset,b.normalized);else{const S=Se(b.type,b.array);E=new(b.isInstancedBufferAttribute?_l:N)(S,b.itemSize,b.normalized)}b.name!==void 0&&(E.name=b.name),b.usage!==void 0&&E.setUsage(b.usage),b.updateRange!==void 0&&(E.updateRange.offset=b.updateRange.offset,E.updateRange.count=b.updateRange.count),a.setAttribute(v,E)}const h=e.data.morphAttributes;if(h)for(const v in h){const b=h[v],E=[];for(let S=0,D=b.length;S<D;S++){const P=b[S];let k;P.isInterleavedBufferAttribute?k=new hr(t(e.data,P.data),P.itemSize,P.offset,P.normalized):k=new N(Se(P.type,P.array),P.itemSize,P.normalized),P.name!==void 0&&(k.name=P.name),E.push(k)}a.morphAttributes[v]=E}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let v=0,b=p.length;v!==b;++v){const E=p[v];a.addGroup(E.start,E.count,E.materialIndex)}const g=e.data.boundingSphere;if(g!==void 0){const v=new U;g.center!==void 0&&v.fromArray(g.center),a.boundingSphere=new jr(v,g.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class ry extends Hn{constructor(e){super(e)}load(e,t,i,r){const a=this,u=this.path===""?sd.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||u;const l=new Ui(this.manager);l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(h){let p=null;try{p=JSON.parse(h)}catch(v){return r!==void 0&&r(v),void console.error("THREE:ObjectLoader: Can't parse "+e+".",v.message)}const g=p.metadata;g!==void 0&&g.type!==void 0&&g.type.toLowerCase()!=="geometry"?a.parse(p,t):console.error("THREE.ObjectLoader: Can't load "+e)},i,r)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,r),u=this.parseImages(e.images,function(){t!==void 0&&t(p)}),l=this.parseTextures(e.textures,u),h=this.parseMaterials(e.materials,l),p=this.parseObject(e.object,a,h,i),g=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,g),t!==void 0){let v=!1;for(const b in u)if(u[b]instanceof HTMLImageElement){v=!0;break}v===!1&&t(p)}return p}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const a=new Qr().fromJSON(e[i]);t[a.uuid]=a}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(a){a.isBone&&(r[a.uuid]=a)}),e!==void 0)for(let a=0,u=e.length;a<u;a++){const l=new ic().fromJSON(e[a],r);i[l.uuid]=l}return i}parseGeometries(e,t){const i={};let r;if(e!==void 0){const a=new vg;for(let u=0,l=e.length;u<l;u++){let h;const p=e[u];switch(p.type){case"PlaneGeometry":case"PlaneBufferGeometry":h=new bi[p.type](p.width,p.height,p.widthSegments,p.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":h=new bi[p.type](p.width,p.height,p.depth,p.widthSegments,p.heightSegments,p.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":h=new bi[p.type](p.radius,p.segments,p.thetaStart,p.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":h=new bi[p.type](p.radiusTop,p.radiusBottom,p.height,p.radialSegments,p.heightSegments,p.openEnded,p.thetaStart,p.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":h=new bi[p.type](p.radius,p.height,p.radialSegments,p.heightSegments,p.openEnded,p.thetaStart,p.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":h=new bi[p.type](p.radius,p.widthSegments,p.heightSegments,p.phiStart,p.phiLength,p.thetaStart,p.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":h=new bi[p.type](p.radius,p.detail);break;case"RingGeometry":case"RingBufferGeometry":h=new bi[p.type](p.innerRadius,p.outerRadius,p.thetaSegments,p.phiSegments,p.thetaStart,p.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":h=new bi[p.type](p.radius,p.tube,p.radialSegments,p.tubularSegments,p.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":h=new bi[p.type](p.radius,p.tube,p.tubularSegments,p.radialSegments,p.p,p.q);break;case"TubeGeometry":case"TubeBufferGeometry":h=new bi[p.type](new Zh[p.path.type]().fromJSON(p.path),p.tubularSegments,p.radius,p.radialSegments,p.closed);break;case"LatheGeometry":case"LatheBufferGeometry":h=new bi[p.type](p.points,p.segments,p.phiStart,p.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":h=new bi[p.type](p.vertices,p.indices,p.radius,p.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":r=[];for(let v=0,b=p.shapes.length;v<b;v++){const E=t[p.shapes[v]];r.push(E)}h=new bi[p.type](r,p.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":r=[];for(let v=0,b=p.shapes.length;v<b;v++){const E=t[p.shapes[v]];r.push(E)}const g=p.options.extrudePath;g!==void 0&&(p.options.extrudePath=new Zh[g.type]().fromJSON(g)),h=new bi[p.type](r,p.options);break;case"BufferGeometry":case"InstancedBufferGeometry":h=a.parse(p);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+p.type+'"');continue}h.uuid=p.uuid,p.name!==void 0&&(h.name=p.name),h.isBufferGeometry===!0&&p.userData!==void 0&&(h.userData=p.userData),i[p.uuid]=h}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const a=new gg;a.setTextures(t);for(let u=0,l=e.length;u<l;u++){const h=e[u];if(h.type==="MultiMaterial"){const p=[];for(let g=0;g<h.materials.length;g++){const v=h.materials[g];i[v.uuid]===void 0&&(i[v.uuid]=a.parse(v)),p.push(i[v.uuid])}r[h.uuid]=p}else i[h.uuid]===void 0&&(i[h.uuid]=a.parse(h)),r[h.uuid]=i[h.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],a=Fa.parse(r);t[a.uuid]=a}return t}parseImages(e,t){function i(l){if(typeof l=="string"){const h=l;return function(p){return r.manager.itemStart(p),u.load(p,function(){r.manager.itemEnd(p)},void 0,function(){r.manager.itemError(p),r.manager.itemEnd(p)})}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(h)?h:r.resourcePath+h)}return l.data?{data:Se(l.type,l.data),width:l.width,height:l.height}:null}const r=this,a={};let u;if(e!==void 0&&e.length>0){const l=new Tu(t);(u=new Ec(l)).setCrossOrigin(this.crossOrigin);for(let h=0,p=e.length;h<p;h++){const g=e[h],v=g.url;if(Array.isArray(v)){a[g.uuid]=[];for(let b=0,E=v.length;b<E;b++){const S=i(v[b]);S!==null&&(S instanceof HTMLImageElement?a[g.uuid].push(S):a[g.uuid].push(new Ms(S.data,S.width,S.height)))}}else{const b=i(g.url);b!==null&&(a[g.uuid]=b)}}}return a}parseTextures(e,t){function i(a,u){return typeof a=="number"?a:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",a),u[a])}const r={};if(e!==void 0)for(let a=0,u=e.length;a<u;a++){const l=e[a];l.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',l.uuid),t[l.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",l.image);let h;const p=t[l.image];Array.isArray(p)?(h=new ws(p),p.length===6&&(h.needsUpdate=!0)):(h=p&&p.data?new Ms(p.data,p.width,p.height):new ei(p),p&&(h.needsUpdate=!0)),h.uuid=l.uuid,l.name!==void 0&&(h.name=l.name),l.mapping!==void 0&&(h.mapping=i(l.mapping,oy)),l.offset!==void 0&&h.offset.fromArray(l.offset),l.repeat!==void 0&&h.repeat.fromArray(l.repeat),l.center!==void 0&&h.center.fromArray(l.center),l.rotation!==void 0&&(h.rotation=l.rotation),l.wrap!==void 0&&(h.wrapS=i(l.wrap[0],yg),h.wrapT=i(l.wrap[1],yg)),l.format!==void 0&&(h.format=l.format),l.type!==void 0&&(h.type=l.type),l.encoding!==void 0&&(h.encoding=l.encoding),l.minFilter!==void 0&&(h.minFilter=i(l.minFilter,xg)),l.magFilter!==void 0&&(h.magFilter=i(l.magFilter,xg)),l.anisotropy!==void 0&&(h.anisotropy=l.anisotropy),l.flipY!==void 0&&(h.flipY=l.flipY),l.premultiplyAlpha!==void 0&&(h.premultiplyAlpha=l.premultiplyAlpha),l.unpackAlignment!==void 0&&(h.unpackAlignment=l.unpackAlignment),r[l.uuid]=h}return r}parseObject(e,t,i,r){function a(g){return t[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",g),t[g]}function u(g){if(g!==void 0){if(Array.isArray(g)){const v=[];for(let b=0,E=g.length;b<E;b++){const S=g[b];i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),v.push(i[S])}return v}return i[g]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",g),i[g]}}let l,h,p;switch(e.type){case"Scene":l=new Jl,e.background!==void 0&&Number.isInteger(e.background)&&(l.background=new Rt(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?l.fog=new Aa(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(l.fog=new Sa(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":l=new O(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(l.focus=e.focus),e.zoom!==void 0&&(l.zoom=e.zoom),e.filmGauge!==void 0&&(l.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(l.filmOffset=e.filmOffset),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"OrthographicCamera":l=new Ga(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(l.zoom=e.zoom),e.view!==void 0&&(l.view=Object.assign({},e.view));break;case"AmbientLight":l=new id(e.color,e.intensity);break;case"DirectionalLight":l=new nd(e.color,e.intensity);break;case"PointLight":l=new td(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":l=new rd(e.color,e.intensity,e.width,e.height);break;case"SpotLight":l=new Qh(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":l=new Jh(e.color,e.groundColor,e.intensity);break;case"LightProbe":l=new Va().fromJSON(e);break;case"SkinnedMesh":l=new wi(h=a(e.geometry),p=u(e.material)),e.bindMode!==void 0&&(l.bindMode=e.bindMode),e.bindMatrix!==void 0&&l.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(l.skeleton=e.skeleton);break;case"Mesh":l=new Ge(h=a(e.geometry),p=u(e.material));break;case"InstancedMesh":h=a(e.geometry),p=u(e.material);const g=e.count,v=e.instanceMatrix,b=e.instanceColor;(l=new Bi(h,p,g)).instanceMatrix=new N(new Float32Array(v.array),16),b!==void 0&&(l.instanceColor=new N(new Float32Array(b.array),b.itemSize));break;case"LOD":l=new Gm;break;case"Line":l=new Nn(a(e.geometry),u(e.material));break;case"LineLoop":l=new Ch(a(e.geometry),u(e.material));break;case"LineSegments":l=new vi(a(e.geometry),u(e.material));break;case"PointCloud":case"Points":l=new ts(a(e.geometry),u(e.material));break;case"Sprite":l=new tc(u(e.material));break;case"Group":l=new Ao;break;case"Bone":l=new Yn;break;default:l=new y}if(l.uuid=e.uuid,e.name!==void 0&&(l.name=e.name),e.matrix!==void 0?(l.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(l.matrixAutoUpdate=e.matrixAutoUpdate),l.matrixAutoUpdate&&l.matrix.decompose(l.position,l.quaternion,l.scale)):(e.position!==void 0&&l.position.fromArray(e.position),e.rotation!==void 0&&l.rotation.fromArray(e.rotation),e.quaternion!==void 0&&l.quaternion.fromArray(e.quaternion),e.scale!==void 0&&l.scale.fromArray(e.scale)),e.castShadow!==void 0&&(l.castShadow=e.castShadow),e.receiveShadow!==void 0&&(l.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(l.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(l.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(l.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&l.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(l.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(l.visible=e.visible),e.frustumCulled!==void 0&&(l.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(l.renderOrder=e.renderOrder),e.userData!==void 0&&(l.userData=e.userData),e.layers!==void 0&&(l.layers.mask=e.layers),e.children!==void 0){const g=e.children;for(let v=0;v<g.length;v++)l.add(this.parseObject(g[v],t,i,r))}if(e.animations!==void 0){const g=e.animations;for(let v=0;v<g.length;v++){const b=g[v];l.animations.push(r[b])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(l.autoUpdate=e.autoUpdate);const g=e.levels;for(let v=0;v<g.length;v++){const b=g[v],E=l.getObjectByProperty("uuid",b.object);E!==void 0&&l.addLevel(E,b.distance)}}return l}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const oy={UVMapping:300,CubeReflectionMapping:ha,CubeRefractionMapping:da,EquirectangularReflectionMapping:Ml,EquirectangularRefractionMapping:Tl,CubeUVReflectionMapping:as,CubeUVRefractionMapping:pa},yg={RepeatWrapping:fa,ClampToEdgeWrapping:xi,MirroredRepeatWrapping:ma},xg={NearestFilter:Jn,NearestMipmapNearestFilter:Sl,NearestMipmapLinearFilter:Al,LinearFilter:$n,LinearMipmapNearestFilter:Gu,LinearMipmapLinearFilter:ls};Ru.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Ru,isImageBitmapLoader:!0,setOptions:function(n){return this.options=n,this},load:function(n,e,t,i){n===void 0&&(n=""),this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const r=this,a=Po.get(n);if(a!==void 0)return r.manager.itemStart(n),setTimeout(function(){e&&e(a),r.manager.itemEnd(n)},0),a;const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,fetch(n,u).then(function(l){return l.blob()}).then(function(l){return createImageBitmap(l,Object.assign(r.options,{colorSpaceConversion:"none"}))}).then(function(l){Po.add(n,l),e&&e(l),r.manager.itemEnd(n)}).catch(function(l){i&&i(l),r.manager.itemError(n),r.manager.itemEnd(n)}),r.manager.itemStart(n)}});class _g{constructor(){this.type="ShapePath",this.color=new Rt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Ua,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,a,u){return this.currentPath.bezierCurveTo(e,t,i,r,a,u),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,t){function i(H){const G=[];for(let W=0,K=H.length;W<K;W++){const Q=H[W],V=new Qr;V.curves=Q.curves,G.push(V)}return G}function r(H,G){const W=G.length;let K=!1;for(let Q=W-1,V=0;V<W;Q=V++){let ge=G[Q],Z=G[V],xe=Z.x-ge.x,we=Z.y-ge.y;if(Math.abs(we)>Number.EPSILON){if(we<0&&(ge=G[V],xe=-xe,Z=G[Q],we=-we),H.y<ge.y||H.y>Z.y)continue;if(H.y===ge.y){if(H.x===ge.x)return!0}else{const be=we*(H.x-ge.x)-xe*(H.y-ge.y);if(be===0)return!0;if(be<0)continue;K=!K}}else{if(H.y!==ge.y)continue;if(Z.x<=H.x&&H.x<=ge.x||ge.x<=H.x&&H.x<=Z.x)return!0}}return K}const a=Dr.isClockWise,u=this.subPaths;if(u.length===0)return[];if(t===!0)return i(u);let l,h,p;const g=[];if(u.length===1)return h=u[0],p=new Qr,p.curves=h.curves,g.push(p),g;let v=!a(u[0].getPoints());v=e?!v:v;const b=[],E=[];let S,D=[],P=0;E[P]=void 0,D[P]=[];for(let H=0,G=u.length;H<G;H++)l=a(S=(h=u[H]).getPoints()),(l=e?!l:l)?(!v&&E[P]&&P++,E[P]={s:new Qr,p:S},E[P].s.curves=h.curves,v&&P++,D[P]=[]):D[P].push({h,p:S[0]});if(!E[0])return i(u);if(E.length>1){let H=!1;const G=[];for(let W=0,K=E.length;W<K;W++)b[W]=[];for(let W=0,K=E.length;W<K;W++){const Q=D[W];for(let V=0;V<Q.length;V++){const ge=Q[V];let Z=!0;for(let xe=0;xe<E.length;xe++)r(ge.p,E[xe].p)&&(W!==xe&&G.push({froms:W,tos:xe,hole:V}),Z?(Z=!1,b[xe].push(ge)):H=!0);Z&&b[W].push(ge)}}G.length>0&&(H||(D=b))}let k;for(let H=0,G=E.length;H<G;H++){p=E[H].s,g.push(p);for(let W=0,K=(k=D[H]).length;W<K;W++)p.holes.push(k[W].h)}return g}}class ad{constructor(e){this.type="Font",this.data=e}generateShapes(e,t=100){const i=[],r=Av(e,t,this.data);for(let a=0,u=r.length;a<u;a++)Array.prototype.push.apply(i,r[a].toShapes());return i}}ad.prototype.isFont=!0;class sy extends Hn{constructor(e){super(e)}load(e,t,i,r){const a=this,u=new Ui(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(a.withCredentials),u.load(e,function(l){let h;try{h=JSON.parse(l)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),h=JSON.parse(l.substring(65,l.length-2))}const p=a.parse(h);t&&t(p)},i,r)}parse(e){return new ad(e)}}let Ac;const ld={getContext:function(){return Ac===void 0&&(Ac=new(window.AudioContext||window.webkitAudioContext)),Ac},setContext:function(n){Ac=n}};class bg extends Hn{constructor(e){super(e)}load(e,t,i,r){const a=this,u=new Ui(this.manager);u.setResponseType("arraybuffer"),u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(l){try{const h=l.slice(0);ld.getContext().decodeAudioData(h,function(p){t(p)})}catch(h){r?r(h):console.error(h),a.manager.itemError(e)}},i,r)}}class Eg extends Va{constructor(e,t,i=1){super(void 0,i);const r=new Rt().set(e),a=new Rt().set(t),u=new U(r.r,r.g,r.b),l=new U(a.r,a.g,a.b),h=Math.sqrt(Math.PI),p=h*Math.sqrt(.75);this.sh.coefficients[0].copy(u).add(l).multiplyScalar(h),this.sh.coefficients[1].copy(u).sub(l).multiplyScalar(p)}}Eg.prototype.isHemisphereLightProbe=!0;class wg extends Va{constructor(e,t=1){super(void 0,t);const i=new Rt().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}wg.prototype.isAmbientLightProbe=!0;const Mg=new Bt,Tg=new Bt;class ay{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new O,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new O,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;const i=e.projectionMatrix.clone(),r=t.eyeSep/2,a=r*t.near/t.focus,u=t.near*Math.tan(Kt.DEG2RAD*t.fov*.5)/t.zoom;let l,h;Tg.elements[12]=-r,Mg.elements[12]=r,l=-u*t.aspect+a,h=u*t.aspect+a,i.elements[0]=2*t.near/(h-l),i.elements[8]=(h+l)/(h-l),this.cameraL.projectionMatrix.copy(i),l=-u*t.aspect-a,h=u*t.aspect-a,i.elements[0]=2*t.near/(h-l),i.elements[8]=(h+l)/(h-l),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Tg),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Mg)}}class Sg{constructor(e){this.autoStart=e===void 0||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ip(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Ip();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const Do=new U,Ag=new ii,ly=new U,No=new U;class cy extends y{constructor(){super(),this.type="AudioListener",this.context=ld.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Sg}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Do,Ag,ly),No.set(0,0,-1).applyQuaternion(Ag),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Do.x,r),t.positionY.linearRampToValueAtTime(Do.y,r),t.positionZ.linearRampToValueAtTime(Do.z,r),t.forwardX.linearRampToValueAtTime(No.x,r),t.forwardY.linearRampToValueAtTime(No.y,r),t.forwardZ.linearRampToValueAtTime(No.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Do.x,Do.y,Do.z),t.setOrientation(No.x,No.y,No.z,i.x,i.y,i.z)}}class cd extends y{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0)return void console.warn("THREE.Audio: Audio is already playing.");if(this.hasPlaybackControl===!1)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl!==!1)return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(this.hasPlaybackControl!==!1)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl!==!1)return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl!==!1)return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Io=new U,Rg=new ii,uy=new U,Oo=new U;class hy extends cd{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Io,Rg,uy),Oo.set(0,0,1).applyQuaternion(Rg);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Io.x,i),t.positionY.linearRampToValueAtTime(Io.y,i),t.positionZ.linearRampToValueAtTime(Io.z,i),t.orientationX.linearRampToValueAtTime(Oo.x,i),t.orientationY.linearRampToValueAtTime(Oo.y,i),t.orientationZ.linearRampToValueAtTime(Oo.z,i)}else t.setPosition(Io.x,Io.y,Io.z),t.setOrientation(Oo.x,Oo.y,Oo.z)}}class Cg{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class Lg{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,a,u;switch(t){case"quaternion":r=this._slerp,a=this._slerpAdditive,u=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,a=this._select,u=this._setAdditiveIdentityOther,this.buffer=new Array(5*i);break;default:r=this._lerp,a=this._lerpAdditive,u=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=a,this._setIdentity=u,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,a=e*r+r;let u=this.cumulativeWeight;if(u===0){for(let l=0;l!==r;++l)i[a+l]=i[l];u=t}else{const l=t/(u+=t);this._mixBufferRegion(i,a,0,l,r)}this.cumulativeWeight=u}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,a=this.cumulativeWeight,u=this.cumulativeWeightAdditive,l=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){const h=t*this._origIndex;this._mixBufferRegion(i,r,h,1-a,t)}u>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let h=t,p=t+t;h!==p;++h)if(i[h]!==i[h+t]){l.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let a=i,u=r;a!==u;++a)t[a]=t[r+a%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,a){if(r>=.5)for(let u=0;u!==a;++u)e[t+u]=e[i+u]}_slerp(e,t,i,r){ii.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,a){const u=this._workIndex*a;ii.multiplyQuaternionsFlat(e,u,e,t,e,i),ii.slerpFlat(e,t,e,t,e,u,r)}_lerp(e,t,i,r,a){const u=1-r;for(let l=0;l!==a;++l){const h=t+l;e[h]=e[h]*u+e[i+l]*r}}_lerpAdditive(e,t,i,r,a){for(let u=0;u!==a;++u){const l=t+u;e[l]=e[l]+e[i+u]*r}}}const dy=new RegExp("[\\[\\]\\.:\\/]","g"),py="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",fy=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),my=/(WCOD+)?/.source.replace("WCOD",py),gy=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),vy=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),yy=new RegExp("^"+fy+my+gy+vy+"$"),xy=["material","materials","bones"];Object.assign(Op.prototype,{getValue:function(n,e){this.bind();const t=this._targetGroup.nCachedObjects_,i=this._bindings[t];i!==void 0&&i.getValue(n,e)},setValue:function(n,e){const t=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=t.length;i!==r;++i)t[i].setValue(n,e)},bind:function(){const n=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=n.length;e!==t;++e)n[e].bind()},unbind:function(){const n=this._bindings;for(let e=this._targetGroup.nCachedObjects_,t=n.length;e!==t;++e)n[e].unbind()}}),Object.assign(fi,{Composite:Op,create:function(n,e,t){return n&&n.isAnimationObjectGroup?new fi.Composite(n,e,t):new fi(n,e,t)},sanitizeNodeName:function(n){return n.replace(/\s/g,"_").replace(dy,"")},parseTrackName:function(n){const e=yy.exec(n);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+n);const t={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},i=t.nodeName&&t.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const r=t.nodeName.substring(i+1);xy.indexOf(r)!==-1&&(t.nodeName=t.nodeName.substring(0,i),t.objectName=r)}if(t.propertyName===null||t.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+n);return t},findNode:function(n,e){if(!e||e===""||e==="."||e===-1||e===n.name||e===n.uuid)return n;if(n.skeleton){const t=n.skeleton.getBoneByName(e);if(t!==void 0)return t}if(n.children){const t=function(r){for(let a=0;a<r.length;a++){const u=r[a];if(u.name===e||u.uuid===e)return u;const l=t(u.children);if(l)return l}return null},i=t(n.children);if(i)return i}return null}}),Object.assign(fi.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(n,e){n[e]=this.node[this.propertyName]},function(n,e){const t=this.resolvedProperty;for(let i=0,r=t.length;i!==r;++i)n[e++]=t[i]},function(n,e){n[e]=this.resolvedProperty[this.propertyIndex]},function(n,e){this.resolvedProperty.toArray(n,e)}],SetterByBindingTypeAndVersioning:[[function(n,e){this.targetObject[this.propertyName]=n[e]},function(n,e){this.targetObject[this.propertyName]=n[e],this.targetObject.needsUpdate=!0},function(n,e){this.targetObject[this.propertyName]=n[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(n,e){const t=this.resolvedProperty;for(let i=0,r=t.length;i!==r;++i)t[i]=n[e++]},function(n,e){const t=this.resolvedProperty;for(let i=0,r=t.length;i!==r;++i)t[i]=n[e++];this.targetObject.needsUpdate=!0},function(n,e){const t=this.resolvedProperty;for(let i=0,r=t.length;i!==r;++i)t[i]=n[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(n,e){this.resolvedProperty[this.propertyIndex]=n[e]},function(n,e){this.resolvedProperty[this.propertyIndex]=n[e],this.targetObject.needsUpdate=!0},function(n,e){this.resolvedProperty[this.propertyIndex]=n[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(n,e){this.resolvedProperty.fromArray(n,e)},function(n,e){this.resolvedProperty.fromArray(n,e),this.targetObject.needsUpdate=!0},function(n,e){this.resolvedProperty.fromArray(n,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(n,e){this.bind(),this.getValue(n,e)},setValue:function(n,e){this.bind(),this.setValue(n,e)},bind:function(){let n=this.node;const e=this.parsedPath,t=e.objectName,i=e.propertyName;let r=e.propertyIndex;if(n||(n=fi.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=n),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!n)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(t){let h=e.objectIndex;switch(t){case"materials":if(!n.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!n.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);n=n.material.materials;break;case"bones":if(!n.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);n=n.skeleton.bones;for(let p=0;p<n.length;p++)if(n[p].name===h){h=p;break}break;default:if(n[t]===void 0)return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);n=n[t]}if(h!==void 0){if(n[h]===void 0)return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,n);n=n[h]}}const a=n[i];if(a===void 0){const h=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+i+" but it wasn't found.",n)}let u=this.Versioning.None;this.targetObject=n,n.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:n.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(r!==void 0){if(i==="morphTargetInfluences"){if(!n.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!n.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!n.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);n.morphTargetDictionary[r]!==void 0&&(r=n.morphTargetDictionary[r])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=r}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][u]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(fi.prototype,{_getValue_unbound:fi.prototype.getValue,_setValue_unbound:fi.prototype.setValue});class Pg{constructor(){this.uuid=Kt.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,a=this._bindings,u=a.length;let l,h=e.length,p=this.nCachedObjects_;for(let g=0,v=arguments.length;g!==v;++g){const b=arguments[g],E=b.uuid;let S=t[E];if(S===void 0){S=h++,t[E]=S,e.push(b);for(let D=0,P=u;D!==P;++D)a[D].push(new fi(b,i[D],r[D]))}else if(S<p){l=e[S];const D=--p,P=e[D];t[P.uuid]=S,e[S]=P,t[E]=D,e[D]=b;for(let k=0,H=u;k!==H;++k){const G=a[k],W=G[D];let K=G[S];G[S]=W,K===void 0&&(K=new fi(b,i[k],r[k])),G[D]=K}}else e[S]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let a=this.nCachedObjects_;for(let u=0,l=arguments.length;u!==l;++u){const h=arguments[u],p=h.uuid,g=t[p];if(g!==void 0&&g>=a){const v=a++,b=e[v];t[b.uuid]=g,e[g]=b,t[p]=v,e[v]=h;for(let E=0,S=r;E!==S;++E){const D=i[E],P=D[v],k=D[g];D[g]=P,D[v]=k}}}this.nCachedObjects_=a}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let a=this.nCachedObjects_,u=e.length;for(let l=0,h=arguments.length;l!==h;++l){const p=arguments[l].uuid,g=t[p];if(g!==void 0)if(delete t[p],g<a){const v=--a,b=e[v],E=--u,S=e[E];t[b.uuid]=g,e[g]=b,t[S.uuid]=v,e[v]=S,e.pop();for(let D=0,P=r;D!==P;++D){const k=i[D],H=k[v],G=k[E];k[g]=H,k[v]=G,k.pop()}}else{const v=--u,b=e[v];v>0&&(t[b.uuid]=g),e[g]=b,e.pop();for(let E=0,S=r;E!==S;++E){const D=i[E];D[g]=D[v],D.pop()}}}this.nCachedObjects_=a}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const a=this._bindings;if(r!==void 0)return a[r];const u=this._paths,l=this._parsedPaths,h=this._objects,p=h.length,g=this.nCachedObjects_,v=new Array(p);r=a.length,i[e]=r,u.push(e),l.push(t),a.push(v);for(let b=g,E=h.length;b!==E;++b){const S=h[b];v[b]=new fi(S,e,t)}return v}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,a=this._parsedPaths,u=this._bindings,l=u.length-1,h=u[l];t[e[l]]=i,u[i]=h,u.pop(),a[i]=a[l],a.pop(),r[i]=r[l],r.pop()}}}Pg.prototype.isAnimationObjectGroup=!0;class _y{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const a=t.tracks,u=a.length,l=new Array(u),h={endingStart:2400,endingEnd:2400};for(let p=0;p!==u;++p){const g=a[p].createInterpolant(null);l[p]=g,g.settings=h}this._interpolantSettings=h,this._interpolants=l,this._propertyBindings=new Array(u),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,a=e._clip.duration,u=a/r,l=r/a;e.warp(1,u,t),this.warp(l,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,a=r.time,u=this.timeScale;let l=this._timeScaleInterpolant;l===null&&(l=r._lendControlInterpolant(),this._timeScaleInterpolant=l);const h=l.parameterPositions,p=l.sampleValues;return h[0]=a,h[1]=a+i,p[0]=e/u,p[1]=t/u,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled)return void this._updateWeight(e);const a=this._startTime;if(a!==null){const h=(e-a)*i;if(h<0||i===0)return;this._startTime=null,t=i*h}t*=this._updateTimeScale(e);const u=this._updateTime(t),l=this._updateWeight(e);if(l>0){const h=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case 2501:for(let g=0,v=h.length;g!==v;++g)h[g].evaluate(u),p[g].accumulateAdditive(l);break;case 2500:default:for(let g=0,v=h.length;g!==v;++g)h[g].evaluate(u),p[g].accumulate(r,l)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;i!==null&&(t*=i.evaluate(e)[0],e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t))}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,a=this._loopCount;const u=i===2202;if(e===0)return a===-1?r:u&&(1&a)==1?t-r:r;if(i===2200){a===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(a===-1&&(e>=0?(a=0,this._setEndings(!0,this.repetitions===0,u)):this._setEndings(this.repetitions===0,!0,u)),r>=t||r<0){const l=Math.floor(r/t);r-=t*l,a+=Math.abs(l);const h=this.repetitions-a;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(h===1){const p=e<0;this._setEndings(p,!p,u)}else this._setEndings(!1,!1,u);this._loopCount=a,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=r;if(u&&(1&a)==1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=2401,r.endingEnd=2401):(r.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,r.endingEnd=t?this.zeroSlopeAtEnd?2401:2400:2402)}_scheduleFading(e,t,i){const r=this._mixer,a=r.time;let u=this._weightInterpolant;u===null&&(u=r._lendControlInterpolant(),this._weightInterpolant=u);const l=u.parameterPositions,h=u.sampleValues;return l[0]=a,h[0]=t,l[1]=a+e,h[1]=i,this}}class Dg extends d{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,a=r.length,u=e._propertyBindings,l=e._interpolants,h=i.uuid,p=this._bindingsByRootAndName;let g=p[h];g===void 0&&(g={},p[h]=g);for(let v=0;v!==a;++v){const b=r[v],E=b.name;let S=g[E];if(S!==void 0)u[v]=S;else{if((S=u[v])!==void 0){S._cacheIndex===null&&(++S.referenceCount,this._addInactiveBinding(S,h,E));continue}const D=t&&t._propertyBindings[v].binding.parsedPath;++(S=new Lg(fi.create(i,E,D),b.ValueTypeName,b.getValueSize())).referenceCount,this._addInactiveBinding(S,h,E),u[v]=S}l[v].resultBuffer=S.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,a=this._actionsByClip[r];this._bindAction(e,a&&a.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const a=t[i];a.useCount++==0&&(this._lendBinding(a),a.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const a=t[i];--a.useCount==0&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,a=this._actionsByClip;let u=a[t];if(u===void 0)u={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=u;else{const l=u.knownActions;e._byClipCacheIndex=l.length,l.push(e)}e._cacheIndex=r.length,r.push(e),u.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const a=e._clip.uuid,u=this._actionsByClip,l=u[a],h=l.knownActions,p=h[h.length-1],g=e._byClipCacheIndex;p._byClipCacheIndex=g,h[g]=p,h.pop(),e._byClipCacheIndex=null,delete l.actionByRoot[(e._localRoot||this._root).uuid],h.length===0&&delete u[a],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const a=t[i];--a.referenceCount==0&&this._removeInactiveBinding(a)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=i,t[i]=a}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=i,t[i]=a}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,a=this._bindings;let u=r[t];u===void 0&&(u={},r[t]=u),u[i]=e,e._cacheIndex=a.length,a.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,a=i.path,u=this._bindingsByRootAndName,l=u[r],h=t[t.length-1],p=e._cacheIndex;h._cacheIndex=p,t[p]=h,t.pop(),delete l[a],Object.keys(l).length===0&&delete u[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=i,t[i]=a}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=i,t[i]=a}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&((i=new oa(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,a=t[r];e.__cacheIndex=r,t[r]=e,a.__cacheIndex=i,t[i]=a}clipAction(e,t,i){const r=t||this._root,a=r.uuid;let u=typeof e=="string"?Fa.findByName(r,e):e;const l=u!==null?u.uuid:e,h=this._actionsByClip[l];let p=null;if(i===void 0&&(i=u!==null?u.blendMode:2500),h!==void 0){const v=h.actionByRoot[a];if(v!==void 0&&v.blendMode===i)return v;p=h.knownActions[0],u===null&&(u=p._clip)}if(u===null)return null;const g=new _y(this,u,t,i);return this._bindAction(g,p),this._addInactiveAction(g,l,a),g}existingAction(e,t){const i=t||this._root,r=i.uuid,a=typeof e=="string"?Fa.findByName(i,e):e,u=a?a.uuid:e,l=this._actionsByClip[u];return l!==void 0&&l.actionByRoot[r]||null}stopAllAction(){const e=this._actions;for(let t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,a=Math.sign(e),u=this._accuIndex^=1;for(let p=0;p!==i;++p)t[p]._update(r,e,a,u);const l=this._bindings,h=this._nActiveBindings;for(let p=0;p!==h;++p)l[p].apply(u);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,a=r[i];if(a!==void 0){const u=a.knownActions;for(let l=0,h=u.length;l!==h;++l){const p=u[l];this._deactivateAction(p);const g=p._cacheIndex,v=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,v._cacheIndex=g,t[g]=v,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const a in i){const u=i[a].actionByRoot[t];u!==void 0&&(this._deactivateAction(u),this._removeInactiveAction(u))}const r=this._bindingsByRootAndName[t];if(r!==void 0)for(const a in r){const u=r[a];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}Dg.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Rc{constructor(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new Rc(this.value.clone===void 0?this.value:this.value.clone())}}Cu.prototype=Object.assign(Object.create(qn.prototype),{constructor:Cu,isInstancedInterleavedBuffer:!0,copy:function(n){return qn.prototype.copy.call(this,n),this.meshPerAttribute=n.meshPerAttribute,this},clone:function(n){const e=qn.prototype.clone.call(this,n);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(n){const e=qn.prototype.toJSON.call(this,n);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.defineProperty(Lu.prototype,"needsUpdate",{set:function(n){n===!0&&this.version++}}),Object.assign(Lu.prototype,{isGLBufferAttribute:!0,setBuffer:function(n){return this.buffer=n,this},setType:function(n,e){return this.type=n,this.elementSize=e,this},setItemSize:function(n){return this.itemSize=n,this},setCount:function(n){return this.count=n,this}}),Object.assign(Pu.prototype,{set:function(n,e){this.ray.set(n,e)},setFromCamera:function(n,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(n.x,n.y,.5).unproject(e).sub(this.ray.origin).normalize(),this.camera=e):e&&e.isOrthographicCamera?(this.ray.origin.set(n.x,n.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld),this.camera=e):console.error("THREE.Raycaster: Unsupported camera type: "+e.type)},intersectObject:function(n,e=!1,t=[]){return Du(n,this,t,e),t.sort(kp),t},intersectObjects:function(n,e=!1,t=[]){for(let i=0,r=n.length;i<r;i++)Du(n[i],this,t,e);return t.sort(kp),t}});class by{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Kt.clamp(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class Ey{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}const Ng=new Je;class Ns{constructor(e=new Je(1/0,1/0),t=new Je(-1/0,-1/0)){this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Ng.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Je),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Je),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Je),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Je),t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Ng.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Ns.prototype.isBox2=!0;const Ig=new U,Cc=new U;class Og{constructor(e=new U,t=new U){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new U),e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new U),e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return t===void 0&&(console.warn("THREE.Line3: .at() target is now required"),t=new U),this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Ig.subVectors(e,this.start),Cc.subVectors(this.end,this.start);const i=Cc.dot(Cc);let r=Cc.dot(Ig)/i;return t&&(r=Kt.clamp(r,0,1)),r}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return i===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new U),this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}(bl.prototype=Object.create(y.prototype)).constructor=bl,bl.prototype.isImmediateRenderObject=!0;const kg=new U;class wy extends y{constructor(e,t){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;const i=new ve,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let u=0,l=1;u<32;u++,l++){const h=u/32*Math.PI*2,p=l/32*Math.PI*2;r.push(Math.cos(h),Math.sin(h),1,Math.cos(p),Math.sin(p),1)}i.setAttribute("position",new ee(r,3));const a=new oi({fog:!1,toneMapped:!1});this.cone=new vi(i,a),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),kg.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(kg),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const eo=new U,Lc=new Bt,ud=new Bt;class Fg extends vi{constructor(e){const t=Fp(e),i=new ve,r=[],a=[],u=new Rt(0,0,1),l=new Rt(0,1,0);for(let h=0;h<t.length;h++){const p=t[h];p.parent&&p.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),a.push(u.r,u.g,u.b),a.push(l.r,l.g,l.b))}i.setAttribute("position",new ee(r,3)),i.setAttribute("color",new ee(a,3)),super(i,new oi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");ud.copy(this.root.matrixWorld).invert();for(let a=0,u=0;a<t.length;a++){const l=t[a];l.parent&&l.parent.isBone&&(Lc.multiplyMatrices(ud,l.matrixWorld),eo.setFromMatrixPosition(Lc),r.setXYZ(u,eo.x,eo.y,eo.z),Lc.multiplyMatrices(ud,l.parent.matrixWorld),eo.setFromMatrixPosition(Lc),r.setXYZ(u+1,eo.x,eo.y,eo.z),u+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}class My extends Ge{constructor(e,t,i){super(new Ia(t,4,2),new Pr({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Ty=new U,Hg=new Rt,Bg=new Rt;class Sy extends y{constructor(e,t,i){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const r=new Da(t);r.rotateY(.5*Math.PI),this.material=new Pr({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const a=r.getAttribute("position"),u=new Float32Array(3*a.count);r.setAttribute("color",new N(u,3)),this.add(new Ge(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Hg.copy(this.light.color),Bg.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const a=i<r/2?Hg:Bg;t.setXYZ(i,a.r,a.g,a.b)}t.needsUpdate=!0}e.lookAt(Ty.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Ug extends vi{constructor(e=10,t=10,i=4473924,r=8947848){i=new Rt(i),r=new Rt(r);const a=t/2,u=e/t,l=e/2,h=[],p=[];for(let v=0,b=0,E=-l;v<=t;v++,E+=u){h.push(-l,0,E,l,0,E),h.push(E,0,-l,E,0,l);const S=v===a?i:r;S.toArray(p,b),b+=3,S.toArray(p,b),b+=3,S.toArray(p,b),b+=3,S.toArray(p,b),b+=3}const g=new ve;g.setAttribute("position",new ee(h,3)),g.setAttribute("color",new ee(p,3)),super(g,new oi({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class Ay extends vi{constructor(e=10,t=16,i=8,r=64,a=4473924,u=8947848){a=new Rt(a),u=new Rt(u);const l=[],h=[];for(let g=0;g<=t;g++){const v=g/t*(2*Math.PI),b=Math.sin(v)*e,E=Math.cos(v)*e;l.push(0,0,0),l.push(b,0,E);const S=1&g?a:u;h.push(S.r,S.g,S.b),h.push(S.r,S.g,S.b)}for(let g=0;g<=i;g++){const v=1&g?a:u,b=e-e/i*g;for(let E=0;E<r;E++){let S=E/r*(2*Math.PI),D=Math.sin(S)*b,P=Math.cos(S)*b;l.push(D,0,P),h.push(v.r,v.g,v.b),S=(E+1)/r*(2*Math.PI),D=Math.sin(S)*b,P=Math.cos(S)*b,l.push(D,0,P),h.push(v.r,v.g,v.b)}}const p=new ve;p.setAttribute("position",new ee(l,3)),p.setAttribute("color",new ee(h,3)),super(p,new oi({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const zg=new U,Pc=new U,Gg=new U;class Ry extends y{constructor(e,t,i){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,t===void 0&&(t=1);let r=new ve;r.setAttribute("position",new ee([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const a=new oi({fog:!1,toneMapped:!1});this.lightPlane=new Nn(r,a),this.add(this.lightPlane),(r=new ve).setAttribute("position",new ee([0,0,0,0,0,1],3)),this.targetLine=new Nn(r,a),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){zg.setFromMatrixPosition(this.light.matrixWorld),Pc.setFromMatrixPosition(this.light.target.matrixWorld),Gg.subVectors(Pc,zg),this.lightPlane.lookAt(Pc),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Pc),this.targetLine.scale.z=Gg.length()}}const Dc=new U,Bn=new I;class Cy extends vi{constructor(e){function t(S,D,P){i(S,P),i(D,P)}function i(S,D){u.push(0,0,0),l.push(D.r,D.g,D.b),h[S]===void 0&&(h[S]=[]),h[S].push(u.length/3-1)}const r=new ve,a=new oi({color:16777215,vertexColors:!0,toneMapped:!1}),u=[],l=[],h={},p=new Rt(16755200),g=new Rt(16711680),v=new Rt(43775),b=new Rt(16777215),E=new Rt(3355443);t("n1","n2",p),t("n2","n4",p),t("n4","n3",p),t("n3","n1",p),t("f1","f2",p),t("f2","f4",p),t("f4","f3",p),t("f3","f1",p),t("n1","f1",p),t("n2","f2",p),t("n3","f3",p),t("n4","f4",p),t("p","n1",g),t("p","n2",g),t("p","n3",g),t("p","n4",g),t("u1","u2",v),t("u2","u3",v),t("u3","u1",v),t("c","t",b),t("p","c",E),t("cn1","cn2",E),t("cn3","cn4",E),t("cf1","cf2",E),t("cf3","cf4",E),r.setAttribute("position",new ee(u,3)),r.setAttribute("color",new ee(l,3)),super(r,a),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=h,this.update()}update(){const e=this.geometry,t=this.pointMap;Bn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),zn("c",t,e,Bn,0,0,-1),zn("t",t,e,Bn,0,0,1),zn("n1",t,e,Bn,-1,-1,-1),zn("n2",t,e,Bn,1,-1,-1),zn("n3",t,e,Bn,-1,1,-1),zn("n4",t,e,Bn,1,1,-1),zn("f1",t,e,Bn,-1,-1,1),zn("f2",t,e,Bn,1,-1,1),zn("f3",t,e,Bn,-1,1,1),zn("f4",t,e,Bn,1,1,1),zn("u1",t,e,Bn,.7,1.1,-1),zn("u2",t,e,Bn,-.7,1.1,-1),zn("u3",t,e,Bn,0,2,-1),zn("cf1",t,e,Bn,-1,0,1),zn("cf2",t,e,Bn,1,0,1),zn("cf3",t,e,Bn,0,-1,1),zn("cf4",t,e,Bn,0,1,1),zn("cn1",t,e,Bn,-1,0,-1),zn("cn2",t,e,Bn,1,0,-1),zn("cn3",t,e,Bn,0,-1,-1),zn("cn4",t,e,Bn,0,1,-1),e.getAttribute("position").needsUpdate=!0}}const Nc=new Mi;class Vg extends vi{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),a=new ve;a.setIndex(new N(i,1)),a.setAttribute("position",new N(r,3)),super(a,new oi({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Nc.setFromObject(this.object),Nc.isEmpty())return;const t=Nc.min,i=Nc.max,r=this.geometry.attributes.position,a=r.array;a[0]=i.x,a[1]=i.y,a[2]=i.z,a[3]=t.x,a[4]=i.y,a[5]=i.z,a[6]=t.x,a[7]=t.y,a[8]=i.z,a[9]=i.x,a[10]=t.y,a[11]=i.z,a[12]=i.x,a[13]=i.y,a[14]=t.z,a[15]=t.x,a[16]=i.y,a[17]=t.z,a[18]=t.x,a[19]=t.y,a[20]=t.z,a[21]=i.x,a[22]=t.y,a[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return vi.prototype.copy.call(this,e),this.object=e.object,this}}class Ly extends vi{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new ve;r.setIndex(new N(i,1)),r.setAttribute("position",new ee([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new oi({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class Py extends Nn{constructor(e,t=1,i=16776960){const r=i,a=new ve;a.setAttribute("position",new ee([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),a.computeBoundingSphere(),super(a,new oi({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const u=new ve;u.setAttribute("position",new ee([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),u.computeBoundingSphere(),this.add(new Ge(u,new Pr({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?Kn:os,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const Wg=new U;let hd,jg;class Dy extends y{constructor(e=new U(0,0,1),t=new U(0,0,0),i=1,r=16776960,a=.2*i,u=.2*a){super(),this.type="ArrowHelper",hd===void 0&&((hd=new ve).setAttribute("position",new ee([0,0,0,0,1,0],3)),(jg=new Ls(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new Nn(hd,new oi({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ge(jg,new Pr({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,a,u)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Wg.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Wg,t)}}setLength(e,t=.2*e,i=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class Xg extends vi{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new ve;i.setAttribute("position",new ee(t,3)),i.setAttribute("color",new ee([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(i,new oi({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}}const qg=new Float32Array(1),Ny=new Int32Array(qg.buffer),Iy={toHalfFloat:function(n){qg[0]=n;const e=Ny[0];let t=e>>16&32768,i=e>>12&2047;const r=e>>23&255;return r<103?t:r>142?(t|=31744,t|=(r==255?0:1)&&8388607&e):r<113?(i|=2048,t|=(i>>114-r)+(i>>113-r&1)):(t|=r-112<<10|i>>1,t+=1&i)}},Is=4,to=8,pr=Math.pow(2,to),Yg=[.125,.215,.35,.446,.526,.582],Kg=to-Is+1+Yg.length,fr={[_i]:0,[xa]:1,[Cl]:2,[Qu]:3,[eh]:4,[th]:5,[Rl]:6},ko=new Pr({side:Kn,depthWrite:!1,depthTest:!1}),Oy=new Ge(new So,ko),dd=new Ga,{_lodPlanes:Wa,_sizeLods:Zg,_sigmas:Ic}=function(){const n=[],e=[],t=[];let i=to;for(let r=0;r<Kg;r++){const a=Math.pow(2,i);e.push(a);let u=1/a;r>to-Is?u=Yg[r-to+Is-1]:r==0&&(u=0),t.push(u);const l=1/(a-1),h=-l/2,p=1+l/2,g=[h,h,p,h,p,p,h,h,p,p,h,p],v=new Float32Array(108),b=new Float32Array(72),E=new Float32Array(36);for(let D=0;D<6;D++){const P=D%3*2/3-1,k=D>2?0:-1,H=[P,k,0,P+2/3,k,0,P+2/3,k+1,0,P,k,0,P+2/3,k+1,0,P,k+1,0];v.set(H,18*D),b.set(g,12*D);const G=[D,D,D,D,D,D];E.set(G,6*D)}const S=new ve;S.setAttribute("position",new N(v,3)),S.setAttribute("uv",new N(b,2)),S.setAttribute("faceIndex",new N(E,1)),n.push(S),i>Is&&i--}return{_lodPlanes:n,_sizeLods:e,_sigmas:t}}(),Jg=new Rt;let pd=null;const Fo=(1+Math.sqrt(5))/2,Os=1/Fo,$g=[new U(1,1,1),new U(-1,1,1),new U(1,1,-1),new U(-1,1,-1),new U(0,Fo,Os),new U(0,Fo,-Os),new U(Os,0,Fo),new U(-Os,0,Fo),new U(Fo,Os,0),new U(-Fo,Os,0)];class ky{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(t){const i=new Float32Array(t),r=new U(0,1,0);return new Ps({name:"SphericalGaussianBlur",defines:{n:t},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r},inputEncoding:{value:fr[_i]},outputEncoding:{value:fr[_i]}},vertexShader:`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`,fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			

		uniform int inputEncoding;
		uniform int outputEncoding;

		#include <encodings_pars_fragment>

		vec4 inputTexelToLinear( vec4 value ) {

			if ( inputEncoding == 0 ) {

				return value;

			} else if ( inputEncoding == 1 ) {

				return sRGBToLinear( value );

			} else if ( inputEncoding == 2 ) {

				return RGBEToLinear( value );

			} else if ( inputEncoding == 3 ) {

				return RGBMToLinear( value, 7.0 );

			} else if ( inputEncoding == 4 ) {

				return RGBMToLinear( value, 16.0 );

			} else if ( inputEncoding == 5 ) {

				return RGBDToLinear( value, 256.0 );

			} else {

				return GammaToLinear( value, 2.2 );

			}

		}

		vec4 linearToOutputTexel( vec4 value ) {

			if ( outputEncoding == 0 ) {

				return value;

			} else if ( outputEncoding == 1 ) {

				return LinearTosRGB( value );

			} else if ( outputEncoding == 2 ) {

				return LinearToRGBE( value );

			} else if ( outputEncoding == 3 ) {

				return LinearToRGBM( value, 7.0 );

			} else if ( outputEncoding == 4 ) {

				return LinearToRGBM( value, 16.0 );

			} else if ( outputEncoding == 5 ) {

				return LinearToRGBD( value, 256.0 );

			} else {

				return LinearToGamma( value, 2.2 );

			}

		}

		vec4 envMapTexelToLinear( vec4 color ) {

			return inputTexelToLinear( color );

		}
	

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

				gl_FragColor = linearToOutputTexel( gl_FragColor );

			}
		`,blending:wr,depthTest:!1,depthWrite:!1})}(20),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){pd=this._renderer.getRenderTarget();const a=this._allocateTargets();return this._sceneToCubeUV(e,i,r,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=zp(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=Up(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let e=0;e<Wa.length;e++)Wa[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(pd),e.scissorTest=!1,El(e,0,0,e.width,e.height)}_fromTexture(e){pd=this._renderer.getRenderTarget();const t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}_allocateTargets(e){const t={magFilter:Jn,minFilter:Jn,generateMipmaps:!1,type:cs,format:Cf,encoding:function(r){return r!==void 0&&r.type===cs&&(r.encoding===_i||r.encoding===xa||r.encoding===Rl)}(e)?e.encoding:Cl,depthBuffer:!1},i=Bp(t);return i.depthBuffer=!e,this._pingPongRenderTarget=Bp(t),i}_compileMaterial(e){const t=new Ge(Wa[0],e);this._renderer.compile(t,dd)}_sceneToCubeUV(e,t,i,r){const a=new O(90,1,t,i),u=[1,-1,1,1,1,1],l=[1,1,1,-1,-1,-1],h=this._renderer,p=h.autoClear,g=h.outputEncoding,v=h.toneMapping;h.getClearColor(Jg),h.toneMapping=yo,h.outputEncoding=_i,h.autoClear=!1;let b=!1;const E=e.background;if(E){if(E.isColor){ko.color.copy(E).convertSRGBToLinear(),e.background=null;const S=Hp(ko.color);ko.opacity=S,b=!0}}else{ko.color.copy(Jg).convertSRGBToLinear();const S=Hp(ko.color);ko.opacity=S,b=!0}for(let S=0;S<6;S++){const D=S%3;D==0?(a.up.set(0,u[S],0),a.lookAt(l[S],0,0)):D==1?(a.up.set(0,0,u[S]),a.lookAt(0,l[S],0)):(a.up.set(0,u[S],0),a.lookAt(0,0,l[S])),El(r,D*pr,S>2?pr:0,pr,pr),h.setRenderTarget(r),b&&h.render(Oy,a),h.render(e,a)}h.toneMapping=v,h.outputEncoding=g,h.autoClear=p}_textureToCubeUV(e,t){const i=this._renderer;e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=zp()):this._equirectShader==null&&(this._equirectShader=Up());const r=e.isCubeTexture?this._cubemapShader:this._equirectShader,a=new Ge(Wa[0],r),u=r.uniforms;u.envMap.value=e,e.isCubeTexture||u.texelSize.value.set(1/e.image.width,1/e.image.height),u.inputEncoding.value=fr[e.encoding],u.outputEncoding.value=fr[t.texture.encoding],El(t,0,0,3*pr,2*pr),i.setRenderTarget(t),i.render(a,dd)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<Kg;r++){const a=Math.sqrt(Ic[r]*Ic[r]-Ic[r-1]*Ic[r-1]),u=$g[(r-1)%$g.length];this._blur(e,r-1,r,a,u)}t.autoClear=i}_blur(e,t,i,r,a){const u=this._pingPongRenderTarget;this._halfBlur(e,u,t,i,r,"latitudinal",a),this._halfBlur(u,e,i,i,r,"longitudinal",a)}_halfBlur(e,t,i,r,a,u,l){const h=this._renderer,p=this._blurMaterial;u!=="latitudinal"&&u!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const g=new Ge(Wa[r],p),v=p.uniforms,b=Zg[i]-1,E=isFinite(a)?Math.PI/(2*b):2*Math.PI/39,S=a/E,D=isFinite(a)?1+Math.floor(3*S):20;D>20&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${D} samples when the maximum is set to 20`);const P=[];let k=0;for(let G=0;G<20;++G){const W=G/S,K=Math.exp(-W*W/2);P.push(K),G==0?k+=K:G<D&&(k+=2*K)}for(let G=0;G<P.length;G++)P[G]=P[G]/k;v.envMap.value=e.texture,v.samples.value=D,v.weights.value=P,v.latitudinal.value=u==="latitudinal",l&&(v.poleAxis.value=l),v.dTheta.value=E,v.mipInt.value=to-i,v.inputEncoding.value=fr[e.texture.encoding],v.outputEncoding.value=fr[e.texture.encoding];const H=Zg[r];El(t,3*Math.max(0,pr-2*H),(r===0?0:2*pr)+2*H*(r>to-Is?r-to+Is:0),3*H,2*H),h.setRenderTarget(t),h.render(g,dd)}}yi.create=function(n,e){return console.log("THREE.Curve.create() has been deprecated"),n.prototype=Object.create(yi.prototype),n.prototype.constructor=n,n.prototype.getPoint=e,n},Ua.prototype.fromPoints=function(n){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(n)},Ug.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Fg.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Hn.prototype.extractUrlBase=function(n){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),sd.extractUrlBase(n)},Hn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Ns.prototype.center=function(n){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(n)},Ns.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ns.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Ns.prototype.size=function(n){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(n)},Mi.prototype.center=function(n){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(n)},Mi.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Mi.prototype.isIntersectionBox=function(n){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},Mi.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},Mi.prototype.size=function(n){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(n)},jr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ma.prototype.setFromMatrix=function(n){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(n)},Og.prototype.center=function(n){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(n)},Kt.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},Kt.nearestPowerOfTwo=function(n){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Kt.floorPowerOfTwo(n)},Kt.nextPowerOfTwo=function(n){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Kt.ceilPowerOfTwo(n)},Qn.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},Qn.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},Qn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Qn.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),n.applyMatrix3(this)},Qn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Qn.prototype.getInverse=function(n){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},Bt.prototype.extractPosition=function(n){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(n)},Bt.prototype.flattenToArrayOffset=function(n,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(n,e)},Bt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new U().setFromMatrixColumn(this,3)},Bt.prototype.setRotationFromQuaternion=function(n){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(n)},Bt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Bt.prototype.multiplyVector3=function(n){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Bt.prototype.multiplyVector4=function(n){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Bt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Bt.prototype.rotateAxis=function(n){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),n.transformDirection(this)},Bt.prototype.crossVector=function(n){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Bt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Bt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Bt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Bt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Bt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Bt.prototype.applyToBufferAttribute=function(n){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),n.applyMatrix4(this)},Bt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Bt.prototype.makeFrustum=function(n,e,t,i,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(n,e,i,t,r,a)},Bt.prototype.getInverse=function(n){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(n).invert()},Yi.prototype.isIntersectionLine=function(n){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(n)},ii.prototype.multiplyVector3=function(n){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),n.applyQuaternion(this)},ii.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},qr.prototype.isIntersectionBox=function(n){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(n)},qr.prototype.isIntersectionPlane=function(n){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(n)},qr.prototype.isIntersectionSphere=function(n){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(n)},Gn.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Gn.prototype.barycoordFromPoint=function(n,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(n,e)},Gn.prototype.midpoint=function(n){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(n)},Gn.prototypenormal=function(n){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(n)},Gn.prototype.plane=function(n){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(n)},Gn.barycoordFromPoint=function(n,e,t,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Gn.getBarycoord(n,e,t,i,r)},Gn.normal=function(n,e,t,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Gn.getNormal(n,e,t,i)},Qr.prototype.extractAllPoints=function(n){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(n)},Qr.prototype.extrude=function(n){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Nr(this,n)},Qr.prototype.makeGeometry=function(n){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Na(this,n)},Je.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},Je.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},Je.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},U.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},U.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},U.prototype.getPositionFromMatrix=function(n){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(n)},U.prototype.getScaleFromMatrix=function(n){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(n)},U.prototype.getColumnFromMatrix=function(n,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,n)},U.prototype.applyProjection=function(n){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(n)},U.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},U.prototype.distanceToManhattan=function(n){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(n)},U.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Mn.prototype.fromAttribute=function(n,e,t){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(n,e,t)},Mn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},y.prototype.getChildByName=function(n){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(n)},y.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},y.prototype.translate=function(n,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,n)},y.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},y.prototype.applyMatrix=function(n){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(y.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(n){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=n}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ge.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ge.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),wi.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(yi.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(n){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=n}}),O.prototype.setLens=function(n,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),e!==void 0&&(this.filmGauge=e),this.setFocalLength(n)},Object.defineProperties(er.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(n){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=n}},shadowCameraLeft:{set:function(n){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=n}},shadowCameraRight:{set:function(n){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=n}},shadowCameraTop:{set:function(n){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=n}},shadowCameraBottom:{set:function(n){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=n}},shadowCameraNear:{set:function(n){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=n}},shadowCameraFar:{set:function(n){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=n}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(n){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=n}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(n){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=n}},shadowMapHeight:{set:function(n){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=n}}}),Object.defineProperties(N.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===bo},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(bo)}}}),N.prototype.setDynamic=function(n){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(n===!0?bo:ds),this},N.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},N.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ve.prototype.addIndex=function(n){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(n)},ve.prototype.addAttribute=function(n,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?n==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(n,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(n,new N(arguments[1],arguments[2])))},ve.prototype.addDrawCall=function(n,e,t){t!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(n,e)},ve.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},ve.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},ve.prototype.removeAttribute=function(n){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(n)},ve.prototype.applyMatrix=function(n){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(n)},Object.defineProperties(ve.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(la.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(n){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=n}}}),Object.defineProperties(Pu.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(n){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=n}}}),Object.defineProperties(qn.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===bo},set:function(n){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(n)}}}),qn.prototype.setDynamic=function(n){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(n===!0?bo:ds),this},qn.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Nr.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Nr.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Nr.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Jl.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Rc.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(x.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Rt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(n){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(n){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=n}}}),Object.defineProperties(go.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(n){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=n}}}),Object.defineProperties(M.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(n){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=n}}}),xn.prototype.clearTarget=function(n,e,t,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(n),this.clear(e,t,i)},xn.prototype.animate=function(n){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(n)},xn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},xn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},xn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},xn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},xn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},xn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},xn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},xn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},xn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},xn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},xn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},xn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},xn.prototype.enableScissorTest=function(n){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(n)},xn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},xn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},xn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},xn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},xn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},xn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},xn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},xn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},xn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},xn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(xn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=n}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(n){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=n}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(n){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=n===!0?xa:_i}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(ji.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Tr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=n}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(n){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=n}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=n}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(n){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=n}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(n){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=n}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(n){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=n}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(n){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=n}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(n){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=n}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(n){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=n}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(n){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=n}}}),cd.prototype.load=function(n){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return new bg().load(n,function(t){e.setBuffer(t)}),this},Cg.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Xl.prototype.updateCubeMap=function(n,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(n,e)},Xl.prototype.clear=function(n,e,t,i){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(n,e,t,i)},Eo.crossOrigin=void 0,Eo.loadTexture=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const r=new xl;r.setCrossOrigin(this.crossOrigin);const a=r.load(n,t,void 0,i);return e&&(a.mapping=e),a},Eo.loadTextureCube=function(n,e,t,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const r=new sg;r.setCrossOrigin(this.crossOrigin);const a=r.load(n,t,void 0,i);return e&&(a.mapping=e),a},Eo.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Eo.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Fy={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"127"}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="127"),s.ACESFilmicToneMapping=yf,s.AddEquation=vo,s.AddOperation=ff,s.AdditiveAnimationBlendMode=2501,s.AdditiveBlending=Ou,s.AlphaFormat=Sf,s.AlwaysDepth=af,s.AlwaysStencilFunc=mm,s.AmbientLight=id,s.AmbientLightProbe=wg,s.AnimationClip=Fa,s.AnimationLoader=iy,s.AnimationMixer=Dg,s.AnimationObjectGroup=Pg,s.AnimationUtils=Pn,s.ArcCurve=Vh,s.ArrayCamera=Sh,s.ArrowHelper=Dy,s.Audio=cd,s.AudioAnalyser=Cg,s.AudioContext=ld,s.AudioListener=cy,s.AudioLoader=bg,s.AxesHelper=Xg,s.AxisHelper=function(n){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Xg(n)},s.BackSide=Kn,s.BasicDepthPacking=3200,s.BasicShadowMap=0,s.BinaryTextureLoader=function(n){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new yl(n)},s.Bone=Yn,s.BooleanKeyframeTrack=Co,s.BoundingBoxHelper=function(n,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Vg(n,e)},s.Box2=Ns,s.Box3=Mi,s.Box3Helper=Ly,s.BoxBufferGeometry=So,s.BoxGeometry=So,s.BoxHelper=Vg,s.BufferAttribute=N,s.BufferGeometry=ve,s.BufferGeometryLoader=vg,s.ByteType=_f,s.Cache=Po,s.Camera=I,s.CameraHelper=Cy,s.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},s.CanvasTexture=ig,s.CatmullRomCurve3=qh,s.CineonToneMapping=vf,s.CircleBufferGeometry=lc,s.CircleGeometry=lc,s.ClampToEdgeWrapping=xi,s.Clock=Sg,s.Color=Rt,s.ColorKeyframeTrack=Gh,s.CompressedTexture=Ph,s.CompressedTextureLoader=Su,s.ConeBufferGeometry=cc,s.ConeGeometry=cc,s.CubeCamera=Xl,s.CubeReflectionMapping=ha,s.CubeRefractionMapping=da,s.CubeTexture=ws,s.CubeTextureLoader=sg,s.CubeUVReflectionMapping=as,s.CubeUVRefractionMapping=pa,s.CubicBezierCurve=Mc,s.CubicBezierCurve3=Yh,s.CubicInterpolant=ml,s.CullFaceBack=Nu,s.CullFaceFront=jp,s.CullFaceFrontBack=3,s.CullFaceNone=Wp,s.Curve=yi,s.CurvePath=lg,s.CustomBlending=qp,s.CustomToneMapping=xf,s.CylinderBufferGeometry=Ls,s.CylinderGeometry=Ls,s.Cylindrical=Ey,s.DataTexture=Ms,s.DataTexture2DArray=wh,s.DataTexture3D=Mh,s.DataTextureLoader=yl,s.DataUtils=Iy,s.DecrementStencilOp=7683,s.DecrementWrapStencilOp=34056,s.DefaultLoadingManager=og,s.DepthFormat=xo,s.DepthStencilFormat=hs,s.DepthTexture=rg,s.DirectionalLight=nd,s.DirectionalLightHelper=Ry,s.DiscreteInterpolant=gl,s.DodecahedronBufferGeometry=uc,s.DodecahedronGeometry=uc,s.DoubleSide=ca,s.DstAlphaFactor=ef,s.DstColorFactor=nf,s.DynamicBufferAttribute=function(n,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new N(n,e).setUsage(bo)},s.DynamicCopyUsage=35050,s.DynamicDrawUsage=bo,s.DynamicReadUsage=35049,s.EdgesGeometry=Nh,s.EdgesHelper=function(n,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new vi(new Nh(n.geometry),new oi({color:e!==void 0?e:16777215}))},s.EllipseCurve=Ha,s.EqualDepth=cf,s.EqualStencilFunc=514,s.EquirectangularReflectionMapping=Ml,s.EquirectangularRefractionMapping=Tl,s.Euler=To,s.EventDispatcher=d,s.ExtrudeBufferGeometry=Nr,s.ExtrudeGeometry=Nr,s.FaceColors=1,s.FileLoader=Ui,s.FlatShading=1,s.Float16BufferAttribute=Ae,s.Float32Attribute=function(n,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new ee(n,e)},s.Float32BufferAttribute=ee,s.Float64Attribute=function(n,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new de(n,e)},s.Float64BufferAttribute=de,s.FloatType=Mr,s.Fog=Aa,s.FogExp2=Sa,s.Font=ad,s.FontLoader=sy,s.FrontSide=os,s.Frustum=Ma,s.GLBufferAttribute=Lu,s.GLSL1="100",s.GLSL3=nh,s.GammaEncoding=Rl,s.GreaterDepth=hf,s.GreaterEqualDepth=uf,s.GreaterEqualStencilFunc=518,s.GreaterStencilFunc=516,s.GridHelper=Ug,s.Group=Ao,s.HalfFloatType=ya,s.HemisphereLight=Jh,s.HemisphereLightHelper=Sy,s.HemisphereLightProbe=Eg,s.IcosahedronBufferGeometry=fc,s.IcosahedronGeometry=fc,s.ImageBitmapLoader=Ru,s.ImageLoader=Ec,s.ImageUtils=Eo,s.ImmediateRenderObject=bl,s.IncrementStencilOp=7682,s.IncrementWrapStencilOp=34055,s.InstancedBufferAttribute=_l,s.InstancedBufferGeometry=la,s.InstancedInterleavedBuffer=Cu,s.InstancedMesh=Bi,s.Int16Attribute=function(n,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new he(n,e)},s.Int16BufferAttribute=he,s.Int32Attribute=function(n,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new Ee(n,e)},s.Int32BufferAttribute=Ee,s.Int8Attribute=function(n,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new B(n,e)},s.Int8BufferAttribute=B,s.IntType=Ef,s.InterleavedBuffer=qn,s.InterleavedBufferAttribute=hr,s.Interpolant=Pi,s.InterpolateDiscrete=2300,s.InterpolateLinear=2301,s.InterpolateSmooth=2302,s.InvertStencilOp=5386,s.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},s.KeepStencilOp=Ll,s.KeyframeTrack=$i,s.LOD=Gm,s.LatheBufferGeometry=mc,s.LatheGeometry=mc,s.Layers=hh,s.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},s.LessDepth=lf,s.LessEqualDepth=wl,s.LessEqualStencilFunc=515,s.LessStencilFunc=513,s.Light=er,s.LightProbe=Va,s.Line=Nn,s.Line3=Og,s.LineBasicMaterial=oi,s.LineCurve=Ba,s.LineCurve3=ag,s.LineDashedMaterial=zh,s.LineLoop=Ch,s.LinePieces=1,s.LineSegments=vi,s.LineStrip=0,s.LinearEncoding=_i,s.LinearFilter=$n,s.LinearInterpolant=oa,s.LinearMipMapLinearFilter=1008,s.LinearMipMapNearestFilter=1007,s.LinearMipmapLinearFilter=ls,s.LinearMipmapNearestFilter=Gu,s.LinearToneMapping=mf,s.Loader=Hn,s.LoaderUtils=sd,s.LoadingManager=Tu,s.LogLuvEncoding=dm,s.LoopOnce=2200,s.LoopPingPong=2202,s.LoopRepeat=2201,s.LuminanceAlphaFormat=Rf,s.LuminanceFormat=Af,s.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},s.Material=x,s.MaterialLoader=gg,s.Math=Kt,s.MathUtils=Kt,s.Matrix3=Qn,s.Matrix4=Bt,s.MaxEquation=Bu,s.Mesh=Ge,s.MeshBasicMaterial=Pr,s.MeshDepthMaterial=Kl,s.MeshDistanceMaterial=Zl,s.MeshFaceMaterial=function(n){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),n},s.MeshLambertMaterial=Bh,s.MeshMatcapMaterial=Uh,s.MeshNormalMaterial=Hh,s.MeshPhongMaterial=kh,s.MeshPhysicalMaterial=go,s.MeshStandardMaterial=Er,s.MeshToonMaterial=Fh,s.MinEquation=Hu,s.MirroredRepeatWrapping=ma,s.MixOperation=pf,s.MultiMaterial=function(n=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),n.isMultiMaterial=!0,n.materials=n,n.clone=function(){return n.slice()},n},s.MultiplyBlending=Fu,s.MultiplyOperation=ua,s.NearestFilter=Jn,s.NearestMipMapLinearFilter=1005,s.NearestMipMapNearestFilter=1004,s.NearestMipmapLinearFilter=Al,s.NearestMipmapNearestFilter=Sl,s.NeverDepth=sf,s.NeverStencilFunc=512,s.NoBlending=wr,s.NoColors=0,s.NoToneMapping=yo,s.NormalAnimationBlendMode=2500,s.NormalBlending=ss,s.NotEqualDepth=df,s.NotEqualStencilFunc=517,s.NumberKeyframeTrack=Oa,s.Object3D=y,s.ObjectLoader=ry,s.ObjectSpaceNormalMap=fm,s.OctahedronBufferGeometry=Da,s.OctahedronGeometry=Da,s.OneFactor=Jp,s.OneMinusDstAlphaFactor=tf,s.OneMinusDstColorFactor=rf,s.OneMinusSrcAlphaFactor=zu,s.OneMinusSrcColorFactor=Qp,s.OrthographicCamera=Ga,s.PCFShadowMap=Iu,s.PCFSoftShadowMap=Xp,s.PMREMGenerator=ky,s.ParametricBufferGeometry=is,s.ParametricGeometry=is,s.Particle=function(n){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new tc(n)},s.ParticleBasicMaterial=function(n){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Ro(n)},s.ParticleSystem=function(n,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new ts(n,e)},s.ParticleSystemMaterial=function(n){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Ro(n)},s.Path=Ua,s.PerspectiveCamera=O,s.Plane=Yi,s.PlaneBufferGeometry=Ta,s.PlaneGeometry=Ta,s.PlaneHelper=Py,s.PointCloud=function(n,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new ts(n,e)},s.PointCloudMaterial=function(n){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Ro(n)},s.PointLight=td,s.PointLightHelper=My,s.Points=ts,s.PointsMaterial=Ro,s.PolarGridHelper=Ay,s.PolyhedronBufferGeometry=$r,s.PolyhedronGeometry=$r,s.PositionalAudio=hy,s.PropertyBinding=fi,s.PropertyMixer=Lg,s.QuadraticBezierCurve=Tc,s.QuadraticBezierCurve3=Kh,s.Quaternion=ii,s.QuaternionKeyframeTrack=Ds,s.QuaternionLinearInterpolant=vl,s.REVISION="127",s.RGBADepthPacking=pm,s.RGBAFormat=Di,s.RGBAIntegerFormat=Of,s.RGBA_ASTC_10x10_Format=Yf,s.RGBA_ASTC_10x5_Format=jf,s.RGBA_ASTC_10x6_Format=Xf,s.RGBA_ASTC_10x8_Format=qf,s.RGBA_ASTC_12x10_Format=Kf,s.RGBA_ASTC_12x12_Format=Zf,s.RGBA_ASTC_4x4_Format=Ff,s.RGBA_ASTC_5x4_Format=Hf,s.RGBA_ASTC_5x5_Format=Bf,s.RGBA_ASTC_6x5_Format=Uf,s.RGBA_ASTC_6x6_Format=zf,s.RGBA_ASTC_8x5_Format=Gf,s.RGBA_ASTC_8x6_Format=Vf,s.RGBA_ASTC_8x8_Format=Wf,s.RGBA_BPTC_Format=Jf,s.RGBA_ETC2_EAC_Format=$u,s.RGBA_PVRTC_2BPPV1_Format=Zu,s.RGBA_PVRTC_4BPPV1_Format=Ku,s.RGBA_S3TC_DXT1_Format=Wu,s.RGBA_S3TC_DXT3_Format=ju,s.RGBA_S3TC_DXT5_Format=Xu,s.RGBDEncoding=th,s.RGBEEncoding=Cl,s.RGBEFormat=Cf,s.RGBFormat=Gr,s.RGBIntegerFormat=If,s.RGBM16Encoding=eh,s.RGBM7Encoding=Qu,s.RGB_ETC1_Format=kf,s.RGB_ETC2_Format=Ju,s.RGB_PVRTC_2BPPV1_Format=Yu,s.RGB_PVRTC_4BPPV1_Format=qu,s.RGB_S3TC_DXT1_Format=Vu,s.RGFormat=Df,s.RGIntegerFormat=Nf,s.RawShaderMaterial=Ps,s.Ray=qr,s.Raycaster=Pu,s.RectAreaLight=rd,s.RedFormat=Lf,s.RedIntegerFormat=Pf,s.ReinhardToneMapping=gf,s.RepeatWrapping=fa,s.ReplaceStencilOp=7681,s.ReverseSubtractEquation=Kp,s.RingBufferGeometry=gc,s.RingGeometry=gc,s.SRGB8_ALPHA8_ASTC_10x10_Format=cm,s.SRGB8_ALPHA8_ASTC_10x5_Format=sm,s.SRGB8_ALPHA8_ASTC_10x6_Format=am,s.SRGB8_ALPHA8_ASTC_10x8_Format=lm,s.SRGB8_ALPHA8_ASTC_12x10_Format=um,s.SRGB8_ALPHA8_ASTC_12x12_Format=hm,s.SRGB8_ALPHA8_ASTC_4x4_Format=$f,s.SRGB8_ALPHA8_ASTC_5x4_Format=Qf,s.SRGB8_ALPHA8_ASTC_5x5_Format=em,s.SRGB8_ALPHA8_ASTC_6x5_Format=tm,s.SRGB8_ALPHA8_ASTC_6x6_Format=nm,s.SRGB8_ALPHA8_ASTC_8x5_Format=im,s.SRGB8_ALPHA8_ASTC_8x6_Format=rm,s.SRGB8_ALPHA8_ASTC_8x8_Format=om,s.Scene=Jl,s.SceneUtils=Fy,s.ShaderChunk=pn,s.ShaderLib=Ji,s.ShaderMaterial=M,s.ShadowMaterial=Oh,s.Shape=Qr,s.ShapeBufferGeometry=Na,s.ShapeGeometry=Na,s.ShapePath=_g,s.ShapeUtils=Dr,s.ShortType=bf,s.Skeleton=ic,s.SkeletonHelper=Fg,s.SkinnedMesh=wi,s.SmoothShading=2,s.Sphere=jr,s.SphereBufferGeometry=Ia,s.SphereGeometry=Ia,s.Spherical=by,s.SphericalHarmonics3=od,s.SplineCurve=Sc,s.SpotLight=Qh,s.SpotLightHelper=wy,s.Sprite=tc,s.SpriteMaterial=$l,s.SrcAlphaFactor=Uu,s.SrcAlphaSaturateFactor=of,s.SrcColorFactor=$p,s.StaticCopyUsage=35046,s.StaticDrawUsage=ds,s.StaticReadUsage=35045,s.StereoCamera=ay,s.StreamCopyUsage=35042,s.StreamDrawUsage=35040,s.StreamReadUsage=35041,s.StringKeyframeTrack=Lo,s.SubtractEquation=Yp,s.SubtractiveBlending=ku,s.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},s.TangentSpaceNormalMap=_o,s.TetrahedronBufferGeometry=vc,s.TetrahedronGeometry=vc,s.TextBufferGeometry=yc,s.TextGeometry=yc,s.Texture=ei,s.TextureLoader=xl,s.TorusBufferGeometry=xc,s.TorusGeometry=xc,s.TorusKnotBufferGeometry=_c,s.TorusKnotGeometry=_c,s.Triangle=Gn,s.TriangleFanDrawMode=2,s.TriangleStripDrawMode=1,s.TrianglesDrawMode=0,s.TubeBufferGeometry=bc,s.TubeGeometry=bc,s.UVMapping=300,s.Uint16Attribute=function(n,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ce(n,e)},s.Uint16BufferAttribute=ce,s.Uint32Attribute=function(n,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ye(n,e)},s.Uint32BufferAttribute=Ye,s.Uint8Attribute=function(n,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new q(n,e)},s.Uint8BufferAttribute=q,s.Uint8ClampedAttribute=function(n,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new $(n,e)},s.Uint8ClampedBufferAttribute=$,s.Uniform=Rc,s.UniformsLib=Et,s.UniformsUtils=Cm,s.UnsignedByteType=cs,s.UnsignedInt248Type=us,s.UnsignedIntType=va,s.UnsignedShort4444Type=wf,s.UnsignedShort5551Type=Mf,s.UnsignedShort565Type=Tf,s.UnsignedShortType=ga,s.VSMShadowMap=rs,s.Vector2=Je,s.Vector3=U,s.Vector4=Mn,s.VectorKeyframeTrack=ka,s.Vertex=function(n,e,t){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new U(n,e,t)},s.VertexColors=2,s.VideoTexture=ng,s.WebGL1Renderer=Fm,s.WebGLCubeRenderTarget=ql,s.WebGLMultisampleRenderTarget=gm,s.WebGLRenderTarget=Tr,s.WebGLRenderTargetCube=function(n,e,t){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new ql(n,t)},s.WebGLRenderer=xn,s.WebGLUtils=ta,s.WireframeGeometry=Ih,s.WireframeHelper=function(n,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new vi(new Ih(n.geometry),new oi({color:e!==void 0?e:16777215}))},s.WrapAroundEnding=2402,s.XHRLoader=function(n){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Ui(n)},s.ZeroCurvatureEnding=2400,s.ZeroFactor=Zp,s.ZeroSlopeEnding=2401,s.ZeroStencilOp=0,s.sRGBEncoding=xa,Object.defineProperty(s,"__esModule",{value:!0})})},{}],12:[function(o,c,f){c.exports=AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(s){var d=this.el;this.active&&this.checkpoint!==s&&(this.checkpoint&&d.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=s,this.sync(),this.position.distanceTo(this.targetPosition)<.1?this.checkpoint=null:(d.emit("navigation-start",{checkpoint:s}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,d.emit("navigation-end",{checkpoint:s}),d.components["movement-controls"].updateNavLocation())))},isVelocityActive:function(){return!(!this.active||!this.checkpoint)},getVelocity:function(){if(this.active){var s=this.data,d=this.offset,m=this.position,_=this.targetPosition,y=this.checkpoint;return this.sync(),m.distanceTo(_)<.1?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:y}),d.set(0,0,0)):(d.setLength(s.animateSpeed),d)}},sync:function(){var s=this.offset,d=this.position,m=this.targetPosition;d.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(m),m.add(this.checkpoint.components.checkpoint.getOffset()),s.copy(m).sub(d)}})},{}],13:[function(o,c,f){var s=o("../../lib/GamepadButton"),d=o("../../lib/GamepadButtonEvent"),m={LEFT:"left",RIGHT:"right"},_={MOVEMENT:1,ROTATION:2};c.exports=AFRAME.registerComponent("gamepad-controls",{GamepadButton:s,schema:{enabled:{default:!0},rotationSensitivity:{default:2}},init:function(){var y=this.el.sceneEl;this.system=y.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};var x=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=x.x,this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=x.y,this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,y.addBehavior(this)},update:function(){this.tick()},tick:function(y,x){this.updateButtonState(),this.updateRotation(x)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var y=this._dpadVector,x=this._moveVector;this.getDpad(y),this.getJoystick(_.MOVEMENT,x);var R=y.x||x.x,C=y.y||x.y;return Math.abs(R)>.2||Math.abs(C)>.2},getVelocityDelta:function(){var y=this._dpadVector,x=this._moveVector;this.getDpad(y),this.getJoystick(_.MOVEMENT,x);var R=y.x||x.x,C=y.y||x.y,L=new THREE.Vector3;return Math.abs(R)>.2&&(L.x+=R),Math.abs(C)>.2&&(L.z+=C),L},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;var y=this._lookVector;return this.getJoystick(_.ROTATION,y),Math.abs(y.x)>.2||Math.abs(y.y)>.2},updateRotation:function(y){if(this.isRotationActive()){var x=this.data,R=this.yaw,C=this.pitch;R.rotation.y=this.el.object3D.rotation.y,C.rotation.x=this.el.object3D.rotation.x;var L=this._lookVector;this.getJoystick(_.ROTATION,L),Math.abs(L.x)<=.2&&(L.x=0),Math.abs(L.y)<=.2&&(L.y=0),L.multiplyScalar(x.rotationSensitivity*y/1e3),R.rotation.y-=L.x,C.rotation.x-=L.y,C.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,C.rotation.x)),this.el.object3D.rotation.set(C.rotation.x,R.rotation.y,0)}},updateButtonState:function(){var y=this.getGamepad(m.RIGHT);if(this.data.enabled&&y)for(var x=0;x<y.buttons.length;x++)y.buttons[x].pressed&&!this.buttons[x]?this.emit(new d("gamepadbuttondown",x,y.buttons[x])):!y.buttons[x].pressed&&this.buttons[x]&&this.emit(new d("gamepadbuttonup",x,y.buttons[x])),this.buttons[x]=y.buttons[x].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(y){this.el.emit(y.type,y),this.el.emit(y.type+":"+y.index,new d(y.type,y.index,y))},getGamepad:function(){var y=[],x=[];return function(R){var C=this.el.sceneEl.components["proxy-controls"],L=C&&C.isConnected()&&C.getGamepad(0);if(L)return L;y.length=0;for(var N=0;N<this.system.controllers.length;N++){var B=this.system.controllers[N],q=B?B.gamepad:null;if(y.push(q),q&&B.handedness===R)return q}for(var $=navigator.getGamepads?navigator.getGamepads():x,he=0;he<$.length;he++){var ce=$[he];if(ce&&ce.hand===R)return ce}return y[0]||$[0]}}(),getButton:function(y){return this.getGamepad(m.RIGHT).buttons[y]},getAxis:function(y){return this.getGamepad(y>1?m.RIGHT:m.LEFT).axes[y]},getJoystick:function(y,x){var R=this.getGamepad(y===_.MOVEMENT?m.LEFT:m.RIGHT);if(!R)return x.set(0,0);if(R.mapping==="xr-standard")switch(y){case _.MOVEMENT:return x.set(R.axes[2],R.axes[3]);case _.ROTATION:return x.set(R.axes[2],0)}else switch(y){case _.MOVEMENT:return x.set(R.axes[0],R.axes[1]);case _.ROTATION:return x.set(R.axes[2],R.axes[3])}throw new Error('Unexpected joystick index "%d".',y)},getDpad:function(y){var x=this.getGamepad(m.LEFT);return x&&x.buttons[s.DPAD_RIGHT]?y.set((x.buttons[s.DPAD_RIGHT].pressed?1:0)+(x.buttons[s.DPAD_LEFT].pressed?-1:0),(x.buttons[s.DPAD_UP].pressed?-1:0)+(x.buttons[s.DPAD_DOWN].pressed?1:0)):y.set(0,0)},isConnected:function(){var y=this.getGamepad(m.LEFT);return!(!y||!y.connected)},getID:function(){return this.getGamepad(m.LEFT).id}})},{"../../lib/GamepadButton":5,"../../lib/GamepadButtonEvent":6}],14:[function(o,c,f){o("./checkpoint-controls"),o("./gamepad-controls"),o("./keyboard-controls"),o("./touch-controls"),o("./movement-controls"),o("./trackpad-controls"),o("./nipple-controls")},{"./checkpoint-controls":12,"./gamepad-controls":13,"./keyboard-controls":15,"./movement-controls":16,"./nipple-controls":17,"./touch-controls":18,"./trackpad-controls":19}],15:[function(o,c,f){o("../../lib/keyboard.polyfill");var s=window.KeyboardEvent;c.exports=AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this),onContextMenu:this.onContextMenu.bind(this)}},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){var d=this.data,m=this.getKeys();return this.dVelocity.set(0,0,0),d.enabled&&((m.KeyW||m.ArrowUp)&&(this.dVelocity.z-=1),(m.KeyA||m.ArrowLeft)&&(this.dVelocity.x-=1),(m.KeyS||m.ArrowDown)&&(this.dVelocity.z+=1),(m.KeyD||m.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},attachEventListeners:function(){window.addEventListener("contextmenu",this.listeners.onContextMenu,!1),window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},onContextMenu:function(){for(var d in this.localKeys)this.localKeys.hasOwnProperty(d)&&delete this.localKeys[d]},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(d){AFRAME.utils.shouldCaptureKeyEvent(d)&&(this.localKeys[d.code]=!0,this.emit(d))},onKeyUp:function(d){AFRAME.utils.shouldCaptureKeyEvent(d)&&(delete this.localKeys[d.code],this.emit(d))},onBlur:function(){for(var d in this.localKeys)this.localKeys.hasOwnProperty(d)&&delete this.localKeys[d]},emit:function(d){"__keyboard-controls-proxy"in d&&this.el.emit(d.type,d),this.el.emit(d.type+":"+d.code,new s(d.type,d)),this.data.debug&&console.log(d.type+":"+d.code)},isPressed:function(d){return d in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){var d=this.el.sceneEl.components["proxy-controls"];return d&&d.isConnected()}})},{"../../lib/keyboard.polyfill":8}],16:[function(o,c,f){c.exports=AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){var s=this.el;this.data.camera||(this.data.camera=s.querySelector("[camera]")),this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.navGroup=null,this.navNode=null,s.sceneEl.hasLoaded?this.injectControls():s.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(s){var d=this.el,m=this.data,_=d.sceneEl.systems.nav;if(d.sceneEl.hasLoaded&&this.injectControls(),_&&m.constrainToNavMesh!==s.constrainToNavMesh&&(m.constrainToNavMesh?_.addAgent(this):_.removeAgent(this)),m.enabled!==s.enabled)for(var y=0;y<m.controls.length;y++){var x=m.controls[y]+"-controls";this.el.setAttribute(x,{enabled:this.data.enabled})}},injectControls:function(){for(var s=this.data,d=0;d<s.controls.length;d++){var m=s.controls[d]+"-controls";this.el.setAttribute(m,{enabled:this.data.enabled})}},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){var s=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3;return function(_,y){if(y){var x=this.el,R=this.data;if(R.enabled){this.updateVelocityCtrl();var C=this.velocityCtrl,L=this.velocity;if(C)if(y/1e3>.2?L.set(0,0,0):this.updateVelocity(y),R.constrainToNavMesh&&C.isNavMeshConstrained!==!1){if(L.lengthSq()<1e-5)return;s.copy(x.object3D.position),d.copy(L).multiplyScalar(y/1e3).add(s);var N=x.sceneEl.systems.nav;this.navGroup=this.navGroup===null?N.getGroup(s):this.navGroup,this.navNode=this.navNode||N.getNode(s,this.navGroup),this.navNode=N.clampStep(s,d,this.navGroup,this.navNode,m),x.object3D.position.copy(m)}else x.hasAttribute("velocity")?x.setAttribute("velocity",L):(x.object3D.position.x+=L.x*y/1e3,x.object3D.position.y+=L.y*y/1e3,x.object3D.position.z+=L.z*y/1e3)}}}}(),updateVelocityCtrl:function(){var s=this.data;if(s.enabled){for(var d=0,m=s.controls.length;d<m;d++){var _=this.el.components[s.controls[d]+"-controls"];if(_&&_.isVelocityActive())return void(this.velocityCtrl=_)}this.velocityCtrl=null}},updateVelocity:function(){var s=new THREE.Vector2,d=new THREE.Quaternion;return function(m){var _=void 0,y=this.el,x=this.velocityCtrl,R=this.velocity,C=this.data;if(x){if(!x.getVelocityDelta){if(x.getVelocity)return void R.copy(x.getVelocity());if(x.getPositionDelta)return void R.copy(x.getPositionDelta(m).multiplyScalar(1e3/m));throw new Error("Incompatible movement controls: ",x)}_=x.getVelocityDelta(m)}if(y.hasAttribute("velocity")&&!C.constrainToNavMesh&&R.copy(this.el.getAttribute("velocity")),_&&C.enabled){var L=C.camera;d.copy(L.object3D.quaternion),d.premultiply(y.object3D.quaternion),_.applyQuaternion(d);var N=_.length();C.fly?(R.copy(_),R.multiplyScalar(16.66667*this.data.speed)):(s.set(_.x,_.z),s.setLength(N*this.data.speed*16.66667),R.x=s.x,R.y=0,R.z=s.y)}}}()})},{}],17:[function(o,c,f){var s=function(d){return d&&d.__esModule?d:{default:d}}(o("nipplejs"));AFRAME.registerComponent("nipple-controls",{schema:{enabled:{default:!0},mode:{default:"dynamic",oneOf:["static","semi","dynamic"]},rotationSensitivity:{default:1},moveJoystickEnabled:{default:!0},lookJoystickEnabled:{default:!0},sideMargin:{default:"30px"},bottomMargin:{default:"70px"},moveJoystickPosition:{default:"left",oneOf:["left","right"]},lookJoystickPosition:{default:"right",oneOf:["left","right"]}},init:function(){this.dVelocity=new THREE.Vector3,this.lookVector=new THREE.Vector2;var d=this.el.querySelector("[look-controls]").components["look-controls"];this.pitchObject=d.pitchObject,this.yawObject=d.yawObject,this.rigRotation=this.el.object3D.rotation,this.moveData=void 0,this.lookData=void 0,this.moving=!1,this.rotating=!1},update:function(d){this.data.moveJoystickPosition===d.moveJoystickPosition&&this.data.sideMargin===d.sideMargin&&this.data.bottomMargin===d.bottomMargin&&this.data.mode===d.mode||this.removeMoveJoystick(),this.data.lookJoystickPosition===d.lookJoystickPosition&&this.data.sideMargin===d.sideMargin&&this.data.bottomMargin===d.bottomMargin&&this.data.mode===d.mode||this.removeLookJoystick(),this.data.enabled&&this.data.moveJoystickEnabled?this.createMoveJoystick():this.removeMoveJoystick(),this.data.enabled&&this.data.lookJoystickEnabled?this.createLookJoystick():this.removeLookJoystick()},pause:function(){this.moving=!1,this.rotating=!1},remove:function(){this.removeMoveJoystick(),this.removeLookJoystick()},isVelocityActive:function(){return this.data.enabled&&this.moving},getVelocityDelta:function(){if(this.dVelocity.set(0,0,0),this.isVelocityActive()){var d=this.moveData.force<1?this.moveData.force:1,m=this.moveData.angle.radian,_=Math.cos(m)*d,y=-Math.sin(m)*d;this.dVelocity.set(_,0,y)}return this.dVelocity},isRotationActive:function(){return this.data.enabled&&this.rotating},updateRotation:function(d){if(this.isRotationActive()){var m=this.lookData.force<1?this.lookData.force:1,_=this.lookData.angle.radian,y=this.lookVector;y.x=Math.cos(_)*m,y.y=Math.sin(_)*m,y.multiplyScalar(this.data.rotationSensitivity*d/1e3),this.yawObject.rotation.y-=y.x;var x=this.pitchObject.rotation.x+y.y;x=Math.max(-Math.PI/2,Math.min(Math.PI/2,x)),this.pitchObject.rotation.x=x}},tick:function(d,m){this.updateRotation(m)},initLeftZone:function(){var d=document.createElement("div");d.setAttribute("id","joystickLeftZone"),d.setAttribute("style","position:absolute;"+this.data.moveJoystickPosition+":"+this.data.sideMargin+";bottom:"+this.data.bottomMargin+";z-index:1"),document.body.appendChild(d),this.leftZone=d},initRightZone:function(){var d=document.createElement("div");d.setAttribute("id","joystickRightZone"),d.setAttribute("style","position:absolute;"+this.data.lookJoystickPosition+":"+this.data.sideMargin+";bottom:"+this.data.bottomMargin+";z-index:1"),document.body.appendChild(d),this.rightZone=d},createMoveJoystick:function(){var d=this;if(!this.moveJoystick){this.initLeftZone();var m={mode:this.data.mode,zone:this.leftZone,color:"white",fadeTime:0};this.leftZone.style.width="100px",this.data.mode==="static"?(this.leftZone.style.height="100px",m.position={left:"50%",bottom:"50%"}):this.leftZone.style.height="400px",this.moveJoystick=s.default.create(m),this.moveJoystick.on("move",function(_,y){d.moveData=y,d.moving=!0}),this.moveJoystick.on("end",function(_,y){d.moving=!1})}},createLookJoystick:function(){var d=this;if(!this.lookJoystick){this.initRightZone();var m={mode:this.data.mode,zone:this.rightZone,color:"white",fadeTime:0};this.rightZone.style.width="100px",this.data.mode==="static"?(this.rightZone.style.height="100px",m.position={left:"50%",bottom:"50%"}):this.rightZone.style.height="400px",this.lookJoystick=s.default.create(m),this.lookJoystick.on("move",function(_,y){d.lookData=y,d.rotating=!0}),this.lookJoystick.on("end",function(_,y){d.rotating=!1})}},removeMoveJoystick:function(){this.moveJoystick&&(this.moveJoystick.destroy(),this.moveJoystick=void 0),this.moveData=void 0,this.leftZone&&this.leftZone.parentNode&&(this.leftZone.remove(),this.leftZone=void 0)},removeLookJoystick:function(){this.lookJoystick&&(this.lookJoystick.destroy(),this.lookJoystick=void 0),this.lookData=void 0,this.rightZone&&this.rightZone.parentNode&&(this.rightZone.remove(),this.rightZone=void 0)}})},{nipplejs:9}],18:[function(o,c,f){c.exports=AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var s=this.el.sceneEl,d=s.canvas;if(d){d.addEventListener("touchstart",this.onTouchStart),d.addEventListener("touchend",this.onTouchEnd);var m=s.getAttribute("vr-mode-ui");m&&m.cardboardModeEnabled&&s.addEventListener("enter-vr",this.onEnterVR)}else s.addEventListener("render-target-loaded",this.addEventListeners.bind(this))},removeEventListeners:function(){var s=this.el.sceneEl&&this.el.sceneEl.canvas;s&&(s.removeEventListener("touchstart",this.onTouchStart),s.removeEventListener("touchend",this.onTouchEnd),this.el.sceneEl.removeEventListener("enter-vr",this.onEnterVR))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onEnterVR=this.onEnterVR.bind(this)},onTouchStart:function(s){this.direction=-1,this.data.reverseEnabled&&s.touches&&s.touches.length===2&&(this.direction=1),s.preventDefault()},onTouchEnd:function(s){this.direction=0,s.preventDefault()},onEnterVR:function(){var s=this.el.sceneEl.xrSession;s&&(s.addEventListener("selectstart",this.onTouchStart),s.addEventListener("selectend",this.onTouchEnd))}})},{}],19:[function(o,c,f){c.exports=AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){var s=this.data,d=this.el.sceneEl;switch(d.addEventListener("axismove",this.onAxisMove),s.mode){case"swipe":case"touch":d.addEventListener("trackpadtouchstart",this.onTouchStart),d.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":d.addEventListener("trackpaddown",this.onTouchStart),d.addEventListener("trackpadup",this.onTouchEnd)}},removeEventListeners:function(){var s=this.el.sceneEl;s.removeEventListener("axismove",this.onAxisMove),s.removeEventListener("trackpadtouchstart",this.onTouchStart),s.removeEventListener("trackpadtouchend",this.onTouchEnd),s.removeEventListener("trackpaddown",this.onTouchStart),s.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(s){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":case"press":this.isMoving=!0}s.preventDefault()},onTouchEnd:function(s){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,s.preventDefault()},onAxisMove:function(s){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(s);case"touch":case"press":return this.handleTouchAxis(s)}},handleSwipeAxis:function(s){var d=this.data,m=s.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=m[0],this.startingAxisData[1]=m[1]),this.startingAxisData.length>0){var _=0,y=0;d.enableNegX&&m[0]<this.startingAxisData[0]&&(_=-1),d.enablePosX&&m[0]>this.startingAxisData[0]&&(_=1),d.enablePosZ&&m[1]>this.startingAxisData[1]&&(y=-1),d.enableNegZ&&m[1]<this.startingAxisData[1]&&(y=1);var x=Math.abs(this.startingAxisData[1]-m[1]);Math.abs(this.startingAxisData[0]-m[0])>x?(this.zVel=0,this.xVel=_,this.isMoving=!0):(this.xVel=0,this.zVel=y,this.isMoving=!0)}},handleTouchAxis:function(s){var d=this.data,m=s.detail.axis,_=0,y=0;d.enableNegX&&m[0]<0&&(_=-1),d.enablePosX&&m[0]>0&&(_=1),d.enablePosZ&&m[1]>0&&(y=-1),d.enableNegZ&&m[1]<0&&(y=1),Math.abs(m[0])>Math.abs(m[1])?(this.zVel=0,this.xVel=_):(this.xVel=0,this.zVel=y)}})},{}],20:[function(o,c,f){function s(m){return m.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}var d={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};c.exports=AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(d)},repetitions:{default:1/0,min:0},timeScale:{default:1},startAt:{default:0}},init:function(){var m=this;this.model=null,this.mixer=null,this.activeActions=[];var _=this.el.getObject3D("mesh");_?this.load(_):this.el.addEventListener("model-loaded",function(y){m.load(y.detail.model)})},load:function(m){var _=this.el;this.model=m,this.mixer=new THREE.AnimationMixer(m),this.mixer.addEventListener("loop",function(y){_.emit("animation-loop",{action:y.action,loopDelta:y.loopDelta})}),this.mixer.addEventListener("finished",function(y){_.emit("animation-finished",{action:y.action,direction:y.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(m){if(m){var _=this.data,y=AFRAME.utils.diff(_,m);if("clip"in y)return this.stopAction(),void(_.clip&&this.playAction());this.activeActions.forEach(function(x){"duration"in y&&_.duration&&x.setDuration(_.duration),"clampWhenFinished"in y&&(x.clampWhenFinished=_.clampWhenFinished),("loop"in y||"repetitions"in y)&&x.setLoop(d[_.loop],_.repetitions),"timeScale"in y&&x.setEffectiveTimeScale(_.timeScale)})}},stopAction:function(){for(var m=this.data,_=0;_<this.activeActions.length;_++)m.crossFadeDuration?this.activeActions[_].fadeOut(m.crossFadeDuration):this.activeActions[_].stop();this.activeActions.length=0},playAction:function(){if(this.mixer){var m=this.model,_=this.data,y=m.animations||(m.geometry||{}).animations||[];if(y.length){for(var x,R=function(N){return new RegExp("^"+N.split(/\*+/).map(s).join(".*")+"$")}(_.clip),C=0;x=y[C];C++)if(x.name.match(R)){var L=this.mixer.clipAction(x,m);L.enabled=!0,L.clampWhenFinished=_.clampWhenFinished,_.duration&&L.setDuration(_.duration),_.timeScale!==1&&L.setEffectiveTimeScale(_.timeScale),L.startAt(this.mixer.time-_.startAt/1e3),L.setLoop(d[_.loop],_.repetitions).fadeIn(_.crossFadeDuration).play(),this.activeActions.push(L)}}}},tick:function(m,_){this.mixer&&!isNaN(_)&&this.mixer.update(_/1e3)}})},{}],21:[function(o,c,f){THREE.ColladaLoader=o("../../lib/ColladaLoader"),c.exports.Component=AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var s=this,d=this.el,m=this.data,_=this.el.sceneEl.systems.renderer;m&&(this.remove(),this.loader.load(m,function(y){s.model=y.scene,s.model.traverse(function(x){if(x.isMesh){var R=x.material;R.color&&_.applyColorCorrection(R.color),R.map&&_.applyColorCorrection(R.map),R.emissive&&_.applyColorCorrection(R.emissive),R.emissiveMap&&_.applyColorCorrection(R.emissiveMap)}}),d.setObject3D("mesh",s.model),d.emit("model-loaded",{format:"collada",model:s.model})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../../lib/ColladaLoader":3}],22:[function(o,c,f){THREE.FBXLoader=o("../../lib/FBXLoader"),c.exports=AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){var s=this.data;if(s.src){this.remove();var d=new THREE.FBXLoader;s.crossorigin&&d.setCrossOrigin(s.crossorigin),d.load(s.src,this.load.bind(this))}},load:function(s){this.model=s,this.el.setObject3D("mesh",s),this.el.emit("model-loaded",{format:"fbx",model:s})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../../lib/FBXLoader":4}],23:[function(o,c,f){var s=o("../../lib/fetch-script")(),d=function(){var m=void 0;return function(){return m=m||s("https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js")}}();c.exports=AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){var m=this;this.model=null,this.loader=null,this.loaderPromise=d().then(function(){m.loader=new THREE.GLTFLoader,m.loader.setCrossOrigin("Anonymous")})},update:function(){var m=this,_=this,y=this.el,x=this.data;x&&(this.remove(),this.loaderPromise.then(function(){m.loader.load(x,function(R){_.model=R.scene,_.model.animations=R.animations,y.setObject3D("mesh",_.model),y.emit("model-loaded",{format:"gltf",model:_.model})})}))},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{"../../lib/fetch-script":7}],24:[function(o,c,f){o("./animation-mixer"),o("./collada-model-legacy"),o("./fbx-model"),o("./gltf-model-legacy"),o("./object-model")},{"./animation-mixer":20,"./collada-model-legacy":21,"./fbx-model":22,"./gltf-model-legacy":23,"./object-model":25}],25:[function(o,c,f){c.exports=AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){var s=this,d=void 0,m=this.data;m.src&&(this.remove(),d=new THREE.ObjectLoader,m.crossorigin&&d.setCrossOrigin(m.crossorigin),d.load(m.src,function(_){_.traverse(function(y){y instanceof THREE.SkinnedMesh&&y.material&&(y.material.skinning=!!(y.geometry&&y.geometry.bones||[]).length)}),s.load(_)}))},load:function(s){this.model=s,this.el.setObject3D("mesh",s),this.el.emit("model-loaded",{format:"json",model:s})},remove:function(){this.model&&this.el.removeObject3D("mesh")}})},{}],26:[function(o,c,f){c.exports=AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){var s=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!s)throw new Error("No `checkpoint-controls` component found.");s.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}})},{}],27:[function(o,c,f){function s(d,m,_,y){d&&(m=m||[],d.traverse(function(x){x.isMesh&&function(R){return R?Array.isArray(R)?R:R.materials?R.materials:[R]:[]}(x.material).forEach(function(R){(!R||"envMap"in R)&&(m.length&&m.indexOf(R.name)===-1||(R.envMap=_,R.reflectivity=y,R.needsUpdate=!0))})}))}c.exports=AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){var d=this,m=this.data;this.texture=new THREE.CubeTextureLoader().load([m.path+"posx."+m.extension,m.path+"negx."+m.extension,m.path+"posy."+m.extension,m.path+"negy."+m.extension,m.path+"posz."+m.extension,m.path+"negz."+m.extension]),this.texture.format=THREE.RGBAFormat,this.object3dsetHandler=function(){var _=d.el.getObject3D("mesh"),y=d.data;s(_,y.materials,d.texture,y.reflectivity)},this.object3dsetHandler(),this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(d){var m=this.data,_=this.el.getObject3D("mesh"),y=[],x=[];if(m.materials.length&&(d.materials?(y=m.materials.filter(function(C){return!d.materials.includes(C)}),x=d.materials.filter(function(C){return!m.materials.includes(C)})):y=m.materials),y.length&&s(_,y,this.texture,m.reflectivity),x.length&&s(_,x,null,1),d.materials&&m.reflectivity!==d.reflectivity){var R=m.materials.filter(function(C){return d.materials.includes(C)});R.length&&s(_,R,this.texture,m.reflectivity)}this.data.enableBackground&&!d.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&d.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);var d=this.el.getObject3D("mesh"),m=this.data;s(d,m.materials,null,1),m.enableBackground&&this.setBackground(null)},setBackground:function(d){this.el.sceneEl.object3D.background=d}})},{}],28:[function(o,c,f){c.exports=AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){var s=this.el;s.addEventListener("hit",this.onHit),s.addEventListener("gripdown",this.onGripClose),s.addEventListener("gripup",this.onGripOpen),s.addEventListener("trackpaddown",this.onGripClose),s.addEventListener("trackpadup",this.onGripOpen),s.addEventListener("triggerdown",this.onGripClose),s.addEventListener("triggerup",this.onGripOpen)},pause:function(){var s=this.el;s.removeEventListener("hit",this.onHit),s.removeEventListener("gripdown",this.onGripClose),s.removeEventListener("gripup",this.onGripOpen),s.removeEventListener("trackpaddown",this.onGripClose),s.removeEventListener("trackpadup",this.onGripOpen),s.removeEventListener("triggerdown",this.onGripClose),s.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){var s=this.hitEl;this.grabbing=!1,s&&(s.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(s){var d=s.detail.el;d.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(d.addState(this.GRABBED_STATE),this.hitEl=d,this.constraint=new CANNON.LockConstraint(this.el.body,d.body),this.system.addConstraint(this.constraint))}})},{}],29:[function(o,c,f){o("./checkpoint"),o("./cube-env-map"),o("./grab"),o("./normal-material"),o("./sphere-collider")},{"./checkpoint":26,"./cube-env-map":27,"./grab":28,"./normal-material":30,"./sphere-collider":31}],30:[function(o,c,f){c.exports=AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial),this.applyMaterial()},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){var s=this;this.el.object3D.traverse(function(d){d.isMesh&&(d.material=s.material)})}})},{}],31:[function(o,c,f){c.exports=AFRAME.registerComponent("sphere-collider",{schema:{enabled:{default:!0},interval:{default:80},objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.prevCheckTime=void 0,this.eventDetail={},this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},play:function(){var s=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(s,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){var s=this.data,d=void 0;d=s.objects?this.el.sceneEl.querySelectorAll(s.objects):this.el.sceneEl.children,this.els=Array.prototype.slice.call(d)},tick:function(){var s=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3,_=new THREE.Vector3,y=new THREE.Box3,x=[],R=new Map;return function(C){if(this.data.enabled){var L=this.prevCheckTime;if(!(L&&C-L<this.data.interval)){this.prevCheckTime=C;var N=this.el,B=this.data,q=void 0;N.getObject3D("mesh")&&(x.length=0,R.clear(),N.object3D.getWorldPosition(s),N.object3D.getWorldScale(m),q=B.radius*function($){return Math.max($.x,$.y,$.z)}(m),this.els.forEach(function($){var he=void 0,ce=void 0,Ee=void 0,Ye=void 0;$.isEntity&&(ce=$.getObject3D("mesh"))&&(y.setFromObject(ce).getSize(_),Ye=Math.max(_.x,_.y,_.z)/2,he=Math.sqrt(2*Ye*Ye),y.getCenter(d),he&&(Ee=s.distanceTo(d))<he+q&&(x.push($),R.set($,Ee)))}),x.sort(function($,he){return R.get($)>R.get(he)?1:-1}).forEach(this.handleHit),this.collisions.filter(function($){return!R.has($)}).forEach(this.handleHitEnd),function($,he){$.length=0;for(var ce=0;ce<he.length;ce++)$[ce]=he[ce]}(this.collisions,x))}}}}(),handleHit:function(s){s.emit("hit"),s.addState(this.data.state),this.eventDetail.el=s,this.el.emit("hit",this.eventDetail)},handleHitEnd:function(s){s.emit("hitend"),s.removeState(this.data.state),this.eventDetail.el=s,this.el.emit("hitend",this.eventDetail)}})},{}],32:[function(o,c,f){o("./nav-mesh"),o("./nav-agent"),o("./system")},{"./nav-agent":33,"./nav-mesh":34,"./system":35}],33:[function(o,c,f){c.exports=AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){var s=new THREE.Vector3,d=new THREE.Vector3,m=new THREE.Vector3;return function(_,y){var x=this.el,R=this.data,C=this.raycaster,L=R.speed*y/1e3;if(R.active){if(!this.path.length){var N=this.el.object3D.position;this.group=this.group||this.system.getGroup(N),this.path=this.system.getPath(N,s.copy(R.destination),this.group)||[],x.emit("navigation-start")}if(!this.path.length)return console.warn("[nav] Unable to find path to %o.",R.destination),this.el.setAttribute("nav-agent",{active:!1}),void x.emit("navigation-end");var B=x.object3D.position,q=this.path[0];d.subVectors(q,B);var $=void 0;if(d.length()<L){if(this.path.shift(),!this.path.length)return this.el.setAttribute("nav-agent",{active:!1}),void x.emit("navigation-end");m.copy(B),$=this.path[0]}else m.copy(d.setLength(L)).add(B),$=q;$.y=B.y,x.object3D.lookAt($),C.ray.origin.copy(m),C.ray.origin.y+=1.5,C.ray.direction={x:0,y:-1,z:0};var he=C.intersectObject(this.system.getNavMesh());he.length?(d.subVectors(he[0].point,B),B.add(d.setLength(L))):B.copy(m)}}}()})},{}],34:[function(o,c,f){c.exports=AFRAME.registerComponent("nav-mesh",{schema:{nodeName:{type:"string"}},init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.nodeName=this.data.nodeName,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){var s=this,d=this.el.getObject3D("mesh");if(this.el.sceneEl.object3D,d){var m=void 0;if(d.traverse(function(y){!y.isMesh||s.nodeName&&y.name!==s.nodeName||(m=y)}),m){var _=m.geometry.clone();m.updateWorldMatrix(!0,!1),_.applyMatrix4(m.matrixWorld),this.system.setNavMeshGeometry(_),this.hasLoadedNavMesh=!0}}}})},{}],35:[function(o,c,f){var s=o("three-pathfinding").Pathfinding,d=new s,m="level";c.exports=AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(_){this.navMesh=new THREE.Mesh(_),d.setZoneData(m,s.createZone(_)),Array.from(this.agents).forEach(function(y){return y.updateNavLocation()})},getNavMesh:function(){return this.navMesh},addAgent:function(_){this.agents.add(_)},removeAgent:function(_){this.agents.delete(_)},getPath:function(_,y,x){return this.navMesh?d.findPath(_,y,m,x):null},getGroup:function(_){return this.navMesh?d.getGroup(m,_):null},getNode:function(_,y){return this.navMesh?d.getClosestNode(_,m,y,!0):null},clampStep:function(_,y,x,R,C){return this.navMesh?R?d.clampStep(_,y,R,m,x,C):(C.copy(y),this.getNode(y,x)):(C.copy(y),null)}})},{"three-pathfinding":10}],36:[function(o,c,f){c.exports=AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}})},{}],37:[function(o,c,f){c.exports.Primitive=AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}}),c.exports.Component=AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){var s=this.el,d=this.data,m=s.components.material,_=new THREE.PlaneGeometry(d.width,d.depth,d.density,d.density);this.waves=[];for(var y=_.getAttribute("position"),x=0;x<y.count;x++)this.waves.push({z:y.getZ(x),ang:Math.random()*Math.PI*2,amp:d.amplitude+Math.random()*d.amplitudeVariance,speed:(d.speed+Math.random()*d.speedVariance)/1e3});m||((m={}).material=new THREE.MeshPhongMaterial({color:d.color,transparent:d.opacity<1,opacity:d.opacity,flatShading:!0})),this.mesh=new THREE.Mesh(_,m.material),s.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(s,d){if(d){for(var m=this.mesh.geometry.getAttribute("position"),_=0;_<m.count;_++){var y=this.waves[_],x=y.z+Math.sin(y.ang)*y.amp;m.setZ(_,x),y.ang+=y.speed*d}m.needsUpdate=!0}}})},{}],38:[function(o,c,f){c.exports.Primitive=AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}}),c.exports.Component=AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){var s=this.el,d=this.data,m=s.components.material;if(d.path.length){var _=new THREE.CatmullRomCurve3(d.path.map(function(x){return x=x.split(" "),new THREE.Vector3(Number(x[0]),Number(x[1]),Number(x[2]))})),y=new THREE.TubeGeometry(_,d.segments,d.radius,d.radialSegments,d.closed);m||((m={}).material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(y,m.material),this.el.setObject3D("mesh",this.mesh)}else console.error("[a-tube] `path` property expected but not found.")},update:function(s){Object.keys(s).length&&(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}})},{}],39:[function(o,c,f){o("./a-grid"),o("./a-ocean"),o("./a-tube")},{"./a-grid":36,"./a-ocean":37,"./a-tube":38}]},{},[1]);(function(o){function c(s){if(f[s])return f[s].exports;var d=f[s]={exports:{},id:s,loaded:!1};return o[s].call(d.exports,d,d.exports,c),d.loaded=!0,d.exports}var f={};return c.m=o,c.c=f,c.p="",c(0)})([function(o,c){if(typeof AFRAME>"u")throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("environment",{schema:{active:{default:!1},preset:{default:"default",oneOf:["none","default","contact","egypt","checkerboard","forest","goaland","yavapai","goldmine","arches","threetowers","poison","tron","japan","dream","volcano","starry","osiris"]},seed:{type:"int",default:1,min:0,max:1e3},skyType:{default:"color",oneOf:["none","color","gradient","atmosphere"]},skyColor:{type:"color"},horizonColor:{type:"color"},lighting:{default:"distant",oneOf:["none","distant","point"]},shadow:{default:!1},shadowSize:{default:10},lightPosition:{type:"vec3",default:{x:0,y:1,z:-.2}},fog:{type:"float",default:0,min:0,max:1},flatShading:{default:!1},playArea:{type:"float",default:1,min:.5,max:10},ground:{default:"hills",oneOf:["none","flat","hills","canyon","spikes","noise"]},groundYScale:{type:"float",default:3,min:0,max:50},groundTexture:{default:"none",oneOf:["none","checkerboard","squares","walkernoise"]},groundColor:{type:"color",default:"#553e35"},groundColor2:{type:"color",default:"#694439"},dressing:{default:"none",oneOf:["none","cubes","pyramids","cylinders","hexagons","stones","trees","mushrooms","towers","apparatus","arches","torii"]},dressingAmount:{type:"int",default:10,min:0,max:1e3},dressingColor:{type:"color",default:"#795449"},dressingScale:{type:"float",default:5,min:0,max:100},dressingVariance:{type:"vec3",default:{x:1,y:1,z:1}},dressingUniformScale:{default:!0},dressingOnPlayArea:{type:"float",default:0,min:0,max:1},grid:{default:"none",oneOf:["none","1x1","2x2","crosses","dots","xlines","ylines"]},gridColor:{type:"color",default:"#ccc"}},multiple:!1,presets:{none:{},default:{active:!0,seed:1,skyType:"atmosphere",skyColor:"#88c",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:-.11,y:1,z:.33},fog:.78,flatShading:!1,playArea:1,ground:"hills",groundYScale:3,groundTexture:"checkerboard",groundColor:"#454545",groundColor2:"#5d5d5d",dressing:"none",dressingAmount:10,dressingColor:"#795449",dressingScale:1,dressingVariance:{x:0,y:0,z:0},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"none",gridColor:"#ccc",shadow:!1},contact:{active:!0,seed:14,skyType:"gradient",skyColor:"#478d54",horizonColor:"#b696cb",lighting:"distant",lightPosition:{x:0,y:2.01,z:-1},fog:.8,flatShading:!1,playArea:1,ground:"spikes",groundYScale:4.91,groundTexture:"none",groundColor:"#2e455f",groundColor2:"#694439",dressing:"apparatus",dressingAmount:7,dressingColor:"#657067",dressingScale:20,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"1x1",gridColor:"#478d54",shadow:!1},egypt:{active:!0,seed:26,skyType:"gradient",skyColor:"#1b7660",horizonColor:"#e4b676",lighting:"distant",lightPosition:{x:0,y:1.65,z:-1},fog:.75,flatShading:!1,playArea:1,ground:"hills",groundYScale:5,groundTexture:"walkernoise",groundColor:"#664735",groundColor2:"#6c4b39",dressing:"pyramids",dressingAmount:10,dressingColor:"#7c5c45",dressingScale:5,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"spots",gridColor:"#e4b676",shadow:!1},checkerboard:{active:!0,seed:1,skyType:"gradient",skyColor:"#0d0d0d",horizonColor:"#404040",lighting:"distant",lightPosition:{x:0,y:1,z:-.2},fog:.81,flatShading:!0,playArea:1,ground:"hills",groundYScale:4.81,groundTexture:"checkerboard",groundColor:"#252525",groundColor2:"#111111",dressing:"cubes",dressingAmount:10,dressingColor:"#9f9f9f",dressingScale:1.51,dressingVariance:{x:5,y:20,z:5},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"dots",gridColor:"#ccc",shadow:!1},forest:{active:!0,seed:8,skyType:"gradient",skyColor:"#24b59f",horizonColor:"#eff9b7",lighting:"distant",lightPosition:{x:-1.2,y:.88,z:-.55},fog:.8,flatShading:!1,playArea:1,ground:"noise",groundYScale:4.18,groundTexture:"squares",groundColor:"#937a24",groundColor2:"#987d2e",dressing:"trees",dressingAmount:500,dressingColor:"#888b1d",dressingScale:1,dressingVariance:{x:10,y:10,z:10},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"none",gridColor:"#c5a543",shadow:!1},goaland:{active:!0,seed:17,skyType:"gradient",skyColor:"#14645f",horizonColor:"#a3dab8",lighting:"point",lightPosition:{x:.1,y:4,z:.56},fog:.73,flatShading:!1,playArea:1,ground:"noise",groundYScale:.81,groundTexture:"none",groundColor:"#ae3241",groundColor2:"#db4453",dressing:"mushrooms",dressingAmount:150,dressingColor:"#a9313d",dressingScale:5,dressingVariance:{x:5,y:10,z:5},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"dots",gridColor:"#239893",shadow:!1},yavapai:{active:!0,seed:11,skyType:"gradient",skyColor:"#239849",horizonColor:"#cfe0af",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!0,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"walkernoise",groundColor:"#C66344",groundColor2:"#c96b4b",dressing:"stones",dressingAmount:500,dressingColor:"#C66344",dressingScale:.06,dressingVariance:{x:.2,y:.1,z:.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:"none",gridColor:"#239893",shadow:!1},goldmine:{active:!0,seed:53,skyType:"gradient",skyColor:"#1e1c1a",horizonColor:"#8c7964",lighting:"point",lightPosition:{x:-.09,y:3,z:.33},fog:.43,flatShading:!0,playArea:1.08,ground:"canyon",groundYScale:50,groundTexture:"none",groundColor:"#353535",groundColor2:"#454545",dressing:"hexagons",dressingAmount:300,dressingColor:"#fe921b",dressingScale:.5,dressingVariance:{x:2,y:8,z:2},dressingUniformScale:!0,dressingOnPlayArea:.03,grid:"none",gridColor:"#ccc",shadow:!1},threetowers:{active:!0,seed:5,skyType:"gradient",skyColor:"#23a06b",horizonColor:"#f5e170",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!1,playArea:1,ground:"spikes",groundYScale:4.26,groundTexture:"walkernoise",groundColor:"#273a49",groundColor2:"#2b464f",dressing:"towers",dressingAmount:3,dressingColor:"#5f6d94",dressingScale:50,dressingVariance:{x:10,y:100,z:10},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"none",gridColor:"#239893",shadow:!1},poison:{active:!0,seed:92,skyType:"gradient",skyColor:"#1ea84a",horizonColor:"#177132",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!1,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"none",groundColor:"#851f31",groundColor2:"#912235",dressing:"hexagons",dressingAmount:20,dressingColor:"#c7415b",dressingScale:20,dressingVariance:{x:20,y:200,z:20},dressingUniformScale:!1,dressingOnPlayArea:0,grid:"crosses",gridColor:"#1ea84a",shadow:!1},arches:{active:!0,seed:19,skyType:"atmosphere",skyColor:"#8cbdc8",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:-.11,y:.16,z:.33},fog:.67,flatShading:!0,playArea:1,ground:"canyon",groundYScale:10,groundTexture:"walkernoise",groundColor:"#a87d6f",groundColor2:"#795449",dressing:"arches",dressingAmount:6,dressingColor:"#795449",dressingScale:26,dressingVariance:{x:20,y:40,z:20},dressingUniformScale:!0,dressingOnPlayArea:.04,grid:"none",gridColor:"#ccc",shadow:!1},tron:{active:!0,seed:14,skyType:"gradient",skyColor:"#091b39",horizonColor:"#284a9e",lighting:"distant",lightPosition:{x:-.72,y:.62,z:.4},fog:.8,flatShading:!1,playArea:1,ground:"spikes",groundYScale:4.91,groundTexture:"none",groundColor:"#061123",groundColor2:"#694439",dressing:"towers",dressingAmount:5,dressingColor:"#fb000e",dressingScale:15,dressingVariance:{x:20,y:20,z:20},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"1x1",gridColor:"#fb000e",shadow:!1},japan:{active:!0,seed:14,skyType:"gradient",skyColor:"#7e5db5",horizonColor:"#b4adda",lighting:"distant",lightPosition:{x:1.33,y:1,z:.24},fog:.9,flatShading:!1,playArea:1,ground:"hills",groundYScale:25,groundTexture:"walkernoise",groundColor:"#7e5db5",groundColor2:"#cabdf5",dressing:"torii",dressingAmount:4,dressingColor:"#bc5e7c",dressingScale:15,dressingVariance:{x:0,y:0,z:0},dressingUniformScale:!0,dressingOnPlayArea:0,grid:"spots",gridColor:"#e4b676",shadow:!1},dream:{active:!0,seed:17,skyType:"gradient",skyColor:"#87faf4",horizonColor:"#b34093",lighting:"distant",lightPosition:{x:-.72,y:.53,z:.97},fog:.8,flatShading:!1,playArea:1,ground:"hills",groundYScale:20,groundTexture:"checkerboard",groundColor:"#b34093",groundColor2:"#c050a2",dressing:"mushrooms",dressingAmount:300,dressingColor:"#3cf7ed",dressingScale:.2,dressingVariance:{x:.2,y:.2,z:.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:"none",gridColor:"#239893",shadow:!1},volcano:{active:!0,seed:92,skyType:"gradient",skyColor:"#4a070f",horizonColor:"#f62300",lighting:"point",lightPosition:{x:.5,y:2.25,z:0},fog:.87,flatShading:!1,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"walkernoise",groundColor:"#fb0803",groundColor2:"#510000",dressing:"arches",dressingAmount:15,dressingColor:"#fb0803",dressingScale:3,dressingVariance:{x:10,y:100,z:10},dressingUniformScale:!1,dressingOnPlayArea:.2,grid:"none",gridColor:"#fa0e00",shadow:!1},starry:{active:!0,seed:1,skyType:"atmosphere",skyColor:"#88c",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:0,y:-.01,z:-.46},fog:.7,flatShading:!1,playArea:1,ground:"hills",groundYScale:3,groundTexture:"none",groundColor:"#553e35",groundColor2:"#694439",dressing:"none",dressingAmount:100,dressingColor:"#795449",dressingScale:5,dressingVariance:{x:1,y:1,z:1},dressingUniformScale:!0,grid:"1x1",dressingOnPlayArea:0,gridColor:"#39d2f2",shadow:!1},osiris:{active:!0,seed:46,skyType:"atmosphere",skyColor:"#88c",horizonColor:"#ddd",lighting:"distant",lightPosition:{x:0,y:.02,z:-.46},fog:0,flatShading:!1,playArea:1,ground:"hills",groundYScale:3,groundTexture:"none",groundColor:"#9e7b47",groundColor2:"#9e7b47",dressing:"pyramids",dressingAmount:7,dressingColor:"#9e7b47",dressingScale:5,dressingVariance:{x:30,y:30,z:30},dressingUniformScale:!0,grid:"dots",dressingOnPlayArea:0,gridColor:"#daa452",shadow:!1},moon:{active:!0,seed:11,skyType:"gradient",skyColor:"#000000",horizonColor:"#000000",lighting:"distant",lightPosition:{x:.5,y:1,z:0},fog:.8,flatShading:!0,playArea:1,ground:"canyon",groundYScale:9.76,groundTexture:"walkernoise",groundColor:"#D1D1D1",groundColor2:"#494949",dressing:"stones",dressingAmount:500,dressingColor:"#494949",dressingScale:.06,dressingVariance:{x:.2,y:.1,z:.2},dressingUniformScale:!0,dressingOnPlayArea:1,grid:"none",gridColor:"#239893",shadow:!1}},init:function(){this.environmentData={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.STAGE_SIZE=200,this.assets={arches:[{type:"mesh",vertices:[409,268,4,351,228,36,336,236,-57,-152,391,69,-135,358,88,-119,330,43,-20,358,-35,-153,357,-47,37,413,-26,-20,411,-14,-302,148,154,-339,121,-126,-389,200,-88,-477,193,-76,-314,346,-19,-314,306,-30,-250,296,-73,-267,237,-82,-212,303,-68,-245,200,-67,-223,304,108,-329,299,107,-289,350,76,-320,342,69,119,373,-39,38,370,8,113,367,52,492,202,-31,462,83,-104,447,71,-80,426,112,25,482,189,-7,222,372,6,121,402,41,87,382,67,221,346,55,559,93,-13,528,47,39,505,21,-111,528,54,-101,616,31,-53,442,256,-15,300,338,19,257,308,-79,408,256,-74,312,352,-26,384,297,-31,437,257,-47,-29,415,53,-232,377,59,-139,335,77,-132,344,2,-18,377,-37,-171,387,-28,-254,384,18,-651,-27,27,-435,-28,179,-345,149,165,-272,-28,23,-215,146,-2,-279,-29,-59,-211,145,-55,-337,-28,-128,-413,247,0,-293,363,24,-214,254,-36,-164,290,33,-284,150,94,-218,362,105,75,369,29,518,147,-63,447,190,-70,445,56,-105,391,185,-60,431,49,-33,459,83,26,470,162,42,130,390,53,167,341,-30,125,394,-45,239,368,-17,91,414,10,450,18,2,449,-27,-9,436,-28,-58,496,-27,-110,582,-28,-140,647,-27,-56,325,325,-45,-307,297,-56,-647,-28,-45,-188,310,-54,-264,197,113,-367,175,139,8,387,82,426,45,-55,114,359,-28,500,27,44,461,-29,13,-512,-27,-151,-152,376,-38,-490,-28,148,12,370,-28,442,160,42,465,194,32,381,183,-33,649,-27,-34,444,16,29,616,-28,25,417,267,-66,-132,352,-34,-322,-27,130,-271,86,-115,-635,-28,-121,-291,203,-99,176,405,-10,561,52,-93,371,305,9,311,237,-22,377,200,-81,-129,406,46,-154,371,99,-82,361,71,-21,354,26,-91,363,-27,-165,413,-12,-414,215,110,-238,127,26,-408,-28,-128,-674,-28,-94,-446,232,-39,-311,226,-90,-255,210,-61,-235,192,-11,-217,218,58,-269,299,124,-386,276,78,-399,281,42,15,373,58,16,393,75,549,107,-46,481,188,-68,409,120,-41,541,81,12,230,368,41,194,350,-50,224,361,-50,604,-28,-10,602,-27,35,486,56,-121,502,69,-120,457,-27,-110,226,317,-40,-584,-28,-124,439,-26,-30,467,-26,39,547,-27,-146,21,368,14,466,229,-29,578,-27,44,609,-27,-96,291,356,-15,290,306,34,255,321,28,231,311,-5,-251,386,50,-183,307,87,-152,307,24,-264,373,-12,-392,-27,190,-333,-28,84,-281,-27,54,-270,-28,-23,-308,-28,-101,-687,-27,-59,39,418,39,413,163,25,404,206,-90,54,400,-31,121,352,8,-454,41,148,-426,9,182,-564,115,3,-427,27,-107,-548,118,-32,-556,122,-53,-517,91,-101,-475,54,140,-461,52,-134,-558,119,-71,-434,286,59,-687,-31,52,-595,146,22,-670,-28,164,-537,166,122,-575,-28,217,-566,159,65,-470,152,136,-712,-29,102,-639,-29,211,-532,-30,181,-442,-30,-100],faces:[76,104,162,1,176,103,103,76,1,2,119,73,73,105,2,2,118,152,45,161,46,46,109,45,3,120,49,49,68,3,3,121,139,139,48,3,4,122,94,94,121,4,6,123,124,9,175,81,10,169,111,10,67,92,88,43,146,11,131,114,11,128,183,13,130,15,90,184,174,90,182,184,130,184,63,14,130,63,15,130,14,16,131,12,15,168,53,18,91,17,131,16,17,65,133,132,65,132,91,67,134,166,166,92,67,20,135,92,20,166,4,4,121,20,22,135,68,25,102,96,25,157,102,69,138,157,69,157,25,39,150,71,71,141,39,28,150,149,149,72,28,142,176,105,36,140,27,27,143,36,32,115,81,32,144,161,161,80,32,77,35,144,34,26,77,78,179,96,145,152,78,178,79,145,80,146,79,147,140,36,143,108,36,143,37,148,74,95,154,154,83,74,72,149,151,151,95,72,38,150,156,40,147,106,70,140,40,40,116,70,42,162,0,35,163,162,43,145,146,46,117,41,47,158,27,48,139,175,122,138,94,157,138,123,52,178,102,52,102,6,52,124,7,7,100,52,53,125,8,57,93,181,56,169,181,59,127,58,60,173,61,62,128,11,11,112,62,65,91,167,65,167,66,126,93,21,22,68,49,72,95,29,142,29,74,74,82,142,75,107,97,75,97,103,76,97,37,104,143,31,78,152,164,78,164,179,79,178,8,97,155,159,107,98,155,83,98,82,154,95,84,39,116,86,86,156,39,87,160,116,24,145,96,162,104,0,105,118,2,43,177,119,44,177,43,91,51,167,44,88,109,46,161,117,3,68,121,3,48,120,4,166,50,50,122,4,5,123,122,123,138,122,110,124,51,170,10,111,110,91,7,7,124,110,8,125,9,9,81,8,186,12,188,92,135,10,11,114,112,64,63,137,13,15,89,89,53,100,64,168,14,14,168,15,89,100,16,16,12,89,100,18,16,17,91,132,112,19,61,18,7,91,19,17,132,133,127,59,133,59,61,136,21,22,134,127,133,20,92,166,121,135,20,158,31,27,21,135,22,23,137,136,24,102,178,178,145,24,25,179,69,26,94,138,27,140,70,27,70,141,150,177,71,28,177,150,29,142,73,73,119,29,142,82,30,30,176,142,107,75,82,31,143,27,33,81,175,31,41,104,115,79,8,32,33,144,80,115,32,33,175,139,35,162,42,77,139,34,163,26,179,163,179,164,78,96,145,177,29,119,108,143,148,148,37,159,97,159,37,74,83,82,38,149,150,156,150,39,40,106,87,87,116,40,140,147,40,161,144,42,42,117,161,41,0,104,41,117,0,0,117,42,164,118,163,1,163,118,118,176,1,118,105,176,152,118,164,43,152,145,43,119,2,71,109,141,47,41,158,44,71,177,45,109,88,45,88,146,46,47,109,141,47,27,167,50,166,49,120,165,139,121,94,5,122,50,123,51,124,157,6,102,157,123,6,100,8,178,5,167,51,6,124,52,100,178,52,53,168,125,125,165,120,54,125,168,9,48,175,120,9,125,93,10,135,181,101,56,57,169,10,59,172,61,67,170,171,67,171,127,58,127,171,129,186,113,60,61,172,61,173,112,62,112,173,174,189,129,165,64,23,64,137,23,165,22,49,64,54,168,17,114,131,17,112,114,66,133,65,19,132,133,19,133,61,134,133,66,166,134,66,166,66,167,93,135,21,68,135,121,23,136,22,94,34,139,25,96,179,26,138,69,69,179,26,30,103,176,116,141,70,39,141,116,73,142,105,143,76,37,26,35,77,103,97,76,77,144,33,33,139,77,38,151,149,80,161,45,80,45,146,81,115,8,107,155,97,82,98,107,95,151,84,38,156,85,86,116,160,96,102,24,72,29,28,29,95,74,75,30,82,108,147,36,88,44,43,91,110,51,170,67,10,11,183,131,64,14,63,89,15,53,100,7,18,112,17,19,127,134,67,136,126,21,158,41,31,33,32,81,115,80,79,177,28,29,43,2,152,71,44,109,47,46,41,141,109,47,167,5,50,123,5,51,100,53,8,125,54,165,9,120,48,93,57,10,59,58,172,174,185,189,165,54,64,165,23,22,94,26,34,30,75,103,143,104,76,26,163,35,38,85,151,192,182,191,183,128,201,12,13,89,181,169,57,186,153,113,188,183,99,184,182,63,185,13,189,180,181,93,186,99,153,189,186,129,185,184,130,186,13,12,187,93,126,193,199,194,194,196,193,200,187,195,187,197,195,187,126,197,197,190,194,190,136,137,190,196,194,63,182,192,63,192,196,192,198,196,191,182,55,193,196,198,194,199,197,195,197,199,136,197,126,190,137,63,190,63,196,197,136,190,192,191,198,201,99,183,90,55,182,181,180,101,185,130,13,186,188,99,186,189,13,187,180,93,200,101,187,183,188,131,184,185,174,180,187,101,16,18,17,12,131,188,35,42,144,163,1,162,76,162,1,79,146,145]}],stones:[{type:"mesh",vertices:[-376,189,42,230,223,-310,353,162,-62,414,-23,-67,256,90,-475,24,85,-526,-418,-16,57,-432,66,-40,-199,151,-376,-155,49,467,-91,289,201,293,197,91,81,-17,-480,42,108,431,-359,-17,-250,383,-19,-243,194,-15,270,-272,180,293,-86,212,262,234,54,297,395,97,-302,-123,-21,-444,-416,-19,-123,-323,-18,267,-100,-16,429,-300,96,-361,163,-19,409,118,201,-431,-241,-18,391,-130,274,-309,306,-19,-399,-221,96,404],faces:[31,18,17,0,17,18,3,20,2,18,11,10,29,27,8,27,29,1,0,18,10,10,29,0,16,19,26,11,2,1,20,30,4,20,3,15,30,12,4,4,12,5,5,27,4,4,27,20,21,25,5,7,8,25,22,7,14,7,25,14,23,28,31,0,7,17,24,26,9,31,28,9,8,27,5,2,20,1,13,19,18,10,11,1,19,13,26,3,11,19,19,16,3,11,3,2,11,18,19,20,15,30,29,10,1,25,21,14,8,5,25,5,12,21,6,7,22,7,6,23,8,0,29,8,7,0,23,31,7,13,31,9,18,31,13,9,28,24,26,13,9,27,1,20,7,31,17]},{type:"mesh",vertices:[-217,34,-153,198,90,20,212,85,169,-131,93,171,197,113,30,173,121,164,315,29,-16,219,24,189,282,50,-102,232,38,-181,-195,-9,-166,-156,30,-207,-51,-9,-231,-180,91,-173,-19,73,-204,-280,23,96,-242,100,107,3,158,-82,109,88,221,275,-10,-40,236,-10,-135,-178,49,184,-1,-10,-243,265,-11,109,-12,-9,237,-36,46,251,-233,86,-81,93,77,-171,-163,133,69,18,16,263,296,44,93,131,-12,-226,-89,-10,-201,-273,-10,-51,-240,-9,110,190,-12,192,-253,-11,-92,42,43,-258,-115,-11,238,168,99,-88,-285,-10,24,71,124,-158,298,-10,10,116,150,-24,-282,44,39],faces:[44,16,26,13,26,16,0,26,13,27,14,41,4,5,1,7,30,2,28,5,43,41,39,27,17,43,41,43,4,39,13,28,17,17,41,13,28,43,17,24,29,38,29,35,7,18,25,29,5,18,2,18,5,3,30,42,6,30,35,23,19,20,8,8,20,9,9,39,8,1,30,8,31,37,9,11,14,37,14,27,37,32,11,12,11,37,12,11,0,13,33,40,44,44,26,33,33,0,36,34,38,15,44,40,15,21,3,16,27,39,9,2,30,1,21,25,3,16,3,28,28,3,5,4,43,5,41,43,39,13,16,28,25,21,38,38,29,25,7,18,29,29,24,35,18,7,2,18,3,25,30,23,42,30,7,35,8,30,6,6,19,8,6,42,19,8,39,1,37,31,22,27,9,37,9,20,31,10,11,32,11,10,0,12,37,22,14,13,41,14,11,13,33,26,0,36,0,10,21,44,15,16,44,21,15,40,34,38,21,15,4,1,39,5,2,1]},{type:"mesh",vertices:[-101,102,57,99,35,102,40,72,80,59,14,-168,-186,22,45,-176,25,-30,66,-7,146,153,-7,53,-110,47,-96,-90,-8,-146,150,-7,-12,-200,-7,8,-173,-7,-55,55,46,-60,125,-7,110,136,30,-10,-149,58,68,-15,82,-71,98,-7,-86,-34,-6,-194,-33,-7,171,-36,65,137,38,-8,-192,-103,-9,147,-12,62,-152],faces:[2,17,0,17,8,0,17,24,8,19,24,22,5,11,4,2,13,17,17,13,24,21,23,20,1,2,21,7,15,1,7,10,15,5,9,12,15,18,13,0,5,16,0,8,5,1,15,2,10,18,15,3,13,18,24,3,22,11,23,4,4,16,5,16,4,23,24,13,3,15,13,2,6,1,21,6,21,20,6,14,1,2,0,21,1,14,7,3,18,22,8,24,19,8,19,9,12,11,5,5,8,9,16,23,21,16,21,0]},{type:"mesh",vertices:[86,55,-18,58,38,73,97,-12,79,135,7,10,-93,-11,-72,-133,5,33,13,68,-32,94,-11,-57,-90,52,53,-24,-11,-106,-13,-10,104,-75,49,-69,-12,18,114,49,-12,-96,-46,-11,-85,-119,-11,-26,48,5,-111,-58,-11,105,-117,-12,52,-5,35,-93,123,-11,7],faces:[5,8,11,2,3,1,8,1,6,11,8,6,6,19,11,10,12,17,20,7,3,3,7,16,16,0,3,16,9,19,14,4,9,15,18,5,5,11,15,18,17,5,19,0,16,1,3,0,0,6,1,19,6,0,12,8,17,2,1,12,12,10,2,1,8,12,3,2,20,16,13,9,16,7,13,19,4,11,15,11,4,17,8,5,9,4,19]}],torii:[{type:"mesh",mirror:!0,flatShading:!0,vertices:[692,966,-52,661,834,-52,692,966,52,661,834,52,0,894,-52,0,776,-52,0,894,52,0,776,52,518,935,52,345,913,52,170,899,52,162,779,52,328,790,52,494,808,52,170,899,-52,345,913,-52,518,935,-52,494,808,-52,328,790,-52,162,779,-52,0,618,16,0,697,16,0,618,-16,0,697,-16,586,618,16,586,697,16,586,618,-16,586,697,-16,331,-29,-75,331,766,-52,369,-29,-65,357,766,-45,396,-29,-37,377,766,-26,406,-29,0,384,766,0,396,-29,37,377,766,26,369,-29,65,357,766,45,331,-29,75,331,766,52,294,-29,65,305,766,45,267,-29,37,286,766,26,257,-29,0,279,766,0,267,-29,-37,286,766,-26,294,-29,-65,305,766,-45,0,777,85,0,681,33,333,762,-75,333,806,-75,371,762,-65,371,806,-65,398,762,-37,398,806,-37,408,762,0,408,806,0,398,762,37,398,806,37,371,762,65,371,806,65,333,762,75,333,806,75,296,762,65,296,806,65,268,762,37,268,806,37,258,762,0,258,806,0,268,762,-37,268,806,-37,296,762,-65,296,806,-65,0,681,-33,0,777,-85,52,681,33,52,777,85,52,681,-33,52,777,-85],faces:[4,10,14,1,13,17,11,6,7,0,3,1,16,1,17,4,19,5,14,18,19,15,17,18,3,8,13,13,9,12,12,10,11,19,7,5,19,12,11,18,13,12,16,2,0,15,8,16,14,9,15,23,26,22,27,24,26,25,20,24,26,20,22,23,25,27,29,30,28,31,32,30,33,34,32,35,36,34,37,38,36,39,40,38,41,42,40,43,44,42,45,46,44,47,48,46,49,50,48,51,28,50,55,56,54,57,58,56,59,60,58,61,62,60,63,64,62,79,81,83,65,66,64,82,53,78,67,68,66,81,53,80,69,70,68,83,80,82,71,72,70,79,82,78,73,74,72,75,63,59,75,76,74,77,54,76,60,68,76,4,6,10,1,3,13,11,10,6,0,2,3,16,0,1,4,14,19,14,15,18,15,16,17,3,2,8,13,8,9,12,9,10,19,11,7,19,18,12,18,17,13,16,8,2,15,9,8,14,10,9,23,27,26,27,25,24,25,21,20,26,24,20,23,21,25,29,31,30,31,33,32,33,35,34,35,37,36,37,39,38,39,41,40,41,43,42,43,45,44,45,47,46,47,49,48,49,51,50,51,29,28,55,57,56,57,59,58,59,61,60,61,63,62,63,65,64,79,52,81,65,67,66,82,80,53,67,69,68,81,52,53,69,71,70,83,81,80,71,73,72,79,83,82,73,75,74,59,57,55,55,77,75,75,73,71,71,69,75,67,65,63,63,61,59,59,55,75,75,69,67,67,63,75,75,77,76,77,55,54,76,54,56,56,58,76,60,62,68,64,66,68,68,70,72,72,74,68,76,58,60,62,64,68,68,74,76]}],hexagons:[{type:"extrude",vertices:[-.198,-.302,.197,-.3,.372,0,.199,.298,-.202,.298,-.368,0]}],towers:[{type:"extrude",vertices:[-.054,-.178,-.007,-.182,.069,-.027,.189,.079,.178,.124,-.007,.097,-.145,.182,-.178,.144,-.079,-.021]},{type:"lathe",segments:4,vertices:[.004,.02,.012,.092,.042,.166,.067,.55,.101,.594,.105,.838,.193,.934,.18,.994]},{type:"lathe",segments:5,vertices:[.069,.216,.067,.562,.126,.562,.128,.774,.191,.774,.193,.986]}],trees:[{type:"lathe",noise:.015,segments:6,vertices:[1e-6,.826,.054,.832,.105,.854,.136,.9,.136,.958,.118,.994]},{type:"lathe",noise:.015,segments:14,vertices:[1e-6,.01,.069,.022,.13,.068,.178,.18,.189,.32,.191,.59,.193,.75,.138,.79,.018,.808,.018,.996]},{type:"lathe",noise:.015,segments:14,vertices:[1e-6,.436,.126,.46,.201,.57,.219,.72,.154,.846,.028,.884,.034,.996]}],apparatus:[{type:"lathe",segments:10,vertices:[1e-6,.23,.042,.23,.069,.36,.038,.362,.038,.372,.06,.372,.073,.572,.024,.572,.024,.67,.069,.67,.075,.722,.097,.724,.105,.852,.083,.902,.065,.902,.065,.924,.128,.924,.146,.996]},{type:"lathe",segments:16,vertices:[1e-6,.232,.229,.182,.486,.07,.356,.182,.213,.242,.154,.242,.144,.262,.178,.262,.126,.314,.04,.328,.038,.374,.058,.374,.071,.408,.026,.406,.03,.42,.091,.418,.034,.496,.01,.498,.03,.506,.014,.998]}],mushrooms:[{type:"lathe",noise:.02,segments:14,vertices:[1e-6,.006,.13,.018,.341,.084,.437,.144,.492,.234,.484,.246,.276,.232,.107,.284,.046,.346,.062,.852,.097,.956,.166,.998]},{type:"lathe",noise:.02,segments:10,vertices:[1e-6,.562,.091,.572,.172,.61,.223,.666,.256,.74,.258,.806,.246,.824,.062,.826,.065,.948,.097,.998]},{type:"lathe",noise:.02,segments:10,vertices:[1e-6,.768,.099,.772,.219,.802,.306,.844,.352,.886,.352,.908,.118,.904,.107,.93,.115,.966,.14,.996]}]};for(var s in this.assets)for(var d=0;d<this.assets[s].length;d++){var m=this.assets[s][d];if(m.type=="mesh")for(var _=0,y=m.vertices.length;_<y;_++)m.vertices[_]/=1e3}this.userFog=this.el.sceneEl.getAttribute("fog"),this.sky=document.createElement("a-sky"),this.sky.setAttribute("radius",this.STAGE_SIZE),this.sky.setAttribute("theta-length",110),this.sky.classList.add("environment"),this.stars=null,this.groundMaterial=null,this.ground=document.createElement("a-entity"),this.ground.setAttribute("rotation","-90 0 0"),this.ground.classList.add("environmentGround"),this.ground.classList.add("environment"),this.groundCanvas=null,this.groundTexture=null,this.groundMaterial=null,this.groundGeometry=null,this.dressing=document.createElement("a-entity"),this.dressing.classList.add("environmentDressing"),this.dressing.classList.add("environment"),this.gridCanvas=null,this.gridTexture=null,this.hemilight=document.createElement("a-entity"),this.hemilight.classList.add("environment"),this.hemilight.setAttribute("position","0 50 0"),this.hemilight.setAttribute("light",{type:"hemisphere",color:"#CEE4F0",intensity:.4}),this.sunlight=document.createElement("a-entity"),this.sunlight.classList.add("environment"),this.sunlight.setAttribute("position",this.data.lightPosition),this.sunlight.setAttribute("light",{intensity:.6}),this.el.appendChild(this.hemilight),this.el.appendChild(this.sunlight),this.el.appendChild(this.ground),this.el.appendChild(this.dressing),this.el.appendChild(this.sky)},getFogColor:function(s,d){var m;if(s=="color"||s=="none")m=new THREE.Color().setStyle(this.environmentData.skyColor,THREE.NoColorSpace);else if(s=="gradient")m=new THREE.Color().setStyle(this.environmentData.horizonColor,THREE.NoColorSpace);else if(s=="atmosphere"){var _=[1,.5,.22,.1,.05,0],y=["#C0CDCF","#81ADC5","#525e62","#2a2d2d","#141616","#000"];if(d<=0)return"#000";d=Math.min(1,d);for(var x=0;x<_.length;x++)if(d>_[x]){var R=new THREE.Color().setStyle(y[x-1],THREE.NoColorSpace),C=new THREE.Color().setStyle(y[x],THREE.NoColorSpace),L=(d-_[x])/(_[x-1]-_[x]);C.lerp(R,L),m=C;break}}return m.multiplyScalar(.9),m.lerp(new THREE.Color().setStyle(this.data.groundColor,THREE.NoColorSpace),.3),m.setRGB(m.r,m.g,m.b,THREE.SRGBColorSpace),"#"+m.getHexString()},update:function(s){var d;this.data.preset?(d=AFRAME.utils.clone(this.environmentData),this.environmentData={},Object.assign(this.environmentData,this.data),Object.assign(this.environmentData,this.presets[this.data.preset]),Object.assign(this.environmentData,this.el.components.environment.attrValue),console.log(this.environmentData)):(d=s,this.environmentData=this.data);var m=this.environmentData.skyType,_=new THREE.Vector3(this.environmentData.lightPosition.x,this.environmentData.lightPosition.y,this.environmentData.lightPosition.z);if(_.normalize(),this.sunlight){if(this.sunlight.setAttribute("position",this.environmentData.lightPosition),m!="atmosphere"){var y=new THREE.Color().setStyle(this.environmentData.skyColor,THREE.NoColorSpace);y.setRGB((y.r+1)/2,(y.g+1)/2,(y.b+1)/2,THREE.SRGBColorSpace),this.hemilight.setAttribute("light",{color:"#"+y.getHexString(),intensity:.6}),this.sunlight.setAttribute("light",{intensity:.6})}else this.hemilight.setAttribute("light",{color:"#CEE4F0",intensity:.1+.5*_.y}),this.sunlight.setAttribute("light",{intensity:.1+.5*_.y});this.sunlight.setAttribute("light",{castShadow:this.environmentData.shadow,shadowCameraLeft:-this.environmentData.shadowSize,shadowCameraBottom:-this.environmentData.shadowSize,shadowCameraRight:this.environmentData.shadowSize,shadowCameraTop:this.environmentData.shadowSize})}if(m!==d.skyType||this.environmentData.skyColor!=d.skyColor||this.environmentData.horizonColor!=d.horizonColor){var x={};x.shader={none:"flat",color:"flat",gradient:"gradientshader",atmosphere:"skyshader"}[m],this.stars&&this.stars.setAttribute("visible",m=="atmosphere"),m=="color"?(x.color=this.environmentData.skyColor,x.fog=!1):m=="gradient"&&(x.topColor=new THREE.Color().setStyle(this.environmentData.skyColor,THREE.NoColorSpace),x.bottomColor=new THREE.Color().setStyle(this.environmentData.horizonColor,THREE.NoColorSpace)),this.sky.setAttribute("material",x)}m=="atmosphere"&&(this.sky.setAttribute("material",{sunPosition:_}),this.setStars(2e3*(1-Math.max(0,8*(_.y+.08))))),this.environmentData.fog>0?this.el.sceneEl.setAttribute("fog",{color:this.getFogColor(m,_.y),far:(1.01-this.environmentData.fog)*this.STAGE_SIZE*2}):this.el.sceneEl.removeAttribute("fog"),this.sunlight.setAttribute("light",{type:this.environmentData.lighting=="point"?"point":"directional"}),this.sunlight.setAttribute("visible",this.environmentData.lighting!=="none"),this.hemilight.setAttribute("visible",this.environmentData.lighting!=="none");var R=!this.groundGeometry||this.environmentData.seed!=d.seed||this.environmentData.ground!=d.ground||this.environmentData.playArea!=d.playArea||this.environmentData.flatShading!=d.flatShading;(R||this.environmentData.groundColor!=d.groundColor||this.environmentData.groundColor2!=d.groundColor2||this.environmentData.groundYScale!=d.groundYScale||this.environmentData.groundTexture!=d.groundTexture||this.environmentData.gridColor!=d.gridColor||this.environmentData.grid!=d.grid)&&(this.updateGround(R),this.hemilight&&this.hemilight.setAttribute("light",{groundColor:this.environmentData.groundColor})),this.environmentData.seed==d.seed&&this.environmentData.dressingOnPlayArea==d.dressingOnPlayArea&&this.environmentData.dressing==d.dressing&&this.environmentData.flatShading==d.flatShading&&this.environmentData.dressingAmount==d.dressingAmount&&this.environmentData.dressingScale==d.dressingScale&&this.environmentData.dressingColor==d.dressingColor&&this.environmentData.dressingVariance.x==d.dressingVariance.x&&this.environmentData.dressingVariance.y==d.dressingVariance.y&&this.environmentData.dressingVariance.z==d.dressingVariance.z&&this.environmentData.dressingUniformScale==d.dressingUniformScale||this.updateDressing(),this.sky.setAttribute("visible",m!=="none"),this.el.setAttribute("visible",this.environmentData.active),this.environmentData.active||(this.userFog?this.el.sceneEl.setAttribute("fog",this.userFog):this.el.sceneEl.removeAttribute("fog")),this.dumpParametersDiff()},logPreset:function(){var s="{";for(var d in this.schema)if(d!="preset"){s+=d+": ";var m=this.schema[d].type;s+=m=="vec3"?"{ x: "+this.environmentData[d].x+", y: "+this.environmentData[d].y+", z: "+this.environmentData[d].z+"}":m=="string"||m=="color"?'"'+this.environmentData[d]+'"':this.environmentData[d],s+=", "}s+="}",console.log(s)},dumpParametersDiff:function(){function s(L){return Math.floor(1e3*L)/1e3}var d=[],m=this.data.preset!="none"&&this.presets[this.data.preset];m&&d.push("preset: "+this.data.preset);for(var _ in this.schema)if(!(_=="preset"||m&&m[_]===void 0)){var y=m?m[_]:this.schema[_].default,x=this.environmentData[_],R=this.schema[_].type;if(R=="vec3"){var C=y;typeof y=="string"&&(y=y.split(" "),C={x:y[0],y:y[1],z:y[2]}),s(C.x)==s(x.x)&&s(C.y)==s(x.y)&&s(C.z)==s(x.z)||d.push(_+": "+s(x.x)+" "+s(x.y)+" "+s(x.z))}else y!=x&&(this.schema[_].type=="number"&&(x=s(x)),d.push(_+": "+x))}console.log("%c"+d.join("; "),"color: #f48;font-weight:bold")},random:function(s){return parseFloat("0."+Math.sin(9999*this.environmentData.seed*s).toString().substr(7))},updateGround:function(s){var d=64;if(s){var m=this.environmentData.ground!="none";if(this.ground.setAttribute("visible",m),!m)return;this.groundGeometry||(this.groundGeometry=new THREE.PlaneGeometry(this.STAGE_SIZE+2,this.STAGE_SIZE+2,d-1,d-1));for(var _=new f(this.environmentData.seed),y=this.groundGeometry.attributes.position.array,x=y.length,R=10,C=R/d,L=0,N=0,B=2;B<x;B+=3)if(this.environmentData.ground!="flat"){var q;switch(this.environmentData.ground){case"hills":q=Math.max(0,_.noise(L,N,0));break;case"canyon":q=.2+.8*_.noise(L,N,0),q=Math.min(1,10*Math.pow(q,2));break;case"spikes":q=this.random(B)<.02?this.random(B+1):0;break;case"noise":q=this.random(B)<.35?this.random(B+1):0}q+=.1*this.random(B+2);var $=2*L/R-1,he=2*N/R-1,ce=this.environmentData.playArea;$=Math.max(0,Math.min(1,(Math.abs($)-(ce-.9))*(1/ce))),he=Math.max(0,Math.min(1,(Math.abs(he)-(ce-.9))*(1/ce))),q*=$>he?$:he,q<.01&&(q=0),y[B]=q,L+=C,L>=10&&(L=0,N+=C)}else y[B]=0;this.groundGeometry.computeVertexNormals(),this.groundGeometry.attributes.position.needsUpdate=!0,this.groundGeometry.attributes.normal.needsUpdate=!0}this.ground.setAttribute("scale",{z:this.environmentData.groundYScale});var Ee=2048,Ye=20,Ae=this.STAGE_SIZE/Ye;this.groundCanvas&&this.groundCanvas.width==Ee||(this.gridCanvas=document.createElement("canvas"),this.gridCanvas.width=Ee,this.gridCanvas.height=Ee,this.gridTexture=new THREE.Texture(this.gridCanvas),this.gridTexture.wrapS=THREE.RepeatWrapping,this.gridTexture.wrapT=THREE.RepeatWrapping,this.gridTexture.repeat.set(Ae,Ae),this.rendererSystem.applyColorCorrection(this.gridTexture),this.groundCanvas=document.createElement("canvas"),this.groundCanvas.width=Ee,this.groundCanvas.height=Ee,this.groundTexture=new THREE.Texture(this.groundCanvas),this.groundTexture.wrapS=THREE.RepeatWrapping,this.groundTexture.wrapT=THREE.RepeatWrapping,this.groundTexture.repeat.set(Ae,Ae),this.rendererSystem.applyColorCorrection(this.groundTexture),this.groundMaterialProps={map:this.groundTexture,emissive:new THREE.Color(16777215),emissiveMap:this.gridTexture},new THREE.Material().hasOwnProperty("shading")?this.groundMaterialProps.shading=this.environmentData.flatShading?THREE.FlatShading:THREE.SmoothShading:this.groundMaterialProps.flatShading=this.environmentData.flatShading,this.groundMaterial=new THREE.MeshLambertMaterial(this.groundMaterialProps));var ee=this.groundCanvas.getContext("2d"),de=this.gridCanvas.getContext("2d");if(this.drawTexture(ee,Ee,Ye),de.fillStyle="#000000",de.fillRect(0,0,Ee,Ee),this.drawGrid(de,Ee,Ye),this.groundTexture.needsUpdate=!0,this.gridTexture.needsUpdate=!0,s){var De=new THREE.Mesh(this.groundGeometry,this.groundMaterial);this.ground.setObject3D("mesh",De)}else this.ground.getObject3D("mesh").material=this.groundMaterial;this.ground.setAttribute("shadow",{cast:!1,receive:this.environmentData.shadow})},drawGrid:function(s,d,m){if(this.environmentData.grid!="none"){var _,y,x,R=Math.floor(m/2),C=d/(m/2);switch(s.fillStyle=this.environmentData.gridColor,this.environmentData.grid){case"1x1":case"2x2":for(this.environmentData.grid=="1x1"&&(R*=2,C=d/m),_=0;_<R;_++)x=Math.floor(_*C),s.fillRect(0,x,d,1),s.fillRect(x,0,1,d);break;case"crosses":var L=Math.floor(C/20);for(_=0;_<R+1;_++)for(x=Math.floor(_*C),y=0;y<R+1;y++){var N=Math.floor(-L+y*C);s.fillRect(N,x,2*L,1),s.fillRect(x,N,1,2*L)}break;case"dots":for(_=0;_<R+1;_++)for(y=0;y<R+1;y++)s.beginPath(),s.arc(Math.floor(y*C),Math.floor(_*C),4,0,2*Math.PI),s.fill();break;case"xlines":for(_=0;_<R;_++)s.fillRect(Math.floor(_*C),0,1,d);break;case"ylines":for(_=0;_<R;_++)s.fillRect(0,Math.floor(_*C),d,1)}}},drawTexture:function(s,d,m){s.fillStyle=this.environmentData.groundColor,s.fillRect(0,0,d,d);var _,y,x,R,C,L,N;if(this.environmentData.groundTexture!="none")switch(this.environmentData.groundTexture){case"checkerboard":s.fillStyle=this.environmentData.groundColor2;var B=Math.floor(m/2),q=d/(m/2);for(_=0;_<B+1;_+=2)for(var $=0;$<B+1;$++)s.fillRect(Math.floor((_+$%2)*q),Math.floor($*q),Math.floor(q),Math.floor(q));break;case"squares":var he=16,ce=d/he;for(x=new THREE.Color().setStyle(this.environmentData.groundColor,THREE.NoColorSpace),R=new THREE.Color().setStyle(this.environmentData.groundColor2,THREE.NoColorSpace),_=0;_<he*he;_++)y=this.random(_+3)>.5?x.clone():R.clone(),y.addScalar(.1*this.random(_+3)-.05),s.fillStyle="#"+y.getHexString(THREE.NoColorSpace),s.fillRect(_%he*ce,Math.floor(_/he)*ce,ce,ce);break;case"noise":L=s.getImageData(0,0,d,d),C=L.data,x=new THREE.Color().setStyle(this.environmentData.groundColor,THREE.NoColorSpace),R=new THREE.Color().setStyle(this.environmentData.groundColor2,THREE.NoColorSpace);var Ee=new THREE.Color(R.r-x.r,R.g-x.g,R.b-x.b),Ye=new f;for(_=0,$=0,N=C.length;_<N;_+=4,$++){var Ae=Ye.noise($%d/d*3,$/d/d*3,0);C[_+0]=Math.floor(255*(x.r+Ee.r*Ae)),C[_+1]=Math.floor(255*(x.g+Ee.g*Ae)),C[_+2]=Math.floor(255*(x.b+Ee.b*Ae))}s.putImageData(L,0,0);break;case"walkernoise":var ee=Math.floor(d/2),de=document.createElement("canvas");de.width=ee,de.height=ee;var De=de.getContext("2d");De.fillStyle=this.environmentData.groundColor,De.fillRect(0,0,ee,ee),L=De.getImageData(0,0,ee,ee),C=L.data,x=new THREE.Color().setStyle(this.environmentData.groundColor,THREE.NoColorSpace),R=new THREE.Color().setStyle(this.environmentData.groundColor2,THREE.NoColorSpace);var Se=[],ve=1e3;for(_=0;_<ve;_++)y=x.clone().lerp(R,Math.random()),Se.push({x:Math.random()*ee,y:Math.random()*ee,r:Math.floor(255*y.r),g:Math.floor(255*y.g),b:Math.floor(255*y.b)});for(var Ge=5e3,Xt=0;Xt<Ge;Xt++)for(_=0;_<ve;_++){var xt=Se[_],At=4*Math.floor(xt.y*ee+xt.x);C[At+0]=xt.r,C[At+1]=xt.g,C[At+2]=xt.b,xt.x+=Math.floor(3*Math.random())-1,xt.y+=Math.floor(3*Math.random())-1,xt.x>=ee&&(xt.x=xt.x-ee),xt.y>=ee&&(xt.y=xt.y-ee),xt.x<0&&(xt.x=ee+xt.x),xt.y<0&&(xt.y=ee+xt.y)}De.putImageData(L,0,0),s.drawImage(de,0,0,d,d)}},getAssetGeometry:function(s){function d(Ee,Ye){for(var Ae=(new THREE.Vector3,Ee.attributes.position.array),ee=Ae.length,de=0;de<ee;de+=3)Ae[de]=(R.random(de)-.5)*Ye,Ae[de+1]=(R.random(de+ee)-.5)*Ye,Ae[de+2]=(R.random(de+2*ee)-.5)*Ye;Ee.attributes.position.needsUpdate=!0}if(!s)return null;for(var m,_,y,x=[],R=this,C=0;C<s.length;C++)if(s[C].type=="lathe"){var L=-99999,N=[];for(y=s[C].vertices,m=0;m<y.length;m+=2)N.push(new THREE.Vector2(y[m],y[m+1])),y[m+1]>L&&(L=y[m+1]);_=new THREE.LatheGeometry(N,s[C].segments||8),_.applyMatrix4(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-Math.PI,0,0))),_.applyMatrix4(new THREE.Matrix4().makeTranslation(0,L,0)),_=_.toNonIndexed(),x.push(_)}else if(s[C].type=="extrude"){var B=new THREE.Shape;for(y=s[C].vertices,m=0;m<y.length;m+=2)m==0?B.moveTo(y[m],y[m+1]):B.lineTo(y[m],y[m+1]);_=new THREE.ExtrudeGeometry(B,{amount:1,bevelEnabled:!1}),_.applyMatrix4(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(-Math.PI/2,0,0))),s[C].noise&&d(_,s[C].noise),x.push(_)}else if(s[C].type=="mesh"){_=new THREE.BufferGeometry,y=s[C].vertices;var q=s[C].faces,$=new Float32Array(y);if(_.setIndex(q),_.setAttribute("position",new THREE.BufferAttribute($,3)),s[C].mirror){var he=_.clone();he.applyMatrix4(new THREE.Matrix4().makeRotationFromEuler(new THREE.Euler(0,Math.PI,0)));var ce=THREE.BufferGeometryUtils.mergeGeometries||THREE.BufferGeometryUtils.mergeBufferGeometries;_=ce([_,he])}s[C].noise&&d(_,s[C].noise),_=_.toNonIndexed(),_.computeVertexNormals(),x.push(_)}return x},updateDressing:function(){var s=new THREE.Object3D,d=[];if(this.dressing.setAttribute("visible",this.environmentData.dressing!="none"),this.environmentData.dressing!="none"){var m;switch(this.environmentData.dressing){case"cubes":m=[new THREE.BoxGeometry(1,1,1)],m[0].applyMatrix4(new THREE.Matrix4().makeTranslation(0,.5,0));break;case"pyramids":m=[new THREE.ConeGeometry(1,1,4,1,!0)],m[0].applyMatrix4(new THREE.Matrix4().makeTranslation(0,.5,0));break;case"cylinders":m=[new THREE.CylinderGeometry(.5,.5,1,8,1,!0)],m[0].applyMatrix4(new THREE.Matrix4().makeTranslation(0,.5,0));break;default:if(m=this.getAssetGeometry(this.assets[this.environmentData.dressing]),!m)return}for(var _=0,y=88343;_<this.environmentData.dressingAmount;_++,y++){var x,R=m[Math.floor(this.random(33+_)*m.length)].clone(),C=this.environmentData.dressingScale,L=new THREE.Vector3(this.environmentData.dressingVariance.x,this.environmentData.dressingVariance.y,this.environmentData.dressingVariance.z),N=this.random(y)<this.environmentData.dressingOnPlayArea;x=N?15*this.random(y+1):10+Math.max(L.x,L.z)+10*this.random(y+1)+this.random(y+2)*this.STAGE_SIZE/3;var B=this.random(y+3)*Math.PI*2,q=new THREE.Matrix4,$=this.random(y+4),he=this.environmentData.dressingUniformScale;q.compose(new THREE.Vector3(Math.cos(B)*x,0,Math.sin(B)*x),new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(0,1,0),(this.random(y+5)-.5)*L.length()*Math.PI*2),new THREE.Vector3(C+(he?$:this.random(y+6))*L.x,C+(he?$:this.random(y+7))*L.y,C+(he?$:this.random(y+8))*L.z)),R.applyMatrix4(q),d.push(R)}var ce=THREE.BufferGeometryUtils.mergeGeometries||THREE.BufferGeometryUtils.mergeBufferGeometries,Ee=ce(d);Ee.attributes.position.needsUpdate=!0;var Ye=new THREE.MeshLambertMaterial({color:new THREE.Color(this.environmentData.dressingColor)});this.rendererSystem.applyColorCorrection(Ye.color);var Ae=new THREE.Mesh(Ee,Ye);s.add(Ae),this.dressing.setObject3D("mesh",s)}},createStars:function(){for(var s=2e3,d=new THREE.BufferGeometry,m=new Float32Array(3*s),_=this.STAGE_SIZE-1,y=new THREE.Vector3,x=0;x<m.length;x+=3)y.set(this.random(x+23)-.5,this.random(x+24),this.random(x+25)-.5),y.normalize(),y.multiplyScalar(_),m[x]=y.x,m[x+1]=y.y,m[x+2]=y.z;d.setAttribute("position",new THREE.BufferAttribute(m,3)),d.setDrawRange(0,0);var R=new THREE.PointsMaterial({size:.01,color:13421772,fog:!1});this.rendererSystem.applyColorCorrection(R.color),this.stars.setObject3D("mesh",new THREE.Points(d,R))},setStars:function(s){this.stars||(this.stars=document.createElement("a-entity"),this.stars.id="stars",this.createStars(),this.el.appendChild(this.stars)),s=Math.floor(Math.min(2e3,Math.max(0,s))),this.stars.getObject3D("mesh").geometry.setDrawRange(0,s)}}),AFRAME.registerShader("skyshader",{schema:{exposureBias:{type:"number",default:1,min:0,max:10,is:"uniform"},turbidity:{type:"number",default:2,min:0,max:20,is:"uniform"},reileigh:{type:"number",default:1,min:0,max:4,is:"uniform"},mieCoefficient:{type:"number",default:.005,min:0,max:.1,is:"uniform"},mieDirectionalG:{type:"number",default:.8,min:0,max:1,is:"uniform"},sunPosition:{type:"vec3",default:{x:0,y:0,z:-1},is:"uniform"},color:{type:"color",default:"#fff"}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","#include <dithering_pars_fragment>","uniform sampler2D skySampler;","uniform vec3 sunPosition;","varying vec3 vWorldPosition;","vec3 cameraPos = vec3(0., 0., 0.);","uniform float exposureBias;","uniform float turbidity;","uniform float reileigh;","uniform float mieCoefficient;","uniform float mieDirectionalG;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float pn = 0.035;","const vec3 lambda = vec3(680E-9, 550E-9, 450E-9);","const vec3 K = vec3(0.686, 0.678, 0.666);","const float v = 4.0;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3(0.0, 1.0, 0.0);","const float EE = 1000.0;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float cutoffAngle = pi/1.95;","const float steepness = 1.5;","vec3 totalRayleigh(vec3 lambda)","{","return (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn));","}","vec3 simplifiedRayleigh()","{","return 0.0005 / vec3(94, 40, 18);","}","float rayleighPhase(float cosTheta)","{   ","return (3.0 / (16.0*pi)) * (1.0 + pow(cosTheta, 2.0));","}","vec3 totalMie(vec3 lambda, vec3 K, float T)","{","float c = (0.2 * T ) * 10E-18;","return 0.434 * c * pi * pow((2.0 * pi) / lambda, vec3(v - 2.0)) * K;","}","float hgPhase(float cosTheta, float g)","{","return (1.0 / (4.0*pi)) * ((1.0 - pow(g, 2.0)) / pow(1.0 - 2.0*g*cosTheta + pow(g, 2.0), 1.5));","}","float sunIntensity(float zenithAngleCos)","{","return EE * max(0.0, 1.0 - exp(-((cutoffAngle - acos(zenithAngleCos))/steepness)));","}","// Filmic ToneMapping http://filmicgames.com/archives/75","float A = 0.15;","float B = 0.50;","float C = 0.10;","float D = 0.20;","float E = 0.02;","float F = 0.30;","float W = 1000.0;","vec3 Uncharted2Tonemap(vec3 x)","{","return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;","}","void main() ","{","float sunfade = 1.0-clamp(1.0-exp((sunPosition.y/450000.0)),0.0,1.0);","float reileighCoefficient = reileigh - (1.0* (1.0-sunfade));","vec3 sunDirection = normalize(sunPosition);","float sunE = sunIntensity(dot(sunDirection, up));","vec3 betaR = simplifiedRayleigh() * reileighCoefficient;","vec3 betaM = totalMie(lambda, K, turbidity) * mieCoefficient;","float zenithAngle = acos(max(0.0, dot(up, normalize(vWorldPosition - cameraPos))));","float sR = rayleighZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","float sM = mieZenithLength / (cos(zenithAngle) + 0.15 * pow(93.885 - ((zenithAngle * 180.0) / pi), -1.253));","vec3 Fex = exp(-(betaR * sR + betaM * sM));","float cosTheta = dot(normalize(vWorldPosition - cameraPos), sunDirection);","float rPhase = rayleighPhase(cosTheta*0.5+0.5);","vec3 betaRTheta = betaR * rPhase;","float mPhase = hgPhase(cosTheta, mieDirectionalG);","vec3 betaMTheta = betaM * mPhase;","vec3 Lin = pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * (1.0 - Fex),vec3(1.5));","Lin *= mix(vec3(1.0),pow(sunE * ((betaRTheta + betaMTheta) / (betaR + betaM)) * Fex,vec3(1.0/2.0)),clamp(pow(1.0-dot(up, sunDirection),5.0),0.0,1.0));","vec3 direction = normalize(vWorldPosition - cameraPos);","float theta = acos(direction.y); // elevation --> y-axis, [-pi/2, pi/2]","float phi = atan(direction.z, direction.x); // azimuth --> x-axis [-pi/2, pi/2]","vec2 uv = vec2(phi, theta) / vec2(2.0*pi, pi) + vec2(0.5, 0.0);","vec3 L0 = vec3(0.1) * Fex;","float sundisk = smoothstep(sunAngularDiameterCos,sunAngularDiameterCos+0.00002,cosTheta);","L0 += (sunE * 19000.0 * Fex)*sundisk;","vec3 whiteScale = 1.0/Uncharted2Tonemap(vec3(W));","vec3 texColor = (Lin+L0);","texColor *= 0.04;","texColor += vec3(0.0,0.001,0.0025)*0.3;","vec3 curr = Uncharted2Tonemap(exposureBias*texColor);","vec3 color = curr*whiteScale;","vec3 retColor = pow(color,vec3(1.0/(1.2+(1.2*sunfade))));","gl_FragColor.rgb = retColor;","gl_FragColor.a = 1.0;","#include <dithering_fragment>","}"].join(`
`)}),AFRAME.registerShader("gradientshader",{schema:{topColor:{type:"color",default:"1 0 0",is:"uniform"},bottomColor:{type:"color",default:"0 0 1",is:"uniform"}},vertexShader:["varying vec3 vWorldPosition;","void main() {"," vec4 worldPosition = modelMatrix * vec4( position, 1.0 );"," vWorldPosition = worldPosition.xyz;"," gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0 );","}"].join(`
`),fragmentShader:["#include <common>","#include <dithering_pars_fragment>","uniform vec3 bottomColor;","uniform vec3 topColor;","uniform float offset;","varying vec3 vWorldPosition;","void main() {"," float h = normalize( vWorldPosition ).y;"," gl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max(h, 0.0 ), 0.8 ), 0.0 ) ), 1.0 );"," #include <dithering_fragment>","}"].join(`
`)});var f=function(s){var d;this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];var m;for(m=0;m<256;m++)d=parseFloat("0."+Math.sin(9999*s*m).toString().substr(7)),this.p[m]=Math.floor(256*d);for(this.perm=[],m=0;m<512;m++)this.perm[m]=this.p[255&m]};f.prototype.dot=function(s,d,m,_){return s[0]*d+s[1]*m+s[2]*_},f.prototype.mix=function(s,d,m){return(1-m)*s+m*d},f.prototype.fade=function(s){return s*s*s*(s*(6*s-15)+10)},f.prototype.noise=function(s,d,m){var _=Math.floor(s),y=Math.floor(d),x=Math.floor(m);s-=_,d-=y,m-=x,_&=255,y&=255,x&=255;var R=this.perm[_+this.perm[y+this.perm[x]]]%12,C=this.perm[_+this.perm[y+this.perm[x+1]]]%12,L=this.perm[_+this.perm[y+1+this.perm[x]]]%12,N=this.perm[_+this.perm[y+1+this.perm[x+1]]]%12,B=this.perm[_+1+this.perm[y+this.perm[x]]]%12,q=this.perm[_+1+this.perm[y+this.perm[x+1]]]%12,$=this.perm[_+1+this.perm[y+1+this.perm[x]]]%12,he=this.perm[_+1+this.perm[y+1+this.perm[x+1]]]%12,ce=this.dot(this.grad3[R],s,d,m),Ee=this.dot(this.grad3[B],s-1,d,m),Ye=this.dot(this.grad3[L],s,d-1,m),Ae=this.dot(this.grad3[$],s-1,d-1,m),ee=this.dot(this.grad3[C],s,d,m-1),de=this.dot(this.grad3[q],s-1,d,m-1),De=this.dot(this.grad3[N],s,d-1,m-1),Se=this.dot(this.grad3[he],s-1,d-1,m-1),ve=this.fade(s),Ge=this.fade(d),Xt=this.fade(m),xt=this.mix(ce,Ee,ve),At=this.mix(ee,de,ve),M=this.mix(Ye,Ae,ve),I=this.mix(De,Se,ve),O=this.mix(xt,M,Ge),A=this.mix(At,I,Ge),T=this.mix(O,A,Xt);return T}}]);AFRAME.registerComponent("cursor-listener",{init(){this.el.addEventListener("click",function(o){let c=o.target.attributes["post-url"];c&&window.vueRouter.push(`/${c.value}`)})}});const Tp=lb(qE);Tp.use(hb());Tp.use(wv);Tp.mount("#trollfield-app");
//# sourceMappingURL=index.js.map
